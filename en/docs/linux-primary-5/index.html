<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-linux/primary/linux-primary-5">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">第 5 章 Linux 磁盘管理 - Linux技术分享</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://zhangqf.com/en/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://zhangqf.com/en/img/logo.png"><meta data-rh="true" property="og:url" content="https://zhangqf.com/en/docs/linux-primary-5"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="第 5 章 Linux 磁盘管理 - Linux技术分享"><meta data-rh="true" name="description" content="一般情况下，采购回来的磁盘都是裸磁盘，需要格式化成文件系统后才能存储数据，所以磁盘管理和文件系统管理是密不可分的。当今主流的硬盘有机械硬盘和固态硬盘两种形态。下面分别介绍。"><meta data-rh="true" property="og:description" content="一般情况下，采购回来的磁盘都是裸磁盘，需要格式化成文件系统后才能存储数据，所以磁盘管理和文件系统管理是密不可分的。当今主流的硬盘有机械硬盘和固态硬盘两种形态。下面分别介绍。"><meta data-rh="true" name="keywords" content="linux,Disk"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zhangqf.com/en/docs/linux-primary-5"><link data-rh="true" rel="alternate" href="https://zhangqf.com/en/docs/linux-primary-5" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://zhangqf.com/docs/linux-primary-5" hreflang="zh"><link data-rh="true" rel="alternate" href="https://zhangqf.com/docs/linux-primary-5" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://9B0V5WT2X8-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S4SD5NXWXF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S4SD5NXWXF",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Linux技术分享" href="/en/opensearch.xml">
<link rel="preconnect" href="https://zhangqf.com/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://zhangqf.com/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script>


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c9a3849aa75f9c4a4e65f846cd1a5155",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/en/rss.xml" title="zhangqf RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/atom.xml" title="zhangqf Atom Feed">
<link rel="alternate" type="application/json" href="/en/feed.json" title="zhangqf JSON Feed">

<link rel="icon" href="/en/img/logo.png">
<link rel="manifest" href="/en/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)"><link rel="stylesheet" href="/en/assets/css/styles.86c9ae18.css">
<link rel="preload" href="/en/assets/js/runtime~main.06ffa367.js" as="script">
<link rel="preload" href="/en/assets/js/main.7f2e5564.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><span>更新 <a href="/website">网址导航</a> 带你发现感兴趣的技术</span></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">kuizuo</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/en/docs/linux">Linux</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/docs/category/Linux基础">Linux 基础</a></li><li><a class="dropdown__link" href="/en/docs/category/Linux进阶">Linux 进阶</a></li><li><a class="dropdown__link" href="/en/docs/category/Linux测试">Linux 测试</a></li><li><a class="dropdown__link" href="/en/docs/category/LinuxCICD">Linux CICD研发</a></li><li><a class="dropdown__link" href="/en/docs/skill/">Notes</a></li><li><a class="dropdown__link" href="/en/docs/tools/">Recommended Tools</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Blog</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/en/tags">Tags</a></li><li><a class="dropdown__link" href="/en/archive">Archive</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Tools</a><ul class="dropdown__menu"><li><a href="https://api.kuizuo.cn" target="_blank" rel="noopener noreferrer" class="dropdown__link">API Service</a></li><li><a href="https://js-de-obfuscator.vercel.app" target="_blank" rel="noopener noreferrer" class="dropdown__link">JS Deobfuscate</a></li><li><a href="https://cipher.kuizuo.cn" target="_blank" rel="noopener noreferrer" class="dropdown__link">CyberChef Encryption</a></li><li><a href="https://pan.kuizuo.cn" target="_blank" rel="noopener noreferrer" class="dropdown__link">Cloudreve</a></li></ul></div><a class="navbar__item navbar__link" href="/en/website">Links</a><a class="navbar__item navbar__link" href="/en/project">Projects</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/en/"><img src="/en/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--dark_i4oU"><b>kuizuo</b></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/linux">linux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/en/docs/category/linux基础">Linux基础</a><button aria-label="Toggle the collapsible sidebar category &#x27;Linux基础&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-1">第 1 章 Linux 基础命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-2">第 2 章 Linux 系统用户</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-3">第 3 章 Linux 文件权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-4">第 4 章 Linux ext 文件系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/linux-primary-5">第 5 章 Linux 磁盘管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-6">第 6 章 Linux LVM 存储管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-7">第 7 章 Linux Raid 存储管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-8">第 8 章 Linux 包管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-9">第 9 章 Linux 进程和信号</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-10">第 10 章 Linux 系统资源监控</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-11">第 11 章 Linux 服务管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-12">第 12 章 Linux 定时任务</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-13">第 13 章 Linux 网络管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/linux-primary-14">第 14 章 Linux 开机启动流程(UEFI+systemd)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/linux进阶">Linux进阶</a><button aria-label="Toggle the collapsible sidebar category &#x27;Linux进阶&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/linux测试">Linux测试</a><button aria-label="Toggle the collapsible sidebar category &#x27;Linux测试&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/linuxcicd">LinuxCICD</a><button aria-label="Toggle the collapsible sidebar category &#x27;LinuxCICD&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/category/linux基础"><span itemprop="name">Linux基础</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">第 5 章 Linux 磁盘管理</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>第 5 章 Linux 磁盘管理</h1></header><p>一般情况下，采购回来的磁盘都是裸磁盘，需要格式化成文件系统后才能存储数据，所以磁盘管理和文件系统管理是密不可分的。当今主流的硬盘有机械硬盘和固态硬盘两种形态。下面分别介绍。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51机械硬盘">5.1、机械硬盘<a class="hash-link" href="#51机械硬盘" title="Direct link to heading">​</a></h2><p><img loading="lazy" alt="real physical disk" src="/en/assets/images/real physical disk-6fc686365d0a4ad0930b0a1b086e4d50.png" width="768" height="608" class="img_ev3q"></p><p>机械硬盘由多块盘片组成，它们都绕着主轴旋转。</p><p>每块盘片上下方都有读写磁头悬浮在盘片上下方，它们与盘片的距离极小。</p><p>每次读写数据时盘片旋转，读写磁头被磁臂控制着不断的移动来读取其中的数据。</p><p>所有的盘片都是同时同步转动，所有的磁头也是同步移动。</p><p><img loading="lazy" alt="disk track" src="/en/assets/images/disk track-f8cf0f3d21f04c9715590807bc3ed651.png" width="564" height="351" class="img_ev3q"></p><p>磁盘在物理上划分了扇区、磁道和柱面。如果划分了分区，则分区是逻辑上柱面的分隔边界。</p><p>读写磁头在停止状态下，在盘片旋转时磁头扫过的一圈轨迹称为磁道，所有的磁道都是同心圆。从盘片外圈开始向内数，磁道号从 0 开始逐数增加。</p><p>每个磁道以 512 字节等分为多个弧段，每个弧段就是一个扇区。但是需要说明的是，扇区的大小并非一定是 512 字节。</p><p>所以外圈磁道的扇区数较多，内圈磁道的扇区数较少，有些硬盘参数上写的磁道扇区数通常用一个范围来标识，如 373-768 表示最外圈磁道有 768 个扇区，最内圈有 373 个扇区，这就可以计算出每个磁道的字节数。</p><p>扇区上记录了物理数据、扇区号、磁头号(或者盘片号)及磁道号。</p><p><img loading="lazy" alt="disk zone track" src="/en/assets/images/disk zone track-544be3024875b36a542b49e5447d7840.png" width="546" height="319" class="img_ev3q"></p><p>旧式磁盘的结构不分区(without zones)，每个磁道扇区数相同，但是每个扇区仍然是 512 字节，也就是说磁性材料记录的 0 和 1 的数量是相同的。这种结构的缺点是外圈磁道的面积大，存储的数据分布宽松，内圈磁道面积小，存储的数据分布密集，这样就导致盘片外圈面积浪费。</p><p>新式磁盘结构进行了分区，将每个磁道等面积划分 512 字节的空间作为一个扇区，所以不同磁道扇区数不同。</p><p>现在的磁盘都是新式扇区划分结构。</p><p><img loading="lazy" alt="disk cylinder" src="/en/assets/images/disk cylinder-14a3d68180963eeb4a27170daa3a6fc0.png" width="388" height="385" class="img_ev3q"></p><p>将所有盘片相同磁道数的磁道划分为柱面。和磁道号的标记方式一样，从外向内从 0 开始逐数增加。</p><p>之所以划分柱面，是因为所有磁盘同步旋转，所有磁头同步移动，所有的磁头在任意一个时刻总是会出在同一个磁道同一个扇区上。读写数据时，任意一段数据总是按柱面来读写的。所以盘片数越多，读写所扫的扇区数就越少，所需的时间相对就越少，性能就越好。</p><p>向磁盘写数据是从外圈柱面向内圈柱面写的，只有写完一个柱面才写下一个柱面。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52固态硬盘">5.2、固态硬盘<a class="hash-link" href="#52固态硬盘" title="Direct link to heading">​</a></h2><p><img loading="lazy" alt="ssd" src="/en/assets/images/SSD-6d6e06cd4b10dc429329163e17d68e29.png" width="679" height="570" class="img_ev3q"></p><p>不像机械硬盘里的一摞子圆形碟片，SSD 是由一些电路和黑色的存储颗粒构成。</p><p>SSD 硬盘是基于 NAND Flash 存储技术的，属于非易失性存储设备，换成人话说，就是掉电了数据不会丢。</p><p>其中每一个黑色的存储颗粒也叫做一个 Die。 我们 &quot;拆开&quot; 一个 Die 来看一下。</p><p><img loading="lazy" alt="SSD die" src="/en/assets/images/SSD die-3b8330ba7605c095ccc7cd50cb7d5a57.png" width="436" height="355" class="img_ev3q"></p><p>每个 Die 有若干个 Plane，每个 Plane 有若干个 Block，每个 Block 有若干个 Page。Page 是磁盘进行读写的最小单位，一般为 2KB/4KB/8KB/16KB 等。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="521ssd-扇区">5.2.1、SSD 扇区<a class="hash-link" href="#521ssd-扇区" title="Direct link to heading">​</a></h3><p>由于历史原因，操作系统等软件里，512KB 扇区的概念是“根深蒂固”。新的机械硬盘虽然把物理扇区已经做到 4KB 的了，但为了兼容老系统还得整出个逻辑扇区的概念来适配。</p><p>到了 SSD 里也一样，虽然每一个物理 Page 的大小为 2K 到 16K 不等，但是为了兼容性，也必须得整出个逻辑扇区才行。</p><p>SSD 控制器在逻辑上会把整个磁盘再重新划分成一个个的“扇区”，采用和新机械硬盘一样的 LBA 方式来进行编址（整个磁盘的扇区从 0 到某个最大值方式排列，并连成一条线）。</p><p>当需要读取某几个 &quot;扇区&quot; 上数据的时候，SSD 控制器通过访问这个 LBA MapTable, 再来找到要实际访问的物理 Page，如下图：</p><p><img loading="lazy" alt="SSD addressing" src="/en/assets/images/SSD addressing-40237d119d41bfe7b9ff1b0e3ee7f8c7.png" width="1097" height="413" class="img_ev3q"></p><ul><li>假设某 SSD 的 Page 大小是 4KB，一个文件是 16KB。那么该文件是存在一个黑色的存储颗粒里,还是多个？<ul><li>假设只写在一个颗粒里，那么对该文件进行读取的时候，就只能用到一条 Flash 通道，这样速度就会比较慢。</li><li>如果存在相邻的 4 个颗粒里，每个写入 4KB。这样多个 Flash 通道的带宽会充分发挥出来，传输速度也更快。所以，实际中是分散在多个。</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="522闪存单元">5.2.2、闪存单元<a class="hash-link" href="#522闪存单元" title="Direct link to heading">​</a></h3><p>SSD 是由一个个的 Page 组成。而在每一个 Page 里，又包含了许许多多的闪存单元。。现代的闪存单元有多种类型，目前主流的主要分为 SLC、MLC 和 TLC。</p><p><img loading="lazy" alt="SSD SLC MLC TLC" src="/en/assets/images/SSD SLC MLC TLC-444e01187b8bc3d944041adadc30e4cd.png" width="440" height="330" class="img_ev3q"></p><p>在 SLC 里，一个单元的电压只分成高低两种状态，所以只能表示 1bit 数据。</p><p>到了 MLC，硬是把一个单元里的电压按照高低分成了四种状态，所以可以表示 2bit。</p><p>到了TLC，直接一个单元应拆分成8个电压高低不同的状态，为了表示3bit。</p><ul><li>由于TLC在数据读写需要八种不同电压状态，而施加不同的电压状态、 就需要更精确，也就需要更长的时间才能得以实现。另外由于电压状态多，出错的可能性也会更大。</li></ul><p>以上三种闪存单元对比：从性能和稳定性角度来看，SLC 最好。从容量角度看，TLC 最大。这就是为什么日常我们看到的工业级的 SSD 要比笔记本 SSD 要贵很多，其中一个很重要的原因就是工业级的盘往往采用的闪存单元是 SLC 或 MLC，而我们家用的笔记本一般都是 TCL，因为便宜嘛。目前主流闪存类型 TLC 居多，因为价格便宜，容量大。</p><table><thead><tr><th>闪存类型</th><th>单 cell 电压变化</th><th>单 cell 表示 bit 数</th><th>速度</th><th>擦写次数</th><th>价格</th></tr></thead><tbody><tr><td>SLC(Single-Level Cell)</td><td>两种</td><td>1 bit</td><td>快</td><td>约 10W 次</td><td>贵</td></tr><tr><td>MLC(Multi-Level Cell)</td><td>四种</td><td>2 bit</td><td>一般</td><td>约 3K 次</td><td>一般</td></tr><tr><td>TLC(Trinary-Level Cell)</td><td>八种</td><td>3 bit</td><td>慢</td><td>约 1K 次</td><td>便宜</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="53分区">5.3、分区<a class="hash-link" href="#53分区" title="Direct link to heading">​</a></h2><p>分区是为了在逻辑上将某些柱面隔开形成边界。它是以柱面为单位来划分的，但是从 CentOS 7 开始，是按照扇区进行划分的。</p><p>在磁盘数据量非常大的情况下，划分分区的好处是扫描块位图等更快速：不用再扫描整块磁盘的块位图，只需扫描对应分区的块位图。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="531分区方法">5.3.1、分区方法<a class="hash-link" href="#531分区方法" title="Direct link to heading">​</a></h3><p>MBR 格式的磁盘中，会维护磁盘第一个扇区——MBR 扇区，在该扇区中第 446 字节之后的 64 字节是分区表，每个分区占用 16 字节，所以限制了一块磁盘最多只能有 4 个主分区(Primary, P)，如果多于 4 个区，只能创建主分区少于 4 个，通过建立扩展分区(Extend, E)，然后在扩展分区建立逻辑分区(Logical, L)的方式来突破 4 个分区的限制，逻辑分区的数量不限制。</p><p>在 Linux 中，MBR 格式的磁盘主分区号从 1 - 4，扩展分区号从 2 - 4，逻辑分区号从 5 开始。</p><p>例如，一块盘想分成6个分区，方式如下</p><ul><li>1P+5L：sda1 + sda5 + sda6 + sda7 + sda8 + sda9</li><li>2P+4L：sda1 + sda2 + sda5 + sda6 + sda7 + sda8</li><li>3P+3L：sda1 + sda2 + sda3 + sda5 + sda6 + sda7</li></ul><p>而 GPT 格式突破了 MBR 的限制，它不再限制只能存储 4 个分区表条目，而是使用了类似 MBR 扩展分区表条目的格式，它允许有 128 个主分区，这也使得它可以对超过 2TB 的磁盘进行分区。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="532mbr-和-gpt-分区表">5.3.2、MBR 和 GPT 分区表<a class="hash-link" href="#532mbr-和-gpt-分区表" title="Direct link to heading">​</a></h3><p>在 MBR 格式分区表中，MBR 扇区占用 512 个字节，前 446 个字节是主引导记录，即 boot loader。</p><p>中间 64 字节记录着分区表信息，每个主分区信息占用 16 字节，因此最多只能有 4 个主分区，最后 2 个字节是有效标识位。</p><p>如果使用扩展分区，则扩展分区对应的 16 字节记录的是指向扩展分区中扩展分区表的指针。</p><p><img loading="lazy" alt="MBR disk" src="/en/assets/images/MBR disk-9c651f4a3124a97bb8d2708585751828.png" width="524" height="637" class="img_ev3q"></p><p>在 MBR 磁盘上，分区和启动信息是保存在一起的，如果这部分数据被覆盖或破坏，只能重建 MBR。</p><p>而 GPT 在整个磁盘上保存多个这部分信息的副本，因此它更为健壮，并可以恢复被破坏的这部分信息。</p><p>GPT 还为这些信息保存了循环冗余校验码(CRC)以保证其完整和正确，如果数据被破坏，GPT 会发现这些破坏，并从磁盘上的其他地方进行恢复。</p><p>下面是 GPT 格式的分区表信息，大致约占 17 个字节。</p><p><img loading="lazy" alt="GPT disk" src="/en/assets/images/GPT disk-175d5a1b016c8058e7e023f7b08becf1.png" width="628" height="578" class="img_ev3q"></p><p>EFI 部分可以分为 4 个区域：EFI 信息区(GPT头)、分区表、GPT 分区区域和备份区域。</p><ol><li>EFI 信息区(GPT头)：起始于磁盘的 LBA1，通常也只占用这个单一扇区。其作用是定义分区表的位置和大小。GPT 头还包含头和分区表的校验和，这样就可以及时发现错误。</li><li>分区表：分区表区域包含分区表项。这个区域由 GPT 头定义，一般占用磁盘 LBA2～LBA33 扇区，每扇区可存储 4 个主分区的分区信息，所以共能分 128 个主分区。分区表中的每个分区项由起始地址、结束地址、类型值、名字、属性标志、GUID 值组成。分区表建立后，128 位的 GUID 对系统来说是唯一的。</li><li>GPT 分区：最大的区域，由分配给分区的扇区组成。这个区域的起始和结束地址由 GPT 头定义。</li><li>备份区：备份区域位于磁盘的尾部，包含 GPT 头和分区表的备份。它占用 GPT 结束扇区和 EFI 结束扇区之间的 33 个扇区。其中最后一个扇区用来备份 1 号扇区的 EFI 信息，其余的 32 个扇区用来备份 LBA2～LBA33 扇区的分区表。</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="533添加磁盘">5.3.3、添加磁盘<a class="hash-link" href="#533添加磁盘" title="Direct link to heading">​</a></h3><p>正常情况下，添加磁盘后需要重启系统才能被内核识别，在 /dev/ 下才有对应的设备号，使用 fdisk -l 才会显示出来。但是有时候不方便重启，所以下面介绍一种磁盘热插拔方式。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 查看主机scsi总线号</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@compute1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /sys/class/scsi_host/ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">host0  host1  host2  host3  host4</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@compute1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>重新扫描 scsi 总线以热插拔方式添加新设备。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@compute1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;- - -&quot; &gt; /sys/class/scsi_host/host0/scan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@compute1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;- - -&quot; &gt; /sys/class/scsi_host/host1/scan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@compute1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;- - -&quot; &gt; /sys/class/scsi_host/host3/scan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@compute1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;- - -&quot; &gt; /sys/class/scsi_host/host4/scan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 再查看就有了</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@compute1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># fdisk -l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="534交互式命令">5.3.4、交互式命令<a class="hash-link" href="#534交互式命令" title="Direct link to heading">​</a></h3><p>交互式命令的好处在于，可以每一步完成一个小目标，最后实现整体目标，思路更加清晰，排错更加容易等。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5341fdisk-命令">5.3.4.1、fdisk 命令<a class="hash-link" href="#5341fdisk-命令" title="Direct link to heading">​</a></h4><p>fdisk 工具用来分 MBR 磁盘上的区。要分 GPT 磁盘上的区，可以使用 gdisk。parted 工具对这两种格式的磁盘分区都支持。</p><p>如果一个存储设备已经分过区，那么它可能是 mbr 格式的，也可能是 gpt 格式的，如果已经是 mbr 格式的，则只能继续使用 fdisk 进行分区，如果已经是 gpt 格式的，则只能使用 gdisk 进行分区。</p><p>当然，无论什么格式的都可以使用 parted 进行分区，只不过也只能划分和已存在分区格式一样的分区，因为无论何种格式的分区，它的分区表和分区标识是已经固定的。</p><p>使用 fdisk 分区，它只能实现 MBR 格式的分区。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># fdisk /dev/vdb</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Welcome to </span><span class="token function" style="color:rgb(0, 0, 255)">fdisk</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">util-linux </span><span class="token number" style="color:rgb(9, 134, 88)">2.27</span><span class="token plain">.1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Changes will remain </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> memory only, </span><span class="token keyword" style="color:rgb(0, 0, 255)">until</span><span class="token plain"> you decide to </span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token plain"> them.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Be careful before using the </span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token plain"> command.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">： m</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Help:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  DOS </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">MBR</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   a   toggle a bootable flag</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   b   edit nested BSD disklabel</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   c   toggle the dos compatibility flag</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Generic</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   d   delete a partition                   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 删除分区，如果删除扩展分区同时会删除里面的逻辑分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   F   list </span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token plain"> unpartitioned space        </span><span class="token comment" style="color:rgb(0, 128, 0)"># 列出空闲未分区的空间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   l   list known partition types           </span><span class="token comment" style="color:rgb(0, 128, 0)"># 列出分区类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   n   </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> a new partition                  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 创建新的分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   p   print the partition table            </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看分区表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   t   change a partition </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain">              </span><span class="token comment" style="color:rgb(0, 128, 0)"># 修改分区类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token function" style="color:rgb(0, 0, 255)">v</span><span class="token plain">   verify the partition table           </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看剩下多少未分配的扇区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   i   print information about a partition  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看分区详情</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Misc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   m   print this menu</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   u   change display/entry </span><span class="token function" style="color:rgb(0, 0, 255)">units</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   x   extra functionality </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">experts only</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Script</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   I   load disk layout from sfdisk script </span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   O   dump disk layout to sfdisk script </span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Save </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain"> Exit</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   w   </span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token plain"> table to disk and </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   q   quit without saving changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Create a new label</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   g   create a new empty GPT partition table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   G   create a new empty SGI </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">IRIX</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> partition table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   o   create a new empty DOS partition table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   s   create a new empty Sun partition table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">：</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>新建第一个主分区</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># fdisk /dev/vdb</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Welcome to </span><span class="token function" style="color:rgb(0, 0, 255)">fdisk</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">util-linux </span><span class="token number" style="color:rgb(9, 134, 88)">2.27</span><span class="token plain">.1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Changes will remain </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> memory only, </span><span class="token keyword" style="color:rgb(0, 0, 255)">until</span><span class="token plain"> you decide to </span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token plain"> them.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Be careful before using the </span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token plain"> command.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">： n                                </span><span class="token comment" style="color:rgb(0, 128, 0)"># 新建分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   p   primary </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> primary, </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> extended, </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">       </span><span class="token comment" style="color:rgb(0, 128, 0)"># 添加主分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   e   extended </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">container </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> logical partitions</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 添加扩展分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Select </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">default p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: p                                </span><span class="token comment" style="color:rgb(0, 128, 0)"># 选择建立主分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">分区号 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">-4, default </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">                            </span><span class="token comment" style="color:rgb(0, 128, 0)"># 输入分区号，从1开始</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">First sector </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">-209715199, default </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 输入起始扇区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Last sector, +sectors or +size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">K,M,G,T,P</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">-209715199, default </span><span class="token number" style="color:rgb(9, 134, 88)">209715199</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: +10G </span><span class="token comment" style="color:rgb(0, 128, 0)"># 分区给10G大小</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Created a new partition </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> of </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Linux&#x27;</span><span class="token plain"> and of size </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> GiB.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">： p    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看分区建立的情况</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/vdb: </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> GiB, </span><span class="token number" style="color:rgb(9, 134, 88)">107374182400</span><span class="token plain"> bytes, </span><span class="token number" style="color:rgb(9, 134, 88)">209715200</span><span class="token plain"> sectors</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Units: sectors of </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> * </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes / </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">I/O size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">minimum/optimal</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes / </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disklabel type: dos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk identifier: 0x2528187f</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">设备       启动 Start   末尾   扇区 Size Id 类型</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vdb1        </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20973567</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20971520</span><span class="token plain">  10G </span><span class="token number" style="color:rgb(9, 134, 88)">83</span><span class="token plain"> Linux</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">：</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>新建扩展分区</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">： n    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 新建分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   p   primary </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> primary, </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> extended, </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   e   extended </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">container </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> logical partitions</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Select </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">default p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: e   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 建立扩展分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">分区号 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">-4, default </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 选择分区号，默认就可以</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">First sector </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">20973568</span><span class="token plain">-209715199, default </span><span class="token number" style="color:rgb(9, 134, 88)">20973568</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 起始扇区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Last sector, +sectors or +size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">K,M,G,T,P</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">20973568</span><span class="token plain">-209715199, default </span><span class="token number" style="color:rgb(9, 134, 88)">209715199</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 结束扇区，这里默认把剩下的所有空间都用上</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Created a new partition </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> of </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Extended&#x27;</span><span class="token plain"> and of size </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token plain"> GiB.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">： p    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看扩展分区有没有成功</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/vdb: </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> GiB, </span><span class="token number" style="color:rgb(9, 134, 88)">107374182400</span><span class="token plain"> bytes, </span><span class="token number" style="color:rgb(9, 134, 88)">209715200</span><span class="token plain"> sectors</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Units: sectors of </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> * </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes / </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">I/O size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">minimum/optimal</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes / </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disklabel type: dos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk identifier: 0x2528187f</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">设备       启动    Start    末尾    扇区 Size Id 类型</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vdb1           </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">20973567</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">20971520</span><span class="token plain">  10G </span><span class="token number" style="color:rgb(9, 134, 88)">83</span><span class="token plain"> Linux</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vdb2       </span><span class="token number" style="color:rgb(9, 134, 88)">20973568</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">209715199</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">188741632</span><span class="token plain">  90G  </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> 扩展     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 显示出来了，成功</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">： n    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 在扩展分区上建立逻辑分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">All space </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> primary partitions is </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> use. </span><span class="token comment" style="color:rgb(0, 128, 0)"># 扩展分区把剩余空间用完了，即使4个主分区没用完，也没得选</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Adding logical partition </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">First sector </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">20975616</span><span class="token plain">-209715199, default </span><span class="token number" style="color:rgb(9, 134, 88)">20975616</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 逻辑分区起始扇区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Last sector, +sectors or +size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">K,M,G,T,P</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">20975616</span><span class="token plain">-209715199, default </span><span class="token number" style="color:rgb(9, 134, 88)">209715199</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 逻辑分区结束扇区，这里默认选择最后一个扇区用完空间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Created a new partition </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> of </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Linux&#x27;</span><span class="token plain"> and of size </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token plain"> GiB.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">： p    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看逻辑分区创建成功没有</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/vdb: </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> GiB, </span><span class="token number" style="color:rgb(9, 134, 88)">107374182400</span><span class="token plain"> bytes, </span><span class="token number" style="color:rgb(9, 134, 88)">209715200</span><span class="token plain"> sectors</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Units: sectors of </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> * </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes / </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">I/O size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">minimum/optimal</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes / </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disklabel type: dos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk identifier: 0x2528187f</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">设备       启动    Start    末尾    扇区 Size Id 类型</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vdb1           </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">20973567</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">20971520</span><span class="token plain">  10G </span><span class="token number" style="color:rgb(9, 134, 88)">83</span><span class="token plain"> Linux</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vdb2       </span><span class="token number" style="color:rgb(9, 134, 88)">20973568</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">209715199</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">188741632</span><span class="token plain">  90G  </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> 扩展</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vdb5       </span><span class="token number" style="color:rgb(9, 134, 88)">20975616</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">209715199</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">188739584</span><span class="token plain">  90G </span><span class="token number" style="color:rgb(9, 134, 88)">83</span><span class="token plain"> Linux  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 逻辑分区创建成功，所有的扩展空间用完</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">命令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">输入 m 获取帮助</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">： w    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 分区结束，保存。如果不保存，则按q，如果没保存，所有分区都白做了</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">The partition table has been altered.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Calling ioctl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> to re-read partition table.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Syncing disks.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>分区的过程，实质上是划分扇区以及修改分区表。</p><p>上面的 fdisk 操作全部是在内存中执行的，必须保存生效。保存后，内核还未识别该分区，可以查看 /proc/partition 目录下存在的文件，这些文件是能被内核识别的分区。</p><p>运行 partprobe 或 partx 命令重新读取分区表让内核识别新的分区，内核识别后才可以格式化。而且分区结束时按 w 保存分区表有时候会失败，提示重启，这时候运行 partprobe 命令可以代替重启就生效。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 这个命令可以读取所有的磁盘分区，也可以用 partprobe /dev/vdb 只读一个磁盘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># partprobe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5342gdisk-命令">5.3.4.2、gdisk 命令<a class="hash-link" href="#5342gdisk-命令" title="Direct link to heading">​</a></h4><p>gdisk 用来划分 gpt 分区，需要单独安装这个工具包。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># aptitude install gdisk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">下列“新”软件包将被安装。       </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  gdisk </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> 个软件包被升级，新安装 </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> 个， </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> 个将被删除， 同时 </span><span class="token number" style="color:rgb(9, 134, 88)">486</span><span class="token plain"> 个将不升级。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">需要获取 </span><span class="token number" style="color:rgb(9, 134, 88)">189</span><span class="token plain"> kB 的存档。 解包后将要使用 </span><span class="token number" style="color:rgb(9, 134, 88)">772</span><span class="token plain"> kB。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">读取： </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> http://archive.kylinos.cn/kylin/KYLIN-ALL </span><span class="token number" style="color:rgb(9, 134, 88)">10.0</span><span class="token plain">/main arm64 gdisk arm64 </span><span class="token number" style="color:rgb(9, 134, 88)">1.0</span><span class="token plain">.1-1kord1 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">189</span><span class="token plain"> kB</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">已下载 </span><span class="token number" style="color:rgb(9, 134, 88)">189</span><span class="token plain"> kB，耗时 </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">秒 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">530</span><span class="token plain"> kB/s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">正在选中未选择的软件包 gdisk。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">正在读取数据库 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">. 系统当前共安装有 </span><span class="token number" style="color:rgb(9, 134, 88)">230153</span><span class="token plain"> 个文件和目录。</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">正准备解包 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">./gdisk_1.0.1-1kord1_arm64.deb  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">正在解包 gdisk </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1.0</span><span class="token plain">.1-1kord1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">正在处理用于 man-db </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2.7</span><span class="token plain">.5-1kord</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> 的触发器 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">正在设置 gdisk </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1.0</span><span class="token plain">.1-1kord1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>分区的时候直接带上设备即可。以下是对新硬盘划分 gpt 分区的过程。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># gdisk /dev/vdb</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GPT </span><span class="token function" style="color:rgb(0, 0, 255)">fdisk</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">gdisk</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> version </span><span class="token number" style="color:rgb(9, 134, 88)">1.0</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition table scan:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  MBR: protective</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  BSD: not present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  APM: not present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  GPT: present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Found valid GPT with protective MBR</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> using GPT.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Command </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">? </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: ?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">b   back up GPT data to a </span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">c   change a partition</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;s name</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">d   delete a partition                                  # 删除分区</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">i   show detailed information on a partition            # 列出分区详细信息</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">l   list known partition types                          # 列出通用的分区类型</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">n   add a new partition                                 # 创建新分区</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">o   create a new empty GUID partition table (GPT)       # 创建一个新的空的guid分区表</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">p   print the partition table                           # 输出分区表信息</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">q   quit without saving changes                         # 退出 gdisk 工具</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">r   recovery and transformation options (experts only)</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">s   sort partitions</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">t   change a partition&#x27;</span><span class="token plain">s </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> code                     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 修改分区类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">v</span><span class="token plain">   verify disk</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">w   </span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token plain"> table to disk and </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">exit</span><span class="token plain">                        </span><span class="token comment" style="color:rgb(0, 128, 0)"># 将分区信息写入到磁盘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">x   extra functionality </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">experts only</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">?   print this menu</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Command </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">? </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>添加一个新分区</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># gdisk /dev/vdb</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GPT </span><span class="token function" style="color:rgb(0, 0, 255)">fdisk</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">gdisk</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> version </span><span class="token number" style="color:rgb(9, 134, 88)">1.0</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition table scan:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  MBR: protective</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  BSD: not present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  APM: not present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  GPT: present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Found valid GPT with protective MBR</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> using GPT.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Command </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">? </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: n     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 新建一个分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition number </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">-128, default </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 第一个分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">First sector </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">34</span><span class="token plain">-209715166, default </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> or </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">+-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">KMGTP</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">:     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 起始扇区选择，默认即可</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Last sector </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">-209715166, default </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">209715166</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> or </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">+-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">KMGTP</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">: +10G  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 结束扇区选择，使用+10G这种格式，它自己会计算需要多少个扇区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Current </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> is </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Linux filesystem&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Hex code or GUID </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">L to show codes, Enter </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8300</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 选择分区类型，默认即可</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Changed </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> of partition to </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Linux filesystem&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Command </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">? </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: p     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看创建分区的情况</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/vdb: </span><span class="token number" style="color:rgb(9, 134, 88)">209715200</span><span class="token plain"> sectors, </span><span class="token number" style="color:rgb(9, 134, 88)">100.0</span><span class="token plain"> GiB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Logical sector size: </span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk identifier </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">GUID</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: 76D04934-547A-4030-93CE-AC4F71B6713A</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition table holds up to </span><span class="token number" style="color:rgb(9, 134, 88)">128</span><span class="token plain"> entries</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">First usable sector is </span><span class="token number" style="color:rgb(9, 134, 88)">34</span><span class="token plain">, last usable sector is </span><span class="token number" style="color:rgb(9, 134, 88)">209715166</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partitions will be aligned on </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">-sector boundaries</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Total </span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token plain"> space is </span><span class="token number" style="color:rgb(9, 134, 88)">188743613</span><span class="token plain"> sectors </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">90.0</span><span class="token plain"> GiB</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Number  Start </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">    End </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">  Size       Code  Name</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">            </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">20973567</span><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">10.0</span><span class="token plain"> GiB    </span><span class="token number" style="color:rgb(9, 134, 88)">8300</span><span class="token plain">  Linux filesystem</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Command </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">? </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: w     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 保存分区表到磁盘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Final checks complete. About to </span><span class="token function" style="color:rgb(0, 0, 255)">write</span><span class="token plain"> GPT data. THIS WILL OVERWRITE EXISTING</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PARTITIONS</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Do you want to proceed? </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Y/N</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: Y</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OK</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> writing new GUID partition table </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">GPT</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> to /dev/vdb.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">The operation has completed successfully.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>执行 partprobe 重新读取分区表信息。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># partprobe /dev/vdb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5343parted-命令">5.3.4.3、parted 命令<a class="hash-link" href="#5343parted-命令" title="Direct link to heading">​</a></h4><p>parted 支持 mbr 格式和 gpt 格式的磁盘分区。它的强大在于可以一步到位而不需要不断的交互式输入(也可以交互式)。</p><p>parted 分区工具是实时的，所以每一步操作都是直接写入磁盘而不是写进内存，它不像 fdisk/gdisk 还需要 w 命令将内存中的结果保存到磁盘中。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># parted /dev/vdb</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GNU Parted </span><span class="token number" style="color:rgb(9, 134, 88)">3.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">使用 /dev/vdb</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">欢迎使用 GNU Parted</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain"> 输入 </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;help&#x27;</span><span class="token plain">可获得命令列表.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token plain">                                                           </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  align-check TYPE N                       check partition N </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> TYPE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">min</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">opt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> alignment</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">COMMAND</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                           print general help, or </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token plain"> on COMMAND</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  mklabel,mktable LABEL-TYPE               create a new disklabel </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">partition table</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  mkpart 分区类型 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">文件系统类型</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> 起始点 终止点   创建一个分区</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  name NUMBER NAME                         将编号为NUMBER 的分区命名为“NAME”</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  print </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">devices</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">list,all</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">NUMBER</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">     display the partition table, available devices, </span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token plain"> space, all found partitions, or a particular partition</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  quit                                     退出程序</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  rescue START END                         挽救临近“起始点”、“终止点”的遗失的分区</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  resizepart NUMBER END                    resize partition NUMBER</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">rm</span><span class="token plain"> NUMBER                                删除编号为 NUMBER 的分区</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">select</span><span class="token plain"> DEVICE                            choose the device to edit</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  disk_set FLAG STATE                      change the FLAG on selected device </span><span class="token comment" style="color:rgb(0, 128, 0)"># 设置 flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  disk_toggle </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">FLAG</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                       toggle the state of FLAG on selected device </span><span class="token comment" style="color:rgb(0, 128, 0)"># 设置 flag on 或者 off</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> NUMBER FLAG STATE                    change the FLAG on partition NUMBER</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  toggle </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">NUMBER </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">FLAG</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                   toggle the state of FLAG on partition NUMBER</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  unit UNIT                                </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> the default unit to UNIT</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  version                                  display the version number and copyright information of GNU Parted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>常用的命令是 mklabel/rm/print/mkpart/help/quit</p><p>parted 分区的前提是磁盘已经有分区表(partition table)或磁盘标签(disk label)，否则将显示 &quot;unrecognised disk label&quot;，这是和 fdisk/gdisk 不同的地方，所以需要先使用 mklabel 创建标签或分区表。</p><p>最常见的标签(分区表)为 &quot;msdos&quot; 和 &quot;gpt&quot;，其中 msdos 分区就是 MBR 格式的分区表，也就是会有主分区、扩展分区和逻辑分区的概念和限制。</p><p>使用 parted 对/dev/sda 创建 msdos 的新分区。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># parted /dev/sda</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GNU Parted </span><span class="token number" style="color:rgb(9, 134, 88)">3.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Using /dev/sda</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Welcome to GNU Parted</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain"> Type </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;help&#x27;</span><span class="token plain"> to view a list of commands.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> mkpart     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 创建分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition type?  primary/extended? primary  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 选择主分区或是扩展分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">File system type?  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ext2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">? xfs  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 这里有一定误导，这个文件系统选择是给GUID表做参考，并不会把分区格式化成 xfs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Start? </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 起始位置选择，注意这个 1 表示的是 1MB，默认单位就是 MB；默认单位可以用 unit &lt;UNIT&gt; 指定，强调 MB 和 MiB 是有区别的，1KB=10^3=1000B，1KiB=2^10=1024B,1MiB=2^20=1048576=1024KiB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">End? </span><span class="token number" style="color:rgb(9, 134, 88)">1024</span><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 结束位置，不包括 1024MB，实际上是 1MB 到 1023MB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> p  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看分区创建成功</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Model: QEMU QEMU HARDDISK </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">scsi</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/sda: 1100GB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: 512B/512B</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition Table: msdos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk Flags: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Number  Start   End     Size    Type     File system  Flags</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">      1049kB  1024MB  1023MB  primary</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> mkpart primary ext4 </span><span class="token number" style="color:rgb(9, 134, 88)">1024</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2048</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 上面的创建方式是交互式创建，可以用一行命令完成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> p  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看第二个分区创建完成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Model: QEMU QEMU HARDDISK </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">scsi</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/sda: 1100GB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: 512B/512B</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition Table: msdos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk Flags: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Number  Start   End     Size    Type     File system  Flags</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">      1049kB  1024MB  1023MB  primary</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">      1024MB  2048MB  1023MB  primary</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">rm</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 删除分区的语法，这里删除第 2 个分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> p  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看第 2 个分区删除完成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Model: QEMU QEMU HARDDISK </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">scsi</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/sda: 1100GB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: 512B/512B</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition Table: msdos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk Flags: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Number  Start   End     Size    Type     File system  Flags</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">      1049kB  1024MB  1023MB  primary</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> mkpart extended xfs </span><span class="token number" style="color:rgb(9, 134, 88)">1030</span><span class="token plain"> -1    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 创建扩展分区是不用指定文件系统的，会报错</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Error: Invalid number.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> mkpart extended </span><span class="token number" style="color:rgb(9, 134, 88)">1030</span><span class="token plain"> -1    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 创建扩展分区的正确方式，-1 表示用完所有的剩余空间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> p  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看扩展分区创建成功</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Model: QEMU QEMU HARDDISK </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">scsi</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/sda: 1100GB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: 512B/512B</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition Table: msdos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk Flags: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Number  Start   End     Size    Type      File system  Flags</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">      1049kB  1024MB  1023MB  primary</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">      1030MB  1100GB  1098GB  extended               lba</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> mkpart     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 在扩展分区上创建逻辑分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition type?  primary/logical? l </span><span class="token comment" style="color:rgb(0, 128, 0)"># 可以选择主分区或者逻辑分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">File system type?  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ext2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">? xfs  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 这里有一定误导，这个文件系统选择是给GUID表做参考，并不会把分区格式化成 xfs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Start? </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 起始位置选择，随意写个 1，结合下面的警告（你已经分过1MB-1024MB的分区，扩展分区的起始是1030MB，建议从这里开始），往下看</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">End? </span><span class="token number" style="color:rgb(9, 134, 88)">1024</span><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 结束位置选择，随意写个 1024，结合下面的警告（你已经分过1MB-1024MB的分区，扩展分区的起始是1030MB，建议从这里开始），往下看</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Warning: You requested a partition from 1000kB to 1024MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sectors </span><span class="token number" style="color:rgb(9, 134, 88)">1953</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">2000000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">The closest location we can manage is 1030MB to 1030MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sectors </span><span class="token number" style="color:rgb(9, 134, 88)">2011137</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">2011137</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Is this still acceptable to you?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Yes/No? </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># 接受建议</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Warning: The resulting partition is not properly aligned </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> best performance.  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 警告：扇区没有对齐，看上面警告括号中的sector，这是我故意没有对齐的，1024MB 和 1030MB 中间明显有一点空间，这些扇区浪费了，所以警告，最好的方式是连续划分。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Ignore/Cancel? Ignore   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 选择忽略扇区没有对齐问题</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> p  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看创建了一个 1030MB 到 1030MB 的分区，也就是 1 个扇区，512 Bytes。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Model: QEMU QEMU HARDDISK </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">scsi</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/sda: 1100GB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: 512B/512B</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition Table: msdos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk Flags: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Number  Start   End     Size    Type      File system  Flags</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">      1049kB  1024MB  1023MB  primary</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">      1030MB  1100GB  1098GB  extended               lba</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain">      1030MB  1030MB  512B    logical</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> mkpart l xfs </span><span class="token number" style="color:rgb(9, 134, 88)">1030</span><span class="token plain"> -1   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 重新创建逻辑分区，从 1030MB 开始到 -1 结束表示用完所有的剩余空间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Warning: The resulting partition is not properly aligned </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> best performance.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Ignore/Cancel? Ignore   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 忽略扇区没有对齐问题</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> p  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看逻辑分区成功</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Model: QEMU QEMU HARDDISK </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">scsi</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk /dev/sda: 1100GB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sector size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">logical/physical</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: 512B/512B</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Partition Table: msdos</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Disk Flags: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Number  Start   End     Size    Type      File system  Flags</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">      1049kB  1024MB  1023MB  primary</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">      1030MB  1100GB  1098GB  extended               lba</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain">      1030MB  1030MB  512B    logical</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain">      1030MB  1100GB  1098GB  logical</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> quit   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 退出 parted 工具</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>掌握好 parted 分区工具，Linux 下的分区基本上没有什么障碍，所以上面的实验每一步我都做了详细的说明。</li><li>parted 最难理解的就是扇区对齐问题，所以磁盘基础知识要扎实，开篇也做了详细的陈述，可以前后对照学习。</li><li>上面的实验是 msdos 格式的分区，gpt 格式的分区步骤更简单，只要准确地理解了上述实验中的每一步骤，gpt 格式分区也就不在话下。</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="535非交互式命令">5.3.5、非交互式命令<a class="hash-link" href="#535非交互式命令" title="Direct link to heading">​</a></h3><p>使用非交互分区时，最重要的是待分的区的起始点不能是已使用的。</p><p>可以使用 lsblk 或 fdisk -l 或 parted DEV print 来判断将要从哪个地方开始分区。</p><p>其实 parted 在非交互分区时是最佳的工具，不仅是因为其书写方式简洁，而且待分区的起点如不合理它会自动提示是否要自动调整。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5351fdisk-命令">5.3.5.1、fdisk 命令<a class="hash-link" href="#5351fdisk-命令" title="Direct link to heading">​</a></h4><p>fdisk 实现非交互的原理是从标准输入中读取，每读取一行传递一次操作。</p><p>所以可以有两种方式：</p><blockquote><p>使用 echo 和管道传递</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 下面的命令创建了两个分区，使用默认值时传递空行即可</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># echo -e &quot;n\np\n1\n\n+5G\nn\np\n2\n\n+1G\nw\n&quot;  | fdisk /dev/sda</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>将操作写入到文件中，从文件中读取</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 如果要传递的操作很多，则可以将它们写入到一个文件中，从文件中读取</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># echo -e &quot;n\np\n1\n\n+5G\nn\np\n2\n\n+1G\nw\n&quot; &gt;/tmp/a.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># fdisk /dev/sda &lt;/tmp/a.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5352gdisk-命令">5.3.5.2、gdisk 命令<a class="hash-link" href="#5352gdisk-命令" title="Direct link to heading">​</a></h4><p>同理 fdisk 命令</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5353parted-命令">5.3.5.3、parted 命令<a class="hash-link" href="#5353parted-命令" title="Direct link to heading">​</a></h4><p>parted 命令只能一次非交互一个命令中的所有动作</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">parted</span><span class="token plain"> /dev/sdb mklabel msdos                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># 设置硬盘flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">parted</span><span class="token plain"> /dev/sdb mkpart primary ext4 </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># Mbr格式分区，分别是partition type/fstype/start/end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">parted</span><span class="token plain"> /dev/sdb mkpart </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> ext4 1M 10240M       </span><span class="token comment" style="color:rgb(0, 128, 0)"># gpt格式分区，分别是name/fstype/start/end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">parted</span><span class="token plain"> /dev/sdb mkpart </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> 10G 15G              </span><span class="token comment" style="color:rgb(0, 128, 0)"># 省略fstype的交互式分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">parted</span><span class="token plain"> /dev/sdb </span><span class="token function" style="color:rgb(0, 0, 255)">rm</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">                          </span><span class="token comment" style="color:rgb(0, 128, 0)"># 删除分区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">parted</span><span class="token plain"> /dev/sdb p                             </span><span class="token comment" style="color:rgb(0, 128, 0)"># 输出信息</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果不确定分区的起点大小，可以加上 -s 选项使用 script 模式，该模式下 parted 将回答一切默认值，如 yes、no。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># parted -s /dev/sda mkpart 3 14G 16G</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Warning: You requested a partition from </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain">.0GB to </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">.0GB.              </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">The closest location we can manage is </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain">.0GB to </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">.0GB.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Is this still acceptable to you?</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Information: You may need to update /etc/fstab.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="54格式化分区">5.4、格式化分区<a class="hash-link" href="#54格式化分区" title="Direct link to heading">​</a></h2><p>分区结束后就需要格式化创建文件系统了，格式化分区的过程就是创建文件系统的过程。</p><p>可以使用 mkfs(make filesystem) 工具进行格式化，也可以使用该工具家族的其他工具如 mkfs.ext4/mkfs.xfs 等专门针对文件系统的工具。</p><p>要查看支持的文件系统类型，只需简单的输入 mkfs 然后按两下 tab 键，就可以列出各文件系统对应的格式化命令，这些就是支持的文件系统类型。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mkfs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">mkfs</span><span class="token plain">         mkfs.cramfs  mkfs.ext3    mkfs.fat     mkfs.msdos   mkfs.xfs   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mkfs.btrfs   mkfs.ext2    mkfs.ext4    mkfs.minix   mkfs.vfat  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mkfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="541mkfs-命令">5.4.1、mkfs 命令<a class="hash-link" href="#541mkfs-命令" title="Direct link to heading">​</a></h3><p>该工具非常简单，它只需指定一个可选的 &quot;-t&quot; 选项指定要创建的文件系统类型，如果省略则默认创建 ext2 文件系统。</p><p>该工具指定的 &quot;-t&quot; 选项其实是在调用对应文件系统专属的格式化工具。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">mkfs</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-t fstype</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> 分区</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mkfs.</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">fstype</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> 分区</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mkfs.ext4 /dev/sda1 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">mke2fs</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.42</span><span class="token plain">.9 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token plain">-Dec-2013</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Discarding device blocks: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain">                          </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Filesystem </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">label</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OS type: Linux</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Block </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">size</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">log</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Fragment </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">size</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">log</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">Stride</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> blocks, Stripe </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">width</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> blocks</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">61056</span><span class="token plain"> inodes, </span><span class="token number" style="color:rgb(9, 134, 88)">243968</span><span class="token plain"> blocks</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">12198</span><span class="token plain"> blocks </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.00</span><span class="token plain">%</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> reserved </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> the super user</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">First data </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">block</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Maximum filesystem </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">blocks</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">251658240</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> block </span><span class="token function" style="color:rgb(0, 0, 255)">groups</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">32768</span><span class="token plain"> blocks per group, </span><span class="token number" style="color:rgb(9, 134, 88)">32768</span><span class="token plain"> fragments per group</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7632</span><span class="token plain"> inodes per group</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Superblock backups stored on blocks: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">32768</span><span class="token plain">, </span><span class="token number" style="color:rgb(9, 134, 88)">98304</span><span class="token plain">, </span><span class="token number" style="color:rgb(9, 134, 88)">163840</span><span class="token plain">, </span><span class="token number" style="color:rgb(9, 134, 88)">229376</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Allocating group tables: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain">                          </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Writing inode tables: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain">                          </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Creating journal </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> blocks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Writing superblocks and filesystem accounting information: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="542mke2fs-命令">5.4.2、mke2fs 命令<a class="hash-link" href="#542mke2fs-命令" title="Direct link to heading">​</a></h3><p>mkfs.ext2/mkfs.ext3/mkfs.ext4 或 mkfs -t extX 其实都是在调用 mke2fs 命令</p><p>该工具创建文件系统时，会从 /etc/mke2fs.conf 配置中读取默认的配置项</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">mke2fs</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -c </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -b block-size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -f fragment-size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -g blocks-per-group </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -G number-of-groups </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -i bytes-per-inode </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -I inode-size </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -j </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -N number-of-inodes </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -m reserved-blocks-percentage </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -q </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -r fs-revision-level </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -v </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -L volume-label </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -S </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -t fs-type </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> device </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> blocks-count </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-t fs-type          :指定要创建的文件系统类型</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">ext2,ext3 ext4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">，若不指定，则从/etc/mke2fs.conf中获取默认的文件系统类型。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-b block-size       :指定每个block的大小，有效值有1024、2048和4096，单位是字节。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-I inode-size       :指定inode大小，单位为字节。必须为2的幂次方，且大于等于128字节。值越大，说明inode的集合体inode table占用越多的空</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     间，这不仅会挤占文件系统中的可用空间，还会降低性能，因为要扫描inode table需要消耗更多时间，但是在linux kernel </span><span class="token number" style="color:rgb(9, 134, 88)">2.6</span><span class="token plain">.10</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     之后，由于使用inode存储了很多扩展的额外属性，所以128字节已经不够用了，因此ext4默认的inode size已经变为256，尽管</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     inode大小增大了，但因为使用inode存储扩展属性带来的性能提升远高于inode size变大导致的负面影响，所以仍建议使用256字</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     节的inode。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-i bytes-per-inode  :指定每多少个字节就为其分配一个inode号。值越大，说明一个文件系统中分配的inode号越少，更适用于存储大量大文件，值越</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     小，inode号越多，更适用于存储大量小文件。该值不能小于一个block的大小，因为这样会造成inode多余。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     注意，创建文件系统后该值就不能再改变了。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-c                  :创建文件系统前先检查设备是否有bad blocks。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-f fragment-size    :指定fragments的大小，单位字节。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-g blocks-per-group :指定每个块组中的block数量。不建议修改此项。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-G number-of-groups :该选项用于ext4文件系统</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">严格地说是启用了flex_bg特性</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">，指定虚拟块组</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">即一个extent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">中包含的块组个数，必须为2的幂次方。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     对于ext4文件系统来说，使用extent的功能能极大提升其性能。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-j                  :创建带有日志功能的文件系统，即ext3。如果要指定关于日志方面的设置，在-j的基础上再使用-J指定，不过一般默认即可，具体可</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     指定的选项看man文档。 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-L new-volume-label :指定卷标名称，名称不得超出16字节。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-m reserved-blocks-percentage   :指定文件系统保留block数量的比例，保留一部分block，可以降低物理碎片。默认比例为5%。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-N number-of-inodes :强制指定该文件系统应该分配多少个inode号，它会覆盖通过计算得出inode数量的结果</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">根据block大小、数量和每多少字节分配</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     一个inode得出Inode数量</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">，但是不建议这么做。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-q                  :安静模式，可用于脚本中</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-S                  :重建superblock和group descriptions。在所有的superblock和备份的superblock都损坏时有用。它会重新初始化superblock和</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     group descriptions，但不会改变inode table、bmap和imap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">若真的改变，该分区数据就全丢了，还不如重新格式化</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">。在重建</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     superblock后，应该执行e2fsck来保证文件系统的一致性。但要注意，应该完全正确地指定block的大小，其改选项并不能完全保</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     证数据不丢失。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-v                  :输出详细执行过程 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>所以，有可能用到的选项也就 &quot;-t&quot; 指定文件系统类型，&quot;-b&quot; 指定 block 大小，&quot;-I&quot; 指定 inode 大小，&quot;-i&quot; 指定分配 inode 的比例。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mke2fs -t ext4 -I 256 /dev/sda1 -b 4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">mke2fs</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.42</span><span class="token plain">.9 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token plain">-Dec-2013</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Discarding device blocks: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain">                          </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Filesystem </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">label</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OS type: Linux</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Block </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">size</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">log</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Fragment </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">size</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">log</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">Stride</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> blocks, Stripe </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">width</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> blocks</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">61056</span><span class="token plain"> inodes, </span><span class="token number" style="color:rgb(9, 134, 88)">243968</span><span class="token plain"> blocks</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">12198</span><span class="token plain"> blocks </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.00</span><span class="token plain">%</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> reserved </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> the super user</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">First data </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">block</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Maximum filesystem </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">blocks</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">251658240</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> block </span><span class="token function" style="color:rgb(0, 0, 255)">groups</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">32768</span><span class="token plain"> blocks per group, </span><span class="token number" style="color:rgb(9, 134, 88)">32768</span><span class="token plain"> fragments per group</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7632</span><span class="token plain"> inodes per group</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Superblock backups stored on blocks: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">32768</span><span class="token plain">, </span><span class="token number" style="color:rgb(9, 134, 88)">98304</span><span class="token plain">, </span><span class="token number" style="color:rgb(9, 134, 88)">163840</span><span class="token plain">, </span><span class="token number" style="color:rgb(9, 134, 88)">229376</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Allocating group tables: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain">                          </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Writing inode tables: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain">                          </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Creating journal </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> blocks</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Writing superblocks and filesystem accounting information: </span><span class="token keyword" style="color:rgb(0, 0, 255)">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="543tune2fs-命令">5.4.3、tune2fs 命令<a class="hash-link" href="#543tune2fs-命令" title="Direct link to heading">​</a></h3><p>该工具其实没什么太大作用，文件系统创建好后很多属性是固定不能修改的，能修改的属性很有限，且都是无关紧要的。</p><p>但有些时候还是可以用到它做些事情，例如刚创建完ext文件系统后会提示修改自检时间。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">tune2fs </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">  -c  max-mount-counts </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -i interval-between-checks </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -j </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> device</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-j：将ext2文件系统升级为ext3；</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-c：修改文件系统最多挂载多少次后进行自检，设置为0或-1将永不自检；</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-i：修改过了多少时间进行自检。时间单位可以指定为天</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">默认</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">/月/星期</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">d</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">m</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">，设置为0将永不自检。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="55查看文件系统">5.5、查看文件系统<a class="hash-link" href="#55查看文件系统" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="551lsblk-命令">5.5.1、lsblk 命令<a class="hash-link" href="#551lsblk-命令" title="Direct link to heading">​</a></h3><p>lsblk(list block devices) 用于列出设备及其状态，主要列出非空的存储设备。其实它只会列出 /sys/dev/block 中的主次设备号文件，且默认只列出非空设备。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># lsblk </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sr0     </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain">:0    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">755</span><span class="token plain">.8M  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> rom  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sda      </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:0    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">     1T  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> disk </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─sda1   </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:1    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   953M  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vda    </span><span class="token number" style="color:rgb(9, 134, 88)">253</span><span class="token plain">:0    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   500G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> disk </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─vda4 </span><span class="token number" style="color:rgb(9, 134, 88)">253</span><span class="token plain">:4    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">482</span><span class="token plain">.9G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part /</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─vda2 </span><span class="token number" style="color:rgb(9, 134, 88)">253</span><span class="token plain">:2    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">     1G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part /boot</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─vda3 </span><span class="token number" style="color:rgb(9, 134, 88)">253</span><span class="token plain">:3    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">    16G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">SWAP</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─vda1 </span><span class="token number" style="color:rgb(9, 134, 88)">253</span><span class="token plain">:1    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   200M  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part /boot/efi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>NAME：设备名称；</li><li>MAJ:MIN：主设备号和此设备号；</li><li>RM：是否为可卸载设备，1 表示可卸载设备。可卸载设备如光盘、USB 等。并非能够 umount 的就是可卸载的；</li><li>SIZE：设备总空间大小；</li><li>RO：是否为只读；</li><li>TYPE：是磁盘 disk，还是分区 part，亦或是 rom，还有 loop 设备；</li><li>mountpoint：挂载点。</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># lsblk /dev/sda</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sda      </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:0    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">    1T  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> disk </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─sda1   </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:1    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  953M  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># lsblk /dev/sda1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sda1   </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:1    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  953M  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>另外常用的一个选项是 &quot;-f&quot;，它可以查看到文件系统类型，和文件系统的 uuid 和挂载点。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># lsblk -f</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME   FSTYPE  LABEL            UUID                                 MOUNTPOINT</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sr0    iso9660 CentOS </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> aarch64 </span><span class="token number" style="color:rgb(9, 134, 88)">2018</span><span class="token plain">-05-08-14-09-45-00             </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sda                                                                </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─sda1 ext4                     f2151d94-6fb5-48af-af4f-b36c403d4247 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">vda                                                                </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─vda4 xfs                      c50aefdd-bc0f-4761-a47f-60deadbc0f30 /</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─vda2 xfs                      cfcb5471-b488-41ab-8622-35b57ebb0395 /boot</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─vda3 swap                     e0421809-f014-4ea5-8183-fd96c8423be3 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">SWAP</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─vda1 vfat                     AD9C-FE26                            /boot/efi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>每个已经格式化的文件系统都有其类型和 uuid，而没有格式化的设备，将只显示一个Name结果，表示该设备还未进行格式化。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="552blkid-命令">5.5.2、blkid 命令<a class="hash-link" href="#552blkid-命令" title="Direct link to heading">​</a></h3><p>虽然它有不少比较强大的功能，但一般只用它一个功能，就是查看器文件系统类型和 uuid。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># blkid </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda1: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">SEC_TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;msdos&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;AD9C-FE26&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;vfat&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">PARTLABEL</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;EFI System Partition&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">PARTUUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;6f5cb7a5-6d83-4f67-af13-1f01f31eb637&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda2: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;cfcb5471-b488-41ab-8622-35b57ebb0395&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xfs&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">PARTUUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;efc59722-5d36-4bcd-87a4-412df21e362d&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda3: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;e0421809-f014-4ea5-8183-fd96c8423be3&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;swap&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">PARTUUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;a5d2758f-0a2c-4145-9c04-9b6ddce9b07c&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda4: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;c50aefdd-bc0f-4761-a47f-60deadbc0f30&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;xfs&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">PARTUUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;6e441755-2842-4746-8f24-8c54019c72b6&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/sda1: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;f2151d94-6fb5-48af-af4f-b36c403d4247&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ext4&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/sr0: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;2018-05-08-14-09-45-00&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">LABEL</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;CentOS 7 aarch64&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;iso9660&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># blkid /dev/sda1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/sda1: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;f2151d94-6fb5-48af-af4f-b36c403d4247&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ext4&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="553file-命令">5.5.3、file 命令<a class="hash-link" href="#553file-命令" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># file -s /dev/sda1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/sda1: Linux </span><span class="token function" style="color:rgb(0, 0, 255)">rev</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.0</span><span class="token plain"> ext4 filesystem data, </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">f2151d94-6fb5-48af-af4f-b36c403d4247 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">extents</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">64bit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">large files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">huge files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="554du-命令">5.5.4、du 命令<a class="hash-link" href="#554du-命令" title="Direct link to heading">​</a></h3><p>du 命令用于评估文件的空间占用情况，它会统计每个文件的大小，统计时会递归统计目录中的文件，也就是说，它会遍历整个待统计目录，所以统计速度上可能并不理想。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">du</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">OPTION</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">. </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">FILE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-a, --all：列出目录中所有文件的统计信息，默认只会列出目录中子目录的统计信息，而不列出文件的统计信息</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-h, --human-readable：人性化显示大小</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-0, --null：以空字符结尾，即</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string entity" style="color:rgb(163, 21, 21)">\0</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain">而非换行的</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string entity" style="color:rgb(163, 21, 21)">\n</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-S, --separate-dirs：不包含子目录的大小</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-s, --summarize：对目录做总的统计，不列出目录内文件的大小信息</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-c,--total：对给出的文件或目录做总计。在统计非同一个目录文件大小时非常有用。见下文例子。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-d,--max-depth：指定显示时的目录深度，默认会递归显示所有层次</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--max-depth</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">N：只列出给定层次的目录统计，如果N</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">，则等价于</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-s&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-x, --one-file-system：忽略不同文件系统上的文件，不对它们进行统计</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-X, --exclude-from</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">FILE：从文件中读取要排除的文件</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--exclude</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">PATTERN：指定要忽略不统计的文件</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>上面的选项中，有些是不列出某些项，有些是不统计某些项，它们是不一样的。</li><li>如果要统计的目录下挂载了一个文件系统，那么这个文件系统的大小也会被计入该目录的大小中。</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># du -sh /etc/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">29M /etc/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># du -ah /tmp/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /tmp/.XIM-unix</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /tmp/.font-unix</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /tmp/.Test-unix</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /tmp/.X11-unix</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /tmp/.ICE-unix</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain">.0K    /tmp/yum_save_tx.2021-06-10.09-43.sULMgF.yumtx</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain">.0K    /tmp/a.txt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">.0K    /tmp/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># du -h --max-depth=1 /usr/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">78M /usr/bin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">43M /usr/sbin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">468M    /usr/lib</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">155M    /usr/lib64</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">238M    /usr/share</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /usr/etc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /usr/games</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">36K /usr/include</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">14M /usr/libexec</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /usr/local</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /usr/src</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">991M    /usr/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># du -h --max-depth=1 --exclude=/usr/lib64 /usr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">78M /usr/bin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">43M /usr/sbin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">468M    /usr/lib</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">238M    /usr/share</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /usr/etc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /usr/games</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">36K /usr/include</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">14M /usr/libexec</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /usr/local</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   /usr/src</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">837M    /usr</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="555df-命令">5.5.5、df 命令<a class="hash-link" href="#555df-命令" title="Direct link to heading">​</a></h3><p>df 用于报告磁盘空间使用率，默认显示的大小是 1K 大小 block 数量，也就是以 k 为单位。</p><p>和 du 不同的是，df 是读取每个文件系统的 superblock 信息，所以评估速度非常快。由于是读取 superblock，所以如果目录下挂载了另一个文件系统，是不会将此挂载的文件系统计入目录大小的。</p><p>如果用 df 统计某个文件的空间使用情况，将会转而统计该文件所在文件系统的空间使用情况。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">df</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">OPTION</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">. </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">FILE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-h：人性化转换大小的显示单位</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-i：统计inode使用情况而非空间使用情况</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-l, --local：只列出本地文件系统的使用情况，不列出网络文件系统信息</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-T, --print-type：同时输出文件系统类型</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-t, --type</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">TYPE：只列出给定文件系统的统计信息</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-x, --exclude-type</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">TYPE：指定不显示的文件系统类型的统计信息</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># df -hT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Filesystem     Type      Size  Used Avail Use% Mounted on</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">devtmpfs       devtmpfs   16G     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   16G   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">% /dev</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs          tmpfs      16G     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   16G   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">% /dev/shm</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs          tmpfs      16G   20M   16G   </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /run</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs          tmpfs      16G     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   16G   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">% /sys/fs/cgroup</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda4      xfs       483G  </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">.2G  482G   </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda2      xfs      1014M  108M  907M  </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain">% /boot</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda1      vfat      200M  </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain">.6M  193M   </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain">% /boot/efi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs          tmpfs     </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">.2G     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">.2G   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">% /run/user/0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># df -i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Filesystem        Inodes IUsed     IFree IUse% Mounted on</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">devtmpfs          </span><span class="token number" style="color:rgb(9, 134, 88)">260971</span><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">349</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">260622</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /dev</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs             </span><span class="token number" style="color:rgb(9, 134, 88)">261119</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">261118</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /dev/shm</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs             </span><span class="token number" style="color:rgb(9, 134, 88)">261119</span><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">498</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">260621</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /run</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs             </span><span class="token number" style="color:rgb(9, 134, 88)">261119</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">261103</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /sys/fs/cgroup</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda4      </span><span class="token number" style="color:rgb(9, 134, 88)">253159936</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">28461</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">253131475</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda2         </span><span class="token number" style="color:rgb(9, 134, 88)">524288</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">524272</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /boot</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda1              </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">         </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">     - /boot/efi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs             </span><span class="token number" style="color:rgb(9, 134, 88)">261119</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">261118</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">% /run/user/0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="56挂卸载文件系统">5.6、挂卸载文件系统<a class="hash-link" href="#56挂卸载文件系统" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="561mount-命令">5.6.1、mount 命令<a class="hash-link" href="#561mount-命令" title="Direct link to heading">​</a></h3><p>mount 用来显示挂载信息或者进行文件系统挂载，它的功能及其的强大，</p><p>它不仅支持挂载非常多种文件系统，如 ext/xfs/nfs/smbfs/cifs (win上的共享目录) 等，还支持共享挂载点、继承挂载点(父子关系)、绑定挂载点、移动挂载点等等功能。在本文只介绍其最简单的挂载功能。</p><p>mount 并非只能挂载文件系统，也可以将目录挂载到另一个目录下，其实它实现的是目录&quot;硬链接&quot;，默认情况下，是无法对目录建立硬链接的，但是通过 mount 可以完成绑定，绑定后两个目录的 inode 号是完全相同的，但尽管建立的是目录的&quot;硬链接&quot;，但其实也仅是拿来当软链接用。</p><p>以下是 ext 类文件系统的选项，可能有些选项是不支持其他文件系统的。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">mount</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)"># 将显示当前已挂载信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">mount</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-t 欲挂载文件系统类型 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-o 特殊选项</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> 设备名 挂载目录</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-a  将/etc/fstab文件里指定的挂载选项重新挂载一遍。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-t  支持ext2/ext3/ext4/vfat/fat/iso9660</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">光盘默认格式</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">。 不用-t时默认会调用blkid来获取文件系统类型。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-n  不把挂载记录写在/etc/mtab文件中，一般挂载会在/proc/mounts中记录下挂载信息，然后同步到/etc/mtab，指定-n表示不同步该挂载信息。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-o  指定挂载特殊选项。下面是两个比较常用的：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    loop  挂载镜像文件，如iso文件</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ro  只读挂载</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    rw  读写挂载</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    auto  相当于mount -a</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    dev 如果挂载的文件系统中有设备访问入口则启用它，使其可以作为设备访问入口</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    default rw,suid,dev,exec,auto,nouser,async,and relatime</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    async   异步挂载，只写到内存</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sync</span><span class="token plain">    同步挂载，通过挂载位置写入对方硬盘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    atime   修改访问时间，每次访问都修改atime会导致性能降低，所以默认是noatime</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    noatime 不修改访问时间，高并发时使用这个选项可以减少磁盘IO</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    nodiratime  不修改文件夹访问时间，高并发时使用这个选项可以减少磁盘IO</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    exec/noexec  挂载后的文件系统里的可执行程序是否可执行，默认是可以执行exec， 优先级高于权限的限定</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    remount  重新挂载，此时可以不用指定挂载点。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    suid/nosuid 对挂载的文件系统启用或禁用suid，对于外来设备最好禁用suid</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    _netdev 需要网络挂载时默认将停留在挂载界面直到加载网络了。使用_netdev可以忽略网络正常挂载。如NFS开机挂载。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    user  允许普通用户进行挂载该目录，但只允许挂载者进行卸载该目录</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">users</span><span class="token plain">  允许所有用户挂载和卸载该目录</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    nouser  禁止普通用户挂载和卸载该目录，这是默认的，默认情况下一个目录不指定user/users时，将只有root能挂载</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>一般 user/users/nouser 都用在 /etc/fstab 中，直接在命令行下使用这几个选项意义不是很大。</li></ul><p>mount 应用举例</p><ol><li><p>挂载 CentOS 的安装镜像到 /mnt</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mount /dev/cdrom /mnt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>其实 /dev/cdrom 是 /dev/sr0 的一个软链接，/dev/sr0 是光驱设备，所以也可以用 /dev/sr0 进行挂载。</li></ul></li><li><p>重新挂载</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mount -t ext4 -o remount /dev/sda1 /data1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>重新挂载文件系统为可读写</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mount -t ext4 -o rw remount /dev/sda1 /data1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>基于ssh挂载远程目录</p><p>如何基于 ssh 像 NFS 一样挂载远程主机上的目录？可以通过 sshfs 工具，该工具在 fuse-sshfs 包中，这个包在 epel 源中提供。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># yum install epel-release -y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># yum install fuse-sshfs -y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># sshfs -p 7422 36.158.226.101:/ /mnt/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">The authenticity of </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;[36.158.226.101]:7422 ([36.158.226.101]:7422)&#x27;</span><span class="token plain"> can</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;t be established.</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">ECDSA key fingerprint is SHA256:URVNsjkxt5/51QYjJ/5K5POzrGOvDHkL51jqDaew7UY.</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">ECDSA key fingerprint is MD5:34:c2:d9:36:d1:9a:ea:ba:45:14:22:2e:2a:66:f3:a2.</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">Are you sure you want to continue connecting (yes/no)? yes</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">root@36.158.226.101&#x27;</span><span class="token plain">s password: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /mnt/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bin   dev  Greatwall  lib    media  opt   root  sbin  sys  usr</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">boot  etc  home       lib64  mnt    proc  run   srv   tmp  var</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>挂载目录到另一个目录下。挂载目录时，挂载目录和挂载点的 inode 是相同的，它们两者的内容也是完全相同的</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mkdir /tmp/mpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># touch /tmp/mpoint/{1,2,3}.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /tmp/mpoint/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">.txt  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">.txt  </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mkdir /tmp/point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># touch /tmp/point/{a,b,c}.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /tmp/point/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">a.txt  b.txt  c.txt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mount --bind /tmp/mpoint/ /tmp/point/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /tmp/point/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">.txt  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">.txt  </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>查看某个目录是否是挂载点，使用 mountpoint 命令</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mountpoint /tmp/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/tmp/ is not a mountpoint</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mountpoint /tmp/point/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/tmp/point/ is a mountpoint</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>挂载的参数信息存放在 /proc/mounts(是/proc/self/mounts的软链接) 中，在 /proc/self/mountstats 和 /proc/mountinfo 里则记录了更详细的挂载信息。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cat /proc/mounts | tail -6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">hugetlbfs /dev/hugepages hugetlbfs rw,relatime,pagesize</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">512M </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">debugfs /sys/kernel/debug debugfs rw,relatime </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda2 /boot xfs rw,relatime,attr2,inode64,noquota </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda1 /boot/efi vfat rw,relatime,fmask</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">0077,dmask</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">0077,codepage</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">437</span><span class="token plain">,iocharset</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">ascii,shortname</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">winnt,errors</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">remount-ro </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">tmpfs /run/user/0 tmpfs rw,nosuid,nodev,relatime,size</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">3342336k,mode</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">700</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda4 /tmp/point xfs rw,relatime,attr2,inode64,noquota </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>文件系统是需要驱动支持的，没有驱动的文件系统也无法挂载，Linux 中支持的文件系统驱动在 /lib/modules/$(uname -r)/kernel/fs 下。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /lib/modules/$(uname -r)/kernel/fs/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">binfmt_misc.ko  cifs    fat      isofs  mbcache.ko  nfsd       pstore    xfs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cachefiles      cramfs  fscache  jbd2   nfs         nls        squashfs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ceph            ext4    fuse     lockd  nfs_common  overlayfs  udf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="562挂载镜像文件">5.6.2、挂载镜像文件<a class="hash-link" href="#562挂载镜像文件" title="Direct link to heading">​</a></h3><p>mount 是一个极其强大的挂载工具，它支持挂载很多种文件类型，其中就支持挂载镜像文件，其实它连挂载目录都支持。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 </span><span class="token number" style="color:rgb(9, 134, 88)">3.5</span><span class="token plain">.2_arm_greatwall</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mount Greatwall-aarch64-DVD-3.5.2-190918-c75.iso /mnt/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mount: /dev/loop0 is write-protected, mounting read-only</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 </span><span class="token number" style="color:rgb(9, 134, 88)">3.5</span><span class="token plain">.2_arm_greatwall</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># lsblk </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">loop0    </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain">:0    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">     3G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> loop /mnt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sda      </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:0    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">837</span><span class="token plain">.9G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> disk </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─sda4   </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:4    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">832</span><span class="token plain">.7G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part /</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─sda2   </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:2    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">     1G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part /boot</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">├─sda3   </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:3    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">     4G  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">SWAP</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─sda1   </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">:1    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   200M  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> part /boot/efi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 </span><span class="token number" style="color:rgb(9, 134, 88)">3.5</span><span class="token plain">.2_arm_greatwall</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="563umount-命令">5.6.3、umount 命令<a class="hash-link" href="#563umount-命令" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">umount</span><span class="token plain"> 设备名或挂载目录</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">umount</span><span class="token plain"> -lf 强制卸载</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>卸载时，既可以使用设备名也可以使用挂载点卸载。有时候挂载网络系统(如NFS)时，设备名很长，这时候可以使用挂载点来卸载就方便多了。</p><p>如果用户正在访问某个目录或文件，使得卸载一直显示 Busy，使用 fuser -v DIR 可以知道谁正在访问该目录或文件。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># fuser -v /mnt/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                     </span><span class="token environment constant" style="color:rgb(129, 31, 63)">USER</span><span class="token plain">        PID ACCESS COMMAND</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/mnt:                root     kernel </span><span class="token function" style="color:rgb(0, 0, 255)">mount</span><span class="token plain"> /mnt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用 -k 选项 kill 掉正在使用目录或文件的进程，使用 -km 选项 kill 掉文件系统上的所有进程，然后再 umount。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># fuser -km /mnt/; umount /mnt/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="564开机自动挂载">5.6.4、开机自动挂载<a class="hash-link" href="#564开机自动挂载" title="Direct link to heading">​</a></h3><p>通过将挂载选项写入到 /etc/fstab 中，系统会自动挂载该文件中的配置项。但要注意，该文件在开机的前几个过程中就被读取，所以配置错误很可能会导致开机失败。</p><p><img loading="lazy" alt="fstable" src="/en/assets/images/fstable-b208b8898aa11f6d6a9e28e7b180a51d.png" width="1053" height="323" class="img_ev3q"></p><p>其中最后两列，它们分别表示备份文件系统和开机自检，一般都可以设置为 0。由于能用的备份工具众多，没人会在这里设置备份，所以备份列设置为 0。</p><p>最后一列是开机自检设置列，开机自检调用的是 fsck 程序，所有有些 ext 类文件系统作为 &quot;/&quot; 时，可能会设置为1，但是 fsck 是不支持 xfs 文件系统的，所以对于 xfs 文件系统而言，该项必须设置为 0。</p><p>其实无需考虑那么多，直接将这两列设置为 0 就可以了。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="565修复错误">5.6.5、修复错误<a class="hash-link" href="#565修复错误" title="Direct link to heading">​</a></h3><p>万一 /etc/fstab 配置错误，导致开机无法加载。一般是停留在 &quot;Give root password for maintenance&quot; 这样的界面，输入 root 密码进入系统，重新修改 /etc/fstab 文件，重启即可。</p><p>如果卡住没法进入系统，可以利用 grub 配置传入 rd.break 参数进入特权模式，修改 /etc/fstable 然后重启即可。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="57swap-分区">5.7、swap 分区<a class="hash-link" href="#57swap-分区" title="Direct link to heading">​</a></h2><p>虽说个人电脑上基本已经无需设置 swap 分区了，但是在服务器上还是应该准备swap分区。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="571查看-swap">5.7.1、查看 swap<a class="hash-link" href="#571查看-swap" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># free -h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              total        used        </span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token plain">      shared  buff/cache   available</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Mem:            31G        224M         31G         35M        441M         28G</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Swap:           15G          0B         15G</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用 mount/lsblk 等可以查看出哪个分区在充当 swap 分区。使用 swapon -s 也可以直接查看出。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># swapon -s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Filename                Type        Size    Used    Priority</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/vda3                               partition   </span><span class="token number" style="color:rgb(9, 134, 88)">16712640</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   -2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="572添加-swap-分区">5.7.2、添加 swap 分区<a class="hash-link" href="#572添加-swap-分区" title="Direct link to heading">​</a></h3><ol><li><p>可以新分一个区，在分区时指定其分区的 ID 号为 SWAP 类型。</p><p>mbr 和 gpt 格式的磁盘上这个 ID 可能不太一样，不过一般 gp t中的格式是在 mbr 格式的 ID 后加上两位数的数值，如 mbr 中 swap 的类型 ID 为 82，在 gpt 中则是 8200，在 mbr 中 linux filesystem 类型的 ID 为 83，在 gpt 中则为 8300，在 mbr 中 lvm 的 ID 为 8e，在 gpt 中为 8e00。</p></li><li><p>格式化为 swap 分区：mkswap</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mkswap /dev/sda1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mkswap: /dev/sda1: warning: wiping old ext4 signature.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Setting up swapspace version </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">, size </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">975808</span><span class="token plain"> KiB</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">no label, </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">9a96b5d9-70b4-4a70-a1d6-31ed99175b52</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>加入 swap 分区空间(swapon)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># swapon /dev/sda1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># free -h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             total        used        </span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token plain">      shared  buff/cache   available</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Mem:            31G        225M         31G         35M        441M         28G</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Swap:           16G          0B         16G</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>取消 swap 分区空间(swapoff)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># swapoff /dev/sda1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># free -h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             total        used        </span><span class="token function" style="color:rgb(0, 0, 255)">free</span><span class="token plain">      shared  buff/cache   available</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Mem:            31G        224M         31G         35M        441M         28G</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Swap:           15G          0B         15G</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>开机自动加载 swap 分区</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 修改 /etc/fstab，加上一行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/dev/sda1    swap    swap    defaults    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/linux-primary-4"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">第 4 章 Linux ext 文件系统</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/linux-primary-6"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">第 6 章 Linux LVM 存储管理</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#51机械硬盘" class="table-of-contents__link toc-highlight">5.1、机械硬盘</a></li><li><a href="#52固态硬盘" class="table-of-contents__link toc-highlight">5.2、固态硬盘</a><ul><li><a href="#521ssd-扇区" class="table-of-contents__link toc-highlight">5.2.1、SSD 扇区</a></li><li><a href="#522闪存单元" class="table-of-contents__link toc-highlight">5.2.2、闪存单元</a></li></ul></li><li><a href="#53分区" class="table-of-contents__link toc-highlight">5.3、分区</a><ul><li><a href="#531分区方法" class="table-of-contents__link toc-highlight">5.3.1、分区方法</a></li><li><a href="#532mbr-和-gpt-分区表" class="table-of-contents__link toc-highlight">5.3.2、MBR 和 GPT 分区表</a></li><li><a href="#533添加磁盘" class="table-of-contents__link toc-highlight">5.3.3、添加磁盘</a></li><li><a href="#534交互式命令" class="table-of-contents__link toc-highlight">5.3.4、交互式命令</a><ul><li><a href="#5341fdisk-命令" class="table-of-contents__link toc-highlight">5.3.4.1、fdisk 命令</a></li><li><a href="#5342gdisk-命令" class="table-of-contents__link toc-highlight">5.3.4.2、gdisk 命令</a></li><li><a href="#5343parted-命令" class="table-of-contents__link toc-highlight">5.3.4.3、parted 命令</a></li></ul></li><li><a href="#535非交互式命令" class="table-of-contents__link toc-highlight">5.3.5、非交互式命令</a><ul><li><a href="#5351fdisk-命令" class="table-of-contents__link toc-highlight">5.3.5.1、fdisk 命令</a></li><li><a href="#5352gdisk-命令" class="table-of-contents__link toc-highlight">5.3.5.2、gdisk 命令</a></li><li><a href="#5353parted-命令" class="table-of-contents__link toc-highlight">5.3.5.3、parted 命令</a></li></ul></li></ul></li><li><a href="#54格式化分区" class="table-of-contents__link toc-highlight">5.4、格式化分区</a><ul><li><a href="#541mkfs-命令" class="table-of-contents__link toc-highlight">5.4.1、mkfs 命令</a></li><li><a href="#542mke2fs-命令" class="table-of-contents__link toc-highlight">5.4.2、mke2fs 命令</a></li><li><a href="#543tune2fs-命令" class="table-of-contents__link toc-highlight">5.4.3、tune2fs 命令</a></li></ul></li><li><a href="#55查看文件系统" class="table-of-contents__link toc-highlight">5.5、查看文件系统</a><ul><li><a href="#551lsblk-命令" class="table-of-contents__link toc-highlight">5.5.1、lsblk 命令</a></li><li><a href="#552blkid-命令" class="table-of-contents__link toc-highlight">5.5.2、blkid 命令</a></li><li><a href="#553file-命令" class="table-of-contents__link toc-highlight">5.5.3、file 命令</a></li><li><a href="#554du-命令" class="table-of-contents__link toc-highlight">5.5.4、du 命令</a></li><li><a href="#555df-命令" class="table-of-contents__link toc-highlight">5.5.5、df 命令</a></li></ul></li><li><a href="#56挂卸载文件系统" class="table-of-contents__link toc-highlight">5.6、挂卸载文件系统</a><ul><li><a href="#561mount-命令" class="table-of-contents__link toc-highlight">5.6.1、mount 命令</a></li><li><a href="#562挂载镜像文件" class="table-of-contents__link toc-highlight">5.6.2、挂载镜像文件</a></li><li><a href="#563umount-命令" class="table-of-contents__link toc-highlight">5.6.3、umount 命令</a></li><li><a href="#564开机自动挂载" class="table-of-contents__link toc-highlight">5.6.4、开机自动挂载</a></li><li><a href="#565修复错误" class="table-of-contents__link toc-highlight">5.6.5、修复错误</a></li></ul></li><li><a href="#57swap-分区" class="table-of-contents__link toc-highlight">5.7、swap 分区</a><ul><li><a href="#571查看-swap" class="table-of-contents__link toc-highlight">5.7.1、查看 swap</a></li><li><a href="#572添加-swap-分区" class="table-of-contents__link toc-highlight">5.7.2、添加 swap 分区</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Study</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/tags">Tags</a></li><li class="footer__item"><a class="footer__link-item" href="/en/archive">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/en/docs/skill">Notes</a></li><li class="footer__item"><a class="footer__link-item" href="/en/project">Projects</a></li><li class="footer__item"><a class="footer__link-item" href="/en/docs/linux">Linux</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social Media</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/about">About Me</a></li><li class="footer__item"><a href="https://github.com/zqingfa" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Juejin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/en/friends">Friends</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/en/website">Links</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p><a href="http://beian.miit.gov.cn/">闽ICP备2020017848号-2</a></p><p>Copyright © 2020 – PRESENT kuizuo Built with Docusaurus.</p></div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.06ffa367.js"></script>
<script src="/en/assets/js/main.7f2e5564.js"></script>
</body>
</html>
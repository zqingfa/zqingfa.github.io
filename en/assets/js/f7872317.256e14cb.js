"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[5892],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return m}});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=p(r),m=a,v=d["".concat(s,".").concat(m)]||d[m]||u[m]||l;return r?n.createElement(v,i(i({ref:t},c),{},{components:r})):n.createElement(v,i({ref:t},c))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=r.length,i=new Array(l);i[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var p=2;p<l;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},86043:function(e,t,r){r.r(t),r.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return u}});var n=r(87462),a=r(63366),l=(r(67294),r(3905)),i=["components"],o={id:"linux-advanced-15",slug:"/linux-advanced-15",title:"\u7b2c 15 \u7ae0 Linux LVS \u670d\u52a1\u914d\u7f6e",authors:"zhangqf",keywords:["linux","lvs"]},s=void 0,p={unversionedId:"linux/advanced/linux-advanced-15",id:"linux/advanced/linux-advanced-15",title:"\u7b2c 15 \u7ae0 Linux LVS \u670d\u52a1\u914d\u7f6e",description:'\u7f51\u7ad9\u67b6\u6784\u4e2d\uff0c\u8d1f\u8f7d\u5747\u8861\u6280\u672f\u662f\u5b9e\u73b0\u7f51\u7ad9\u67b6\u6784\u4f38\u7f29\u6027\u7684\u4e3b\u8981\u624b\u6bb5\u4e4b\u4e00\u3002\u6240\u8c13 "\u4f38\u7f29\u6027"\uff0c\u662f\u6307\u53ef\u4ee5\u4e0d\u65ad\u5411\u96c6\u7fa4\u4e2d\u6dfb\u52a0\u65b0\u7684\u670d\u52a1\u5668\u6765\u63d0\u5347\u6027\u80fd\u3001\u7f13\u89e3\u4e0d\u65ad\u589e\u52a0\u7684\u5e76\u53d1\u7528\u6237\u8bbf\u95ee\u538b\u529b\u3002',source:"@site/docs/linux/advanced/\u7b2c 15 \u7ae0 Linux LVS \u670d\u52a1\u914d\u7f6e.md",sourceDirName:"linux/advanced",slug:"/linux-advanced-15",permalink:"/en/docs/linux-advanced-15",draft:!1,tags:[],version:"current",frontMatter:{id:"linux-advanced-15",slug:"/linux-advanced-15",title:"\u7b2c 15 \u7ae0 Linux LVS \u670d\u52a1\u914d\u7f6e",authors:"zhangqf",keywords:["linux","lvs"]},sidebar:"linux",previous:{title:"\u7b2c 14 \u7ae0 Linux haproxy \u670d\u52a1\u9ad8\u7ea7\u914d\u7f6e",permalink:"/en/docs/linux-advanced-14"},next:{title:"\u7b2c 16 \u7ae0 Linux Keepalived \u670d\u52a1\u914d\u7f6e",permalink:"/en/docs/linux-advanced-16"}},c={},u=[{value:"10.1\u3001LVS \u7b80\u4ecb",id:"101lvs-\u7b80\u4ecb",level:2},{value:"10.2\u3001LVS-ipvs \u4e09\u79cd\u6a21\u5f0f\u7684\u5de5\u4f5c\u539f\u7406",id:"102lvs-ipvs-\u4e09\u79cd\u6a21\u5f0f\u7684\u5de5\u4f5c\u539f\u7406",level:2},{value:"10.2.1\u3001VS/NAT \u6a21\u5f0f",id:"1021vsnat-\u6a21\u5f0f",level:3},{value:"10.2.2\u3001VS/TUN \u6a21\u5f0f",id:"1022vstun-\u6a21\u5f0f",level:3},{value:"10.2.3\u3001VS/DR \u6a21\u5f0f",id:"1023vsdr-\u6a21\u5f0f",level:3},{value:"10.2.4\u3001lvs-ipvs \u7684\u4e09\u79cd\u6a21\u5f0f\u6bd4\u8f83",id:"1024lvs-ipvs-\u7684\u4e09\u79cd\u6a21\u5f0f\u6bd4\u8f83",level:3},{value:"10.3\u3001VS/TUN \u548c VS/DR \u6a21\u5f0f\u4e2d\u7684 ARP \u95ee\u9898",id:"103vstun-\u548c-vsdr-\u6a21\u5f0f\u4e2d\u7684-arp-\u95ee\u9898",level:2},{value:"10.4\u3001LVS \u8d1f\u8f7d\u5747\u8861\u7684\u8c03\u5ea6\u7b97\u6cd5",id:"104lvs-\u8d1f\u8f7d\u5747\u8861\u7684\u8c03\u5ea6\u7b97\u6cd5",level:2},{value:"10.5\u3001ipvsadm \u547d\u4ee4",id:"105ipvsadm-\u547d\u4ee4",level:2},{value:"10.6\u3001ipvsadm \u8bed\u6cd5",id:"106ipvsadm-\u8bed\u6cd5",level:2},{value:"10.7\u3001\u5b9e\u73b0 VS/NAT \u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861",id:"107\u5b9e\u73b0-vsnat-\u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861",level:2},{value:"10.8\u3001\u5b9e\u73b0 VS/DR \u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861",id:"108\u5b9e\u73b0-vsdr-\u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861",level:2},{value:"10.8.1\u3001CIP\u3001VIP\u3001RIP \u540c\u7f51\u6bb5\u5b9e\u9a8c",id:"1081cipviprip-\u540c\u7f51\u6bb5\u5b9e\u9a8c",level:3},{value:"10.8.2\u3001CIP\u3001VIP\u3001RIP \u4e0d\u540c\u7f51\u6bb5\u5b9e\u9a8c",id:"1082cipviprip-\u4e0d\u540c\u7f51\u6bb5\u5b9e\u9a8c",level:3}],d={toc:u};function m(e){var t=e.components,o=(0,a.Z)(e,i);return(0,l.kt)("wrapper",(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"\u7f51\u7ad9\u67b6\u6784\u4e2d\uff0c\u8d1f\u8f7d\u5747\u8861\u6280\u672f\u662f\u5b9e\u73b0\u7f51\u7ad9\u67b6\u6784",(0,l.kt)("strong",{parentName:"p"},"\u4f38\u7f29\u6027"),'\u7684\u4e3b\u8981\u624b\u6bb5\u4e4b\u4e00\u3002\u6240\u8c13 "\u4f38\u7f29\u6027"\uff0c\u662f\u6307\u53ef\u4ee5\u4e0d\u65ad\u5411\u96c6\u7fa4\u4e2d\u6dfb\u52a0\u65b0\u7684\u670d\u52a1\u5668\u6765\u63d0\u5347\u6027\u80fd\u3001\u7f13\u89e3\u4e0d\u65ad\u589e\u52a0\u7684\u5e76\u53d1\u7528\u6237\u8bbf\u95ee\u538b\u529b\u3002'),(0,l.kt)("p",null,"\u8d1f\u8f7d\u5747\u8861\u6709\u597d\u51e0\u79cd\u65b9\u5f0f\uff1ahttp URL \u91cd\u5b9a\u5411\u3001DNS \u7684 A \u8bb0\u5f55\u8d1f\u8f7d\u5747\u8861\u3001\u53cd\u5411\u4ee3\u7406\u8d1f\u8f7d\u5747\u8861\u3001IP \u8d1f\u8f7d\u5747\u8861\u548c\u94fe\u8def\u5c42\u8d1f\u8f7d\u3002\u672c\u6587\u6240\u8ff0\u4e3a LVS\uff0c\u5b83\u7684 VS/NAT \u548c VS/TUN \u6a21\u5f0f\u662f IP \u8d1f\u8f7d\u5747\u8861\u7684\u4f18\u79c0\u4ee3\u8868\uff0c\u800c\u5b83\u7684 VS/DR \u6a21\u5f0f\u5219\u662f\u94fe\u8def\u5c42\u8d1f\u8f7d\u5747\u8861\u7684\u4f18\u79c0\u4ee3\u8868\u3002"),(0,l.kt)("h2",{id:"101lvs-\u7b80\u4ecb"},"10.1\u3001LVS \u7b80\u4ecb"),(0,l.kt)("p",null,"LVS \u4e2d\u6587\u5b98\u65b9\u624b\u518c\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://www.linuxvirtualserver.org/zh/index.html%E3%80%82%E8%BF%99%E4%B8%AA%E6%89%8B%E5%86%8C%E5%AF%B9%E4%BA%8E%E4%BA%86%E8%A7%A3"},"http://www.linuxvirtualserver.org/zh/index.html\u3002\u8fd9\u4e2a\u624b\u518c\u5bf9\u4e8e\u4e86\u89e3")," lvs \u7684\u80cc\u666f\u77e5\u8bc6\u5f88\u6709\u5e2e\u52a9\u3002"),(0,l.kt)("p",null,"LVS \u82f1\u6587\u5b98\u65b9\u624b\u518c\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://www.linuxvirtualserver.org/Documents.html%E3%80%82%E8%BF%99%E4%B8%AA%E6%89%8B%E5%86%8C%E6%AF%94%E8%BE%83%E5%85%A8%E9%9D%A2%EF%BC%8C%E5%AF%B9%E4%BA%8E%E4%BA%86%E8%A7%A3%E5%92%8C%E5%AD%A6%E4%B9%A0"},"http://www.linuxvirtualserver.org/Documents.html\u3002\u8fd9\u4e2a\u624b\u518c\u6bd4\u8f83\u5168\u9762\uff0c\u5bf9\u4e8e\u4e86\u89e3\u548c\u5b66\u4e60")," lvs \u7684\u539f\u7406\u3001\u914d\u7f6e\u5f88\u6709\u5e2e\u52a9\u3002"),(0,l.kt)("p",null,"LVS \u662f\u7ae0\u6587\u5d69\u5f00\u53d1\u7684\u4e00\u4e2a\u56fd\u4ea7\u5f00\u6e90\u8d1f\u8f7d\u5747\u8861\u8f6f\u4ef6\u3002LVS \u6700\u521d\u662f\u4ed6\u5728\u5927\u5b66\u671f\u95f4\u7684\u73a9\u5177\uff0c\u968f\u7740\u540e\u6765\u4f7f\u7528\u7684\u7528\u6237\u8d8a\u6765\u8d8a\u591a\uff0cLVS \u4e5f\u8d8a\u6765\u8d8a\u5b8c\u5584\uff0c\u6700\u7ec8\u96c6\u6210\u5230\u4e86 Linux \u7684\u5185\u6838\u4e2d\u3002\u6709\u4e0d\u5c11\u5f00\u6e90\u725b\u4eba\u90fd\u4e3a LVS \u5f00\u53d1\u8fc7\u8f85\u52a9\u5de5\u5177\u548c\u8f85\u52a9\u7ec4\u4ef6\uff0c\u6700\u51fa\u540d\u7684\u5c31\u662f Alexandre \u4e3a LVS \u7f16\u5199\u7684 Keepalived\uff0c\u5b83\u6700\u521d\u4e13\u95e8\u7528\u4e8e\u76d1\u63a7 LVS\uff0c\u540e\u6765\u52a0\u5165\u4e86\u901a\u8fc7 VRRP \u5b9e\u73b0\u9ad8\u53ef\u7528\u7684\u529f\u80fd\u3002"),(0,l.kt)("p",null,"LVS \u7684\u5168\u79f0\u662f Linux virtual server\uff0c\u5373 Linux \u865a\u62df\u670d\u52a1\u5668\u3002\u4e4b\u6240\u4ee5\u662f\u865a\u62df\u670d\u52a1\u5668\uff0c\u662f\u56e0\u4e3a LVS \u81ea\u8eab\u662f\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668(director)\uff0c\u4e0d\u76f4\u63a5\u5904\u7406\u8bf7\u6c42\uff0c\u800c\u662f\u5c06\u8bf7\u6c42\u8f6c\u53d1\u81f3\u4f4d\u4e8e\u5b83\u540e\u7aef\u771f\u6b63\u7684\u670d\u52a1\u5668 realserver \u4e0a\u3002"),(0,l.kt)("p",null,"LVS \u662f\u56db\u5c42(\u4f20\u8f93\u5c42 tcp/udp)\u3001\u4e03\u5c42(\u5e94\u7528\u5c42)\u7684\u8d1f\u8f7d\u5747\u8861\u5de5\u5177\uff0c\u53ea\u4e0d\u8fc7\u5927\u4f17\u4e00\u822c\u90fd\u4f7f\u7528\u5b83\u7684\u56db\u5c42\u8d1f\u8f7d\u5747\u8861\u529f\u80fd ipvs\uff0c\u800c\u4e03\u5c42\u7684\u5185\u5bb9\u5206\u53d1\u8d1f\u8f7d\u5de5\u5177 ktcpvs(kernel tcp virtual server)\u4e0d\u600e\u4e48\u5b8c\u5584\uff0c\u4f7f\u7528\u7684\u4eba\u5e76\u4e0d\u591a\u3002"),(0,l.kt)("p",null,"ipvs \u662f\u96c6\u6210\u5728\u5185\u6838\u4e2d\u7684\u6846\u67b6\uff0c\u53ef\u4ee5\u901a\u8fc7\u7528\u6237\u7a7a\u95f4\u7684\u7a0b\u5e8f ",(0,l.kt)("inlineCode",{parentName:"p"},"ipvsadm")," \u5de5\u5177\u6765\u7ba1\u7406\uff0c\u8be5\u5de5\u5177\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e9b\u89c4\u5219\u6765\u7ba1\u7406\u5185\u6838\u4e2d\u7684 ipvs\u3002\u5c31\u50cf iptables \u548c netfilter \u7684\u5173\u7cfb\u4e00\u6837\u3002"),(0,l.kt)("h2",{id:"102lvs-ipvs-\u4e09\u79cd\u6a21\u5f0f\u7684\u5de5\u4f5c\u539f\u7406"},"10.2\u3001LVS-ipvs \u4e09\u79cd\u6a21\u5f0f\u7684\u5de5\u4f5c\u539f\u7406"),(0,l.kt)("p",null,"\u9996\u5148\u8981\u89e3\u91ca\u7684\u662f LVS \u76f8\u5173\u7684\u51e0\u79cd IP\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"VIP"),"\uff1avirtual IP\uff0cLVS \u670d\u52a1\u5668\u4e0a\u63a5\u6536\u5916\u7f51\u6570\u636e\u5305\u7684\u7f51\u5361 IP \u5730\u5740\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"DIP"),"\uff1adirector IP\uff0cLVS \u670d\u52a1\u5668\u4e0a\u8f6c\u53d1\u6570\u636e\u5305\u5230 realserver \u7684\u7f51\u5361 IP \u5730\u5740\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"RIP"),"\uff1arealserver(\u5e38\u7b80\u79f0\u4e3a RS)\u4e0a\u63a5\u6536 Director \u8f6c\u53d1\u6570\u636e\u5305\u7684 IP\uff0c\u5373\u63d0\u4f9b\u670d\u52a1\u7684\u670d\u52a1\u5668 IP\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CIP"),"\uff1a\u5ba2\u6237\u7aef\u7684 IP\u3002")),(0,l.kt)("p",null,"LVS \u7684\u4e09\u79cd\u5de5\u4f5c\u6a21\u5f0f\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u901a\u8fc7\u7f51\u7edc\u5730\u5740\u8f6c\u6362(NAT)\u5c06\u4e00\u7ec4\u670d\u52a1\u5668\u6784\u6210\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u3001\u9ad8\u53ef\u7528\u7684\u865a\u62df\u670d\u52a1\u5668\uff0c\u662f VS/NAT \u6280\u672f\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u5728\u5206\u6790 VS/NAT \u7684\u7f3a\u70b9\u548c\u7f51\u7edc\u670d\u52a1\u7684\u975e\u5bf9\u79f0\u6027\u7684\u57fa\u7840\u4e0a\uff0c\u63d0\u51fa\u4e86\u901a\u8fc7 IP \u96a7\u9053\u5b9e\u73b0\u865a\u62df\u670d\u52a1\u5668\u7684\u65b9\u6cd5 VS/TUN\uff08Virtual Server via IP Tunneling\uff09\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u901a\u8fc7\u76f4\u63a5\u8def\u7531\u5b9e\u73b0\u865a\u62df\u670d\u52a1\u5668\u7684\u65b9\u6cd5 VS/DR\uff08Virtual Server via Direct Routing\uff09\u3002")),(0,l.kt)("h3",{id:"1021vsnat-\u6a21\u5f0f"},"10.2.1\u3001VS/NAT \u6a21\u5f0f"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\u5230\u8fbe Director \u540e\uff0cDirector \u6839\u636e\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u6539\u5199\u76ee\u6807\u5730\u5740\u4e3a\u540e\u7aef\u67d0\u4e2a RIP(web \u670d\u52a1\u5668\u6c60\u4e2d\u4e3b\u673a\u4e4b\u4e00)\u5e76\u8f6c\u53d1\u7ed9\u8be5\u540e\u7aef\u4e3b\u673a\uff0c\u5c31\u50cf NAT \u4e00\u6837\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u5f53\u540e\u7aef\u4e3b\u673a\u5904\u7406\u5b8c\u8bf7\u6c42\u540e\uff0c\u540e\u7aef\u4e3b\u673a\u5c06\u54cd\u5e94\u6570\u636e\u4ea4\u7ed9 Director\uff0c\u5e76\u7531 director \u6539\u5199\u6e90\u5730\u5740\u4e3a VIP \u540e\u4f20\u8f93\u7ed9\u5ba2\u6237\u7aef\u3002")),(0,l.kt)("p",null,"\u5927\u591a\u6570\u5546\u54c1\u5316\u7684 IP \u8d1f\u8f7d\u5747\u8861\u786c\u4ef6\u90fd\u662f\u4f7f\u7528\u6b64\u65b9\u6cd5\uff0c\u5982 Cisco \u7684 LocalDirector\u3001F5 \u7684 Big/IP\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"lvs nat",src:r(97263).Z,width:"836",height:"355"})),(0,l.kt)("p",null,"VS/NAT \u6a21\u5f0f\u4e0b\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"RIP \u548c DIP \u4e00\u822c\u5904\u4e8e\u540c\u4e00\u79c1\u6709\u7f51\u6bb5\u4e2d\u3002\u4f46\u5e76\u975e\u5fc5\u987b\uff0c\u53ea\u8981\u5b83\u4eec\u80fd\u901a\u4fe1\u5373\u53ef\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u5404 RealServer \u7684\u7f51\u5173\u6307\u5411 DIP\uff0c\u8fd9\u6837\u80fd\u4fdd\u8bc1\u5c06\u54cd\u5e94\u6570\u636e\u4ea4\u7ed9 Director\u3002"),(0,l.kt)("li",{parentName:"ol"},'VS/NAT \u6a21\u5f0f\u7684\u6700\u5927\u7f3a\u70b9\u662f Director \u8d1f\u8d23\u6240\u6709\u8fdb\u51fa\u6570\u636e\uff1a\u4e0d\u4ec5\u5904\u7406\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u8bf7\u6c42\uff0c\u8fd8\u8d1f\u8d23\u5c06\u54cd\u5e94\u4f20\u8f93\u7ed9\u5ba2\u6237\u7aef\u3002\u800c\u54cd\u5e94\u6570\u636e\u4e00\u822c\u6bd4\u8bf7\u6c42\u6570\u636e\u5927\u5f97\u591a\uff0c\u8c03\u5ea6\u5668 Director \u5bb9\u6613\u51fa\u73b0\u74f6\u9888\u3002(\u4e5f\u5c31\u662f\u50cf 7 \u5c42\u8d1f\u8f7d\u7684\u5904\u7406\u65b9\u5f0f\u4e00\u6837\uff0c\u4f46\u5374\u6ca1\u6709 7 \u5c42\u8d1f\u8f7d\u90a3\u4e48 "\u591a\u529f\u80fd")'),(0,l.kt)("li",{parentName:"ol"},"\u8fd9\u79cd\u6a21\u5f0f\u914d\u7f6e\u8d77\u6765\u6700\u7b80\u5355\u3002")),(0,l.kt)("h3",{id:"1022vstun-\u6a21\u5f0f"},"10.2.2\u3001VS/TUN \u6a21\u5f0f"),(0,l.kt)("p",null,"\u91c7\u7528 NAT \u6280\u672f\u65f6\uff0c\u7531\u4e8e\u8bf7\u6c42\u548c\u54cd\u5e94\u62a5\u6587\u90fd\u5fc5\u987b\u7ecf\u8fc7\u8c03\u5ea6\u5668\u5730\u5740\u91cd\u5199\uff0c\u5f53\u5ba2\u6237\u8bf7\u6c42\u8d8a\u6765\u8d8a\u591a\u65f6\uff0c\u8c03\u5ea6\u5668\u7684\u5904\u7406\u80fd\u529b\u5c06\u6210\u4e3a\u74f6\u9888\u3002"),(0,l.kt)("p",null,"\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u8c03\u5ea6\u5668\u628a\u8bf7\u6c42\u62a5\u6587\u901a\u8fc7 IP \u96a7\u9053\u8f6c\u53d1\u81f3\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u800c\u771f\u5b9e\u670d\u52a1\u5668\u5c06\u54cd\u5e94\u76f4\u63a5\u8fd4\u56de\u7ed9\u5ba2\u6237\uff0c\u6240\u4ee5\u8c03\u5ea6\u5668\u53ea\u5904\u7406\u8bf7\u6c42\u62a5\u6587\u3002"),(0,l.kt)("p",null,"\u7531\u4e8e\u4e00\u822c\u7f51\u7edc\u670d\u52a1\u54cd\u5e94\u62a5\u6587\u6bd4\u8bf7\u6c42\u62a5\u6587\u5927\u8bb8\u591a\uff0c\u91c7\u7528 VS/TUN \u6280\u672f\u540e\uff0c\u8c03\u5ea6\u5668\u5f97\u5230\u6781\u5927\u7684\u89e3\u653e\uff0c\u96c6\u7fa4\u7cfb\u7edf\u7684\u6700\u5927\u541e\u5410\u91cf\u53ef\u4ee5\u63d0\u9ad8 10 \u500d\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"lvs tun",src:r(10613).Z,width:"1019",height:"356"})),(0,l.kt)("p",null,"VS/TUN \u6a21\u5f0f\u7684\u5de5\u4f5c\u539f\u7406\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"IP \u96a7\u9053\u6280\u672f\u53c8\u79f0\u4e3a IP \u5c01\u88c5\u6280\u672f\uff0c\u5b83\u53ef\u4ee5\u5c06\u5e26\u6709\u6e90\u548c\u76ee\u6807 IP \u5730\u5740\u7684\u6570\u636e\u62a5\u6587\u4f7f\u7528\u65b0\u7684\u6e90\u548c\u76ee\u6807 IP \u8fdb\u884c\u7b2c\u4e8c\u6b21\u5c01\u88c5\uff0c\u8fd9\u6837\u8fd9\u4e2a\u62a5\u6587\u5c31\u53ef\u4ee5\u53d1\u9001\u5230\u4e00\u4e2a\u6307\u5b9a\u7684\u76ee\u6807\u4e3b\u673a\u4e0a\uff1b"),(0,l.kt)("li",{parentName:"ol"},"VS/TUN \u6a21\u5f0f\u4e0b\uff0c\u8c03\u5ea6\u5668\u548c\u540e\u7aef\u670d\u52a1\u5668\u7ec4\u4e4b\u95f4\u4f7f\u7528 IP \u96a7\u9053\u6280\u672f\u3002\u5f53\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42(CIP--\x3eVIP)\u88ab director \u63a5\u6536\u540e\uff0cdirector \u4fee\u6539\u8be5\u62a5\u6587\uff0c\u52a0\u4e0a IP \u96a7\u9053\u4e24\u7aef\u7684 IP \u5730\u5740\u4f5c\u4e3a\u65b0\u7684\u6e90\u548c\u76ee\u6807\u5730\u5740\uff0c\u5e76\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u540e\u7aef\u88ab\u9009\u4e2d\u7684\u4e00\u4e2a\u76ee\u6807\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u5f53\u540e\u7aef\u670d\u52a1\u5668\u63a5\u6536\u5230\u62a5\u6587\u540e\uff0c\u9996\u5148\u89e3\u5c01\u62a5\u6587\u5f97\u5230\u539f\u6709\u7684 CIP--\x3eVIP\uff0c\u8be5\u540e\u7aef\u670d\u52a1\u5668\u53d1\u73b0\u81ea\u8eab\u7684 tun \u63a5\u53e3\u4e0a\u914d\u7f6e\u4e86 VIP\uff0c\u56e0\u6b64\u63a5\u53d7\u8be5\u6570\u636e\u5305\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u5f53\u8bf7\u6c42\u5904\u7406\u5b8c\u6210\u540e\uff0c\u7ed3\u679c\u5c06\u4e0d\u4f1a\u91cd\u65b0\u4ea4\u7ed9 director\uff0c\u800c\u662f\u76f4\u63a5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u6b64\u65f6\u54cd\u5e94\u6570\u636e\u5305\u7684\u6e90 IP \u4e3a VIP\uff0c\u76ee\u6807 IP \u4e3a CIP\u3002")),(0,l.kt)("p",null,"\u91c7\u7528 VS/TUN \u6a21\u5f0f\u65f6\u7684\u57fa\u672c\u5c5e\u6027\u548c\u8981\u6c42\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"RealServer \u7684 RIP \u548c director \u7684 DIP \u4e0d\u7528\u5904\u4e8e\u540c\u4e00\u7269\u7406\u7f51\u7edc\u4e2d\uff0c\u4e14 RIP \u5fc5\u987b\u53ef\u4ee5\u548c\u516c\u7f51\u901a\u4fe1\u3002\u4e5f\u5c31\u662f\u8bf4\u96c6\u7fa4\u8282\u70b9\u53ef\u4ee5\u8de8\u4e92\u8054\u7f51\u5b9e\u73b0\u3002"),(0,l.kt)("li",{parentName:"ol"},"realserver \u7684 tun \u63a5\u53e3\u4e0a\u9700\u8981\u914d\u7f6e VIP \u5730\u5740\uff0c\u4ee5\u4fbf\u63a5\u6536 director \u8f6c\u53d1\u8fc7\u6765\u7684\u6570\u636e\u5305\uff0c\u4ee5\u53ca\u4f5c\u4e3a\u54cd\u5e94\u62a5\u6587\u7684\u6e90 IP\u3002"),(0,l.kt)("li",{parentName:"ol"},"director \u7ed9 realserver \u65f6\u9700\u8981\u501f\u52a9\u96a7\u9053\uff0c\u96a7\u9053\u5916\u5c42\u7684 IP \u5934\u90e8\u7684\u6e90 IP \u662f DIP\uff0c\u76ee\u6807 IP \u662f RIP\u3002\u800c realsever \u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u7684 IP \u5934\u90e8\u662f\u6839\u636e\u96a7\u9053\u5185\u5c42\u7684 IP \u5934\u5206\u6790\u5f97\u5230\u7684\uff0c\u6e90 IP \u662f VIP\uff0c\u76ee\u6807 IP \u662f CIP\u3002\u8fd9\u6837\u5ba2\u6237\u7aef\u5c31\u65e0\u6cd5\u533a\u5206\u8fd9\u4e2a VIP \u5230\u5e95\u662f director \u7684\u8fd8\u662f\u670d\u52a1\u5668\u7ec4\u4e2d\u7684\u3002"),(0,l.kt)("li",{parentName:"ol"},"director \u53ea\u5904\u7406\u5165\u7ad9\u8bf7\u6c42\uff0c\u54cd\u5e94\u8bf7\u6c42\u7531 realserver \u5b8c\u6210\u3002")),(0,l.kt)("p",null,"\u4e00\u822c\u6765\u8bf4\uff0cVS/TUN \u6a21\u5f0f\u4f1a\u7528\u6765\u8d1f\u8f7d\u8c03\u5ea6\u7f13\u5b58\u670d\u52a1\u5668\u7ec4\uff0c\u8fd9\u4e9b\u7f13\u5b58\u670d\u52a1\u5668\u4e00\u822c\u653e\u7f6e\u5728\u4e0d\u540c\u7f51\u7edc\u73af\u5883\uff0c\u53ef\u4ee5\u5c31\u8fd1\u8fd4\u56de\u6570\u636e\u7ed9\u5ba2\u6237\u7aef\u3002\u5728\u8bf7\u6c42\u5bf9\u8c61\u4e0d\u80fd\u5728 Cache \u670d\u52a1\u5668\u672c\u5730\u547d\u4e2d\u7684\u60c5\u51b5\u4e0b\uff0cCache \u670d\u52a1\u5668\u8981\u5411\u6e90\u670d\u52a1\u5668\u53d1\u8bf7\u6c42\uff0c\u5c06\u7ed3\u679c\u53d6\u56de\uff0c\u6700\u540e\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u3002"),(0,l.kt)("h3",{id:"1023vsdr-\u6a21\u5f0f"},"10.2.3\u3001VS/DR \u6a21\u5f0f"),(0,l.kt)("p",null,"VS/TUN \u6a21\u5f0f\u4e0b\uff0c\u8c03\u5ea6\u5668\u5bf9\u6570\u636e\u5305\u7684\u5904\u7406\u662f\u4f7f\u7528 IP \u96a7\u9053\u6280\u672f\u8fdb\u884c\u4e8c\u6b21\u5c01\u88c5\u3002VS/DR \u6a21\u5f0f\u548c VS/TUN \u6a21\u5f0f\u5f88\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u8c03\u5ea6\u5668\u5bf9\u6570\u636e\u5305\u7684\u5904\u7406\u662f\u6539\u5199\u6570\u636e\u5e27\u7684\u76ee\u6807 MAC \u5730\u5740\uff0c\u901a\u8fc7\u94fe\u8def\u5c42\u6765\u8d1f\u8f7d\u5747\u8861\u3002"),(0,l.kt)("p",null,"VS/DR \u901a\u8fc7\u6539\u5199\u8bf7\u6c42\u62a5\u6587\u7684\u76ee\u6807 MAC \u5730\u5740\uff0c\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u800c\u771f\u5b9e\u670d\u52a1\u5668\u5c06\u54cd\u5e94\u76f4\u63a5\u8fd4\u56de\u7ed9\u5ba2\u6237\u3002\u540c VS/TUN \u6280\u672f\u4e00\u6837\uff0cVS/DR \u6280\u672f\u53ef\u6781\u5927\u5730\u63d0\u9ad8\u96c6\u7fa4\u7cfb\u7edf\u7684\u4f38\u7f29\u6027\u3002\u8fd9\u79cd\u65b9\u6cd5\u6ca1\u6709 IP \u96a7\u9053\u7684\u5f00\u9500\uff0c\u5bf9\u96c6\u7fa4\u4e2d\u7684\u771f\u5b9e\u670d\u52a1\u5668\u4e5f\u6ca1\u6709\u5fc5\u987b\u652f\u6301 IP \u96a7\u9053\u534f\u8bae\u7684\u8981\u6c42\uff0c\u4f46\u662f\u8981\u6c42\u8c03\u5ea6\u5668\u4e0e\u771f\u5b9e\u670d\u52a1\u5668\u90fd\u6709\u4e00\u5757\u7f51\u5361\u8fde\u5728\u540c\u4e00\u7269\u7406\u7f51\u6bb5\u4e0a\uff0c\u4ee5\u4fbf\u4f7f\u7528 MAC \u5730\u5740\u901a\u4fe1\u8f6c\u53d1\u6570\u636e\u5305\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"lvs dr",src:r(74086).Z,width:"993",height:"390"})),(0,l.kt)("p",null,"VS/DR \u6a21\u5f0f\u7684\u5de5\u4f5c\u539f\u7406\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\u88ab director \u63a5\u6536\u540e\uff0cdirector \u6839\u636e\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u6539\u5199\u6570\u636e\u5e27\u7684",(0,l.kt)("strong",{parentName:"li"},"\u76ee\u6807 MAC \u5730\u5740"),"\u4e3a\u540e\u7aef\u67d0 RS \u7684 MAC \u5730\u5740\uff0c\u5e76\u5c06\u8be5\u6570\u636e\u5305\u8f6c\u53d1\u7ed9\u8be5 RS(\u5b9e\u9645\u4e0a\u662f\u5f80\u6574\u4e2a\u5c40\u57df\u7f51\u53d1\u9001\uff0c\u4f46\u53ea\u6709\u8be5 MAC \u5730\u5740\u7684 RS \u624d\u4e0d\u4f1a\u4e22\u5f03)\u3002"),(0,l.kt)("li",{parentName:"ol"},"RS \u63a5\u6536\u5230\u6570\u636e\u5305\u540e\uff0c\u53d1\u73b0\u6570\u636e\u5305\u7684\u76ee\u6807 IP \u5730\u5740\u4e3a VIP\uff0c\u800c RS \u672c\u8eab\u5df2\u7ecf\u5c06 VIP \u914d\u7f6e\u5728\u4e86\u67d0\u4e2a\u63a5\u53e3\u4e0a\uff0c\u56e0\u6b64 RS \u4f1a\u63a5\u6536\u4e0b\u8fd9\u4e2a\u6570\u636e\u5305\u5e76\u8fdb\u884c\u5904\u7406\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u5904\u7406\u5b8c\u6bd5\u540e\uff0cRS \u76f4\u63a5\u5c06\u54cd\u5e94\u62a5\u6587\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u3002\u6b64\u65f6\u6570\u636e\u5305\u6e90 IP \u4e3a VIP\uff0c\u76ee\u6807 IP \u4e3a CIP\u3002")),(0,l.kt)("p",null,"\u91c7\u7528 VS/DR \u6a21\u5f0f\u65f6\u7684\u57fa\u672c\u5c5e\u6027\u548c\u8981\u6c42\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"RealServer \u7684 RIP \u548c director \u7684 DIP \u5fc5\u987b\u5904\u4e8e\u540c\u4e00\u7f51\u6bb5\u4e2d\uff0c\u4ee5\u4fbf\u4f7f\u7528 MAC \u5730\u5740\u8fdb\u884c\u901a\u4fe1\u3002"),(0,l.kt)("li",{parentName:"ol"},"realserver \u4e0a\u5fc5\u987b\u914d\u7f6e VIP \u5730\u5740\uff0c\u4ee5\u4fbf\u63a5\u6536 director \u8f6c\u53d1\u8fc7\u6765\u7684\u6570\u636e\u5305\uff0c\u4ee5\u53ca\u4f5c\u4e3a\u54cd\u5e94\u62a5\u6587\u7684\u6e90 IP\u3002"),(0,l.kt)("li",{parentName:"ol"},"realsever \u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u7684\u6570\u636e\u5305\u7684\u6e90\u548c\u76ee\u6807 IP \u4e3a VIP --\x3e CIP\u3002"),(0,l.kt)("li",{parentName:"ol"},"director \u53ea\u5904\u7406\u5165\u7ad9\u8bf7\u6c42\uff0c\u54cd\u5e94\u8bf7\u6c42\u7531 realserver \u5b8c\u6210\u3002")),(0,l.kt)("h3",{id:"1024lvs-ipvs-\u7684\u4e09\u79cd\u6a21\u5f0f\u6bd4\u8f83"},"10.2.4\u3001lvs-ipvs \u7684\u4e09\u79cd\u6a21\u5f0f\u6bd4\u8f83"),(0,l.kt)("p",null,"\u4e09\u79cd\u6a21\u5f0f\u7684\u6bd4\u8f83\u5982\u56fe\u6240\u793a\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"lvs compared",src:r(27864).Z,width:"628",height:"138"})),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5728\u6027\u80fd\u4e0a\uff0cVS/DR \u548c VS/TUN \u8fdc\u9ad8\u4e8e VS/NAT\uff0c\u56e0\u4e3a\u8c03\u5ea6\u5668\u53ea\u5904\u4e8e\u4ece\u5ba2\u6237\u5230\u670d\u52a1\u5668\u7684\u534a\u8fde\u63a5\u4e2d\uff0c\u6309\u7167\u534a\u8fde\u63a5\u7684 TCP \u6709\u9650\u72b6\u6001\u673a\u8fdb\u884c\u72b6\u6001\u8fc1\u79fb\uff0c\u6781\u5927\u7a0b\u5ea6\u4e0a\u51cf\u8f7b\u4e86\u8c03\u5ea6\u5668\u7684\u538b\u529b(\u771f\u6b63\u5efa\u7acb TCP \u8fde\u63a5\u7684\u662f RS \u548c Client)\u3002"),(0,l.kt)("li",{parentName:"ol"},"VS/DR \u6027\u80fd\u53c8\u7a0d\u9ad8\u4e8e VS/TUN\uff0c\u56e0\u4e3a\u5c11\u4e86\u96a7\u9053\u7684\u5f00\u9500\u3002\u4f46\u662f\uff0cVS/DR \u548c VS/TUN \u7684\u4e3b\u8981\u533a\u522b\u662f VS/TUN \u53ef\u4ee5\u8de8\u7f51\u7edc\u5b9e\u73b0\u540e\u7aef\u670d\u52a1\u5668\u8d1f\u8f7d\u5747\u8861(\u4e5f\u53ef\u4ee5\u5c40\u57df\u7f51\u5185)\uff0c\u800c VS/DR \u53ea\u80fd\u548c director \u5728\u5c40\u57df\u7f51\u5185\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u3002")),(0,l.kt)("h2",{id:"103vstun-\u548c-vsdr-\u6a21\u5f0f\u4e2d\u7684-arp-\u95ee\u9898"},"10.3\u3001VS/TUN \u548c VS/DR \u6a21\u5f0f\u4e2d\u7684 ARP \u95ee\u9898"),(0,l.kt)("p",null,"\u53c2\u89c1 ",(0,l.kt)("a",{parentName:"p",href:"https://www.brinnatt.com/addons/%e7%ac%ac-d-1-%e7%ab%a0-linux-arp-%e5%ba%94%e7%94%a8/"},"VS/TUN \u548c VS/DR \u7684 arp \u95ee\u9898"),"\uff0c\u975e\u5e38\u8be6\u7ec6\u5730\u5206\u6790\u4e86 ARP\u3001arp","_","ignore \u548c arp","_","announce \u76f8\u5173\u539f\u7406\u548c\u8bbe\u7f6e\u65b9\u6cd5\u3002\u6b64\u5904\u7b80\u5355\u8bf4\u660e\u4e3a\u4f55\u9700\u8981\u8bbe\u7f6e arp \u6291\u5236\u4ee5\u53ca\u8bbe\u7f6e arp \u6291\u5236\u7684\u65b9\u6cd5\u3002"),(0,l.kt)("p",null,"\u5f53\u4e00\u4e2a\u76ee\u6807 IP \u5730\u5740\u4e3a VIP \u7684\u6570\u636e\u5305\u8fdb\u5165 Director \u65f6\uff0cDirector \u5c40\u57df\u7f51(\u5305\u62ec\u96a7\u9053)\u5185\u4f1a\u8fdb\u884c ARP \u5e7f\u64ad\uff0c\u4ee5\u627e\u51fa VIP \u5730\u5740\u7684 MAC \u5730\u5740\u5728\u54ea\u53f0\u4e3b\u673a\u4e0a\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Director \u548c\u5404 RS \u90fd\u914d\u7f6e\u4e86 VIP"),"\u3002Director \u548c RS \u4e4b\u95f4\u7684\u8fde\u63a5\u8bbe\u5907 L(\u53ef\u80fd\u662f\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\uff0c\u4e5f\u53ef\u80fd\u662f\u76f4\u8fde\u65f6 Director \u7684\u5185\u6838) \u53d1\u9001 ARP \u5e7f\u64ad\u540e\uff0cDirector \u548c RS \u90fd\u4f1a\u6536\u5230\u8fd9\u4e2a\u5e7f\u64ad\u5305\uff0c\u4e14\u90fd\u8ba4\u4e3a\u8fd9\u4e2a\u5e7f\u64ad\u5305\u627e\u7684\u5c31\u662f\u81ea\u5df1\uff0c\u4e8e\u662f\u90fd\u56de\u5e94\u7ed9\u8bbe\u5907 L\uff0c\u8fd9\u6837\u8bbe\u5907 L \u4e0a\u7684 ARP \u7f13\u5b58\u8868\u4e2d\u7684\u6761\u76ee ",(0,l.kt)("inlineCode",{parentName:"p"},"VIP <--\x3e vip_MAC")," \u5c31\u4e0d\u65ad\u88ab\u8986\u76d6\u76f4\u5230\u6700\u540e\u4e00\u4e2a\u56de\u5e94\u3002"),(0,l.kt)("p",null,"\u8fd9\u6837\u4e00\u6765\uff0c\u8bbe\u5907 L \u5c06\u628a\u5ba2\u6237\u7aef\u7684\u6570\u636e\u5305\u53d1\u9001\u7ed9\u6700\u540e\u4e00\u4e2a\u56de\u5e94\u7684\u4e3b\u673a\uff0c\u8fd9\u53f0\u4e3b\u673a\u7684 VIP \u53ef\u80fd\u662f Director \u4e0a\u7684\uff0c\u4e5f\u53ef\u80fd\u662f\u67d0\u4e2a RS \u4e0a\u7684\u3002\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\uff0c\u8bbe\u5907 L \u6536\u5230\u76ee\u6807 IP \u4e3a VIP \u7684\u6570\u636e\u5305\u90fd\u4f1a\u53d1\u9001\u7ed9\u8be5\u4e3b\u673a\u3002\u4f46\u8bbe\u5907 L \u4f1a\u5b9a\u65f6\u53d1\u9001 ARP \u5e7f\u64ad\u5305\uff0c\u8fd9\u6837\u4e00\u6765 ARP \u7f13\u5b58\u8868\u4e2d\u7684 VIP \u5bf9\u5e94\u7684 MAC \u5730\u5740\u53ef\u80fd\u4f1a\u6362\u6210\u53e6\u4e00\u53f0\u4e3b\u673a\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u56e0\u6b64\uff0c\u5fc5\u987b\u8981\u4fdd\u8bc1\u8bbe\u5907 L \u53ea\u4fdd\u5b58 Director \u4e0a VIP \u5bf9\u5e94\u7684 MAC \u5730\u5740\uff0c\u5373\u53ea\u5141\u8bb8 Director \u624d\u5bf9\u8bbe\u5907 L \u7684 ARP \u5e7f\u64ad\u8fdb\u884c\u56de\u5e94\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6240\u6709 RS \u4e0a\u7684 VIP \u5fc5\u987b\u9690\u85cf\u8d77\u6765"),"\u3002"),(0,l.kt)("p",null,"\u4e00\u822c\u901a\u8fc7\u5c06 Real Server \u4e0a\u7684 VIP \u8bbe\u7f6e\u5728 lo \u63a5\u53e3\u7684\u522b\u540d\u63a5\u53e3\u4e0a(\u5982 lo:0)\uff0c\u5e76\u8bbe\u7f6e ",(0,l.kt)("inlineCode",{parentName:"p"},"arp_ignore=1")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"arp_announce=2")," \u7684\u65b9\u5f0f\u6765\u9690\u85cf RS \u4e0a\u7684 VIP\u3002\u81f3\u4e8e VIP \u4e3a\u4f55\u8981\u8bbe\u7f6e\u5728 lo \u63a5\u53e3\u4e0a\u4ee5\u53ca\u4e3a\u4f55\u8981\u8fd9\u6837\u8bbe\u7f6e\u8fd9\u4e24\u4e2a arp \u53c2\u6570\uff0c\u8bf7\u53c2\u89c1 ",(0,l.kt)("a",{parentName:"p",href:"https://www.brinnatt.com/addons/%e7%ac%ac-d-1-%e7%ab%a0-linux-arp-%e5%ba%94%e7%94%a8/"},"VS/TUN \u548c VS/DR \u7684 arp \u95ee\u9898"),"\uff0c\u5185\u5bb9\u975e\u5e38\u8be6\u7ec6\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"echo 1 >/proc/sys/net/ipv4/conf/all/arp_ignore\necho 2 >/proc/sys/net/ipv4/conf/all/arp_announce\n")),(0,l.kt)("p",null,"\u6216\u8005\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"sysctl -w net.ipv4.conf.all.arp_ignore=1\nsysctl -w net.ipv4.conf.all.arp_announce=2\n")),(0,l.kt)("p",null,"\u6216\u8005\u5c06 arp \u53c2\u6570\u8bbe\u7f6e\u5230\u5185\u6838\u53c2\u6570\u914d\u7f6e\u6587\u4ef6\u4e2d\u4ee5\u8ba9\u5176\u6c38\u4e45\u751f\u6548\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'echo "net.ipv4.conf.all.arp_ignore=1" >>/etc/sysctl.conf\necho "net.ipv4.conf.all.arp_announce=2" >>/etc/sysctl.conf\nsysctl -p\n')),(0,l.kt)("p",null,"\u5728\u7f51\u4e0a\u51e0\u4e4e\u6240\u6709\u6587\u7ae0\u8fd8\u8bbe\u7f6e\u4e86 lo \u63a5\u53e3\u4e0a\u7684 arp \u53c2\u6570\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"echo 1 >/proc/sys/net/ipv4/conf/lo/arp_ignore\necho 2 >/proc/sys/net/ipv4/conf/lo/arp_announce\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4f46\u8fd9\u6ca1\u6709\u4efb\u4f55\u610f\u4e49\uff0c\u56e0\u4e3a lo \u63a5\u53e3\u4e0d\u53d7 arp \u53c2\u6570\u7684\u5f71\u54cd\u3002")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5e94\u8be5\u5728\u914d\u7f6e VIP \u4e4b\u524d\u5c31\u8bbe\u7f6e arp \u53c2\u6570\uff0c\u4ee5\u9632\u6b62\u914d\u7f6e VIP \u540e\u3001\u8bbe\u7f6e arp \u6291\u5236\u4e4b\u524d\u88ab\u5916\u754c\u4e3b\u673a\u53d1\u73b0\u3002")),(0,l.kt)("h2",{id:"104lvs-\u8d1f\u8f7d\u5747\u8861\u7684\u8c03\u5ea6\u7b97\u6cd5"},"10.4\u3001LVS \u8d1f\u8f7d\u5747\u8861\u7684\u8c03\u5ea6\u7b97\u6cd5"),(0,l.kt)("p",null,"LVS \u7684\u8c03\u5ea6\u7b97\u6cd5\uff0c\u8be6\u7ec6\u5185\u5bb9\u89c1\u5b98\u65b9\u624b\u518c\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://www.linuxvirtualserver.org/zh/lvs4.html"},"http://www.linuxvirtualserver.org/zh/lvs4.html")," \u3002"),(0,l.kt)("p",null,"IPVS \u5728\u5185\u6838\u4e2d\u7684\u8d1f\u8f7d\u5747\u8861\u8c03\u5ea6\u662f",(0,l.kt)("strong",{parentName:"p"},"\u4ee5\u8fde\u63a5\u4e3a\u7c92\u5ea6"),"\u7684\u3002\u5728 HTTP \u534f\u8bae\uff08\u975e\u6301\u4e45\uff09\u4e2d\uff0c\u6bcf\u6b21\u4ece WEB \u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u8d44\u6e90\u90fd\u9700\u8981\u5efa\u7acb\u4e00\u4e2a TCP \u8fde\u63a5\uff0c\u540c\u4e00\u7528\u6237\u7684\u4e0d\u540c\u8bf7\u6c42\u4f1a\u88ab\u8c03\u5ea6\u5230\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u6240\u4ee5\u8fd9\u79cd\u7ec6\u7c92\u5ea6\u7684\u8c03\u5ea6\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u53ef\u4ee5\u907f\u514d\u5355\u4e2a\u7528\u6237\u8bbf\u95ee\u7684\u7a81\u53d1\u6027\u5f15\u8d77\u670d\u52a1\u5668\u95f4\u7684\u8d1f\u8f7d\u4e0d\u5e73\u8861\u3002"),(0,l.kt)("p",null,"LVS \u5206\u4e3a\u4e24\u79cd\u8c03\u5ea6\u65b9\u5f0f\uff1a\u9759\u6001\u8c03\u5ea6\u548c\u52a8\u6001\u53cd\u9988\u8c03\u5ea6\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u9759\u6001\u8c03\u5ea6\u65b9\u5f0f\u662f\u6307\u4e0d\u7ba1 RS \u7684\u7e41\u5fd9\u7a0b\u5ea6\uff0c\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5\u8ba1\u7b97\u540e\u8f6e\u5230\u8c01\u5c31\u8c03\u5ea6\u8c01\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f8b\u5982\u4e24\u53f0 realserver\uff0c\u4e00\u5f00\u59cb\u53cc\u65b9\u90fd\u5728\u5904\u7406 500 \u4e2a\u8fde\u63a5\uff0c\u4e0b\u4e00\u4e2a\u8bf7\u6c42\u5230\u6765\u524d\uff0cserver1 \u53ea\u65ad\u5f00\u4e86 10 \u4e2a\uff0c\u800c server2 \u65ad\u5f00\u4e86 490 \u4e2a\uff0c\u4f46\u662f\u6b64\u65f6\u8f6e\u5230\u4e86 server1\uff0c\u5c31\u4f1a\u8c03\u5ea6 server1 \u800c\u4e0d\u7ba1\u7e41\u5fd9\u7684\u7a0b\u5ea6\u3002"))),(0,l.kt)("li",{parentName:"ul"},"\u52a8\u6001\u8c03\u5ea6\u65b9\u5f0f\u662f\u6307\u6839\u636e RS \u7684\u7e41\u5fd9\u7a0b\u5ea6\u53cd\u9988\uff0c\u8ba1\u7b97\u51fa\u4e0b\u4e00\u4e2a\u8fde\u63a5\u5e94\u8be5\u8c03\u5ea6\u8c01\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u52a8\u6001\u53cd\u9988\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u8003\u8651\u670d\u52a1\u5668\u7684\u5b9e\u65f6\u8d1f\u8f7d\u548c\u54cd\u5e94\u60c5\u51b5\uff0c\u4e0d\u65ad\u8c03\u6574\u670d\u52a1\u5668\u95f4\u5904\u7406\u8bf7\u6c42\u7684\u6bd4\u4f8b\uff0c\u6765\u907f\u514d\u6709\u4e9b\u670d\u52a1\u5668\u8d85\u8f7d\u65f6\u4f9d\u7136\u6536\u5230\u5927\u91cf\u8bf7\u6c42\uff0c\u4ece\u800c\u63d0\u9ad8\u6574\u4e2a\u7cfb\u7edf\u7684\u541e\u5410\u7387\u3002")))),(0,l.kt)("p",null,"\u5728\u5185\u6838\u4e2d\u7684\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u4e0a\uff0cIPVS \u5df2\u5b9e\u73b0\u4e86\u4ee5\u4e0b\u516b\u79cd\u8c03\u5ea6\u7b97\u6cd5\uff1a\u9ed8\u8ba4\u7684\u7b97\u6cd5\u4e3a wlc\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u9759\u6001\u8c03\u5ea6\uff1a"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8f6e\u53eb\u8c03\u5ea6\uff08Round-Robin Scheduling\uff0crr\uff09"),(0,l.kt)("li",{parentName:"ul"},"\u52a0\u6743\u8f6e\u53eb\u8c03\u5ea6\uff08Weighted Round-Robin Scheduling\uff0cwrr\uff09\uff0c\u6309\u7167\u6743\u91cd\u6bd4\u4f8b\u4f5c\u4e3a\u8f6e\u8be2\u6807\u51c6"),(0,l.kt)("li",{parentName:"ul"},"\u76ee\u6807\u5730\u5740\u6563\u5217\u8c03\u5ea6\uff08Destination Hashing Scheduling\uff0cdh\uff09\uff0c\u76ee\u6807\u5730\u5740\u54c8\u5e0c\uff0c\u5bf9\u4e8e\u540c\u4e00\u76ee\u6807 IP \u7684\u8bf7\u6c42\u603b\u662f\u53d1\u5f80\u540c\u4e00\u670d\u52a1\u5668"),(0,l.kt)("li",{parentName:"ul"},"\u6e90\u5730\u5740\u6563\u5217\u8c03\u5ea6\uff08Source Hashing Scheduling\uff0csh\uff09\uff0c\u6e90\u5730\u5740\u54c8\u5e0c\uff0c\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\uff0c\u53ea\u8981\u662f\u6765\u81ea\u540c\u4e00\u4e2a\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5c31\u53d1\u9001\u81f3\u540c\u4e00\u4e2a realserver"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u52a8\u6001\u53cd\u9988\u8c03\u5ea6\uff1a"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\uff08Least-Connection Scheduling\uff0clc\uff09\uff0c\u8c03\u5ea6\u5668\u9700\u8981\u8bb0\u5f55\u5404\u4e2a\u670d\u52a1\u5668\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u6570\u76ee\uff0c\u5f53\u4e00\u4e2a\u8bf7\u6c42\u88ab\u8c03\u5ea6\u5230\u67d0\u670d\u52a1\u5668\uff0c\u5176\u8fde\u63a5\u6570\u52a0 1\uff1b\u5f53\u8fde\u63a5\u4e2d\u6b62\u6216\u8d85\u65f6\uff0c\u5176\u8fde\u63a5\u6570\u51cf 1\u3002\u5f53\u5404\u4e2a\u670d\u52a1\u5668\u7684\u5904\u7406\u80fd\u529b\u4e0d\u540c\u65f6\uff0c\u8be5\u7b97\u6cd5\u4e0d\u7406\u60f3\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\uff08Weighted Least-Connection Scheduling\uff0cwlc\uff09"),(0,l.kt)("li",{parentName:"ul"},"\u57fa\u4e8e\u672c\u5730\u7684\u6700\u5c11\u8fde\u63a5\uff08Locality-Based Least Connections Scheduling\uff0clblc\uff09\uff0c\u76ee\u524d\u8be5\u7b97\u6cd5\u4e3b\u8981\u7528\u4e8e cache \u96c6\u7fa4\u7cfb\u7edf\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5e26\u590d\u5236\u7684\u57fa\u4e8e\u5c40\u90e8\u6027\u6700\u5c11\u8fde\u63a5\uff08Locality-Based Least Connections with Replication Scheduling\uff0clblcr\uff09\uff0c\u76ee\u524d\u4e3b\u8981\u7528\u4e8e Cache \u96c6\u7fa4\u7cfb\u7edf\u3002")))),(0,l.kt)("h2",{id:"105ipvsadm-\u547d\u4ee4"},"10.5\u3001ipvsadm \u547d\u4ee4"),(0,l.kt)("p",null,"ipvsadm \u662f ipvs \u7684\u547d\u4ee4\u884c\u7ba1\u7406\u5de5\u5177\uff0c\u53ef\u4ee5\u5b9a\u4e49\u3001\u5220\u9664\u3001\u67e5\u770b virtual service \u548c Real Server \u7684\u5c5e\u6027\u3002"),(0,l.kt)("p",null,"\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u81ea\u5e26\u7684 rpm \u5305\u8fdb\u884c\u5b89\u88c5\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@yidam ~]# cat /etc/redhat-release \nCentOS Linux release 7.9.2009 (AltArch)\n[root@yidam ~]# \n[root@yidam ~]# yum info ipvsadm\nLoaded plugins: fastestmirror\nLoading mirror speeds from cached hostfile\nAvailable Packages\nName        : ipvsadm\nArch        : aarch64\nVersion     : 1.27\nRelease     : 8.el7\nSize        : 44 k\nRepo        : base/aarch64\nSummary     : Utility to administer the Linux Virtual Server\nURL         : https://kernel.org/pub/linux/utils/kernel/ipvsadm/\nLicense     : GPLv2+\nDescription : ipvsadm is used to setup, maintain, and inspect the virtual server\n            : table in the Linux kernel. The Linux Virtual Server can be used to\n            : build scalable network services based on a cluster of two or more\n            : nodes. The active node of the cluster redirects service requests to a\n            : collection of server hosts that will actually perform the\n            : services. Supported Features include:\n            :   - two transport layer (layer-4) protocols (TCP and UDP)\n            :   - three packet-forwarding methods (NAT, tunneling, and direct routing)\n            :   - eight load balancing algorithms (round robin, weighted round robin,\n            :     least-connection, weighted least-connection, locality-based\n            :     least-connection, locality-based least-connection with\n            :     replication, destination-hashing, and source-hashing)\n\n[root@yidam ~]# yum install ipvsadm.aarch64 -y\n")),(0,l.kt)("p",null,"\u4f7f\u7528\u6700\u65b0\u7684 ipvsadm \u6e90\u7801\u5b89\u88c5\uff0c\u4e0b\u8f7d\u5730\u5740 ",(0,l.kt)("a",{parentName:"p",href:"https://mirrors.edge.kernel.org/pub/linux/utils/kernel/ipvsadm/"},"https://mirrors.edge.kernel.org/pub/linux/utils/kernel/ipvsadm/"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'[root@yidam ~]# wget --no-check-certificate https://mirrors.edge.kernel.org/pub/linux/utils/kernel/ipvsadm/ipvsadm-1.31.tar.xz\n[root@yidam ~]# yum groups install "Development Tools" -y\n[root@yidam ~]# yum install libnl3-devel.aarch64 popt-devel -y\n[root@yidam ~]# tar xf ipvsadm-1.31.tar.xz \n[root@yidam ~]# cd ipvsadm-1.31/\n[root@yidam ipvsadm-1.31]# make && make install\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7f16\u8bd1\u5b89\u88c5\u540e\u81ea\u52a8\u6267\u884c\u4e0b\u9762\u7684\u5de5\u4f5c\uff0c\u4e00\u822c\u5176\u4ed6\u8f6f\u4ef6\u90fd\u8981\u624b\u52a8\u6267\u884c\u8fd9\u4e9b\u52a8\u4f5c\uff0c\u7ed9 ipvsadm \u70b9\u4e2a\u8d5e\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"if [ ! -d /sbin ]; then mkdir -p /sbin; fi\ninstall -m 0755 ipvsadm /sbin\ninstall -m 0755 ipvsadm-save /sbin\ninstall -m 0755 ipvsadm-restore /sbin\n[ -d /usr/man/man8 ] || mkdir -p /usr/man/man8\ninstall -m 0644 ipvsadm.8 /usr/man/man8\ninstall -m 0644 ipvsadm-save.8 /usr/man/man8\ninstall -m 0644 ipvsadm-restore.8 /usr/man/man8\n[ -d /etc/rc.d/init.d ] || mkdir -p /etc/rc.d/init.d\ninstall -m 0755 ipvsadm.sh /etc/rc.d/init.d/ipvsadm\n")),(0,l.kt)("h2",{id:"106ipvsadm-\u8bed\u6cd5"},"10.6\u3001ipvsadm \u8bed\u6cd5"),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"ipvsadm --help")," \u53ef\u4ee5\u67e5\u770b\u4f7f\u7528\u65b9\u6cd5\u3002ipvs \u7684\u66f4\u591a\u529f\u80fd\u4ee5\u53ca ipvsadm \u7684\u66f4\u8be6\u7ec6\u7528\u6cd5\uff0c\u8bf7 ",(0,l.kt)("inlineCode",{parentName:"p"},"man ipvsadm")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# ipvsadm\u7684\u9009\u9879\u4e2d\uff0c\u5927\u5199\u9009\u9879\u7ba1\u7406\u865a\u62df\u670d\u52a1virtual service\uff0c\u5c0f\u5199\u9009\u9879\u7ba1\u7406\u5173\u8054\u4e86\u865a\u62df\u670d\u52a1\u7684\u771f\u5b9e\u670d\u52a1\u5668RealServer\uff0c"-L"\u548c"-l"\u9664\u5916\uff0c\u5b83\u4eec\u540c\u4e49\u3002\n\n(1).Manage virtual services:\n    Add:    -A  -t|u|f service-address [-s scheduler]\n            -t: tcp\u534f\u8bae\u7684\u96c6\u7fa4\n            -u: udp\u534f\u8bae\u7684\u96c6\u7fa4\n                service-address\u683c\u5f0f\u4e3aIP:PORT\n            -f: firewall-mark\u9632\u706b\u5899\u6807\u8bb0\n                service-address\uff1aa num for mark\n            -s: \u8c03\u5ea6\u7b97\u6cd5\n    Modify: -E -t|u|f service-address [-s scheduler]   \n            # \u548c-A\u4f7f\u7528\u65b9\u6cd5\u4e00\u6837\n    Delete: -D -t|u|f service-address\n            # \u548c-A\u4f7f\u7528\u65b9\u6cd5\u4e00\u6837\n\n# Example:  ipvsadm -A -t 172.16.10.20:80 -s rr (\u5bf9\u5916\u7684\u5730\u5740\uff0c\u4e5f\u5c31\u662fVIP)\n\n(2).Manage realservers in virtual service:\n    Add:    -a  -t|u|f service-address -r server-address [-g|i|m] [-w weight]\n                -t|u|f service-address: \u6307\u5b9aReal server\u6240\u7ed1\u5b9a\u7684virtual service\n                -r server-address: \u67d0RS\u5730\u5740\uff0c\u5728NAT\u6a21\u578b\u4e2d\uff0c\u53efIP:PORT\u5b9e\u73b0\u7aef\u53e3\u6620\u5c04\uff0c\u5373\u7aef\u53e3\u65e0\u9700\u7b49\u4e8eVIP\u5bf9\u5e94\u7684port\n                -g|i|m: \u6307\u5b9alvs\u7684\u7c7b\u578b\uff0c\u6709\u4e09\u79cd:\n                    -g: gataway\u5373DR\u7c7b\u578b\uff08\u9ed8\u8ba4\u7684\u6a21\u578b\uff09\n                    -i: --ipip\uff0c\u5373TUN\u7c7b\u578b\n                    -m: masquerade\u5730\u5740\u4f2a\u88c5\u5373NAT\n                -w: \u6307\u5b9a\u6743\u91cd\uff08\u9700\u8981\u8c03\u5ea6\u7b97\u6cd5\u652f\u6301\u6743\u91cd\uff09\n    Modify: -e\u548c-a\u7528\u6cd5\u4e00\u6837\n    Delete: -d  -t|u|f service-address -r server-address\u8868\u793a\u4ece\u54ea\u4e2avirtual service\u4e2d\u5220\u9664\u54ea\u4e2arealserver\n\n# Examples: ipvsadm -a -t 172.16.10.20:80 -r 192.168.100.9 -m\n# Examples: ipvsadm -a -t 172.16.10.20:80 -r 192.168.100.10 -m \n\n(3).view:\n    -L/-l:      \u5217\u51fa\u72b6\u6001\u4fe1\u606f\uff0c\u914d\u5408\u4ee5\u4e0b\u9009\u9879\u7528\u4e8e\u663e\u793a\u66f4\u7cbe\u786e\u6570\u636e\n    -n:         \u53ea\u663e\u793a\u6570\u5b57\u683c\u5f0f\uff0c\u4e0d\u53cd\u89e3IP\u5730\u5740\u548c\u7aef\u53e3\n    --stats:    \u663e\u793a\u7edf\u8ba1\u4fe1\u606f\n    --rate:     \u663e\u793a\u901f\u7387\u4fe1\u606f\uff08\u6bcf\u79d2\u7684\u503c\uff09\n    --timeout:  \u663e\u793atcp/tcpfin/udp\u7684\u4f1a\u8bdd\u8d85\u65f6\u65f6\u95f4\u957f\u5ea6\n    --daemon:   \u663e\u793a\u8fdb\u7a0b\u72b6\u6001\u548c\u591a\u64ad\u7aef\u53e3\uff08\u4e0d\u592a\u7528\uff09\n    --sort:     \u5bf9-n\u5217\u51fa\u6765\u7684\u8fdb\u884c\u6392\u5e8f\uff08\u6309\u534f\u8bae\u3001IP\u3001\u7aef\u53e3\u53f7\u5347\u5e8f\u6392\u5e8f\uff09\n    -c:         \u663e\u793a\u5f53\u524dipvs\u7684\u8fde\u63a5\u72b6\u51b5\uff08\u4e0d\u80fd\u548cstats\u9009\u9879\u540c\u7528\uff09\n\n(4).others:\n    -Z:         \u6e05\u7a7a\u7edf\u8ba1\u6570\u636e\n    -C:         \u5220\u9664\u4e00\u4e2a\u6216\u6240\u6709virtual service\uff0c\u8fde\u540c\u4e0e\u4e4b\u7ed1\u5b9a\u7684real server\u4e5f\u5220\u9664\n    -S:         \u4fdd\u5b58\u89c4\u5219  ipvsadm -S > /path/to/somefile \u6216\u8005\u4f7f\u7528ipvsadm-save > /path/to/somefile\n    -R:         \u8f7d\u5165\u89c4\u5219  ipvsadm -R < /path/to/somefile \u6216\u8005\u4f7f\u7528ipvsadm-restore < /path/to/somefile\n                service ipvsadm save\n                service ipvsadm restore\n')),(0,l.kt)("h2",{id:"107\u5b9e\u73b0-vsnat-\u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861"},"10.7\u3001\u5b9e\u73b0 VS/NAT \u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861"),(0,l.kt)("p",null,"\u5b9e\u9a8c\u73af\u5883\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"lvs nat practice",src:r(58952).Z,width:"944",height:"442"})),(0,l.kt)("p",null,"\u5728\u5f00\u59cb\u64cd\u4f5c\u524d\uff0c\u5148\u56de\u987e\u4e0b VS/NAT \u6a21\u5f0f\u7684\u76f8\u5173\u5185\u5bb9\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bf7\u6c42\u8fc7\u7a0b\uff1aCIP--\x3eVIP--ip_forward--\x3eDIP--\x3eRIP\n\u54cd\u5e94\u8fc7\u7a0b\uff1aRIP--\x3eDIP--ip_forward--\x3eVIP--\x3eCIP\n")),(0,l.kt)("p",null,"\u7531\u4e8e director \u63a5\u6536\u5230 CIP \u53d1\u9001\u7684\u6570\u636e\u5305\u540e\uff0c\u9700\u8981\u8f6c\u53d1\u7ed9 Real Server \u8fdb\u884c\u5904\u7406\uff0c\u4f46 Real Server \u7684 RIP \u548c DIP \u662f\u540c\u4e00\u7f51\u6bb5\u7684\uff0c\u56e0\u6b64 Director \u5fc5\u987b\u5c06 VIP \u63a5\u53e3\u4e0a\u6536\u5230\u7684\u6570\u636e\u5305\u8f6c\u53d1\u7ed9 DIP\uff0c\u4e5f\u5c31\u662f\u8bf4 ",(0,l.kt)("strong",{parentName:"p"},"Director \u9700\u8981\u5f00\u542f ip","_","forward \u529f\u80fd"),"\u3002"),(0,l.kt)("p",null,"\u5f53 RS \u5904\u7406\u5b8c\u6210\u540e\uff0c\u54cd\u5e94\u6570\u636e\u9700\u8981\u5148\u8f6c\u53d1\u7ed9 Director\uff0c\u4f46\u56e0\u4e3a",(0,l.kt)("strong",{parentName:"p"},"\u54cd\u5e94\u6570\u636e\u7684\u76ee\u6807\u5730\u5740\u4e3a CIP\uff0c\u56e0\u6b64\u9700\u8981\u5c06 RS \u7684\u7f51\u5173\u6307\u5411 Director \u7684 DIP"),"\uff0c\u8fd9\u6837 CIP \u76ee\u7684\u7684\u6570\u636e\u5305\u624d\u80fd\u4fdd\u8bc1\u4ea4\u7ed9 director \u8fdb\u884c\u5904\u7406\u5e76\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002"),(0,l.kt)("p",null,"\u56e0\u6b64\uff0c\u5982\u4e0b\u64cd\u4f5c Director\uff1a\u5047\u8bbe\u8be5\u5b9e\u9a8c\u4e2d\u7684 VS/NAT \u91c7\u7528 wrr \u8c03\u5ea6\u7b97\u6cd5\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@director ~]# echo 1 >/proc/sys/net/ipv4/ip_forward\n[root@director ~]# ipvsadm -A -t 192.168.122.202:80 -s wrr\n[root@director ~]# ipvsadm -a -t 192.168.122.202:80 -r 172.16.4.203 -m -w 2\n[root@director ~]# ipvsadm -a -t 192.168.122.202:80 -r 172.16.4.204 -m -w 3\n")),(0,l.kt)("p",null,"\u5982\u4e0b\u64cd\u4f5c\u5404 RS\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# realserver1\n[root@realserver1 ~]# yum install httpd -y\n[root@realserver1 ~]# echo "This is page from RS1:172.16.4.203" > /var/www/html/index.html\n[root@realserver1 ~]# service httpd start\nRedirecting to /bin/systemctl start httpd.service\n[root@realserver1 ~]# route del default\n[root@realserver1 ~]# route add default gw 172.16.4.202\n\n# realserver2\n[root@realserver2 ~]# yum install httpd -y\n[root@realserver2 ~]# echo "This is page from RS2:172.16.4.204" > /var/www/html/index.html\n[root@realserver2 ~]# service httpd start\nRedirecting to /bin/systemctl start httpd.service\n[root@realserver2 ~]# route del default\n[root@realserver2 ~]# route add default gw 172.16.4.202\n')),(0,l.kt)("p",null,"\u4f7f\u7528 linux \u5ba2\u6237\u7aef(192.168.122.8) \u6d4b\u8bd5 ",(0,l.kt)("a",{parentName:"p",href:"http://192.168.122.202/"},"http://192.168.122.202:80"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@yidam ~]# curl http://192.168.122.202\n<h1>This is page from RS1:172.16.4.203</h1>\n[root@yidam ~]# curl http://192.168.122.202\n<h1>This is page from RS2:172.16.4.204</h1>\n[root@yidam ~]# curl http://192.168.122.202\n<h1>This is page from RS2:172.16.4.204</h1>\n[root@yidam ~]# curl http://192.168.122.202\n<h1>This is page from RS1:172.16.4.203</h1>\n[root@yidam ~]# curl http://192.168.122.202\n<h1>This is page from RS2:172.16.4.204</h1>\n[root@yidam ~]# curl http://192.168.122.202\n<h1>This is page from RS1:172.16.4.203</h1>\n[root@yidam ~]# curl http://192.168.122.202\n<h1>This is page from RS2:172.16.4.204</h1>\n[root@yidam ~]# curl http://192.168.122.202\n<h1>This is page from RS2:172.16.4.204</h1>\n")),(0,l.kt)("p",null,"\u67e5\u770b director \u4e3b\u673a\u7edf\u8ba1\u6570\u636e\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@director ~]# ipvsadm -ln --stats\nIP Virtual Server version 1.2.1 (size=4096)\nProt LocalAddress:Port               Conns   InPkts  OutPkts  InBytes OutBytes\n  -> RemoteAddress:Port\nTCP  192.168.122.202:80                 14      115       78    14586    10292\n  -> 172.16.4.203:80                     5       35       24     3440     3279\n  -> 172.16.4.204:80                     9       80       54    11146     7013\n[root@director ~]#\n")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"\u6ce8\u610f\u4e8b\u9879\uff1a")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("em",{parentName:"li"},"VS/NAT \u6a21\u5f0f\u4e0b\uff0crealserver \u4e0a\u4e0d\u8981\u914d\u7f6e\u8ddf vip \u540c\u7f51\u6bb5\u7684 ip \u5730\u5740\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u8bf7\u6c42\u5f02\u5e38\u7684\u60c5\u51b5\u3002")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("em",{parentName:"li"},"\u6d4b\u8bd5\u5ba2\u6237\u7aef\u6700\u597d\u4f7f\u7528 linux \u7cfb\u7edf\uff0c\u4f7f\u7528 curl \u547d\u4ee4\u8bf7\u6c42 vip \u5730\u5740\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u66f4\u63a5\u8fd1\u671f\u671b\u503c\uff0c\u65b9\u4fbf\u5206\u6790\u3002"))),(0,l.kt)("h2",{id:"108\u5b9e\u73b0-vsdr-\u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861"},"10.8\u3001\u5b9e\u73b0 VS/DR \u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"lvs dr",src:r(74086).Z,width:"993",height:"390"})),(0,l.kt)("p",null,"\u5148\u8bf4\u660e\u4e00\u4e0b VS/DR \u6a21\u5f0f\u4e0b\uff0cDirector \u7684\u529f\u80fd\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5728 VS/DR \u6a21\u5f0f\u4e0b\uff0cTCP \u8fde\u63a5\u662f\u5ba2\u6237\u7aef\u548c RS \u4e4b\u95f4\u5efa\u7acb\u7684\uff0cDirector \u53ea\u662f\u8d1f\u8d23\u6539\u9020\u3001\u8f6c\u53d1\u5efa\u7acb TCP \u8fde\u63a5\u65f6\u7684\u6570\u636e\u5305\u7ed9\u540e\u7aef RealServer\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5f53 TCP \u8fde\u63a5\u5efa\u7acb\u5b8c\u6210\u540e\uff0c\u5c31\u6709\u4e86\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef(RS)\u7684\u6982\u5ff5\uff0c\u8fd9\u65f6\u5ba2\u6237\u7aef\u5c06\u76f4\u63a5\u548c RS \u8fdb\u884c\u6570\u636e\u901a\u4fe1\uff0c\u800c Director \u5df2\u7ecf\u9000\u51fa\u821e\u53f0\uff0c\u4e0d\u518d\u8d1f\u8d23\u6539\u9020\u3001\u8f6c\u53d1\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u76f4\u5230\u5173\u95ed\u8fde\u63a5\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u5c31\u662f\u8bf4\uff0cDirector \u6539\u9020\u3001\u8f6c\u53d1\u7684\u6570\u636e\u5305\u53ea\u6709\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u548c tcp \u8fde\u63a5\u5efa\u7acb\u3001\u5173\u95ed\u76f8\u5173\u7684 syn\u3001ack \u548c fin \u5305\uff0c\u5176\u5b83\u6570\u636e\u5305\u548c\u5b83\u65e0\u5173(\u7f51\u7edc\u72b6\u51b5\u826f\u597d\u7684\u60c5\u51b5\u4e0b\uff0c\u5171\u8f6c\u53d1 syn+ack\u3001fin+ack 4 \u4e2a\u5305)\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u60f3\u8c61\uff0c\u8fd9\u6837\u7684 Director \u76f8\u6bd4 NAT \u6a21\u5f0f\uff0c\u6027\u80fd\u9ad8\u7684\u4e0d\u662f\u4e00\u70b9\u70b9\u3002")))),(0,l.kt)("p",null,"\u8bf7\u6c42\u5e94\u7b54\u8fc7\u7a0b\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5f53\u5ba2\u6237\u7aef\u53d1\u8d77 ",(0,l.kt)("inlineCode",{parentName:"li"},"http://VIP")," \u7684\u8bf7\u6c42\u65f6\uff0c\u6570\u636e\u5305\u7684\u6e90\u548c\u76ee\u6807\u5730\u5740\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"CIP--\x3eVIP"),"\u3002\u8fd9\u4e2a\u6570\u636e\u5305\u6700\u7ec8\u4f1a\u5230\u8fbe Director\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u5f53 Director \u6536\u5230\u8bf7\u6c42\u6570\u636e\u5305\u540e\uff0c\u5c06\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5\u9009\u62e9\u4e00\u53f0\u540e\u7aef RealServer \u4f5c\u4e3a\u8c03\u5ea6\u7684\u76ee\u6807\u3002\u4e8e\u662f\u4fee\u6539\u6570\u636e\u5305\u7684\u76ee\u6807 MAC \u5730\u5740\u4e3a\u8be5 RealServer \u7684 RIP \u6240\u5728 MAC \u5730\u5740\u3002\u6570\u636e\u5305\u5c06\u8f6c\u53d1\u7ed9\u8be5 RS\uff0c\u6b64\u65f6\u6570\u636e\u5305\u7684\u6e90\u548c\u76ee\u6807 IP \u5730\u5740\u4ecd\u7136\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"CIP--\x3eVIP"),"\uff0c\u4f46\u6e90\u548c\u76ee\u6807 MAC \u5730\u5740\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"DIP_MAC--\x3eRIP_MAC"),"\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cDirector \u867d\u7136\u8981\u5c06\u6570\u636e\u5305\u4ea4\u7ed9 RS\uff0c\u4f46\u4ea4\u51fa\u53bb\u7684\u8fd9\u4e2a\u6570\u636e\u5305\u662f\u4fee\u6539\u8fc7\u76ee\u6807 MAC \u5730\u5740\u7684\u6570\u636e\u5305\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ea4\u7ed9 RIP \u7684\u6570\u636e\u5305\u4e0d\u662f\u539f\u5305\uff0c\u56e0\u6b64\u5728 Director \u4e0a\u4e0d\u4f1a\u7ecf\u8fc7 ip","_","forward \u8f6c\u53d1\uff0c\u800c\u662f\u4fee\u6539 MAC \u540e\u6839\u636e\u8def\u7531\u51b3\u7b56\u76f4\u63a5\u8def\u7531\u5230 RIP\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u56e0\u6b64\uff0c",(0,l.kt)("strong",{parentName:"li"},"VS/DR \u6a21\u5f0f\u4e0b\uff0cDirector \u65e0\u9700\u5f00\u542f ip","_","forward \u529f\u80fd\uff0c\u8fd9\u4e00\u70b9\u5f88\u5bb9\u6613\u51fa\u73b0\u8bef\u89e3"),"\uff0c\u5176\u5b9e\u5982\u679c\u642d\u5efa\u8fc7 keepalived+lvs \u7684 DR\uff0c\u5c31\u53ef\u4ee5\u53d1\u73b0 keepalived \u7ba1\u7406 ipvs \u7684\u65f6\u5019\uff0c\u5e76\u6ca1\u6709\u5f00\u542f ip","_","forward\u3002"))),(0,l.kt)("li",{parentName:"ol"},"\u88ab\u8c03\u5ea6\u5230\u7684 RS \u6536\u5230 Director \u8f6c\u53d1\u7684\u6570\u636e\u5305\u540e\uff0c\u53d1\u73b0\u76ee\u6807 IP \u5730\u5740\u5df2\u7ecf\u914d\u7f6e\u5728\u81ea\u8eab\u5185\u6838\uff0c\u56e0\u6b64\u4f1a\u6536\u4e0b\u8be5\u6570\u636e\u5305\u3002\u4e4b\u540e\u4f1a\u5904\u7406\u8bf7\u6c42\uff0c\u5e76\u6784\u5efa\u54cd\u5e94\u6570\u636e\u3002"),(0,l.kt)("li",{parentName:"ol"},"RS \u5c06\u54cd\u5e94\u6570\u636e\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\uff0c\u8be5\u54cd\u5e94\u6570\u636e\u5305\u7684\u6e90\u548c\u76ee\u6807 IP \u5730\u5740\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"VIP--\x3eCIP"),"\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7531\u4e8e RS \u4e0a\u7684 VIP \u4e00\u822c\u914d\u7f6e\u5728 lo \u7684\u522b\u540d\u63a5\u53e3\u4e0a\uff0c\u5b83\u65e0\u6cd5\u548c\u5916\u754c\u76f4\u63a5\u901a\u4fe1\uff0c\u56e0\u6b64\u6570\u636e\u5305\u6700\u7ec8\u4f1a\u4ece\u666e\u901a\u7f51\u5361\u4e0a\u6d41\u51fa\uff0c\u5982 RIP \u6240\u5728\u63a5\u53e3\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u6839\u636e TCP/IP \u534f\u8bae\uff0c\u54cd\u5e94\u6570\u636e\u5305\u7684\u6e90 MAC \u5730\u5740\u4e5f\u5c06\u662f\u666e\u901a\u7f51\u5361(\u5982 RIP \u6240\u5728\u63a5\u53e3)\u7684 MAC \u5730\u5740\u3002\u8fd9\u4e00\u7ec6\u8282\u5728\u540e\u9762\u914d\u7f6e CIP\u3001VIP\u3001RIP \u4e0d\u540c\u7f51\u6bb5\u65f6\u4f1a\u5f15\u51fa\u4e00\u79cd\u7279\u6b8a\u95ee\u9898\uff0c\u8be6\u60c5\u89c1\u540e\u6587\u3002")))),(0,l.kt)("h3",{id:"1081cipviprip-\u540c\u7f51\u6bb5\u5b9e\u9a8c"},"10.8.1\u3001CIP\u3001VIP\u3001RIP \u540c\u7f51\u6bb5\u5b9e\u9a8c"),(0,l.kt)("p",null,"CIP\u3001VIP \u548c RIP \u540c\u7f51\u6bb5\u65f6\uff0c\u914d\u7f6e\u975e\u5e38\u7b80\u5355\uff0c\u51e0\u4e4e\u65e0\u9700\u8003\u8651\u989d\u5916\u7684\u8def\u7531\u95ee\u9898\uff0c\u4e5f\u90fd\u65e0\u9700\u5206\u6790\u6570\u636e\u5305\u6d41\u5411\u95ee\u9898\u3002"),(0,l.kt)("p",null,"\u5b9e\u9a8c\u73af\u5883\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"lvs dr practice",src:r(70264).Z,width:"1073",height:"479"})),(0,l.kt)("p",null,"\u914d\u7f6e Director\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@director ~]# ipvsadm -C\n[root@director ~]# ipvsadm -A -t 192.168.122.9:80 -s wrr\n[root@director ~]# ipvsadm -a -t 192.168.122.9:80 -r 192.168.122.203 -g -w 2\n[root@director ~]# ipvsadm -a -t 192.168.122.9:80 -r 192.168.122.204 -g -w 1\n")),(0,l.kt)("p",null,"\u914d\u7f6e\u6240\u6709 realservers\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# 1.\u63d0\u4f9bweb\u670d\u52a1\u548c\u6d4b\u8bd5\u9875\u9762\nyum -y install httpd\necho "This is page from RS1:172.16.4.203" > /var/www/html/index.html  # \u5728RS1\u4e0a\u64cd\u4f5c\necho "This is page from RS2:172.16.4.204" > /var/www/html/index.html  # \u5728RS2\u4e0a\u64cd\u4f5c\nservice httpd start\n\n# 2.\u8bbe\u7f6earp\u53c2\u6570\necho 1 >/proc/sys/net/ipv4/conf/all/arp_ignore\necho 2 >/proc/sys/net/ipv4/conf/all/arp_announce\n\n# 3.\u8bbe\u7f6eVIP\nifconfig lo:0 192.168.122.9 netmask 255.255.255.255 up\nroute add -host 192.168.122.9 dev lo:0\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"DR \u6a21\u578b\u4e2d\u4e00\u5b9a\u8981\u914d lo:0 \u56de\u73af\u53e3\u7684\u8def\u7531\uff0c\u4e0d\u7136\u5185\u6838\u4e0d\u80fd\u7528 lo:0 \u4e0a\u7684 vip \u8fdb\u884c\u5c01\u88c5\u62a5\u6587\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u6ce8\u610f\u5373\u4f7f\u914d\u4e86 arp","_","announce\u3001arp","_","ignore\uff0c\u4e00\u6837\u8981\u5c06 lo:0 \u914d\u6210 32 \u4f4d\u63a9\u7801\uff0c\u6291\u5236 arp feedback\uff0c\u800c\u4e14\u524d\u9762\u4e24\u4e2a\u5185\u6838\u53c2\u6570\u8981\u63d0\u524d\u6539\uff0c\u56e0\u4e3a\u5148\u914d\u4e86 ip \u5c31\u4f1a\u5e7f\u64ad\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5b66\u4e60 iptables \u7684\u7ae0\u8282\u65f6\uff0c\u6211\u4eec\u5c31\u77e5\u9053",(0,l.kt)("strong",{parentName:"li"},"\u5730\u5740\u662f\u5c5e\u4e8e\u5185\u6838\u7684\uff0c\u4e0d\u662f\u5c5e\u4e8e\u63a5\u53e3\u7684"),"\uff0c\u8bf7\u6c42\u5185\u6838\u7684\u5730\u5740\u4ece\u54ea\u4e2a\u63a5\u53e3\u8fdb\u6765\u9ed8\u8ba4\u4ece\u54ea\u4e2a\u63a5\u53e3\u51fa\u53bb\uff0c\u4e0d\u8fc7\u8def\u7531\u8868\u624d\u662f\u771f\u6b63\u5177\u6709\u6743\u5a01\u7684\u3002")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"\u7ecf\u9a8c\u5206\u4eab\uff1a")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("em",{parentName:"p"},"\u5b9e\u9a8c\u8fc7\u7a0b\u4e2d\uff0c\u6211\u7b2c\u4e00\u6b21\u6ca1\u6709\u5728 Director \u4e0a\u8bbe\u7f6e ",(0,l.kt)("inlineCode",{parentName:"em"},"eth0:0")," \u7528\u4f5c VIP\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528 eth0 \u5f53 VIP\uff0c\u7ed3\u679c\u4e00\u65e6 RealServers \u914d\u7f6e\u4e86 lo:0 \u4f5c\u4e3a VIP \u65f6\uff0c\u5c31\u4f1a\u8ddf Director \u4e0a\u7684 eth0 VIP \u5730\u5740\u51b2\u7a81\u3002\u6700\u7ec8\u5bfc\u81f4 Director \u548c RealServers \u4e4b\u95f4\u65e0\u6cd5\u901a\u4fe1\uff0c\u5373\u4fbf\u8bbe\u7f6e\u4e86 arp","_","announce\u3001arp","_","ignore\uff0c\u4e5f\u6ca1\u6709\u610f\u4e49\uff0c\u56e0\u4e3a\u5730\u5740\u662f\u5c5e\u4e8e\u5185\u6838\u7684\uff0c\u8fd9\u4e24\u4e2a\u53c2\u6570\u53ea\u662f\u8ba9\u5185\u6838\u4ece\u54ea\u4e2a\u53e3\u5982\u4f55\u54cd\u5e94 arp \u7f62\u4e86\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("em",{parentName:"p"},"\u5b9e\u9a8c\u8fc7\u7a0b\u4e2d\u5982\u679c\u8ddf\u6211\u4e00\u6837 Director \u4e2d\u53ea\u8bbe\u7f6e\u4e86\u4e00\u4e2a IP \u5730\u5740\uff0c\u800c\u4e14\u4f5c\u4e3a\u4e86 VIP\uff0c\u90a3\u4e48\u5b9e\u9a8c\u8fc7\u7a0b\u4e2d\u4f60\u4f1a\u5f97\u5230 ",(0,l.kt)("inlineCode",{parentName:"em"},"No route to host")," \u9519\u8bef\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e3a\u4e86\u6709\u4e00\u4e2a\u66f4\u76f4\u89c2\u7684\u7406\u89e3\uff0c\u628a\u4e0a\u8ff0\u62d3\u6251\u56fe\u5b9e\u9a8c\u73af\u5883\u914d\u7f6e\u597d\uff0c\u901a\u8fc7\u5ba2\u6237\u7aef(192.168.122.8) \u53bb curl ",(0,l.kt)("a",{parentName:"p",href:"http://192.168.122.9/"},"http://192.168.122.9:80")," \u4e24\u6b21\uff0c\u7136\u540e\u5728 Director \u7684 eth0 \u63a5\u53e3\u4e0a\u6293\u5305\uff0c\u5982\u4e0b\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@director ~]# tcpdump -i eth0 not tcp port 22 -nn\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes\n12:27:10.889114 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [S], seq 4149950767, win 29200, options [mss 1460,sackOK,TS val 1289129575 ecr 0,nop,wscale 7], length 0\n12:27:10.889175 ARP, Request who-has 192.168.122.203 tell 192.168.122.202, length 28\n12:27:10.889700 ARP, Reply 192.168.122.203 is-at 52:54:00:0e:05:54, length 28\n12:27:10.889729 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [S], seq 4149950767, win 29200, options [mss 1460,sackOK,TS val 1289129575 ecr 0,nop,wscale 7], length 0\n12:27:10.890167 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [.], ack 1449142928, win 229, options [nop,nop,TS val 1289129576 ecr 4290791627], length 0\n12:27:10.890203 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [.], ack 1, win 229, options [nop,nop,TS val 1289129576 ecr 4290791627], length 0\n12:27:10.890250 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [P.], seq 0:77, ack 1, win 229, options [nop,nop,TS val 1289129576 ecr 4290791627], length 77: HTTP: GET / HTTP/1.1\n12:27:10.890258 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [P.], seq 0:77, ack 1, win 229, options [nop,nop,TS val 1289129576 ecr 4290791627], length 77: HTTP: GET / HTTP/1.1\n12:27:10.890999 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [.], ack 286, win 237, options [nop,nop,TS val 1289129577 ecr 4290791628], length 0\n12:27:10.891042 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [.], ack 286, win 237, options [nop,nop,TS val 1289129577 ecr 4290791628], length 0\n12:27:10.891353 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [F.], seq 77, ack 286, win 237, options [nop,nop,TS val 1289129577 ecr 4290791628], length 0\n12:27:10.891389 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [F.], seq 77, ack 286, win 237, options [nop,nop,TS val 1289129577 ecr 4290791628], length 0\n12:27:10.891820 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [.], ack 287, win 237, options [nop,nop,TS val 1289129578 ecr 4290791628], length 0\n12:27:10.891851 IP 192.168.122.8.55976 > 192.168.122.9.80: Flags [.], ack 287, win 237, options [nop,nop,TS val 1289129578 ecr 4290791628], length 0\n12:27:11.352836 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [S], seq 1099517050, win 29200, options [mss 1460,sackOK,TS val 1289130039 ecr 0,nop,wscale 7], length 0\n12:27:11.352899 ARP, Request who-has 192.168.122.204 tell 192.168.122.202, length 28\n12:27:11.353344 ARP, Reply 192.168.122.204 is-at 52:54:00:52:1a:d4, length 28\n12:27:11.353373 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [S], seq 1099517050, win 29200, options [mss 1460,sackOK,TS val 1289130039 ecr 0,nop,wscale 7], length 0\n12:27:11.353758 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [.], ack 322887858, win 229, options [nop,nop,TS val 1289130040 ecr 3849403757], length 0\n12:27:11.353796 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [.], ack 1, win 229, options [nop,nop,TS val 1289130040 ecr 3849403757], length 0\n12:27:11.353825 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [P.], seq 0:77, ack 1, win 229, options [nop,nop,TS val 1289130040 ecr 3849403757], length 77: HTTP: GET / HTTP/1.1\n12:27:11.353833 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [P.], seq 0:77, ack 1, win 229, options [nop,nop,TS val 1289130040 ecr 3849403757], length 77: HTTP: GET / HTTP/1.1\n12:27:11.354754 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [.], ack 286, win 237, options [nop,nop,TS val 1289130041 ecr 3849403758], length 0\n12:27:11.354799 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [.], ack 286, win 237, options [nop,nop,TS val 1289130041 ecr 3849403758], length 0\n12:27:11.354950 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [F.], seq 77, ack 286, win 237, options [nop,nop,TS val 1289130041 ecr 3849403758], length 0\n12:27:11.354982 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [F.], seq 77, ack 286, win 237, options [nop,nop,TS val 1289130041 ecr 3849403758], length 0\n12:27:11.355422 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [.], ack 287, win 237, options [nop,nop,TS val 1289130042 ecr 3849403758], length 0\n12:27:11.355455 IP 192.168.122.8.55978 > 192.168.122.9.80: Flags [.], ack 287, win 237, options [nop,nop,TS val 1289130042 ecr 3849403758], length 0\n^C\n61 packets captured\n61 packets received by filter\n0 packets dropped by kernel\n[root@director ~]#\n")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e24\u6b21\u8bf7\u6c42\u7684\u6700\u5f00\u59cb\u90fd\u662f Director arp \u5e7f\u64ad\u5bfb\u627e RealServers\uff0c\u662f 192.168.122.202 \u627e 192.168.122.203/204\uff0c\u4e0d\u662f VIP 192.168.122.9 \u627e 192.168.122.203/204\uff0c\u4e0d\u7136\u4f1a\u8ddf RealServers \u4e0a\u7684 VIP \u51b2\u7a81\u3002\u6240\u4ee5 Director \u4e0a\u5fc5\u987b\u914d\u7f6e\u9664 VIP \u5916\u7684\u81ea\u5df1\u7684\u5730\u5740\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u4e3a\u4ec0\u4e48 VS/NAT \u4e0a Director \u6ca1\u6709\u914d\u7f6e ",(0,l.kt)("inlineCode",{parentName:"li"},"eth0:0")," \u5462\uff1f\u56e0\u4e3a\u8fd9\u79cd\u6a21\u5f0f RealServers \u6ca1\u6709 VIP\uff0c\u800c\u4e14\u5bfb\u5740\u903b\u8f91\u5b8c\u5168\u4e0d\u540c\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u53e6\u5916\u901a\u8fc7\u8fd9\u4e24\u6b21\u8bf7\u6c42\u7684 Director arp \u5bfb\u5740\uff0c\u6b63\u597d\u53ef\u4ee5\u611f\u53d7\u5230 ipvsadm \u4fee\u6539 MAC \u5730\u5740\u7684\u7cbe\u9ad3\u3002")))),(0,l.kt)("h3",{id:"1082cipviprip-\u4e0d\u540c\u7f51\u6bb5\u5b9e\u9a8c"},"10.8.2\u3001CIP\u3001VIP\u3001RIP \u4e0d\u540c\u7f51\u6bb5\u5b9e\u9a8c"),(0,l.kt)("p",null,"\u8003\u8651\u5b9e\u9645\u7684\u751f\u4ea7\u73af\u5883\uff0c\u7531\u4e8e\u516c\u7f51\u5730\u5740\u6709\u9650\uff0c\u4e00\u822c\u53ea\u7ed9 web server \u7684\u8d1f\u8f7d\u5747\u8861\u7cfb\u7edf\u5206\u914d\u4e00\u4e2a\u516c\u7f51\u5730\u5740\u3002\u8fd9\u4e2a\u516c\u7f51\u5730\u5740\u53ef\u80fd\u76f4\u63a5\u5206\u914d\u7ed9 VIP\uff0c\u8fd9\u6837 CIP\u3001VIP\u3001RIP \u4e24\u4e24\u90fd\u5904\u4e8e\u4e0d\u540c\u7f51\u6bb5\uff1b\u8fd8\u53ef\u80fd\u5206\u914d\u7ed9\u8def\u7531\u5668\u6216\u9632\u706b\u5899\uff0c\u7136\u540e VIP \u548c RIP \u90fd\u662f\u7528\u79c1\u7f51\u5730\u5740\uff0c\u8fd9\u6837 VIP/RIP \u540c\u7f51\u6bb5\uff0c\u4f46\u5b83\u4eec\u548c CIP \u4e0d\u540c\u7f51\u6bb5\u3002"),(0,l.kt)("p",null,"\u4e0d\u7ba1\u516c\u7f51\u5730\u5740\u5206\u914d\u7ed9\u8c01\uff0cCIP\u3001RIP \u603b\u662f\u4e0d\u540c\u7f51\u6bb5\u7684\u3002\u8fd9\u65f6\u9700\u8981\u8003\u8651\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"RS \u5c06\u54cd\u5e94\u6570\u636e\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\uff0c\u8be5\u54cd\u5e94\u6570\u636e\u5305\u7684\u6e90\u548c\u76ee\u6807 IP \u5730\u5740\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"VIP--\x3eCIP"),"\uff0c\u4f46\u56e0\u4e3a\u662f\u4ece RIP \u6240\u5728\u7f51\u5361\u6d41\u51fa\u7684\uff0c\u8fd9\u4e2a\u54cd\u5e94\u6570\u636e\u5305\u7684\u6e90 MAC \u5730\u5740\u4e3a MAC","_","RIP\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u7531\u4e8e RIP \u548c CIP \u4e0d\u540c\u7f51\u6bb5\uff0c\u56e0\u6b64 RS \u9700\u8981\u501f\u52a9\u67d0\u4e2a\u8def\u7531\u8bbe\u5907\u6765\u8f6c\u53d1\u8fd9\u4e2a\u6570\u636e\u5305\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u7531\u4e8e RS \u4e0a\u7684 VIP \u88ab\u9690\u85cf\uff0cDIP/RIP \u6240\u5728\u7f51\u6bb5\u7684\u6240\u6709\u4e3b\u673a(\u5305\u62ec\u8fd9\u4e2a\u8def\u7531\u8bbe\u5907)\u4e0a\u7f13\u5b58\u7684\u5173\u4e8e VIP \u7684 arp \u8bb0\u5f55\u90fd\u662f Director \u4e0a\u7684(\u5373 ",(0,l.kt)("inlineCode",{parentName:"li"},"VIP<--\x3eMAC_V"),")\uff0c\u5373\u4f7f\u91cd\u65b0\u53d1\u8d77 arp \u8bf7\u6c42\uff0c\u4e5f\u53ea\u80fd\u83b7\u53d6\u5230\u8fd9\u6837\u7684\u5bf9\u5e94\u5173\u7cfb\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},'\u56e0\u6b64\uff0c\u54cd\u5e94\u6570\u636e\u5305\u7684\u6e90 IP\u3001\u6e90 MAC \u7684\u5bf9\u5e94\u5173\u7cfb\u548c\u8def\u7531\u8bbe\u5907 arp \u7f13\u5b58\u4e2d\u8bb0\u5f55\u4e0d\u4e00\u81f4\uff0c\u8fd9\u4e2a\u54cd\u5e94\u6570\u636e\u5305\u662f "\u975e\u6cd5" \u6570\u636e\u5305\u3002'))),(0,l.kt)("li",{parentName:"ol"},"\u8fd9\u4e2a\u8def\u7531\u8bbe\u5907\u53d1\u73b0\u6570\u636e\u5305\u7684\u6e90 MAC \u5730\u5740\u3001\u6e90 IP \u548c\u5b83 arp \u7f13\u5b58\u4e2d\u7684\u8bb0\u5f55\u4e0d\u4e00\u81f4\uff0c\u5b83\u4f1a\u4e22\u5f03\u8fd9\u4e2a\u6570\u636e\u5305\u5417\uff1f\u5206\u4e24\u79cd\u60c5\u51b5\uff1a",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},'\u5982\u679c\u8fd9\u4e2a\u6570\u636e\u5305\u88ab\u8def\u7531\u5230\u666e\u901a\u7684\u8def\u7531\u8bbe\u5907\u4e0a\uff0c\u8def\u7531\u8bbe\u5907\u9ed8\u8ba4\u4e0d\u4f1a\u68c0\u67e5\u6e90\u5730\u5740\u662f\u5426\u5408\u6cd5\u3002\u8fd9\u79cd\u68c0\u67e5\u79f0\u4e3a "reverse path filter"(\u53cd\u5411\u8def\u5f84\u8fc7\u6ee4)\u529f\u80fd\u3002\u9ed8\u8ba4 Linux \u4e3b\u673a\u4f1a\u505a\u53cd\u5411\u68c0\u67e5\uff0cLinux \u4e0a\u63a7\u5236\u8be5\u529f\u80fd\u7684\u53c2\u6570\u4e3a rp',"_","filter\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u8fd9\u4e2a\u6570\u636e\u5305\u88ab\u8def\u7531\u5230 Director \u6240\u5728\u4e3b\u673a(Linux)\u4e0a\uff0c\u9ed8\u8ba4\u4f1a\u4e22\u5f03\u8fd9\u4e2a\u6570\u636e\u5305\uff0c\u56e0\u4e3a\u6e90 IP \u5730\u5740\u6b63\u597d\u5728\u672c\u673a\u4e0a\u3002\u4f46\u53ef\u4ee5\u4e3a\u5185\u6838\u6253\u4e0a forward","_","shared \u8865\u4e01\uff0c\u4ee5\u4fbf\u4f7f\u7528 forward","_","shared \u548c rp","_","filter \u53c2\u6570\u6765\u5f00\u542f\u8f6c\u53d1\u6e90 IP \u5730\u5740\u4e3a\u81ea\u8eab\u5730\u5740\u6570\u636e\u5305\u7684\u529f\u80fd\u3002\u8f6c\u53d1\u65f6\uff0c\u9700\u8981\u8bbe\u7f6e\u8f6c\u53d1\u63a5\u53e3\u4e3a VIP \u6240\u5728\u63a5\u53e3\uff0c\u8fd9\u6837\u6570\u636e\u5305\u7684\u6e90 MAC \u5730\u5740\u548c VIP \u76f8\u4e92\u5bf9\u5e94\uff0c\u4e4b\u540e\u7684\u8def\u7531\u8fc7\u7a0b\u4f1a\u4e00\u8def\u987a\u7545\u3002")))),(0,l.kt)("p",null,"\u6839\u636e\u7b2c\u56db\u70b9\u7684 2 \u79cd\u60c5\u51b5\uff0cDirector \u4e0e RS \u4e4b\u95f4\u7684\u8def\u7531\u5668\u6709\u5982\u4e0b\u4e24\u4e2a\u9009\u62e9\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7b2c\u4e00\u79cd\u60c5\u51b5\u8bbe\u7f6e\u5f88\u7b80\u5355\uff0c\u4f46 Linux \u5145\u5f53\u8def\u7531\u8bbe\u5907\u5173\u95ed\u6e90 IP \u5730\u5740\u68c0\u67e5\u529f\u80fd\u540e\uff0c\u5c06\u66f4\u5bb9\u6613\u53d7\u5230 DDos \u653b\u51fb\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u7b2c\u4e8c\u79cd\u60c5\u51b5\u53ef\u4ee5\u5ffd\u7565\uff0c\u4e0d\u4ec5\u8981\u91cd\u65b0\u7f16\u8bd1\u5185\u6838\uff0c\u66f4\u91cd\u8981\u7684\u662f VS/DR \u6a21\u5f0f\u7684\u4f18\u70b9\u672c\u5c31\u5728\u4e8e\u8ba9 Director \u4e13\u6ce8\u4e8e\u8c03\u5ea6\u5de5\u4f5c\u6765\u5b9e\u73b0\u9ad8\u6027\u80fd\uff0c\u800c\u4e0d\u5e94\u8be5\u8ba9\u5176\u5e2e\u52a9\u8f6c\u53d1\u3002")),(0,l.kt)("p",null,"\u56e0\u6b64\uff0c\u672c\u6587\u5c06\u4ee5\u7b2c\u4e00\u79cd\u60c5\u51b5\u6765\u505a\u5b9e\u9a8c\u6d4b\u8bd5\u3002"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u662f ",(0,l.kt)("a",{parentName:"p",href:"https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt"},"Linux\u5185\u6838\u6587\u6863")," \u4e2d\u5173\u4e8erp","_","filter\u53d8\u91cf\u7684\u63cf\u8ff0\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"rp_filter - INTEGER\n    0 - No source validation.\n    1 - Strict mode as defined in RFC3704 Strict Reverse Path\n        Each incoming packet is tested against the FIB and if the interface\n        is not the best reverse path the packet check will fail.\n        By default failed packets are discarded.\n    2 - Loose mode as defined in RFC3704 Loose Reverse Path\n        Each incoming packet's source address is also tested against the FIB\n        and if the source address is not reachable via any interface\n        the packet check will fail.\n\n    Current recommended practice in RFC3704 is to enable strict mode\n    to prevent IP spoofing from DDos attacks. If using asymmetric routing\n    or other complicated routing, then loose mode is recommended.\n\n    The max value from conf/{all,interface}/rp_filter is used\n    when doing source validation on the {interface}.\n\n    Default value is 0. Note that some distributions enable it\n    in startup scripts.\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"0\uff1a\u4e0d\u5f00\u542f\u6e90\u5730\u5740\u6821\u9a8c\u3002"),(0,l.kt)("li",{parentName:"ul"},"1\uff1a\u5f00\u542f\u4e25\u683c\u7684\u53cd\u5411\u8def\u5f84\u6821\u9a8c\u3002\u5bf9\u6bcf\u4e2a\u8fdb\u6765\u7684\u6570\u636e\u5305\uff0c\u6821\u9a8c\u5176\u53cd\u5411\u8def\u5f84\u662f\u5426\u662f\u6700\u4f73\u8def\u5f84(",(0,l.kt)("strong",{parentName:"li"},"\u901a\u8fc7\u7279\u5b9a\u63a5\u53e3"),")\u3002\u5982\u679c\u53cd\u5411\u8def\u5f84\u4e0d\u662f\u6700\u4f73\u8def\u5f84\uff0c\u5219\u76f4\u63a5\u4e22\u5f03\u8be5\u6570\u636e\u5305\u3002"),(0,l.kt)("li",{parentName:"ul"},"2\uff1a\u5f00\u542f\u677e\u6563\u7684\u53cd\u5411\u8def\u5f84\u6821\u9a8c\u3002\u5bf9\u6bcf\u4e2a\u8fdb\u6765\u7684\u6570\u636e\u5305\uff0c\u6821\u9a8c\u5176\u6e90\u5730\u5740\u662f\u5426\u53ef\u8fbe\uff0c\u5373\u53cd\u5411\u8def\u5f84\u662f\u5426\u80fd\u901a\uff08",(0,l.kt)("strong",{parentName:"li"},"\u901a\u8fc7\u4efb\u610f\u63a5\u53e3"),"\uff09\uff0c\u5982\u679c\u53cd\u5411\u8def\u5f84\u4e0d\u901a\uff0c\u5219\u76f4\u63a5\u4e22\u5f03\u8be5\u6570\u636e\u5305\u3002\u8fd9\u4e2a\u503c\u53ea\u662f\u4e3a\u4e86\u9632\u6b62\u8f6c\u53d1\u65e0\u6548\u6216\u5192\u5145\u7684\u6e90 IP \u5730\u5740\uff0c\u5982 192.16.10 \u8fd9\u6837\u7684\u4e0d\u5b8c\u6574 IP\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u53d6 /proc/sys/net/ipv4/conf/{all,interface}/rp","_","filter \u4e2d\u7684\u6700\u5927\u503c\u751f\u6548\u3002\u6ce8\u610f\uff0c\u5bf9 lo \u63a5\u53e3\u8bbe\u7f6e\u8be5\u53c2\u6570\u662f\u65e0\u610f\u4e49\u7684\u3002")),(0,l.kt)("p",null,"\u4e3a\u4e86\u66f4\u597d\u5730\u89e3\u51b3\u5b9e\u9645\u751f\u4ea7\u95ee\u9898\uff0c\u6211\u4e13\u95e8\u5c31\u81ea\u5df1\u7684\u5de5\u4f5c\u73af\u5883\u8bbe\u8ba1\u4e86\u4e00\u5f20\u62d3\u6251\u56fe\uff0c\u5982\u679c\u6709\u9700\u8981\uff0c\u6211\u4f1a\u4ee5\u6b64\u8bbe\u8ba1\u65b9\u6848\u4f5c\u4e3a\u751f\u4ea7\u73af\u5883\uff0c\u5982\u4e0b\u56fe\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"lvs dr production",src:r(99325).Z,width:"927",height:"601"})),(0,l.kt)("p",null,"\u914d\u7f6e lvs \u6bd4\u8f83\u7b80\u5355\uff0c\u51e0\u6761\u547d\u4ee4\u5c31\u53ef\u4ee5\u4e86\uff0c\u771f\u6b63\u7684\u96be\u70b9\u5728\u7f51\u7edc\u67b6\u6784\u5982\u4f55\u8bbe\u8ba1\uff0c\u8fd9\u91cc\u5e76\u6ca1\u6709\u52a0\u4e0a HA \u9ad8\u53ef\u7528\uff0c\u6240\u4ee5\u76f8\u5bf9\u6765\u8bf4\u8fd8\u6bd4\u8f83\u7b80\u5355\u3002\u628a\u8fd9\u4e2a\u5b9e\u9a8c\u641e\u61c2\uff0c\u518d\u52a0\u4e2a keepalived \u4e5f\u4e0d\u5728\u8bdd\u4e0b\u3002"),(0,l.kt)("p",null,"Director \u914d\u7f6e\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@director ~]# ipvsadm -C\n[root@director ~]# ipvsadm -A -t 192.168.122.9:80 -s wrr\n[root@director ~]# ipvsadm -a -t 192.168.122.9:80 -r 172.16.4.203 -g -w 2\n[root@director ~]# ipvsadm -a -t 192.168.122.9:80 -r 172.16.4.204 -g -w 1\n\n# \u6dfb\u52a0 vip\uff0c\u6211\u8fd9\u91cc\u4f7f\u7528 ip add \u6dfb\u52a0\u7684\uff0c\u8ddf ifconfig eth0:0 \u4e00\u6837\uff0c\u90fd\u662f\u4e34\u65f6\u751f\u6548\uff0c\u751f\u4ea7\u4e0a\u4e00\u5b9a\u8981\u5199\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\n[root@director ~]# ip add add 192.168.122.9/24 dev eth0 \n")),(0,l.kt)("p",null,"\u6240\u6709 RealServers \u914d\u7f6e\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# 1.\u63d0\u4f9bweb\u670d\u52a1\u548c\u6d4b\u8bd5\u9875\u9762\nyum -y install httpd\necho "This is page from RS1:172.16.4.203" > /var/www/html/index.html  # \u5728RS1\u4e0a\u64cd\u4f5c\necho "This is page from RS2:172.16.4.204" > /var/www/html/index.html  # \u5728RS2\u4e0a\u64cd\u4f5c\nservice httpd start\n\n# 2.\u8bbe\u7f6earp\u53c2\u6570\necho 1 >/proc/sys/net/ipv4/conf/all/arp_ignore\necho 2 >/proc/sys/net/ipv4/conf/all/arp_announce\n\n# 3.\u8bbe\u7f6eVIP\nifconfig lo:0 192.168.122.9 netmask 255.255.255.255 up\nroute add -host 192.168.122.9 dev lo:0\n\n# 4.\u4e00\u5b9a\u8981\u6ce8\u610f\uff0c\u7f51\u5173\u4e0d\u80fd\u6307\u5411director\uff0c\u800c\u662f\u8981\u6307\u5411router\uff0c\u6211\u5728\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\u4e2d\u5199\u597d\u4e86\uff0c\u6309\u7167\u4e0a\u9762\u62d3\u6251\u53bb\u8bbe\u7f6e\n')),(0,l.kt)("p",null,"\u6b64\u65f6\uff0c\u5982\u679c\u901a\u8fc7\u5ba2\u6237\u7aef(192.168.122.1) \u53bb\u8bf7\u6c42 vip(192.168.122.9)\uff0c\u7ed3\u679c\u662f\u4e0d\u901a\u7684\uff0c\u8fd9\u662f VS/DR \u6a21\u5f0f\u4e0b\u8de8\u7f51\u6bb5\u7684\u7279\u6b8a\u6027\uff0c\u91cd\u70b9\u5728\u8fd9\u4e2a router \u4e0a\uff0c\u7406\u8bba\u4e0a\u9762\u5206\u6790\u5f97\u5f88\u8be6\u7ec6\uff0c\u5982\u4e0b\u8bbe\u7f6e router \u5373\u53ef\u5b8c\u6210\u914d\u7f6e\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@router ~]# echo 1 > /proc/sys/net/ipv4/ip_forward\n[root@router ~]# echo 2 > /proc/sys/net/ipv4/conf/all/rp_filter\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u8fd9\u4e2a router \u662f linux \u4e3b\u673a\uff0c\u6240\u4ee5\u5fc5\u987b\u914d\u7f6e rp","_","filter\uff0c\u4e0a\u4e00\u5c0f\u8282\u662f\u540c\u7f51\u6bb5\uff0c\u4e0d\u9700\u8981\u8d70\u4e09\u5c42\u8def\u7531\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e0d\u7528\u8bbe\u7f6e rp","_","filter\u3002")),(0,l.kt)("p",null,"\u5ba2\u6237\u7aef\u518d\u6d4b\u8bd5\uff0c\u6ca1\u6709\u95ee\u9898\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"[root@yidam ~]# curl 192.168.122.9\n<h1>This is page from RS1:172.16.4.203</h1>\n[root@yidam ~]# curl 192.168.122.9\n<h1>This is page from RS1:172.16.4.203</h1>\n[root@yidam ~]# curl 192.168.122.9\n<h1>This is page from RS2:172.16.4.204</h1>\n[root@yidam ~]# curl 192.168.122.9\n<h1>This is page from RS1:172.16.4.203</h1>\n[root@yidam ~]# curl 192.168.122.9\n<h1>This is page from RS1:172.16.4.203</h1>\n[root@yidam ~]# curl 192.168.122.9\n<h1>This is page from RS2:172.16.4.204</h1>\n[root@yidam ~]#\n")))}m.isMDXComponent=!0},27864:function(e,t){t.Z="data:image/png;base64,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"},70264:function(e,t,r){t.Z=r.p+"assets/images/lvs dr practice-81302fc4ab8fdc48c980bcda36f00d79.png"},99325:function(e,t,r){t.Z=r.p+"assets/images/lvs dr production-9504038a2bf1c02d9af3a7094c69ed65.png"},74086:function(e,t,r){t.Z=r.p+"assets/images/lvs dr-ca6f17d52a4c2e13bb567a37f2aa126d.png"},58952:function(e,t,r){t.Z=r.p+"assets/images/lvs nat practice-fd68ae8a7fff100b03c6a05311c2efa6.png"},97263:function(e,t,r){t.Z=r.p+"assets/images/lvs nat-686ea57ac7c2ba3683bfd0a310a69c39.png"},10613:function(e,t,r){t.Z=r.p+"assets/images/lvs tun-e96e763bce775faf88b5447d07413d7b.png"}}]);
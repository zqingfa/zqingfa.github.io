"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[1693],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return p}});var s=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},a=Object.keys(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var m=s.createContext({}),o=function(e){var t=s.useContext(m),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=o(e.components);return s.createElement(m.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},u=s.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,m=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=o(n),p=r,y=u["".concat(m,".").concat(p)]||u[p]||d[p]||a;return n?s.createElement(y,l(l({ref:t},c),{},{components:n})):s.createElement(y,l({ref:t},c))}));function p(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,l=new Array(a);l[0]=u;var i={};for(var m in t)hasOwnProperty.call(t,m)&&(i[m]=t[m]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var o=2;o<a;o++)l[o]=n[o];return s.createElement.apply(null,l)}return s.createElement.apply(null,n)}u.displayName="MDXCreateElement"},68327:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return m},default:function(){return p},frontMatter:function(){return i},metadata:function(){return o},toc:function(){return d}});var s=n(87462),r=n(63366),a=(n(67294),n(3905)),l=["components"],i={id:"linux-primary-11",slug:"/linux-primary-11",title:"\u7b2c 11 \u7ae0 Linux \u670d\u52a1\u7ba1\u7406",authors:"zhangqf",keywords:["linux","Service"]},m=void 0,o={unversionedId:"linux/primary/linux-primary-11",id:"linux/primary/linux-primary-11",title:"\u7b2c 11 \u7ae0 Linux \u670d\u52a1\u7ba1\u7406",description:"\u5f00\u7bc7\u524d\u8981\u5148\u505a\u4e00\u4e0b\u8bf4\u660e\uff0cCentos \u64cd\u4f5c\u7cfb\u7edf\u4ece 7.x \u7248\u672c\u624d\u5f00\u59cb\u652f\u6301 arm64 \u67b6\u6784\uff0c\u4e5f\u5c31\u662f Centos 6.x \u53ca\u4ee5\u524d\u7684\u7248\u672c\u90fd\u4e0d\u652f\u6301 arm64 \u67b6\u6784\u3002Centos 7.x \u548c Centos 6.x \u7ba1\u7406\u670d\u52a1\u7684\u65b9\u5f0f\u622a\u7136\u4e0d\u540c\uff0c\u800c Centos 7.x \u53c8\u517c\u5bb9 Centos 6.x \u7684\u670d\u52a1\u7ba1\u7406\u65b9\u5f0f\uff0c\u6240\u4ee5\u6709\u5fc5\u8981\u90fd\u4ecb\u7ecd\u4e00\u4e0b\uff0c\u4f1a\u7528\u5230 x86 \u67b6\u6784\u7684 centos 6.4\u3002",source:"@site/docs/linux/primary/\u7b2c 11 \u7ae0 Linux \u670d\u52a1\u7ba1\u7406.md",sourceDirName:"linux/primary",slug:"/linux-primary-11",permalink:"/en/docs/linux-primary-11",draft:!1,tags:[],version:"current",frontMatter:{id:"linux-primary-11",slug:"/linux-primary-11",title:"\u7b2c 11 \u7ae0 Linux \u670d\u52a1\u7ba1\u7406",authors:"zhangqf",keywords:["linux","Service"]},sidebar:"linux",previous:{title:"\u7b2c 10 \u7ae0 Linux \u7cfb\u7edf\u8d44\u6e90\u76d1\u63a7",permalink:"/en/docs/linux-primary-10"},next:{title:"\u7b2c 12 \u7ae0 Linux \u5b9a\u65f6\u4efb\u52a1",permalink:"/en/docs/linux-primary-12"}},c={},d=[{value:"11.1\u3001\u670d\u52a1\u7684\u6982\u5ff5",id:"111\u670d\u52a1\u7684\u6982\u5ff5",level:2},{value:"11.2\u3001\u670d\u52a1\u7c7b\u578b",id:"112\u670d\u52a1\u7c7b\u578b",level:2},{value:"11.2.1\u3001\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b",id:"1121\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b",level:3},{value:"11.2.2\u3001xinetd \u8d85\u7ea7\u5b88\u62a4\u8fdb\u7a0b",id:"1122xinetd-\u8d85\u7ea7\u5b88\u62a4\u8fdb\u7a0b",level:3},{value:"11.2.2.1\u3001\u7ba1\u7406\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b",id:"11221\u7ba1\u7406\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b",level:4},{value:"11.2.2.2\u3001\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u7684\u914d\u7f6e",id:"11222\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u7684\u914d\u7f6e",level:4},{value:"11.2.2.3\u3001xinetd \u5b88\u62a4 sshd",id:"11223xinetd-\u5b88\u62a4-sshd",level:4},{value:"11.2.3\u3001\u7ba1\u7406\u670d\u52a1\u5f00\u673a\u81ea\u542f",id:"1123\u7ba1\u7406\u670d\u52a1\u5f00\u673a\u81ea\u542f",level:3},{value:"11.3\u3001systemd \u670d\u52a1",id:"113systemd-\u670d\u52a1",level:2},{value:"11.3.1\u3001\u521d\u8bc6 systemd",id:"1131\u521d\u8bc6-systemd",level:3},{value:"11.3.1.1\u3001systemd \u53ef\u7ba1\u7406\u54ea\u4e9b\u670d\u52a1",id:"11311systemd-\u53ef\u7ba1\u7406\u54ea\u4e9b\u670d\u52a1",level:4},{value:"11.3.1.2\u3001systemd \u7ba1\u7406\u670d\u52a1\u7684\u547d\u4ee4",id:"11312systemd-\u7ba1\u7406\u670d\u52a1\u7684\u547d\u4ee4",level:4},{value:"11.3.1.3\u3001systemd \u6240\u7ba1\u7406\u670d\u52a1\u7684\u72b6\u6001",id:"11313systemd-\u6240\u7ba1\u7406\u670d\u52a1\u7684\u72b6\u6001",level:4},{value:"11.3.2\u3001systemd \u670d\u52a1\u914d\u7f6e\u6587\u4ef6",id:"1132systemd-\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",level:3},{value:"11.3.2.1\u3001systemd service",id:"11321systemd-service",level:4},{value:"11.3.2.2\u3001systemd \u914d\u7f6e\u6587\u4ef6\u8def\u5f84",id:"11322systemd-\u914d\u7f6e\u6587\u4ef6\u8def\u5f84",level:4},{value:"11.3.2.3\u3001systemd service \u6587\u4ef6\u683c\u5f0f",id:"11323systemd-service-\u6587\u4ef6\u683c\u5f0f",level:4},{value:"11.3.2.4\u3001systemd service\uff1aType=forking",id:"11324systemd-servicetypeforking",level:4},{value:"11.3.2.5\u3001systemd service\uff1aType=simple",id:"11325systemd-servicetypesimple",level:4},{value:"11.3.2.6\u3001Systemd Service\uff1a\u5176\u5b83 Type",id:"11326systemd-service\u5176\u5b83-type",level:4},{value:"11.3.3\u3001\u6a21\u677f\u578b\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",id:"1133\u6a21\u677f\u578b\u670d\u52a1\u914d\u7f6e\u6587\u4ef6",level:3},{value:"11.3.4\u3001\u4f7f\u7528 target \u7ec4\u5408\u591a\u4e2a\u670d\u52a1",id:"1134\u4f7f\u7528-target-\u7ec4\u5408\u591a\u4e2a\u670d\u52a1",level:3},{value:"11.3.5\u3001systemd \u5f00\u673a\u81ea\u542f\u4efb\u52a1",id:"1135systemd-\u5f00\u673a\u81ea\u542f\u4efb\u52a1",level:3},{value:"11.3.5.1\u3001systemd \u670d\u52a1\u5f00\u673a\u81ea\u542f",id:"11351systemd-\u670d\u52a1\u5f00\u673a\u81ea\u542f",level:4},{value:"11.3.5.2\u3001systemd \u4e2d\u81ea\u5b9a\u4e49\u5f00\u673a\u81ea\u542f\u52a8\u547d\u4ee4/\u811a\u672c",id:"11352systemd-\u4e2d\u81ea\u5b9a\u4e49\u5f00\u673a\u81ea\u542f\u52a8\u547d\u4ee4\u811a\u672c",level:4},{value:"11.3.6\u3001systemd \u8fd0\u884c\u7ea7\u522b",id:"1136systemd-\u8fd0\u884c\u7ea7\u522b",level:3},{value:"11.3.7\u3001systemd timer \u5b9a\u65f6\u4efb\u52a1",id:"1137systemd-timer-\u5b9a\u65f6\u4efb\u52a1",level:3},{value:"11.3.7.1\u3001Cron \u548c Systemd Timer",id:"11371cron-\u548c-systemd-timer",level:4},{value:"11.3.7.2\u3001systemd timer \u793a\u4f8b\uff1a\u6bcf 3 \u79d2\u8fd0\u884c\u4e00\u6b21",id:"11372systemd-timer-\u793a\u4f8b\u6bcf-3-\u79d2\u8fd0\u884c\u4e00\u6b21",level:4},{value:"11.3.7.3\u3001\u5b9a\u65f6\u4efb\u52a1\u7684\u6267\u884c\u65f6\u95f4\u70b9",id:"11373\u5b9a\u65f6\u4efb\u52a1\u7684\u6267\u884c\u65f6\u95f4\u70b9",level:4},{value:"11.3.7.4\u3001AccuracySec \u548c RandomizedDelaySec",id:"11374accuracysec-\u548c-randomizeddelaysec",level:4},{value:"11.3.7.5\u3001systemd timer \u652f\u6301\u7684\u5355\u8c03\u5b9a\u65f6\u89c4\u5219",id:"11375systemd-timer-\u652f\u6301\u7684\u5355\u8c03\u5b9a\u65f6\u89c4\u5219",level:4},{value:"11.3.7.6\u3001\u66f4\u4e3a\u7075\u6d3b\u7684\u5b9a\u65f6\u89c4\u5219\uff1aOnCalendar",id:"11376\u66f4\u4e3a\u7075\u6d3b\u7684\u5b9a\u65f6\u89c4\u5219oncalendar",level:4},{value:"11.3.7.7\u3001Unit \u548c Persistent",id:"11377unit-\u548c-persistent",level:4},{value:"11.3.7.8\u3001systemd timer \u7528\u6237\u7ea7\u5b9a\u65f6\u4efb\u52a1",id:"11378systemd-timer-\u7528\u6237\u7ea7\u5b9a\u65f6\u4efb\u52a1",level:4},{value:"11.3.7.9\u3001systemd \u4e34\u65f6\u5b9a\u65f6\u4efb\u52a1",id:"11379systemd-\u4e34\u65f6\u5b9a\u65f6\u4efb\u52a1",level:4},{value:"11.3.7.10\u3001\u9650\u5236\u5b9a\u65f6\u4efb\u52a1\u7684\u8d44\u6e90\u4f7f\u7528\u91cf",id:"113710\u9650\u5236\u5b9a\u65f6\u4efb\u52a1\u7684\u8d44\u6e90\u4f7f\u7528\u91cf",level:4}],u={toc:d};function p(e){var t=e.components,i=(0,r.Z)(e,l);return(0,a.kt)("wrapper",(0,s.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u5f00\u7bc7\u524d\u8981\u5148\u505a\u4e00\u4e0b\u8bf4\u660e\uff0cCentos \u64cd\u4f5c\u7cfb\u7edf\u4ece 7.x \u7248\u672c\u624d\u5f00\u59cb\u652f\u6301 arm64 \u67b6\u6784\uff0c\u4e5f\u5c31\u662f Centos 6.x \u53ca\u4ee5\u524d\u7684\u7248\u672c\u90fd\u4e0d\u652f\u6301 arm64 \u67b6\u6784\u3002Centos 7.x \u548c Centos 6.x \u7ba1\u7406\u670d\u52a1\u7684\u65b9\u5f0f\u622a\u7136\u4e0d\u540c\uff0c\u800c Centos 7.x \u53c8\u517c\u5bb9 Centos 6.x \u7684\u670d\u52a1\u7ba1\u7406\u65b9\u5f0f\uff0c\u6240\u4ee5\u6709\u5fc5\u8981\u90fd\u4ecb\u7ecd\u4e00\u4e0b\uff0c\u4f1a\u7528\u5230 x86 \u67b6\u6784\u7684 centos 6.4\u3002"),(0,a.kt)("h2",{id:"111\u670d\u52a1\u7684\u6982\u5ff5"},"11.1\u3001\u670d\u52a1\u7684\u6982\u5ff5"),(0,a.kt)("p",null,"\u670d\u52a1\u662f\u5411\u5916\u63d0\u4f9b\u670d\u52a1\u7684\u8fdb\u7a0b\uff0c\u4e00\u822c\u6765\u8bf4\u90fd\u4f1a\u653e\u5728\u540e\u53f0\uff0c\u65e2\u7136\u8981\u6301\u7eed\u4e0d\u65ad\u7684\u63d0\u4f9b\u5916\u754c\u968f\u65f6\u53d1\u6765\u7684\u670d\u52a1\u8bf7\u6c42\uff0c\u670d\u52a1\u8fdb\u7a0b\u5c31\u9700\u8981\u5e38\u9a7b\u5728\u5185\u5b58\u4e2d\uff0c\u4e14\u4e0d\u5e94\u8be5\u548c\u7ec8\u7aef\u6709\u5173\uff0c\u5426\u5219\u7ec8\u7aef\u9000\u51fa\u670d\u52a1\u7a0b\u5e8f\u5c31\u9000\u51fa\u4e86\u3002"),(0,a.kt)("p",null,'\u53e6\u5916\uff0c\u8981\u80fd\u591f\u63a5\u5f85\u5916\u754c\u7684\u8bf7\u6c42\u4e3a\u5916\u754c\u63d0\u4f9b\u670d\u52a1\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u6709\u4e2a\u4e13\u5c5e\u4e8e\u8fd9\u4e2a\u670d\u52a1\u7684 "\u670d\u52a1\u7a97\u53e3"\uff0c\u8fd9\u4e2a\u670d\u52a1\u7a97\u53e3\u5c31\u662f\u7aef\u53e3\u53f7\uff0c\u901a\u8fc7\u7aef\u53e3\u53f7\u5c31\u80fd\u627e\u5230\u670d\u52a1\u7684\u63d0\u4f9b\u8005\u3002'),(0,a.kt)("p",null,"\u63d0\u4f9b\u670d\u52a1\u7684\u4e00\u7aef\u53eb\u505a\u670d\u52a1\u7aef\uff0c\u5411\u670d\u52a1\u7aef\u8bf7\u6c42\u670d\u52a1\u7684\u53eb\u505a\u5ba2\u6237\u7aef\u3002\u4e24\u7aef\u7684\u4ea4\u4e92\u8fc7\u7a0b\u5982\u4e0b\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u670d\u52a1\u7aef\u542f\u52a8\u670d\u52a1\u8fdb\u7a0b\uff0c\u6b64\u65f6\u5c06\u5f00\u653e\u5bf9\u5e94\u7684\u7aef\u53e3\u53f7\uff1b"),(0,a.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\u6307\u5b9a\u670d\u52a1\u7aef IP \u5730\u5740\u548c\u7aef\u53e3\u53f7\u5411\u8be5\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\uff1b"),(0,a.kt)("li",{parentName:"ol"},"\u670d\u52a1\u7aef\u6240\u5728\u4e3b\u673a\u7684\u5185\u6838\u63a5\u6536\u5230\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u7136\u540e\u5206\u6790\u6570\u636e\u5305\u53d1\u73b0\u8bf7\u6c42\u7684\u662f\u67d0\u67d0\u7aef\u53e3\u53f7\uff0c\u5185\u6838\u77e5\u9053\u8be5\u7aef\u53e3\u53f7\u662f\u54ea\u4e2a\u5e94\u7528\u7a0b\u5e8f\u76d1\u542c\u7684\u7aef\u53e3\uff0c\u6240\u4ee5\u5c06\u8bf7\u6c42\u62a5\u6587\u53d1\u9001\u7ed9\u5bf9\u5e94\u7684\u5e94\u7528\u7a0b\u5e8f\uff1b"),(0,a.kt)("li",{parentName:"ol"},"\u5e94\u7528\u7a0b\u5e8f\u6536\u5230\u62a5\u6587\u540e\uff0c\u5c06\u548c\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\uff0c\u5e76\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u3002")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"\u6ce8\u610f\uff1a\u5e76\u975e\u6240\u6709\u670d\u52a1\u90fd\u603b\u662f\u63d0\u4f9b\u7aef\u53e3\u53f7\u7684\uff0c\u4f8b\u5982 xinetd \u8fd9\u4e2a\u670d\u52a1\uff0c\u53ea\u6709\u5728\u9700\u8981\u7684\u65f6\u5019\u624d\u63a5\u7ba1\u76f8\u5e94\u7684\u7aef\u53e3\uff0c\u5982 rsync \u76d1\u542c\u7aef\u53e3\u4e3a 222 \u65f6\uff0c\u90a3\u4e48\u8bf7\u6c42 rsync \u65f6\uff0cxinetd \u5728\u76d1\u542c\u8fc7\u7a0b\u4e2d\u7684\u7aef\u53e3\u53f7\u5c31\u662f 222\u3002\u5728\u4e0d\u88ab\u8bf7\u6c42\u7684\u65f6\u5019\uff0cxinetd \u662f\u6ca1\u6709\u7aef\u53e3\u53f7\u7684\u3002")),(0,a.kt)("h2",{id:"112\u670d\u52a1\u7c7b\u578b"},"11.2\u3001\u670d\u52a1\u7c7b\u578b"),(0,a.kt)("p",null,"\u5728 Linux \u4e2d\uff0c\u670d\u52a1\u5206\u4e3a\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\u548c\u8d85\u7ea7\u5b88\u62a4\u8fdb\u7a0b\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\u662f\u81ea\u884c\u76d1\u542c\u5728\u540e\u53f0\u7684\uff0c\u57fa\u672c\u4e0a\u6240\u6709\u7684\u670d\u52a1\u90fd\u662f\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\u7c7b\u7684\u670d\u52a1\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u8d85\u7ea7\u5b88\u62a4\u8fdb\u7a0b\u4e13\u6307 xinetd \u8fd9\u4e2a\u670d\u52a1\uff0c\u8fd9\u4e2a\u670d\u52a1\u4ee3\u4e3a\u7ba1\u7406\u7740\u4e00\u4e9b\u7279\u6b8a\u7684\u670d\u52a1\uff0c\u8fd9\u7c7b\u670d\u52a1\u5728\u88ab\u8bf7\u6c42\u7684\u65f6\u5019\u624d\u4f1a\u7531 xinetd \u901a\u77e5\u5b83\u542f\u52a8\u670d\u52a1\uff0c\u670d\u52a1\u63d0\u4f9b\u5b8c\u6bd5\u540e\u5c31\u5173\u95ed\u670d\u52a1\uff0c\u8fd9\u7c7b\u670d\u52a1\u79f0\u4e3a\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5373\u53ea\u5b58\u5728\u4e8e\u77ac\u65f6\u3002",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4f46\u8981\u660e\u767d\uff0c\u8d85\u7ea7\u5b88\u62a4\u8fdb\u7a0b xinetd \u672c\u8eab\u662f\u4e00\u4e2a\u5e38\u9a7b\u5185\u5b58\u7684\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\uff0c\u56e0\u4e3a\u5b83\u8981\u76d1\u542c\u6765\u81ea\u5916\u754c\u5bf9\u5176\u7ba1\u7406\u7684\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u7684\u8bf7\u6c42\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u8fc7\u4e00\u822c\u4e0d\u5de5\u4f5c\u7684\u65f6\u5019\uff0cxinetd \u4e0d\u5360\u7528\u7aef\u53e3\u53f7\uff0c\u5728\u5de5\u4f5c\u7684\u65f6\u5019\u5b83\u5360\u7528\u88ab\u8bf7\u6c42\u7684\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u7684\u7aef\u53e3\u53f7\uff0c\u5e76\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u3002")))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5728 11.2.X \u8fd9\u4e00\u5c0f\u8282\u5c06\u4f7f\u7528 x86 Centos 6.4 \u505a\u6240\u6709\u5b9e\u9a8c\uff0c\u5176\u5b83\u7684\u6ca1\u6709\u505a\u8bf4\u660e\u7684\u90fd\u662f\u4f7f\u7528 ARM64 \u67b6\u6784\u7684\u64cd\u4f5c\u7cfb\u7edf\u505a\u6240\u6709\u5b9e\u9a8c\u3002")),(0,a.kt)("h3",{id:"1121\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b"},"11.2.1\u3001\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b"),(0,a.kt)("p",null,"\u5728 x86 CentOS 6.4 \u4e0a\uff0c\u6240\u6709\u7684\u670d\u52a1\u811a\u672c\u90fd\u5728 /etc/rc.d/init.d/ \u76ee\u5f55\u4e0b\uff0c/etc/init.d/ \u662f\u5b83\u7684\u8f6f\u94fe\u63a5\u3002\u5728\u6b64\u76ee\u5f55\u4e0b\u7684\u811a\u672c\u90fd\u662f LSB \u98ce\u683c\u7684\u811a\u672c\uff0c\u5b83\u4eec\u57fa\u672c\u4e0a\u90fd\u80fd\u63a5\u53d7 start/stop/restart/reload/status \u7b49\u53c2\u6570\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@x86 ~]# ls /etc/init.d/\nauditd            halt       lvm2-lvmetad  network      rsyslog    sshd\nblk-availability  ip6tables  lvm2-monitor  postfix      sandbox    udev-post\ncrond             iptables   netconsole    rdisc        saslauthd\nfunctions         killall    netfs         restorecond  single\n[root@x86 ~]#\n")),(0,a.kt)("p",null,"\u8981\u7ba1\u7406\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\u7c7b\u7684\u670d\u52a1"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# /etc/init.d/service_name   restart|start|stop|status      # \u65b9\u6cd5\u4e00\n# service  service_name      restart|start|stop|status      # \u65b9\u6cd5\u4e8c\n")),(0,a.kt)("p",null,"\u8981\u8ba9\u670d\u52a1\u80fd\u591f\u88ab service \u547d\u4ee4\u7ba1\u7406\uff0c\u5c06\u5176\u670d\u52a1\u811a\u672c\u653e\u5728 /etc/init.d \u76ee\u5f55\u4e0b\u5373\u53ef\u3002"),(0,a.kt)("h3",{id:"1122xinetd-\u8d85\u7ea7\u5b88\u62a4\u8fdb\u7a0b"},"11.2.2\u3001xinetd \u8d85\u7ea7\u5b88\u62a4\u8fdb\u7a0b"),(0,a.kt)("p",null,"xinetd \u5373 extended internet daemon\uff0cxinetd \u662f\u65b0\u4e00\u4ee3\u7684\u7f51\u7edc\u5b88\u62a4\u8fdb\u7a0b\u670d\u52a1\u7a0b\u5e8f\uff0c\u53c8\u53eb\u8d85\u7ea7 Internet \u670d\u52a1\u5668\u3002\u7ecf\u5e38\u7528\u6765\u7ba1\u7406\u591a\u79cd\u8f7b\u91cf\u7ea7 Internet \u670d\u52a1\u3002"),(0,a.kt)("h4",{id:"11221\u7ba1\u7406\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b"},"11.2.2.1\u3001\u7ba1\u7406\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b"),(0,a.kt)("p",null,"\u8be5\u7c7b\u670d\u52a1\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528 service \u547d\u4ee4\u6765\u542f\u52a8\u3002\u53ea\u80fd\u53bb /etc/xinetd.d/ \u76ee\u5f55\u4e0b\u7684\u5bf9\u5e94\u6587\u4ef6\u4e2d\u8fdb\u884c\u8bbe\u7f6e(\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5728 /etc/xinetd.conf \u4e2d\u914d\u7f6e)\uff0c\u7136\u540e\u7531 xinetd \u8fdb\u884c\u7ba1\u7406\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5b89\u88c5 xinetd\n[root@x86 ~]# yum install xinetd -y\n\n# \u5b89\u88c5 rsync\uff0c\u9ed8\u8ba4\u5f52\u4e8e xinetd \u6210\u4e3a\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\n[root@x86 ~]# yum install rsync -y\n\n[root@x86 ~]# chkconfig --list\n......\nxinetd          0:off   1:off   2:off   3:on    4:on    5:on    6:off\n\nxinetd based services:\n    chargen-dgram:  off\n    chargen-stream: off\n    daytime-dgram:  off\n    daytime-stream: off\n    discard-dgram:  off\n    discard-stream: off\n    echo-dgram:     off\n    echo-stream:    off\n    rsync:          off # \u9ed8\u8ba4\u5f52\u4e8e xinetd \u6210\u4e3a\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\n    tcpmux-server:  off\n    time-dgram:     off\n    time-stream:    off\n")),(0,a.kt)("p",null,"\u9996\u5148\u5f97\u4fdd\u8bc1 xinetd \u662f\u5df2\u7ecf\u5de5\u4f5c\u5728\u540e\u53f0\u7684\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@x86 ~]# service xinetd start\nStarting xinetd:                                           [  OK  ]\n[root@x86 ~]# \n")),(0,a.kt)("p",null,"\u7136\u540e\u7ba1\u7406\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\uff0c\u8be5\u7c7b\u670d\u52a1\u6bd4\u8f83\u7279\u522b\uff0c\u5176\u81ea\u542f\u52a8\u72b6\u6001\u548c\u670d\u52a1\u8fd0\u884c\u72b6\u6001\u662f\u540c\u6b65\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4 chkconfig \u8bbe\u7f6e\u4e86\u5176\u81ea\u542f\u52a8\u5219\u8868\u793a\u542f\u52a8\u8be5\u670d\u52a1\uff0c\u5426\u5219\u4e3a\u505c\u6b62\u8be5\u670d\u52a1\u3002"),(0,a.kt)("p",null,"\u53e6\u5916\uff0c\u5bf9\u5176\u6307\u5b9a\u7ea7\u522b\u662f\u65e0\u6548\u7684\uff0c\u5b83\u4eec\u7684\u542f\u52a8\u7ea7\u522b\u7ee7\u627f\u4e8e xinetd \u7684\u542f\u52a8\u7ea7\u522b\uff0c\u5e76\u4e14 xinetd \u4f1a\u63a5\u7ba1\u5176\u89e6\u53d1\u7684\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u7684\u7aef\u53e3\u53f7\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\u542f\u52a8 rsync \u8fd9\u4e2a\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@x86 ~]# chkconfig rsync on\n[root@x86 ~]# \n[root@x86 ~]# chkconfig --list\n......\nxinetd          0:off   1:off   2:off   3:on    4:on    5:on    6:off\n\nxinetd based services:\n    chargen-dgram:  off\n    chargen-stream: off\n    daytime-dgram:  off\n    daytime-stream: off\n    discard-dgram:  off\n    discard-stream: off\n    echo-dgram:     off\n    echo-stream:    off\n    rsync:          on  # \u5df2\u542f\u52a8\n    tcpmux-server:  off\n    time-dgram:     off\n    time-stream:    off\n[root@x86 ~]#\n")),(0,a.kt)("h4",{id:"11222\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u7684\u914d\u7f6e"},"11.2.2.2\u3001\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u7684\u914d\u7f6e"),(0,a.kt)("p",null,"\u77ac\u65f6\u5b88\u62a4\u8fdb\u7a0b\u5173\u8054\u4e09\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u4e00\u4e2a\u662f xinetd \u7684\u914d\u7f6e\u6587\u4ef6 /etc/xinetd.conf \u63d0\u4f9b\u9ed8\u8ba4\u914d\u7f6e\uff1b\u4e00\u4e2a\u662f /etc/xinetd.d/ \u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u9488\u5bf9\u5bf9\u5e94\u7684\u670d\u52a1\u63d0\u4f9b\u914d\u7f6e\uff1b\u6700\u540e\u4e00\u4e2a /etc/services\uff0c\u8bbe\u7f6e\u4e86 xinetd \u4e0b\u7684 service \u5bf9\u5e94\u7684\u7aef\u53e3\u53f7\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\u914d\u7f6e rsync"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# /etc/xinetd.d/rsync \u7684\u9ed8\u8ba4\u914d\u7f6e\u3002\n[root@x86 ~]# cat /etc/xinetd.d/rsync\n# default: off    \n# description: The rsync server is a good addition to an ftp server, as it \\\n#       allows crc checksumming etc.\nservice rsync                               # \u5b9a\u4e49rsync\u670d\u52a1\uff0c\u540d\u79f0\u8981\u548c/etc/xinetd.d/\u4e0b\u7684\u6587\u4ef6\u540c\u540d\n{\n        disable         = yes               # yes\u8868\u793a\u4e0d\u542f\u52a8\uff0cno\u8868\u793a\u542f\u52a8\uff0c\u7b49\u4ef7\u4e8echkconfig rsync {on|off}\uff0c\u6240\u4ee5\u8fd9\u91cc\u8bbe\u7f6e\u540e\u5c06\u76f4\u63a5\u5728chkconfig\u4e2d\u751f\u6548\n        flags           = IPv6              # \u4e0d\u7528\u7ba1\n        socket_type     = stream            # \u8fd9\u4ee3\u8868\u7684\u662ftcp\u7c7b\u578b\u7684\u5957\u63a5\u5b57\n        wait            = no                # \u8be5\u670d\u52a1\u662f\u5355\u7ebf\u7a0b\u8fd8\u662f\u591a\u7ebf\u7a0b\u7684\uff0cyes\u8868\u793a\u8be5\u670d\u52a1\u4e3a\u5355\u7ebf\u7a0b\uff0cxinetd\u53ea\u542f\u52a8\u670d\u52a1\u5668\u4e0d\u5904\u7406\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u5904\u7406\u8bf7\u6c42\u8fde\u63a5\uff1bno\u8868\u793a\u8be5\u670d\u52a1\u4e3a\u591a\u7ebf\u7a0b\uff0cxinetd\u7ee7\u7eed\u5904\u7406\u65b0\u670d\u52a1\u8bf7\u6c42\u5e76\u5904\u7406\u8fde\u63a5\u3002\u4e00\u822cudp\u4e3ayes\uff0ctcp\u4e3ano\u3002\n        user            = root              # \u4ee5\u4ec0\u4e48\u8eab\u4efd\u8fd0\u884crsync\n        server          = /usr/bin/rsync    # \u542f\u52a8\u670d\u52a1\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\n        server_args     = --daemon          # \u670d\u52a1\u7a0b\u5e8f\u542f\u52a8\u65f6\u4f20\u9012\u7684\u53c2\u6570\n        log_on_failure  += USERID           # \u8fde\u63a5\u5931\u8d25\u7684\u65e5\u5fd7\u8bb0\u5f55\uff0c+\u8868\u793a\u5728\u5168\u5c40\u5bf9\u5e94\u7684\u6761\u76ee\u4e0a\u65b0\u589e\u6b64\u5904\u6307\u5b9a\u7684USERID\n}\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'# /etc/services \u5b9a\u4e49 rsync \u7aef\u53e3\u53f7\n[root@x86 ~]# grep "\\<rsync\\>" /etc/services \nrsync           873/tcp                         # rsync\nrsync           873/udp                         # rsync\n[root@x86 ~]#\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'[root@x86 ~]# grep -v "^#" /etc/xinetd.conf \n\ndefaults\n{\n    log_type    = SYSLOG daemon info            # \u767b\u5f55\u6587\u4ef6\u7684\u8bb0\u5f55\u670d\u52a1\u7c7b\u578b\n    log_on_failure  = HOST                      # \u53d1\u751f\u9519\u8bef\u65f6\u9700\u8981\u8bb0\u5f55\u7684\u4fe1\u606f\u4e3a\u4e3b\u673a (HOST)\n    log_on_success  = PID HOST DURATION EXIT    # \u6210\u529f\u542f\u52a8\u6216\u767b\u9646\u65f6\u7684\u8bb0\u5f55\u4fe1\u606f\n\n    cps     = 50 10     # \u8868\u793a\u6bcf\u79d250\u4e2a\u5165\u7ad9\u8fde\u63a5\uff0c\u5982\u679c\u8d85\u8fc7\u9650\u5236\uff0c\u5219\u7b49\u5f8510\u79d2\u3002\u4e3b\u8981\u7528\u4e8e\u5bf9\u4ed8\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\n    instances   = 50    # \u8868\u793a\u6700\u5927\u8fde\u63a5\u8fdb\u7a0b\u6570\u4e3a50\u4e2a\n    per_source  = 10    # \u63a5\u53d7\u4e00\u4e2a\u6574\u6570\u6216\u201cUNLIMITED\u201d\u4f5c\u4e3a\u53c2\u6570\u3002\u6307\u5b9a\u6bcf\u4e2a\u6e90IP\u5730\u5740\u7684\u6700\u5927\u670d\u52a1\u5b9e\u4f8b\u6570\u3002\n    v6only      = no    # \u662f\u5426\u4ec5\u5141\u8bb8 IPv6 \uff1f\u53ef\u4ee5\u5148\u6682\u65f6\u4e0d\u542f\u52a8 IPv6 \u652f\u6301\uff01\n    groups      = yes   # \u5982\u679cgroups\u5c5e\u6027\u88ab\u8bbe\u7f6e\u4e3a\u201cyes\u201d\uff0c\u90a3\u4e48\u670d\u52a1\u5668\u6267\u884c\u65f6\u5c06\u8bbf\u95ee\u670d\u52a1\u5668\u7684\u6709\u6548UID\u6240\u8bbf\u95ee\u7684\u7ec4\u3002\u6216\u8005\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86group\u5c5e\u6027\uff0c\u5219\u6267\u884c\u670d\u52a1\u5668\u5e76\u8bbf\u95ee\u6307\u5b9a\u7684\u7ec4\u3002\u5982\u679c\u5c06groups\u5c5e\u6027\u8bbe\u7f6e\u4e3a\u201cno\u201d\uff0c\u5219\u670d\u52a1\u5668\u4e0d\u5e26\u8865\u5145\u7ec4\u8fd0\u884c\u3002\n    umask       = 002   # \u8fd9\u4e2a\u9009\u9879\u53ef\u4ee5\u5728"defaults"\u90e8\u5206\u8bbe\u7f6e\uff0c\u4e3a\u6240\u6709\u670d\u52a1\u8bbe\u7f6e\u4e00\u4e2aumask\u3002xinetd\u5c06\u81ea\u5df1\u7684\u63a9\u7801\u8bbe\u7f6e\u4e3a\u5148\u524d\u7684\u63a9\u7801\u6216022\u3002\u5982\u679c\u6ca1\u6709\u4f7f\u7528umask\u9009\u9879\uff0c\u6240\u6709\u5b50\u8fdb\u7a0b\u5c06\u7ee7\u627f\u8fd9\u4e2aumask\u3002\n}\nincludedir /etc/xinetd.d\n[root@x86 ~]#\n')),(0,a.kt)("h4",{id:"11223xinetd-\u5b88\u62a4-sshd"},"11.2.2.3\u3001xinetd \u5b88\u62a4 sshd"),(0,a.kt)("p",null,"sshd \u672c\u8eab\u662f\u4e2a\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\uff0c\u4e3a\u4e86\u589e\u5f3a sshd \u7684\u529f\u80fd\uff0c\u6211\u4eec\u628a sshd \u6258\u7ba1\u5230 xinetd \u4e0b\u9762\uff0c\u6ce8\u610f\u8981\u5148\u5173\u95ed sshd \u670d\u52a1\u8fdb\u7a0b\uff0c\u5e76\u7981\u6b62\u5f00\u673a\u81ea\u542f\uff0c\u5982\u679c\u4f60\u662f\u8fdc\u7a0b\u64cd\u4f5c\uff0c\u8bf7\u4e00\u5b9a\u8981\u628a\u63e1\u64cd\u4f5c\u987a\u5e8f\uff0c\u5e76\u77e5\u9053\u81ea\u5df1\u5728\u5e72\u4ec0\u4e48\u3002"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5173\u95ed sshd \u670d\u52a1\uff0c\u7981\u6b62\u5f00\u673a\u81ea\u542f"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@x86 ~]# service sshd stop\n[root@x86 ~]# \n[root@x86 ~]# chkconfig sshd off\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5728 /etc/xinetd.d/ \u76ee\u5f55\u4e0b\u9762\u521b\u5efa sshd \u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u9ed8\u8ba4\u662f\u6ca1\u6709\u7684\uff0c\u624b\u52a8\u521b\u5efa"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@x86 ~]# cat /etc/xinetd.d/sshd \nservice ssh                          # \u4ee3\u8868\u88ab\u6258\u7ba1\u670d\u52a1\u7684\u540d\u79f0\n{\n       disable = no             # \u662f\u5426\u7981\u7528\u6258\u7ba1\u670d\u52a1\uff0cno \u8868\u793a\u5f00\u542f\u6258\u7ba1\u670d\u52a1\n       log_on_failure += USERID # \u8bbe\u7f6e\u5931\u8d25\u65f6\uff0cUID \u6dfb\u52a0\u5230\u7cfb\u7edf\u767b\u8bb0\u8868\n       socket_type = stream     # socket\u8fde\u63a5\u65b9\u5f0f\uff0cstream\u662ftcp\uff0cdgram\u662fudp\n       cps = 25 30                  # \u6bcf\u79d225\u4e2a\u5165\u7ad9\u8fde\u63a5\uff0c\u5982\u679c\u8d85\u8fc7\u9650\u5236\uff0c\u5219\u7b49\u5f8530\u79d2\u3002\n       protocol = tcp               # \u4ee3\u8868ssh\u8d70\u7684\u662ftcp\u534f\u8bae\u8fde\u63a5\n       wait = no                    # \u8be5\u670d\u52a1\u662f\u5355\u7ebf\u7a0b\u8fd8\u662f\u591a\u7ebf\u7a0b\u7684\uff0c\u4e00\u822cudp\u4e3ayes\uff0ctcp\u4e3ano\n       user = root                  # \u4ee5\u4ec0\u4e48\u7528\u6237\u8fdb\u884c\u542f\u52a8\n       server = /usr/sbin/sshd      # \u88ab\u6258\u7ba1\u670d\u52a1\u7684\u4e8c\u8fdb\u5236\u542f\u52a8\u811a\u672c\n       server_args = -i         # sshd \u662f\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5fc5\u987b\u4f20\u5165 -i \u53c2\u6570\uff0c\u5426\u5219\u65e0\u6cd5\u88abxinetd\u6258\u7ba1\n       server_args = -D $OPTIONS    # \u5982\u679c\u8fd8\u8981\u7ed9server\u4f20\u53c2\uff0c\u8be5\u53c2\u6570\u5fc5\u987b\u5728 -i \u53c2\u6570\u4e0b\u9762\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u8fde\u63a5\u95ea\u9000\u60c5\u51b5\n}\n[root@x86 ~]#\n")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"xinetd \u542f\u52a8\u7684\u670d\u52a1\u4eec\u6709\u4e00\u4e2a\u4e0e\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\u4e0d\u517c\u5bb9\u7684\u7279\u5b9a\u63a5\u53e3\uff0c\u8fd9\u4e9b\u670d\u52a1\u4e0d\u80fd\u6253\u5f00\u548c\u76d1\u542c\u5957\u63a5\u5b57\uff0c\u5b83\u4eec\u5fc5\u987b\u901a\u8fc7 stdin/stdout \u4e0e\u5ba2\u6237\u7aef\u901a\u4fe1\u3002",(0,a.kt)("strong",{parentName:"li"},"\u9700\u8981\u6307\u5b9a server","_","args = -i \u4f20\u7ed9\u72ec\u7acb\u5b88\u62a4\u8fdb\u7a0b\uff0c\u624d\u80fd\u88ab xinetd \u6258\u7ba1"),"\u3002"),(0,a.kt)("li",{parentName:"ul"},"socket","_","type \u548c protocol \u81f3\u5c11\u8981\u6709\u4e00\u4e2a\u6307\u5b9a tcp \u534f\u8bae\uff0c\u5426\u5219\u65e0\u6cd5\u542f\u52a8 sshd \u670d\u52a1\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u8fd9\u91cc\u7684 /usr/sbin/sshd \u4e8c\u8fdb\u5236\u811a\u672c\u542f\u52a8\u65f6\u6709\u81ea\u5df1\u7684\u914d\u7f6e\u6587\u4ef6 /etc/ssh/sshd","_","config\uff0c\u4e5f\u5c31\u662f\u8bf4 sshd \u539f\u6709\u7684\u529f\u80fd\u662f\u4e0d\u53d8\u7684\u3002"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u67e5\u770b sshd 22 \u53f7\u7aef\u53e3\u662f\u5426\u7531 xinetd \u6258\u7ba1"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@x86 ~]# lsof -i :22\nCOMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\nsshd    1427 root    3r  IPv4  12622      0t0  TCP 192.168.114.131:ssh->192.168.114.1:60477 (ESTABLISHED)\nxinetd  9959 root    5u  IPv6  24146      0t0  TCP *:ssh (LISTEN)\n[root@x86 ~]#\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5728 /etc/xinetd.d/sshd \u91cc\u9762\u6dfb\u52a0\u8bbf\u95ee\u63a7\u5236"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@x86 ~]# cat /etc/xinetd.d/sshd\nservice ssh                           \n{\n       disable = no\n       log_on_failure += USERID\n       cps = 25 30\n       wait = no\n       user = root\n       protocol = tcp\n       server_args = -i\n       server_args = -D $OPTIONS\n       server = /usr/sbin/sshd\n    only_from = 192.168.114.0/24    # \u8868\u793a\u5141\u8bb8114\u7f51\u6bb5\u8bbf\u95ee\n       no_access = 192.168.1.128        # \u4f46\u662f\u4e0d\u5141\u8bb8128\u8bbf\u95ee\n}\n[root@x86 ~]#\n\n# \u6d4b\u8bd5\uff0c\u8fd9\u53f0\u670d\u52a1\u5668\u5730\u5740\u5c31\u662f 192.168.114.128\n[root@mysql ~]# ip -4 add | grep inet\n   inet 127.0.0.1/8 scope host lo\n   inet 192.168.114.128/24 brd 192.168.114.255 scope global dynamic ens32\n[root@mysql ~]#\n# \u8bd5\u9a8c\u6210\u529f\uff0c\u62d2\u7edd\u8fde\u63a5\n[root@mysql ~]# ssh 192.168.114.131\nssh_exchange_identification: read: Connection reset by peer\n[root@mysql ~]#\n")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u6ce8\u91ca\u4e0d\u8981\u52a0\u5728\u914d\u7f6e\u6587\u4ef6\u91cc\u9762\uff0c\u6211\u662f\u4e3a\u4e86\u8bf4\u660e\u610f\u601d\uff0c\u52a0\u5728\u91cc\u9762\u542f\u52a8\u4e0d\u4e86\u670d\u52a1\u7684\u3002"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u518d\u6dfb\u52a0\u591a\u4e2a\u63a7\u5236"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u63a7\u5236\u8fd9\u4e2a\u670d\u52a1\u6700\u591a\u53ea\u80fd 3 \u4e2a\u8fde\u63a5\uff0c\u6bcf\u4e2a\u6e90 IP \u53ea\u80fd 1 \u4e2a\u8fde\u63a5"),(0,a.kt)("li",{parentName:"ul"},"\u63a7\u5236\u53ea\u80fd 9\uff1a00 \u5230 18\uff1a00 \u624d\u80fd ssh \u8fde\u63a5"),(0,a.kt)("li",{parentName:"ul"},"\u6307\u5b9a\u65e5\u5fd7\u8bb0\u5f55\u5230 /var/log/xinetd","_","ssh.log \u91cc")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@x86 ~]# cat /etc/xinetd.d/sshd\nservice ssh                           \n{\n       disable = no\n       log_on_failure += USERID\n       cps = 25 30\n       wait = no\n       user = root\n       protocol = tcp\n       server_args = -i\n       server_args = -D $OPTIONS\n       server = /usr/sbin/sshd\n    only_from = 192.168.114.0/24\n       no_access = 192.168.114.128\n    instances = 3                               # \u6700\u5927\u8fde\u63a5\u6570\u4e3a3\n       per_source = 1                               # \u6bcf\u4e2a\u6e90IP\u53ea\u80fd\u67091\u4e2a\u8fde\u63a5\n       access_times = 9:00-18:00                    # \u53ea\u80fd9\uff1a00\u523018\uff1a00\u624d\u80fdssh\u8fde\u63a5\n       log_type = file /var/log/xinetd_ssh.log      # \u6307\u5b9a\u65e5\u5fd7\u8bb0\u5f55\u5230/var/log/xinetd_ssh.log\u91cc\n}\n[root@x86 ~]#\n")))),(0,a.kt)("h3",{id:"1123\u7ba1\u7406\u670d\u52a1\u5f00\u673a\u81ea\u542f"},"11.2.3\u3001\u7ba1\u7406\u670d\u52a1\u5f00\u673a\u81ea\u542f"),(0,a.kt)("p",null,"chkconfig \u547d\u4ee4\u80fd\u7ba1\u7406 /etc/init.d/ \u76ee\u5f55\u4e0b\u5b58\u5728\u4e14\u811a\u672c\u7684\u5185\u5bb9\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\u7684\u670d\u52a1\u3002"),(0,a.kt)("p",null,"\u8981\u80fd\u8ba9 chkconfig \u7ba1\u7406\u670d\u52a1\u7684\u5f00\u673a\u662f\u5426\u81ea\u542f\u52a8\u884c\u4e3a\uff0c\u53ea\u9700\u5c06\u811a\u672c\u653e\u5728 /etc/init.d \u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728\u811a\u672c\u7684\u524d\u90e8\u52a0\u4e0a chkconfig \u884c\u548c description \u884c\u3002\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\n\n# chkconfig: - 85 15\n# description: The Apache HTTP Server is an efficient and extensible\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},'\u8fd9\u4e24\u884c\u5fc5\u987b\u5728\u6240\u6709\u975e\u6ce8\u91ca\u884c\u7684\u524d\u9762\uff0c\u4e14\u8fd9\u4e24\u884c\u5fc5\u987b\u5f97\u88ab"\u6ce8\u91ca"\u3002'),(0,a.kt)("li",{parentName:"ul"},'\u5176\u4e2d chkconfig \u884c "-" \u8868\u793a\u9002\u7528\u4e8e\u8fd0\u884c\u7ea7\u522b 123456 \u4e0a\uff0c85 \u8868\u793a\u5f00\u673a\u542f\u52a8\u65f6\uff0c\u5b83\u7684\u542f\u52a8\u987a\u5e8f\u4e3a 85\uff0c15 \u8868\u793a\u5173\u673a\u505c\u6b62\u670d\u52a1\u65f6\uff0c\u5b83\u7684\u505c\u6b62\u987a\u5e8f\u4e3a 15\u3002description \u884c\u968f\u4fbf\u7ed9\u4e00\u70b9\u63cf\u8ff0\u4fe1\u606f\u5c31\u53ef\u4ee5\uff0c\u4f46\u662f\u5fc5\u987b\u5f97\u7ed9 "description:" \u5173\u952e\u5b57\u3002')),(0,a.kt)("p",null,"\u7136\u540e\uff0c\u5c31\u53ef\u4ee5\u6709 chkconfig \u6765\u7ba1\u7406\u670d\u52a1\u7684\u5f00\u673a\u81ea\u542f\u52a8\u4e86\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"chkconfig [--add | --del] <name>  # \u5c06/etc/init.d\u4e2d\u53ef\u4ee5\u88abchkconfig\u7ba1\u7406\u7684\u670d\u52a1\u6dfb\u52a0\u5230chkconfig\u7684\u7ba1\u7406\u5217\u8868\u4e2d\uff0c\u6216\u8005\u4ece\u5217\u8868\u4e2d\u5220\u9664\nchkconfig [--list] [name]         # \u5217\u51fa\u6307\u5b9a\u540d\u79f0\u7684\u670d\u52a1\u7684\u5f00\u542f\u81ea\u542f\u52a8\u4fe1\u606f\u3002name\u53ef\u4ee5\u4f7f\u7528all\u6765\u8868\u793a\u5217\u51fa\u6240\u6709chkconfig\u7ba1\u7406\u5217\u8868\u4e2d\u7684\u670d\u52a1\nchkconfig [--level <levels>] <name> <on|off|reset>  # \u5c06\u6307\u5b9a\u540d\u79f0\u7684\u670d\u52a1\u5728\u6307\u5b9a\u7ea7\u522b\u4e0a\u6253\u5f00\u5f00\u673a\u81ea\u542f\u52a8\u6216\u5173\u95ed\u5f00\u673a\u81ea\u542f\u52a8\u529f\u80fd\u3002\n                                                    # reset\u5219\u8868\u793a\u91cd\u7f6e\u4e3a\u811a\u672c\u4e2d\u6307\u5b9a\u7684\u7ea7\u522b\n")),(0,a.kt)("p",null,"\u5f53\u7136\uff0c\u9664\u4e86 chkconfig \u53ef\u4ee5\u7ba1\u7406\u5f00\u673a\u81ea\u542f\u52a8\uff0c\u5c06\u542f\u52a8\u547d\u4ee4\u653e\u5728 /etc/rc.d/rc.local \u6587\u4ef6\u4e2d\u4e5f\u662f\u53ef\u4ee5\u7684\u3002"),(0,a.kt)("h2",{id:"113systemd-\u670d\u52a1"},"11.3\u3001systemd \u670d\u52a1"),(0,a.kt)("p",null,"\u4e0b\u9762\u4f1a\u5206\u4e00\u4e9b\u5b50\u7ae0\u8282\u6765\u4ecb\u7ecd systemd \u670d\u52a1\uff0cLinux \u64cd\u4f5c\u7cfb\u7edf\u542f\u52a8\u52a0\u8f7d\u5b8c\u5185\u6838\u540e\uff0c\u542f\u52a8\u7b2c\u4e00\u4e2a\u521d\u4ee3\u8fdb\u7a0b\u5c31\u662f systemd \u8fdb\u7a0b\u3002\u5b9e\u9645\u4e0a\u4ece centos 5\u3001centos6 \u518d\u5230 centos 7 \u7ecf\u5386\u8fc7 init\u3001upstart \u548c systemd \u4e09\u4e2a\u9636\u6bb5\uff0c\u6beb\u65e0\u7591\u95ee systemd \u4f5c\u4e3a\u521d\u4ee3\u8fdb\u7a0b\u662f\u76ee\u524d\u6700\u597d\u7684\u9009\u62e9\u3002"),(0,a.kt)("h3",{id:"1131\u521d\u8bc6-systemd"},"11.3.1\u3001\u521d\u8bc6 systemd"),(0,a.kt)("p",null,"\u4f7f\u7528 systemd \u505a\u670d\u52a1\u7ba1\u7406\u65f6\uff0c\u9700\u8981\u4e86\u89e3\u4e00\u4e9b\u57fa\u672c\u77e5\u8bc6\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u4e86\u89e3 systemd \u53ef\u7ba1\u7406\u54ea\u4e9b\u670d\u52a1"),(0,a.kt)("li",{parentName:"ol"},"\u4e86\u89e3 systemd \u6240\u7ba1\u7406\u670d\u52a1\u7684\u72b6\u6001"),(0,a.kt)("li",{parentName:"ol"},"\u4e86\u89e3 systemctl \u7ba1\u7406\u670d\u52a1\u7684\u57fa\u672c\u547d\u4ee4"),(0,a.kt)("li",{parentName:"ol"},"\u5b66\u4f1a\u7f16\u5199\u3001\u4fee\u6539\u3001\u770b\u61c2\u670d\u52a1 Unit \u914d\u7f6e\u6587\u4ef6")),(0,a.kt)("h4",{id:"11311systemd-\u53ef\u7ba1\u7406\u54ea\u4e9b\u670d\u52a1"},"11.3.1.1\u3001systemd \u53ef\u7ba1\u7406\u54ea\u4e9b\u670d\u52a1"),(0,a.kt)("p",null,"\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528 systemd \u540e\uff0c\u6240\u6709\u7528\u6237\u8fdb\u7a0b\u90fd\u662f systemd \u7684\u540e\u4ee3\u8fdb\u7a0b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# pstree -ph | more\nsystemd(1)-+-agetty(804)\n           |-agetty(16547)\n           |-auditd(747)---{auditd}(748)\n           |-chronyd(791)\n           |-crond(784)\n           |-dbus-daemon(775)---{dbus-daemon}(777)\n           |-firewalld(811)---{firewalld}(950)\n           |-irqbalance(773)\n           |-master(1970)---qmgr(2002)\n           |-polkitd(780)-+-{polkitd}(805)\n           |              |-{polkitd}(806)\n           |              |-{polkitd}(807)\n           |              |-{polkitd}(808)\n           |              `-{polkitd}(809)\n           |-rsyslogd(1122)-+-{rsyslogd}(1127)\n           |                `-{rsyslogd}(1128)\n           |-sshd(1118)---sshd(16844)---bash(16849)-+-more(16881)\n           |                                        `-pstree(16880)\n           |-systemd-journal(561)\n           |-systemd-logind(774)\n           |-systemd-udevd(585)\n           `-tuned(1119)-+-{tuned}(1653)\n                         |-{tuned}(1654)\n                         |-{tuned}(1666)\n                         `-{tuned}(1696)\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u5f53\u67d0\u4e2a\u8fdb\u7a0b\u4e0d\u5728\u67d0\u4e2a\u7ed1\u5b9a\u7ec8\u7aef\u7684 Shell \u8fdb\u7a0b\u4e0b\uff0c\u8be5\u8fdb\u7a0b\u5fc5\u7136\u662f\u8131\u79bb\u7ec8\u7aef\u8131\u79bb Shell \u7684 Daemon \u7c7b\u8fdb\u7a0b\u6216\u5176\u5b50\u5b59\u8fdb\u7a0b\u3002"),(0,a.kt)("p",null,"\u867d\u7136\u4ece\u8fdb\u7a0b\u6811\u5173\u7cfb\u6765\u770b\uff0c\u6240\u6709\u8fdb\u7a0b\u90fd\u76f4\u63a5\u6216\u95f4\u63a5\u5730\u53d7\u5230 systemd \u7684\u7ba1\u7406\uff0c\u4f46\u662f\uff0c\u5e76\u975e\u6240\u6709 systemd \u7684\u5b50\u8fdb\u7a0b\u90fd\u53d7 Systemd Unit \u7ba1\u7406\u5355\u5143\u7684\u7ba1\u7406\u3002"),(0,a.kt)("p",null,"\u53ea\u6709\u90a3\u4e9b\u7531 systemd \u65b9\u5f0f\u542f\u52a8\u7684\u670d\u52a1\u8fdb\u7a0b(\u6bd4\u5982 systemctl \u547d\u4ee4\u542f\u52a8) \u624d\u53d7\u5230 Systemd Unit \u7ba1\u7406\u5355\u5143\u7684\u76d1\u63a7\u548c\u7ba1\u7406\u3002\u4e3a\u4e86\u7b80\u5316\u63cf\u8ff0\uff0c\u540e\u9762\u5747\u76f4\u63a5\u4ee5 ",(0,a.kt)("inlineCode",{parentName:"p"},"systemd \u7ba1\u7406")," \u6765\u63cf\u8ff0\u53d7 systemd unit \u7ba1\u7406\u5355\u5143\u7684\u7ba1\u7406\u3002"),(0,a.kt)("p",null,"\u6bd4\u5982\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u4e24\u79cd\u65b9\u5f0f\u542f\u52a8 Nginx \u670d\u52a1\u8fdb\u7a0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# nginx                             # (1)\n[root@arm64v8 ~]# systemctl start nginx.service     # (2)\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"systemd \u53ea\u80fd\u76d1\u63a7\u3001\u7ba1\u7406\u7b2c (2) \u79cd\u65b9\u5f0f\u542f\u52a8\u7684 nginx \u670d\u52a1\u3002\u6bd4\u5982\u7b2c\u4e00\u79cd\u65b9\u5f0f\u542f\u52a8\u7684 nginx\uff0c\u65e0\u6cd5\u4f7f\u7528 systemctl stop nginx \u6765\u505c\u6b62\u3002")),(0,a.kt)("p",null,"\u6240\u4ee5\uff0csystemd \u4e0b\u7684\u76f4\u7cfb\u5b50\u8fdb\u7a0b\u53ef\u5206\u4e3a\u4e24\u7c7b\uff1a\u53d7 systemd \u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\u548c\u4e0d\u53d7 systemd \u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\u3002"),(0,a.kt)("h4",{id:"11312systemd-\u7ba1\u7406\u670d\u52a1\u7684\u547d\u4ee4"},"11.3.1.2\u3001systemd \u7ba1\u7406\u670d\u52a1\u7684\u547d\u4ee4"),(0,a.kt)("p",null,"\u542f\u52a8\u3001\u505c\u6b62\u670d\u52a1:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl start Service_Name1 Service_Name2\nsystemctl stop  Service_Name\n")),(0,a.kt)("p",null,"\u670d\u52a1\u91cd\u8f7d\u3001\u91cd\u542f\u76f8\u5173\u64cd\u4f5c\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u91cd\u8f7d\u670d\u52a1\uff1a\u670d\u52a1\u672a\u8fd0\u884c\u65f6\u4e0d\u505a\u4efb\u4f55\u4e8b\nsystemctl reload Service_Name\n\n# \u91cd\u542f\u670d\u52a1\uff1a\u670d\u52a1\u5df2\u8fd0\u884c\u65f6\u91cd\u542f\u4e4b\uff0c\u670d\u52a1\u672a\u8fd0\u884c\u65f6\u542f\u52a8\u4e4b\nsystemctl restart Service_Name\n\n# \u670d\u52a1\u5df2\u8fd0\u884c\u65f6\u91cd\u542f\u4e4b\uff0c\u672a\u8fd0\u884c\u65f6\u4e0d\u542f\u52a8\u4e4b\nsystemctl try-restart Service_Name\n\n# \u670d\u52a1\u5df2\u8fd0\u884c\u65f6\uff0c\u5982\u679c\u652f\u6301reload\uff0c\u5219reload\uff0c\u5982\u679c\u4e0d\u652f\u6301\u5219restart\n# \u670d\u52a1\u672a\u8fd0\u884c\u65f6\uff0c\u542f\u52a8\u4e4b\nsystemctl reload-or-restart Service_Name\n\n# \u670d\u52a1\u5df2\u8fd0\u884c\u65f6\uff0c\u5982\u679c\u652f\u6301reload\uff0c\u5219reload\uff0c\u5982\u679c\u4e0d\u652f\u6301\u5219restart\n# \u670d\u52a1\u672a\u8fd0\u884c\u65f6\uff0c\u4e0d\u505a\u4efb\u4f55\u4e8b\nsystemctl reload-or-try-restart Service_Name\n")),(0,a.kt)("p",null,"\u670d\u52a1\u72b6\u6001\u67e5\u770b\u64cd\u4f5c\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u67e5\u770b\u670d\u52a1\u72b6\u6001\nsystemctl status Service_Name\n\n# \u68c0\u67e5\u670d\u52a1\u662f\u5426active: \u670d\u52a1\u662f\u5426\u5df2\u542f\u52a8\n# \u81f3\u5c11\u4e00\u4e2a\u670d\u52a1active\u65f6\uff0c\u8fd4\u56de0\uff0c\u5426\u5219\u8fd4\u56de\u975e0\u9000\u51fa\u72b6\u6001\u7801\nsystemctl is-active Service_Name1 Service_Name2\nsystemctl --quiet is-active Service_Name  # \u9759\u9ed8\u6a21\u5f0f\n\n# \u68c0\u67e5\u670d\u52a1\u662f\u5426failed: \u670d\u52a1\u542f\u52a8\u547d\u4ee4\u9000\u51fa\u72b6\u6001\u7801\u975e0\u6216\u542f\u52a8\u8d85\u65f6\nsystemctl is-failed Service_Name\n")),(0,a.kt)("h4",{id:"11313systemd-\u6240\u7ba1\u7406\u670d\u52a1\u7684\u72b6\u6001"},"11.3.1.3\u3001systemd \u6240\u7ba1\u7406\u670d\u52a1\u7684\u72b6\u6001"),(0,a.kt)("p",null,"\u5f53\u4f7f\u7528 systemd \u7ba1\u7406\u670d\u52a1\u65f6\uff0c\u6709\u5fc5\u8981\u4e86\u89e3\u670d\u52a1\u7684\u5404\u79cd\u72b6\u6001\u4fe1\u606f\u3002"),(0,a.kt)("p",null,"\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"systemctl list-units --type=service")," \u53ef\u4ee5\u5217\u51fa Service Unit \u7684\u72b6\u6001\u4fe1\u606f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl list-units --type=service\nUNIT                                LOAD   ACTIVE SUB     DESCRIPTION\nauditd.service                      loaded active running Security Auditing Service\nchronyd.service                     loaded active running NTP client/server\ncrond.service                       loaded active running Command Scheduler\n......\nserial-getty@ttyS0.service          loaded active running Serial Getty on ttyS0\nsshd-keygen.service                 loaded active exited  OpenSSH Server Key Generation\nsshd.service                        loaded active running OpenSSH server daemon\n......\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\n\n41 loaded units listed. Pass --all to see loaded but inactive units, too.\nTo show all installed unit files use 'systemctl list-unit-files'.\n")),(0,a.kt)("p",null,"\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"systemctl status Service_Name")," \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5230\u670d\u52a1\u7684\u72b6\u6001\u4fe1\u606f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl status sshd\n\u25cf sshd.service - OpenSSH server daemon\n   Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: enabled)\n   Active: active (running) since Tue 2021-08-03 06:16:18 EDT; 1h 21min ago\n     Docs: man:sshd(8)\n           man:sshd_config(5)\n Main PID: 1118 (sshd)\n   CGroup: /system.slice/sshd.service\n           \u2514\u25001118 /usr/sbin/sshd -D\n\n......\n[root@arm64v8 ~]#\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u91cd\u70b9\u5728 Active \u884c\uff0c\u5b83\u63cf\u8ff0\u4e86\u670d\u52a1\u7684\u8fd0\u884c\u72b6\u6001\u3002\u4e0a\u9762 active \u4f4d\u7f6e\u53ef\u80fd\u7684\u72b6\u6001\u503c\u6709\uff1a"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"active"),(0,a.kt)("li",{parentName:"ul"},"inactive"),(0,a.kt)("li",{parentName:"ul"},"activating \u6216 deactivating"),(0,a.kt)("li",{parentName:"ul"},"reloading"),(0,a.kt)("li",{parentName:"ul"},"failed")),(0,a.kt)("p",{parentName:"li"},"\u5982\u679c\u4e00\u4e2a\u670d\u52a1\u5df2\u7ecf\u542f\u52a8\u6210\u529f\uff0c\u5b83\u5c06\u6210\u529f\u52a0\u5165\u5230 systemd \u76d1\u63a7\u961f\u5217(job queue)\uff0c\u6b64\u540e\u5b83\u5c06\u53d7\u5230 systemd \u76d1\u63a7\u548c\u7ba1\u7406\uff0c\u6b64\u65f6\u8be5\u670d\u52a1\u7684\u72b6\u6001\u4e3a active\u3002"),(0,a.kt)("p",{parentName:"li"},"\u5982\u679c\u4e00\u4e2a\u670d\u52a1\u5728\u542f\u52a8\u8fc7\u7a0b\u4e2d\u5931\u8d25\uff0c\u6bd4\u5982\u8d1f\u8d23\u670d\u52a1\u542f\u52a8\u7684\u547d\u4ee4(ExecStart \u6307\u4ee4\u6240\u6307\u5b9a) \u5728\u542f\u52a8\u65f6\u4ee5\u975e 0 \u72b6\u6001\u7801\u9000\u51fa\u3001\u670d\u52a1\u542f\u52a8\u8fc7\u7a0b\u8017\u65f6\u8fc7\u4e45\u5bfc\u81f4\u8d85\u65f6\u3001\u8fdb\u7a0b\u5d29\u6e83\u7b49\uff0c\u6b64\u65f6\u8be5\u670d\u52a1\u7684\u72b6\u6001\u5c06\u5904\u4e8e failed \u72b6\u6001\uff0c\u8868\u793a\u52a0\u5165\u76d1\u63a7\u961f\u5217\u5931\u8d25\uff0c\u4e8b\u5b9e\u4e0a\u5b83\u52a0\u5165\u5230\u4e86\u67d0\u4e2a\u63cf\u8ff0\u542f\u52a8\u5931\u8d25\u7684\u961f\u5217\u4e2d\u3002"),(0,a.kt)("p",{parentName:"li"},"\u5f53\u4e00\u4e2a\u670d\u52a1\u672a\u542f\u52a8\uff0c\u6216\u8005\u670d\u52a1\u5df2\u505c\u6b62\u65f6\uff0c\u8be5\u670d\u52a1\u7684\u72b6\u6001\u5c06\u5904\u4e8e inactive \u72b6\u6001\u3002"),(0,a.kt)("p",{parentName:"li"},"\u6709\u4e9b\u670d\u52a1\u542f\u52a8\u3001\u505c\u6b62\u53ef\u80fd\u4f1a\u6d88\u8017\u4e00\u70b9\u65f6\u95f4\uff0c\u5728\u542f\u52a8\u6216\u505c\u6b62\u7684\u8fc7\u7a0b\u4e2d\u53bb\u67e5\u770b\u670d\u52a1\u7684\u72b6\u6001\uff0c\u770b\u5230\u7684\u72b6\u6001\u4fe1\u606f\u53ef\u80fd\u4f1a\u662f activating \u6216 deactivating \u6216 reloading\u3002")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u62ec\u53f7\u4e2d\u7684 running \u4f4d\u7f6e\u53ef\u80fd\u7684\u503c\u6709\u5f88\u591a\uff1a"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@kylinv10 ~]# systemctl --state=help\nAvailable unit load states:\nstub\n......\n\nAvailable unit active states:\nactive\n......\n\nAvailable unit file states:\nenabled\n......\n\nAvailable automount unit substates:\ndead\n......\n\nAvailable mount unit substates:\n......\nfailed\n\nAvailable path unit substates:\nwaiting\n......\n[root@kylinv10 ~]# \n")))),(0,a.kt)("p",null,"\u867d\u7136\u6709\u5f88\u591a\u79cd\u72b6\u6001\uff0c\u4f46\u7528\u6237\u901a\u5e38\u53ea\u9700\u5173\u6ce8\u5176\u4e2d\u51e0\u9879\u5e38\u89c1\u7684\u5373\u53ef\u3002\u5e76\u4e14\u8fd9\u4e9b\u72b6\u6001\u7684\u5b58\u5728\u901a\u5e38\u90fd\u4f9d\u8d56\u4e8e\u7b2c\u4e00\u9879 active \u72b6\u6001\uff0c\u6bd4\u5982 active(running)\u3001active(exited)\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"running")," \u72b6\u6001\u8868\u660e\u88ab systemd \u76d1\u63a7\u7684\u670d\u52a1\u8fdb\u7a0b\u6b63\u5728\u8fd0\u884c\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"dead")," \u72b6\u6001\u8868\u660e\u88ab systemd \u76d1\u63a7\u7684\u8fdb\u7a0b\u5df2\u7ecf\u6b7b\u4e86(\u7ec8\u7ed3\u4e86)\uff0csystemd \u8bc6\u522b\u5230\u8fd9\u79cd\u72b6\u6001\u540e\u5c31\u4f1a\u5c06\u5176\u4ece\u76d1\u63a7\u961f\u5217\u4e2d\u91ca\u653e\u5e76\u4e0d\u518d\u76d1\u63a7\u5b83\uff0c\u6240\u4ee5\u5b83\u7684\u7b2c\u4e00\u9879\u72b6\u6001\u4e5f\u4f1a\u968f\u4e4b\u53d8\u4e3a inactive\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"exited")," \u8868\u660e\u88ab systemd \u76d1\u63a7\u7684\u670d\u52a1\u8fdb\u7a0b\u5df2\u7ecf\u9000\u51fa\u4e86\u6216\u8005 systemd \u627e\u4e0d\u5230\u5b83\u672c\u8be5\u8981\u76d1\u63a7\u7684\u8fdb\u7a0b\uff0c\u4f46\u662f\u7ba1\u7406\u8005 systemd \u8ba4\u4e3a\u5b83\u8fd8\u6ca1\u6709\u6b7b\uff0c\u53ea\u662f\u8ba4\u4e3a\u5b83\u6682\u65f6\u9000\u51fa\u4e86\uff0c\u6240\u4ee5\u901a\u5e38\u4f1a\u7ed3\u5408 active \u72b6\u6001\u4e00\u8d77\u51fa\u73b0\uff0c\u5373 active(exited)\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u8fd9\u79cd\u72b6\u6001\u8868\u660e\u4e86\u4e00\u79cd\u610f\u613f\uff0c\u670d\u52a1\u8fdb\u7a0b\u5df2\u7ecf\u6d88\u5931\u4e86\uff0c\u4f46\u4f9d\u7136\u8ba4\u4e3a\u670d\u52a1\u8fdb\u7a0b\u662f\u6d3b\u52a8\u7684\u4e14\u6b63\u88ab\u76d1\u63a7\u3002",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4f8b\u5982\uff0c\u5f53\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u4e86 RemainAfterExit=true \u65f6\uff0c\u670d\u52a1\u5728\u9000\u51fa\u540e\u4f1a\u8fdb\u5165 active(exited) \u72b6\u6001\uff0c\u8fd8\u6709\u591a\u79cd\u5176\u5b83\u53ef\u80fd\u4f1a\u8fdb\u5165\u8fd9\u79cd\u72b6\u6001\uff0c\u901a\u5e38\u6765\u8bf4\u610f\u5473\u7740\u670d\u52a1\u542f\u52a8\u4e0d\u6b63\u5e38(\u6bd4\u5982\u914d\u7f6e\u6587\u4ef6\u9519\u8bef)\uff0c\u4f46\u5e76\u975e\u4e00\u5b9a\u4ee3\u8868\u670d\u52a1\u662f\u5931\u8d25\u7684\uff0c\u5b83\u4ecd\u7136\u53ef\u80fd\u4f1a\u6b63\u5e38\u63d0\u4f9b\u670d\u52a1\u3002")))),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"auto-restart")," \u8868\u660e\u670d\u52a1\u6b63\u5728\u88ab systemd \u81ea\u52a8\u91cd\u542f\u4e2d\uff0c\u5f53\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u8bbe\u7f6e\u4e86 Restart \u4e14\u7b26\u5408 Restart \u89c4\u5219\u65f6 systemd \u4f1a\u81ea\u52a8\u91cd\u542f\u670d\u52a1\u3002"),(0,a.kt)("h3",{id:"1132systemd-\u670d\u52a1\u914d\u7f6e\u6587\u4ef6"},"11.3.2\u3001systemd \u670d\u52a1\u914d\u7f6e\u6587\u4ef6"),(0,a.kt)("h4",{id:"11321systemd-service"},"11.3.2.1\u3001systemd service"),(0,a.kt)("p",null,"Systemd Service \u662f systemd \u63d0\u4f9b\u7684\u7528\u4e8e\u7ba1\u7406\u670d\u52a1\u542f\u52a8\u3001\u505c\u6b62\u548c\u76f8\u5173\u64cd\u4f5c\u7684\u529f\u80fd\uff0c\u5b83\u6781\u5927\u7684\u7b80\u5316\u4e86\u670d\u52a1\u7ba1\u7406\u7684\u914d\u7f6e\u8fc7\u7a0b\uff0c\u7528\u6237\u53ea\u9700\u8981\u914d\u7f6e\u51e0\u9879\u6307\u4ee4\u5373\u53ef\u3002"),(0,a.kt)("p",null,"\u76f8\u6bd4\u4e8e SysV \u7684\u670d\u52a1\u7ba1\u7406\u811a\u672c\uff0c\u7528\u6237\u4e0d\u9700\u8981\u53bb\u7f16\u5199\u670d\u52a1\u7684\u542f\u52a8\u3001\u505c\u6b62\u3001\u91cd\u542f\u3001\u72b6\u6001\u67e5\u770b\u7b49\u7b49\u4e00\u7cfb\u5217\u590d\u6742\u7684\u811a\u672c\u4ee3\u7801\u3002"),(0,a.kt)("p",null,"systemd service \u662f systemd \u6240\u7ba1\u7406\u7684\u5176\u4e2d\u4e00\u9879\u5185\u5bb9\u3002\u5b9e\u9645\u4e0a\uff0csystemd service \u662f Systemd Unit \u7684\u4e00\u79cd\uff0c\u9664\u4e86 Service\uff0csystemd \u8fd8\u6709\u5176\u4ed6\u51e0\u79cd\u7c7b\u578b\u7684 unit\uff0c\u6bd4\u5982 socket\u3001slice\u3001scope\u3001target \u7b49\u7b49\u3002\u5728\u8fd9\u91cc\uff0c\u6682\u65f6\u4e86\u89e3\u4e24\u9879\u5185\u5bb9\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Service \u7c7b\u578b\uff0c\u5b9a\u4e49\u670d\u52a1\u7a0b\u5e8f\u7684\u542f\u52a8\u3001\u505c\u6b62\u3001\u91cd\u542f\u7b49\u64cd\u4f5c\u548c\u8fdb\u7a0b\u76f8\u5173\u5c5e\u6027"),(0,a.kt)("li",{parentName:"ul"},"Target \u7c7b\u578b\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u5bf9 Service(\u4e5f\u53ef\u4ee5\u662f\u5176\u5b83 Unit) \u8fdb\u884c\u5206\u7ec4\u3001\u5f52\u7c7b\uff0c\u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a Service Unit(\u4e5f\u53ef\u4ee5\u662f\u5176\u5b83 Unit)")),(0,a.kt)("p",null,"\u6b64\u5916\uff0cSystemd \u4f5c\u4e3a\u7ba1\u5bb6\uff0c\u8fd8\u5c06\u4e00\u4e9b\u529f\u80fd\u96c6\u6210\u5230\u4e86 Systemd Service \u4e2d\uff0c\u4e2a\u4eba\u89c9\u5f97\u6bd4\u8f83\u51fa\u5f69\u7684\u4e24\u4e2a\u96c6\u6210\u529f\u80fd\u662f\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u5728 Service \u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49 CGroup \u76f8\u5173\u6307\u4ee4\u6765\u5bf9\u8be5\u670d\u52a1\u7a0b\u5e8f\u505a\u8d44\u6e90\u9650\u5236\u3002\u5728\u4ee5\u524d\uff0c\u5bf9\u670d\u52a1\u7a0b\u5e8f\u505a CGroup \u8d44\u6e90\u63a7\u5236\u7684\u6b65\u9aa4\u662f\u6bd4\u8f83\u7e41\u7410\u7684"),(0,a.kt)("li",{parentName:"ul"},"\u7528\u6237\u53ef\u4ee5\u9009\u62e9 Journal \u65e5\u5fd7\u800c\u975e\u91c7\u7528 rsyslog\uff0c\u8fd9\u610f\u5473\u7740\u7528\u6237\u53ef\u4ee5\u4e0d\u7528\u5355\u72ec\u53bb\u914d\u7f6e rsyslog\uff0c\u800c\u4e14\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 systemctl \u6216 journalctl \u547d\u4ee4\u6765\u67e5\u770b\u67d0\u670d\u52a1\u7684\u65e5\u5fd7\u4fe1\u606f\u3002\u5f53\u7136\uff0c\u8be5\u529f\u80fd\u5e76\u4e0d\u9002\u7528\u4e8e\u6240\u6709\u60c5\u51b5\uff0c\u6bd4\u5982\u7528\u6237\u9700\u8981\u7ba1\u7406\u65e5\u5fd7\u65f6")),(0,a.kt)("p",null,"Systemd Service \u8fd8\u6709\u5176\u5b83\u4e00\u4e9b\u7279\u6027\uff0c\u6bd4\u5982\u53ef\u4ee5\u52a8\u6001\u4fee\u6539\u670d\u52a1\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6\uff0c\u6bd4\u5982\u53ef\u4ee5\u5e76\u884c\u542f\u52a8\u975e\u4f9d\u8d56\u7684\u670d\u52a1\uff0c\u4ece\u800c\u52a0\u901f\u5f00\u673a\u8fc7\u7a0b\uff0c\u7b49\u7b49\u3002\u4f8b\u5982\uff0c\u4f7f\u7528 systemd-analyze blame \u53ef\u5206\u6790\u5f00\u673a\u542f\u52a8\u5404\u670d\u52a1\u5360\u7528\u7684\u65f6\u957f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemd-analyze blame \n         32.216s kdump.service\n          8.040s NetworkManager-wait-online.service\n          5.341s network.service\n          1.272s postfix.service\n          1.127s dev-sda3.device\n           975ms firewalld.service\n           838ms tuned.service\n           703ms NetworkManager.service\n           611ms systemd-hwdb-update.service\n           466ms sshd-keygen.service\n           368ms systemd-fsck-root.service\n           351ms plymouth-start.service\n           343ms chronyd.service\n           296ms nginx.service\n           269ms systemd-vconsole-setup.service\n           130ms polkit.service\n           104ms systemd-logind.service\n            98ms sshd.service\n\n# \u4ece\u5185\u6838\u542f\u52a8\u5f00\u59cb\u81f3\u5f00\u673a\u7ed3\u675f\u6240\u82b1\u65f6\u95f4\n[root@arm64v8 ~]# systemd-analyze time\nStartup finished in 4.863s (kernel) + 2.738s (initrd) + 44.161s (userspace) = 51.763s\n[root@arm64v8 ~]#\n")),(0,a.kt)("h4",{id:"11322systemd-\u914d\u7f6e\u6587\u4ef6\u8def\u5f84"},"11.3.2.2\u3001systemd \u914d\u7f6e\u6587\u4ef6\u8def\u5f84"),(0,a.kt)("p",null,"systemd service \u914d\u7f6e\u6587\u4ef6\u90fd\u4ee5 .service \u7ed3\u5c3e\uff0csystemd \u5c06\u670d\u52a1\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6\u7edf\u4e00\u9690\u85cf\u5728 /usr/lib/systemd/system \u76ee\u5f55\u4e0b\uff0c\u540c\u65f6\u66b4\u9732\u4e00\u4e2a\u53ef\u4f9b\u7528\u6237\u5b58\u653e\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55 /etc/systemd/system\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u7528\u6237\u9700\u8981\uff0c\u53ef\u4ee5\u5c06\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u624b\u52a8\u5b58\u653e\u81f3\u7528\u6237\u914d\u7f6e\u76ee\u5f55 /etc/systemd/system \u4e0b\u3002\u8be5\u76ee\u5f55\u4e0b\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u53ef\u4ee5\u662f\u666e\u901a .service \u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u662f\u94fe\u63a5\u81f3 /usr/lib/systemd/system \u76ee\u5f55\u4e0b\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u7684\u8f6f\u94fe\u63a5\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u4f4d\u4e8e/usr/lib/systemd/system\u4e0b\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\n# \u6ce8\u610f\u5e26\u6709`@`\u7b26\u53f7\u7684\u6587\u4ef6\u540d\uff0c\u5b83\u6709\u7279\u6b8a\u610f\u4e49\n[root@arm64v8 ~]# ls /usr/lib/systemd/system -1 | tail\nsystem-update.target\nteamd@.service\ntimers.target\ntimers.target.wants\ntime-sync.target\ntmp.mount\ntuned.service\numount.target\nuser.slice\nwpa_supplicant.service\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u4e0b\u9762\u8fd9\u4e9b\u76ee\u5f55(","*",".target.wants) \u5b9a\u4e49\u5404\u79cd\u7c7b\u578b\u4e0b\u9700\u8981\u8fd0\u884c\u7684\u670d\u52a1"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# ls -1dF /etc/systemd/system/*\n/etc/systemd/system/basic.target.wants/\n/etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service@\n/etc/systemd/system/default.target@\n/etc/systemd/system/default.target.wants/\n/etc/systemd/system/getty.target.wants/\n/etc/systemd/system/local-fs.target.wants/\n/etc/systemd/system/multi-user.target.wants/\n/etc/systemd/system/network-online.target.wants/\n/etc/systemd/system/sysinit.target.wants/\n/etc/systemd/system/system-update.target.wants/\n[root@arm64v8 ~]#\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"sysinit.target.wants \u76ee\u5f55\u4e0b\u7684\u662f\u7cfb\u7edf\u521d\u59cb\u5316\u8fc7\u7a0b\u8fd0\u884c\u7684\u670d\u52a1"),(0,a.kt)("li",{parentName:"ul"},"getty.target.wants \u76ee\u5f55\u4e0b\u7684\u662f\u5f00\u673a\u540e\u542f\u52a8\u865a\u62df\u7ec8\u7aef\u65f6\u8fd0\u884c\u7684\u670d\u52a1"),(0,a.kt)("li",{parentName:"ul"},"multi-user.target.wants \u76ee\u5f55\u4e0b\u7684\u662f\u591a\u7528\u6237\u6a21\u5f0f(\u5bf9\u5e94\u8fd0\u884c\u7ea7\u522b2\u30013\u30014) \u4e0b\u8fd0\u884c\u7684\u670d\u52a1"),(0,a.kt)("li",{parentName:"ul"},"\u8fd9\u91cc\u4e0d\u4e00\u4e00\u4ecb\u7ecd\uff0c\u5176\u5b9e\u5927\u90e8\u5206\u53ef\u4ee5\u89c1\u540d\u77e5\u4e49\u3002")),(0,a.kt)("p",null,"/etc/systemd/system/multi-user.target.wants \u4e0b\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\uff0c\u51e0\u4e4e\u90fd\u662f\u8f6f\u94fe\u63a5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# ls -l /etc/systemd/system/multi-user.target.wants/ | awk '{print $9,$10,$11}' | tail\ncrond.service -> /usr/lib/systemd/system/crond.service\nfirewalld.service -> /usr/lib/systemd/system/firewalld.service\nirqbalance.service -> /usr/lib/systemd/system/irqbalance.service\nkdump.service -> /usr/lib/systemd/system/kdump.service\npostfix.service -> /usr/lib/systemd/system/postfix.service\nremote-fs.target -> /usr/lib/systemd/system/remote-fs.target\nrhel-configure.service -> /usr/lib/systemd/system/rhel-configure.service\nrsyslog.service -> /usr/lib/systemd/system/rsyslog.service\nsshd.service -> /usr/lib/systemd/system/sshd.service\ntuned.service -> /usr/lib/systemd/system/tuned.service\n[root@arm64v8 ~]#\n")),(0,a.kt)("h4",{id:"11323systemd-service-\u6587\u4ef6\u683c\u5f0f"},"11.3.2.3\u3001systemd service \u6587\u4ef6\u683c\u5f0f"),(0,a.kt)("p",null,"\u4e00\u4e2a Systemd Service \u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u5927\u6982\u957f\u8fd9\u6837\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[Unit]\nDescription = some descriptions\nDocumentation = man:xxx(8) man:xxx_config(5)\nRequires = xxx1.target xxx2.target\nAfter = yyy1.target yyy2.target\n\n[Service]\nType = <TYPE>\nExecStart = <CMD_for_START>\nExecStop = <CMD_for_STOP>\nExecReload = <CMD_for_RELOAD>\nRestart = <WHEN_TO_RESTART>\nRestartSec = <TIME>\n\n[Install]\nWantedBy = xxx.target yyy.target\n")),(0,a.kt)("p",null,"\u4e00\u4e2a .Service \u914d\u7f6e\u6587\u4ef6\u5206\u4e3a\u4e09\u90e8\u5206\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Unit\uff1a\u5b9a\u4e49\u8be5\u670d\u52a1\u4f5c\u4e3a Unit \u89d2\u8272\u65f6\u76f8\u5173\u7684\u5c5e\u6027"),(0,a.kt)("li",{parentName:"ol"},"Service\uff1a\u5b9a\u4e49\u672c\u670d\u52a1\u76f8\u5173\u7684\u5c5e\u6027"),(0,a.kt)("li",{parentName:"ol"},"Install\uff1a\u5b9a\u4e49\u672c\u670d\u52a1\u5728\u8bbe\u7f6e\u670d\u52a1\u5f00\u673a\u81ea\u542f\u52a8\u65f6\u76f8\u5173\u7684\u5c5e\u6027\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u53ea\u6709\u5728 \u521b\u5efa/\u79fb\u9664 \u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u7684\u8f6f\u94fe\u63a5\u65f6\uff0cInstall \u6bb5\u624d\u4f1a\u6d3e\u4e0a\u7528\u573a\u3002\u8fd9\u4e00\u914d\u7f6e\u6bb5\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u5f53\u672a\u914d\u7f6e ","[","Install","]"," \u65f6\uff0c\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u52a8\u6216\u7981\u6b62\u5f00\u673a\u81ea\u542f\u52a8\u7684\u64cd\u4f5c\u5c06\u65e0\u4efb\u4f55\u6548\u679c")),(0,a.kt)("p",null,"[","Unit","]"," \u548c ","[","Install","]"," \u6bb5\u7684\u914d\u7f6e\u6307\u4ee4\u90fd\u6765\u81ea\u4e8e man systemd.unit\uff0c\u8fd9\u4e9b\u6307\u4ee4\u90fd\u7528\u4e8e\u63cf\u8ff0\u4f5c\u4e3a Unit \u65f6\u7684\u5c5e\u6027\uff0c","[","Service","]"," \u6bb5\u5219\u4e13\u5c5e\u4e8e .Service \u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u3002"),(0,a.kt)("p",null,"\u8fd9\u91cc\u5148\u4ecb\u7ecd\u4e00\u4e9b\u5e38\u89c1\u7684 ","[","Unit","]"," \u548c ","[","Install","]"," \u76f8\u5173\u7684\u6307\u4ee4(\u867d\u7136\u652f\u6301\u7684\u914d\u7f6e\u6307\u4ee4\u5f88\u591a\uff0c\u4f46\u53ea\u9700\u719f\u6089\u51e0\u4e2a\u5373\u53ef)\uff0c\u4e4b\u540e\u518d\u4e13\u95e8\u4ecb\u7ecd Service \u6bb5\u843d\u7684\u914d\u7f6e\u6307\u4ee4\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"[","Unit","]"," \u6bb5\u843d\u6307\u4ee4"))),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Unit\u6307\u4ee4"),(0,a.kt)("th",{parentName:"tr",align:null},"\u542b\u4e49"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Description"),(0,a.kt)("td",{parentName:"tr",align:null},"Unit \u7684\u63cf\u8ff0\u4fe1\u606f")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Documentation"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c Unit \u7684 man \u6587\u6863\u8def\u5f84")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"After"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c\u670d\u52a1\u5728\u54ea\u4e9b\u670d\u52a1\u542f\u52a8\u4e4b\u540e\u542f\u52a8\uff0c\u4ec5\u5b9a\u4e49\u542f\u52a8\u987a\u5e8f\uff0c\u4e0d\u5b9a\u4e49\u670d\u52a1\u4f9d\u8d56\u5173\u7cfb\uff0c\u5373\u4f7f\u8981\u6c42\u5148\u542f\u52a8\u7684\u670d\u52a1\u542f\u52a8\u5931\u8d25\uff0c\u672c\u670d\u52a1\u4e5f\u4f9d\u7136\u4f1a\u542f\u52a8")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Before"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c\u670d\u52a1\u5728\u54ea\u4e9b\u670d\u52a1\u542f\u52a8\u4e4b\u524d\u542f\u52a8\uff0c\u4ec5\u5b9a\u4e49\u542f\u52a8\u987a\u5e8f\uff0c\u4e0d\u5b9a\u4e49\u670d\u52a1\u4f9d\u8d56\u5173\u7cfb\u3002\u901a\u5e38\u7528\u4e8e\u5b9a\u4e49\u5728\u5173\u673a\u524d\u8981\u5173\u95ed\u7684\u670d\u52a1\uff0c\u5982 Before=shutdown.target")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Wants"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c\u670d\u52a1\u5728\u54ea\u4e9b\u670d\u52a1\u542f\u52a8\u4e4b\u540e\u542f\u52a8\uff0c\u5b9a\u4e49\u670d\u52a1\u4f9d\u8d56\u5173\u7cfb\uff0c\u4e0d\u5b9a\u4e49\u670d\u52a1\u542f\u52a8\u987a\u5e8f\u3002\u542f\u52a8\u672c\u670d\u52a1\u65f6\uff0c\u5982\u679c\u88ab\u4f9d\u8d56\u670d\u52a1\u672a\u542f\u52a8\uff0c\u5219\u4e5f\u4f1a\u542f\u52a8\u88ab\u4f9d\u8d56\u670d\u52a1\u3002\u5982\u679c\u88ab\u4f9d\u8d56\u670d\u52a1\u542f\u52a8\u5931\u8d25\uff0c\u672c\u670d\u52a1\u4e0d\u4f1a\u53d7\u4e4b\u5f71\u54cd\uff0c\u56e0\u6b64\u672c\u670d\u52a1\u4f1a\u7ee7\u7eed\u542f\u52a8\u3002\u5982\u679c\u672a\u7ed3\u5408 After \u4f7f\u7528\uff0c\u5219\u672c\u670d\u52a1\u548c\u88ab\u4f9d\u8d56\u670d\u52a1\u540c\u65f6\u542f\u52a8\u3002\u5f53\u914d\u7f6e\u5728","[","Install","]"," \u6bb5\u843d\u4e2d\u65f6\uff0csystemctl enable \u64cd\u4f5c\u5c06\u4f1a\u5c06\u672c\u670d\u52a1\u5b89\u88c5\u5230\u5bf9\u5e94\u7684 .wants \u76ee\u5f55\u4e0b(\u5728\u8be5\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5)\uff0c\u5728\u5f00\u673a\u81ea\u542f\u52a8\u65f6\uff0c.wants \u76ee\u5f55\u4e2d\u7684\u670d\u52a1\u4f1a\u88ab\u9690\u5f0f\u6dfb\u52a0\u81f3\u76ee\u6807 Unit \u7684 Wants \u6307\u4ee4\u540e\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Requires"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c\u670d\u52a1\u5728\u54ea\u4e9b\u670d\u52a1\u542f\u52a8\u4e4b\u540e\u542f\u52a8\uff0c\u5b9a\u4e49\u670d\u52a1\u5f3a\u4f9d\u8d56\u5173\u7cfb\uff0c\u4e0d\u5b9a\u4e49\u670d\u52a1\u542f\u52a8\u987a\u5e8f\u3002\u542f\u52a8\u672c\u670d\u52a1\u65f6\uff0c\u5982\u679c\u88ab\u4f9d\u8d56\u670d\u52a1\u672a\u542f\u52a8\uff0c\u5219\u4e5f\u4f1a\u542f\u52a8\u88ab\u4f9d\u8d56\u670d\u52a1\u3002\u5982\u679c\u7ed3\u5408\u4e86 After\uff0c\u5f53\u5b58\u5728\u975e active \u72b6\u6001\u7684\u88ab\u4f9d\u8d56\u670d\u52a1\u65f6\uff0c\u672c\u670d\u52a1\u4e0d\u4f1a\u542f\u52a8\u3002\u4e14\u5f53\u88ab\u4f9d\u8d56\u670d\u52a1\u88ab\u624b\u52a8\u505c\u6b62\u65f6\uff0c\u672c\u670d\u52a1\u4e5f\u4f1a\u88ab\u505c\u6b62\uff0c\u4f46\u6709\u4f8b\u5916\u3002\u5982\u679c\u8981\u4fdd\u8bc1\u4e24\u670d\u52a1\u4e4b\u95f4\u72b6\u6001\u5fc5\u987b\u4e00\u81f4\uff0c\u4f7f\u7528 BindsTo \u6307\u4ee4\u3002\u5f53\u914d\u7f6e\u5728","[","Install","]"," \u6bb5\u843d\u4e2d\u65f6\uff0csystemctl enable \u64cd\u4f5c\u5c06\u4f1a\u5c06\u672c\u670d\u52a1\u5b89\u88c5\u5230\u5bf9\u5e94\u7684 .requires \u76ee\u5f55\u4e0b(\u5728\u8be5\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5)\uff0c\u5728\u5f00\u673a\u81ea\u542f\u52a8\u65f6\uff0c.requires \u76ee\u5f55\u4e2d\u7684\u670d\u52a1\u4f1a\u88ab\u9690\u5f0f\u6dfb\u52a0\u81f3\u76ee\u6807 Unit \u7684 Requires \u6307\u4ee4\u540e\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Requisite"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c\u670d\u52a1\u5728\u54ea\u4e9b\u670d\u52a1\u542f\u52a8\u4e4b\u540e\u542f\u52a8\uff0c\u5b9a\u4e49\u670d\u52a1\u4f9d\u8d56\u5173\u7cfb\uff0c\u4e0d\u5b9a\u4e49\u670d\u52a1\u542f\u52a8\u987a\u5e8f\u3002\u542f\u52a8\u672c\u670d\u52a1\u65f6\uff0c\u5982\u679c\u88ab\u4f9d\u8d56\u670d\u52a1\u5904\u4e8e\u5c1a\u672a\u542f\u52a8\u72b6\u6001\uff0c\u5219\u4e0d\u4f1a\u4e3b\u52a8\u53bb\u542f\u52a8\u8fd9\u4e9b\u670d\u52a1\uff0c\u6240\u4ee5\u672c\u670d\u52a1\u76f4\u63a5\u542f\u52a8\u5931\u8d25\u3002\u8be5\u6307\u4ee4\u4e00\u822c\u7ed3\u5408 After \u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u4fbf\u4fdd\u8bc1\u542f\u52a8\u987a\u5e8f\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"BindsTo"),(0,a.kt)("td",{parentName:"tr",align:null},"\u7ed1\u5b9a\u4e24\u4e2a\u670d\u52a1\uff0c\u4e24\u670d\u52a1\u7684\u72b6\u6001\u4fdd\u8bc1\u4e00\u81f4\u3002\u5982\u670d\u52a1 1 \u4e3a active\uff0c\u5219\u672c\u670d\u52a1\u4e5f\u4e00\u5b9a\u4e3a active\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"PartOf"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c\u670d\u52a1\u662f\u5176\u5b83\u670d\u52a1\u7684\u4e00\u90e8\u5206\uff0c\u5b9a\u4e49\u4e86\u5355\u5411\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u4e14\u53ea\u5bf9 stop \u548c restart \u64cd\u4f5c\u6709\u6548\u3002\u5f53\u88ab\u4f9d\u8d56\u670d\u52a1\u6267\u884c stop \u6216 restart \u64cd\u4f5c\u65f6\uff0c\u672c\u670d\u52a1\u4e5f\u4f1a\u6267\u884c\u64cd\u4f5c\uff0c\u4f46\u672c\u670d\u52a1\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u4e0d\u4f1a\u5f71\u54cd\u88ab\u4f9d\u8d56\u670d\u52a1\u3002\u4e00\u822c\u7528\u4e8e\u7ec4\u5408 target \u4f7f\u7528\uff0c\u6bd4\u5982 a.service \u548c b.service \u90fd\u914d\u7f6e PartOf=c.target\uff0c\u90a3\u4e48 stop c \u7684\u65f6\u5019\uff0c\u4e5f\u4f1a\u540c\u65f6 stop a \u548c b\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Conflicts"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5b9a\u4e49\u51b2\u7a81\u7684\u670d\u52a1\uff0c\u672c\u670d\u52a1\u548c\u88ab\u51b2\u7a81\u670d\u52a1\u7684\u72b6\u6001\u5fc5\u987b\u76f8\u53cd\u3002\u5f53\u672c\u670d\u52a1\u8981\u542f\u52a8\u65f6\uff0c\u5c06\u4f1a\u505c\u6b62\u76ee\u6807\u670d\u52a1\uff0c\u5f53\u542f\u52a8\u76ee\u6807\u670d\u52a1\u65f6\uff0c\u5c06\u4f1a\u505c\u6b62\u672c\u670d\u52a1\u3002\u542f\u52a8\u548c\u505c\u6b62\u7684\u64cd\u4f5c\u540c\u65f6\u8fdb\u884c\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u60f3\u8981\u8ba9\u672c\u670d\u52a1\u5728\u76ee\u6807\u670d\u52a1\u542f\u52a8\u4e4b\u524d\u5c31\u5df2\u7ecf\u5904\u4e8e\u505c\u6b62\u72b6\u6001\uff0c\u5219\u5fc5\u987b\u5b9a\u4e49 After/Before\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OnFailure"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5f53\u672c\u670d\u52a1\u5904\u4e8e failed \u65f6\uff0c\u5c06\u542f\u52a8\u76ee\u6807\u670d\u52a1\u3002\u5982\u679c\u672c\u670d\u52a1\u914d\u7f6e\u4e86 Restart \u91cd\u542f\u6307\u4ee4\uff0c\u5219\u5728\u8017\u5c3d\u91cd\u542f\u6b21\u6570\u4e4b\u540e\uff0c\u672c\u670d\u52a1\u624d\u4f1a\u8fdb\u5165 failed\u3002\u6709\u65f6\u5019\u8fd9\u662f\u975e\u5e38\u6709\u7528\u7684\uff0c\u4e00\u4e2a\u5178\u578b\u7528\u6cd5\u662f\u672c\u670d\u52a1\u5931\u8d25\u65f6\u8c03\u7528\u5b9a\u4e49\u4e86\u90ae\u4ef6\u53d1\u9001\u529f\u80fd\u7684 service \u6765\u53d1\u9001\u90ae\u4ef6\uff0c\u7279\u522b\u5730\uff0c\u53ef\u4ee5\u7ed3\u5408 systemd.timer \u5b9a\u65f6\u4efb\u52a1\u5b9e\u73b0 cron \u7684 MAILTO \u529f\u80fd\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"RefuseManualStart",(0,a.kt)("br",null),"RefuseManualStop"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c\u670d\u52a1\u4e0d\u5141\u8bb8\u624b\u52a8\u542f\u52a8\u548c\u624b\u52a8\u505c\u6b62\uff0c\u53ea\u80fd\u88ab\u4f9d\u8d56\u65f6\u7684\u542f\u52a8\u548c\u505c\u6b62\uff0c\u5982\u679c\u624b\u52a8\u542f\u52a8\u6216\u505c\u6b62\uff0c\u5219\u4f1a\u62a5\u9519\u3002\u6709\u4e9b\u7279\u6b8a\u7684\u670d\u52a1\u975e\u5e38\u5173\u952e\uff0c\u6216\u8005\u67d0\u670d\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u5927\u670d\u52a1\u7684\u4e00\u90e8\u5206\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u5b89\u5168\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528\u8be5\u7279\u6027\u3002\u4f8b\u5982\uff0c\u7cfb\u7edf\u5ba1\u8ba1\u670d\u52a1 auditd.service \u4e2d\u914d\u7f6e\u4e86\u4e0d\u5141\u8bb8\u624b\u52a8\u505c\u6b62\u6307\u4ee4 RefuseManualStop\uff0cnetwork.target \u4e2d\u914d\u7f6e\u4e86\u4e0d\u5141\u8bb8\u624b\u52a8\u542f\u52a8\u6307\u4ee4 RefuseManualStart\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"AllowIsolated"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5141\u8bb8\u4f7f\u7528 systemctl isolate \u5207\u6362\u5230\u672c\u670d\u52a1\uff0c\u53ea\u914d\u7f6e\u5728 target \u4e2d\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u7528\u6237\u670d\u52a1\u662f\u7edd\u4e0d\u53ef\u80fd\u7528\u5230\u8fd9\u4e00\u9879\u7684\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ConditionPathExists",(0,a.kt)("br",null)," AssertPathExists"),(0,a.kt)("td",{parentName:"tr",align:null},"\u8981\u6c42\u7ed9\u5b9a\u7684\u7edd\u5bf9\u8def\u5f84\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u5426\u5219\u4e0d\u505a\u4efb\u4f55\u4e8b(condition) \u6216\u8fdb\u5165 failed \u72b6\u6001(assert)\uff0c\u53ef\u5728\u8def\u5f84\u524d\u4f7f\u7528!\u8868\u793a\u6761\u4ef6\u53d6\u53cd\uff0c\u5373\u4e0d\u5b58\u5728\u65f6\u624d\u542f\u52a8\u670d\u52a1\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ConditionPathIsDirectory",(0,a.kt)("br",null),"AssertPathIsDirectory"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5982\u4e0a\uff0c\u8def\u5f84\u5b58\u5728\u4e14\u662f\u76ee\u5f55\u65f6\u542f\u52a8\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ConditionPathIsReadWrite",(0,a.kt)("br",null),"AssertPathIsReadWrite"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5982\u4e0a\uff0c\u8def\u5f84\u5b58\u5728\u4e14\u53ef\u8bfb\u53ef\u5199\u65f6\u542f\u52a8\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ConditionFileIsExecutable",(0,a.kt)("br",null),"AssertFileIsExecutable"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5982\u4e0a\uff0c\u8def\u5f84\u5b58\u5728\u4e14\u662f\u53ef\u6267\u884c\u666e\u901a\u6587\u4ef6\u65f6\u542f\u52a8\u3002")))),(0,a.kt)("p",null,"\u5bf9\u4e8e\u81ea\u5b9a\u4e49\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u6765\u8bf4\uff0c\u9700\u8981\u5b9a\u4e49\u7684\u5e38\u89c1\u6307\u4ee4\u5305\u62ec Description\u3001After\u3001Wants \u53ca\u53ef\u80fd\u9700\u8981\u7684\u6761\u4ef6\u5224\u65ad\u7c7b\u6307\u4ee4\u3002\u6240\u4ee5\uff0cUnit \u6bb5\u843d\u662f\u975e\u5e38\u7b80\u5355\u7684\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"[",(0,a.kt)("em",{parentName:"p"},"Install"),"]"," \u6bb5\u843d\u6307\u4ee4")),(0,a.kt)("p",null,"\u4e0b\u9762\u662f ","[",(0,a.kt)("em",{parentName:"p"},"Install"),"]"," \u6bb5\u843d\u76f8\u5173\u7684\u6307\u4ee4\uff0c\u5b83\u4eec\u53ea\u5728 systemctl enable/disable \u64cd\u4f5c\u65f6\u6709\u6548\u3002\u5982\u679c\u671f\u671b\u670d\u52a1\u5f00\u673a\u81ea\u542f\u52a8\uff0c\u4e00\u822c\u53ea\u914d\u7f6e\u4e00\u4e2a WantedBy \u6307\u4ee4\uff0c\u5982\u679c\u4e0d\u671f\u671b\u670d\u52a1\u5f00\u673a\u81ea\u542f\u52a8\uff0c\u5219 Install \u6bb5\u843d\u901a\u5e38\u7701\u7565\u3002"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Install \u6307\u4ee4"),(0,a.kt)("th",{parentName:"tr",align:null},"\u542b\u4e49"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"WantedBy"),(0,a.kt)("td",{parentName:"tr",align:null},"\u672c\u670d\u52a1\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u52a8\u65f6\uff0c\u5728\u88ab\u4f9d\u8d56\u76ee\u6807\u7684 .wants \u76ee\u5f55\u4e0b\u521b\u5efa\u672c\u670d\u52a1\u7684\u8f6f\u94fe\u63a5\u3002\u4f8b\u5982 WantedBy = multi-user.target \u65f6\uff0c\u5c06\u5728 /etc/systemd/multi-user.target.wants \u76ee\u5f55\u4e0b\u521b\u5efa\u672c\u670d\u52a1\u7684\u8f6f\u94fe\u63a5\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"RequiredBy"),(0,a.kt)("td",{parentName:"tr",align:null},"\u7c7b\u4f3c WantedBy\uff0c\u4f46\u662f\u662f\u5728 .requires \u76ee\u5f55\u4e0b\u521b\u5efa\u8f6f\u94fe\u63a5\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Alias"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6307\u5b9a\u521b\u5efa\u8f6f\u94fe\u63a5\u65f6\u94fe\u63a5\u81f3\u672c\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u7684\u522b\u540d\u6587\u4ef6\u3002\u4f8b\u5982 reboot.target \u4e2d\u914d\u7f6e\u4e86 Alias=ctrl-alt-del.target\uff0c\u5f53\u6267\u884c enable \u65f6\uff0c\u5c06\u521b\u5efa /etc/systemd/system/ctrl-alt-del.service \u8f6f\u94fe\u63a5\u5e76\u6307\u5411 reboot.target\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"DefaultInstance"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5f53\u662f\u4e00\u4e2a\u6a21\u677f\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u65f6(\u5373\u6587\u4ef6\u540d\u4e3a Service","_",(0,a.kt)("a",{parentName:"td",href:"mailto:Name@.service"},"Name@.service"),")\uff0c\u8be5\u6307\u4ee4\u6307\u5b9a\u8be5\u6a21\u677f\u7684\u9ed8\u8ba4\u5b9e\u4f8b\u3002\u4f8b\u5982 ",(0,a.kt)("a",{parentName:"td",href:"mailto:trojan@.service"},"trojan@.service")," \u4e2d\u914d\u7f6e\u4e86 DefaultInstall=server \u65f6\uff0csystemctl enable ",(0,a.kt)("a",{parentName:"td",href:"mailto:trojan@.service"},"trojan@.service")," \u65f6\u5c06\u521b\u5efa\u540d\u4e3a ",(0,a.kt)("a",{parentName:"td",href:"mailto:trojan@server.service"},"trojan@server.service")," \u7684\u8f6f\u94fe\u63a5\u3002")))),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c\u4e0b\u9762\u662f sshd \u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6 /usr/lib/systemd/system/sshd.service\uff0c\u53ea\u770b Unit \u6bb5\u843d\u548c Install \u6bb5\u843d\uff0c\u662f\u5426\u5f88\u7b80\u5355\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/sshd.service \n[Unit]\nDescription=OpenSSH server daemon\nDocumentation=man:sshd(8) man:sshd_config(5)\nAfter=network.target sshd-keygen.service\nWants=sshd-keygen.service\n\n[Service]\n......\n\n[Install]\nWantedBy=multi-user.target\n[root@arm64v8 ~]#\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"[","Service","]"," \u6bb5\u914d\u7f6e")),(0,a.kt)("p",null,"Systemd Service \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 ","[","Service","]"," \u6bb5\u843d\u53ef\u914d\u7f6e\u7684\u6307\u4ee4\u5f88\u591a\uff0c\u53ef\u914d\u7f6e\u5728\u6b64\u6bb5\u843d\u4e2d\u7684\u6307\u4ee4\u6765\u6e90\u6709\u591a\u5904\uff0c\u5305\u62ec\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"man systemd.service \u4e2d\u63cf\u8ff0\u7684\u4e13\u5c5e\u4e8e Service Unit \u7684\u6307\u4ee4\uff0c\u4e00\u822c\u662f\u5b9a\u4e49\u670d\u52a1\u8fdb\u7a0b\u542f\u52a8\u3001\u505c\u6b62\u3001\u91cd\u542f\u7b49\u7ba1\u7406\u884c\u4e3a\u7684\u6307\u4ee4\u3002\u6bd4\u5982 ExecStart \u6307\u4ee4\u6307\u5b9a\u670d\u52a1\u542f\u52a8\u65f6\u6267\u884c\u7684\u547d\u4ee4\u3002"),(0,a.kt)("li",{parentName:"ul"},"man systemd.exec \u4e2d\u63cf\u8ff0\u7684\u6307\u4ee4\uff0c\u4e00\u822c\u662f\u5b9a\u4e49\u670d\u52a1\u8fdb\u7a0b\u7684\u542f\u52a8\u73af\u5883\u3001\u8fd0\u884c\u73af\u5883\u7684\u6307\u4ee4\u3002\u4f8b\u5982\u6307\u5b9a\u5de5\u4f5c\u76ee\u5f55\u3001\u6307\u5b9a\u670d\u52a1\u8fdb\u7a0b\u7684\u8fd0\u884c\u7528\u6237\u3001\u6307\u5b9a\u73af\u5883\u53d8\u91cf\u3001\u6307\u5b9a\u670d\u52a1 OOM \u76f8\u5173\u5c5e\u6027\u7b49\u3002"),(0,a.kt)("li",{parentName:"ul"},"man systemd.kill \u4e2d\u63cf\u8ff0\u7684\u6307\u4ee4\uff0c\u4e00\u822c\u662f\u5b9a\u4e49\u7ec8\u6b62\u670d\u52a1\u8fdb\u7a0b\u76f8\u5173\u7684\u6307\u4ee4\uff0c\u6bd4\u5982\u7ec8\u6b62\u670d\u52a1\u65f6\u53d1\u9001\u4ec0\u4e48\u4fe1\u53f7\u3001\u670d\u52a1\u8fdb\u7a0b\u6ca1\u6740\u6b7b\u65f6\u5982\u4f55\u5904\u7406\u7b49\u3002"),(0,a.kt)("li",{parentName:"ul"},"man resource-control \u4e2d\u63cf\u8ff0\u7684\u6307\u4ee4\uff0c\u4e00\u822c\u662f\u5b9a\u4e49\u670d\u52a1\u8fdb\u7a0b\u5173\u4e8e\u8d44\u6e90\u63a7\u5236\u76f8\u5173\u7684\u6307\u4ee4\uff0c\u5373\u914d\u7f6e\u670d\u52a1\u8fdb\u7a0b\u7684 CGroup\u3002\u6bd4\u5982\u8be5\u670d\u52a1\u8fdb\u7a0b\u6700\u591a\u5141\u8bb8\u4f7f\u7528\u591a\u5c11\u5185\u5b58\u3001\u4f7f\u7528\u54ea\u4e9b CPU\u3001\u6700\u591a\u5360\u7528\u591a\u5c11\u767e\u5206\u6bd4\u7684 CPU \u65f6\u95f4\u7b49\u3002")),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c/usr/lib/systemd/system/rsyslog.service \u6587\u4ef6\u7684\u5185\u5bb9\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[Service]\nEnvironmentFile=-/etc/sysconfig/rsyslog             # \u6765\u81easystemd.exec\nUMask=0066                                          # \u6765\u81easystemd.exec\nStandardOutput=null                                 # \u6765\u81easystemd.exec\n\nType=notify                                         # \u6765\u81easystemd.service\nExecStart=/usr/sbin/rsyslogd -n $SYSLOGD_OPTIONS    # \u6765\u81easystemd.service\nRestart=on-failure                                  # \u6765\u81easystemd.service\n")),(0,a.kt)("p",null,"\u518d\u6bd4\u5982\uff0c\u60f3\u8981\u9650\u5236\u4e00\u4e2a\u670d\u52a1\u6700\u591a\u5141\u8bb8\u4f7f\u7528 300M \u5185\u5b58(\u6bd4\u5982 512M \u7684 vps \u4e3b\u673a\u8fd0\u884c\u4e00\u4e2a\u6bd4\u8f83\u8017\u5185\u5b58\u7684\u535a\u5ba2\u7cfb\u7edf\u65f6\uff0c\u53ef\u8bbe\u7f6e\u5185\u5b58\u4f7f\u7528\u9650\u5236)\uff0c\u6700\u591a 30% CPU \u65f6\u95f4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[Service]\nMemoryLimit=300M\nCPUQuota=30%\nExecStart=xxx\n")),(0,a.kt)("p",null,"\u6b64\u5916\u8fd8\u9700\u8981\u4e86\u89e3 systemd \u7684\u4e00\u9879\u529f\u80fd\uff0csystemctl set-property\uff0c\u5b83\u53ef\u4ee5\u5728\u7ebf\u4fee\u6539\u5df2\u542f\u52a8\u670d\u52a1\u7684\u5c5e\u6027\u3002\u4f8b\u5982"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u76f4\u63a5\u9650\u5236\uff0c\u4e14\u5199\u5165\u914d\u7f6e\u6587\u4ef6\uff0c\u6240\u4ee5\u4e0b\u6b21\u542f\u52a8\u670d\u52a1\u4e5f\u4f1a\u88ab\u9650\u5236\n[root@arm64v8 ~]# ll /etc/systemd/system/sshd.service.d/\ntotal 0\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# systemctl set-property sshd.service CPUQuota=20% \n[root@arm64v8 ~]# systemctl set-property sshd.service MemoryLimit=100M \n[root@arm64v8 ~]# \n[root@arm64v8 ~]# ll /etc/systemd/system/sshd.service.d/\ntotal 8\n-rw-r--r--. 1 root root 23 Aug  3 08:58 50-CPUQuota.conf\n-rw-r--r--. 1 root root 32 Aug  3 08:58 50-MemoryLimit.conf\n[root@arm64v8 ~]#\n\n# \u76f4\u63a5\u9650\u5236\uff0c\u4e0d\u5199\u5165\u914d\u7f6e\u6587\u4ef6\uff0c\u6240\u4ee5\u4e0b\u6b21\u542f\u52a8\u670d\u52a1\u4e0d\u4f1a\u88ab\u9650\u5236\n[root@arm64v8 ~]# systemctl set-property nginx MemoryLimit=100M --runtime\n")),(0,a.kt)("p",null,"\u76ee\u524d\u6765\u8bf4\uff0c\u53ef\u4ee5\u4e0d\u7528\u8fc7\u591a\u5173\u6ce8\u6765\u81ea\u5176\u5b83\u4f4d\u7f6e\u7684\u6307\u4ee4\uff0c\u5e94\u8be5\u7ed9\u4e88\u91cd\u70b9\u5173\u6ce8\u7684\u662f\u6765\u81ea systemd.service \u81ea\u8eab\u7684\u6307\u4ee4\uff0c\u6bd4\u5982\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Type\uff1a\u6307\u5b9a\u670d\u52a1\u7684\u7ba1\u7406\u7c7b\u578b"),(0,a.kt)("li",{parentName:"ul"},"ExecStart\uff1a\u6307\u5b9a\u542f\u52a8\u670d\u52a1\u65f6\u6267\u884c\u7684\u547d\u4ee4\u884c"),(0,a.kt)("li",{parentName:"ul"},"ExecStop\uff1a\u6307\u5b9a\u505c\u6b62\u670d\u52a1\u65f6\u8fd0\u884c\u7684\u547d\u4ee4"),(0,a.kt)("li",{parentName:"ul"},"ExecReload\uff1a\u6307\u5b9a\u91cd\u8f7d\u670d\u52a1\u8fdb\u7a0b\u65f6\u8fd0\u884c\u7684\u547d\u4ee4"),(0,a.kt)("li",{parentName:"ul"},"Restart\uff1a\u6307\u5b9a systemd \u662f\u5426\u8981\u81ea\u52a8\u91cd\u542f\u670d\u52a1\u8fdb\u7a0b\u4ee5\u53ca\u4ec0\u4e48\u60c5\u51b5\u4e0b\u91cd\u542f")),(0,a.kt)("p",null,"\u7279\u522b\u662f Type \u6307\u4ee4\uff0c\u5b83\u76f4\u63a5\u5f71\u54cd ","[","Service","]"," \u6bb5\u4e2d\u7684\u591a\u9879\u914d\u7f6e\u65b9\u5f0f\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"simple"),(0,a.kt)("li",{parentName:"ul"},"exec"),(0,a.kt)("li",{parentName:"ul"},"forking"),(0,a.kt)("li",{parentName:"ul"},"oneshot"),(0,a.kt)("li",{parentName:"ul"},"dbus"),(0,a.kt)("li",{parentName:"ul"},"notify"),(0,a.kt)("li",{parentName:"ul"},"idle")),(0,a.kt)("p",null,"\u5982\u679c\u914d\u7f6e\u7684\u662f\u670d\u52a1\u8fdb\u7a0b\uff0cType \u7684\u503c\u5f88\u53ef\u80fd\u662f forking \u6216 simple\uff0c\u5982\u679c\u662f\u666e\u901a\u547d\u4ee4\u7684\u8fdb\u7a0b\uff0cType \u7684\u503c\u53ef\u80fd\u662f simple\u3001oneshot\u3002"),(0,a.kt)("p",null,"\u800c dbus \u7c7b\u578b\u4e00\u822c\u60c5\u51b5\u4e0b\u7528\u4e0d\u4e0a\uff0cnotify \u8981\u6c42\u670d\u52a1\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u4ee3\u7801\u5bf9 systemd notify \u8fdb\u884c\u652f\u6301\uff0c\u6240\u4ee5\u591a\u6570\u60c5\u51b5\u4e0b\u53ef\u80fd\u4e5f\u7528\u4e0d\u4e0a\u3002"),(0,a.kt)("h4",{id:"11324systemd-servicetypeforking"},"11.3.2.4\u3001systemd service\uff1aType=forking"),(0,a.kt)("p",null,"\u5f53\u4f7f\u7528 systemd \u53bb\u7ba1\u7406\u4e00\u4e2a\u957f\u4e45\u8fd0\u884c\u7684\u670d\u52a1\u8fdb\u7a0b\u65f6\uff0c\u6700\u5e38\u7528\u7684 Type \u662f forking \u7c7b\u578b\u3002"),(0,a.kt)("p",null,"\u4f7f\u7528 Type=forking \u65f6\uff0c\u8981\u6c42 ExecStart \u542f\u52a8\u7684\u547d\u4ee4\u81ea\u8eab\u5c31\u662f\u4ee5 daemon \u6a21\u5f0f\u8fd0\u884c\u7684\u3002\u800c\u4ee5 daemon \u6a21\u5f0f\u8fd0\u884c\u7684\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u7279\u6027\uff1a\u603b\u662f\u4f1a\u6709\u4e00\u4e2a\u77ac\u95f4\u9000\u51fa\u7684\u4e2d\u95f4\u7236\u8fdb\u7a0b\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff0cnginx \u547d\u4ee4\u9ed8\u8ba4\u4ee5 daemon \u6a21\u5f0f\u8fd0\u884c\uff0c\u6240\u4ee5\u53ef\u76f4\u63a5\u5c06\u5176\u914d\u7f6e\u4e3a forking \u7c7b\u578b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cp /usr/lib/systemd/system/nginx.service /usr/lib/systemd/system/nginx.service.backup\n[root@arm64v8 ~]# cat /usr/lib/systemd/system/nginx.service\n[Unit]\nDescription = Rewrite by Brinnatt@gmail.com for understanding Type=forking\n\n[Service]\nType = forking\nExecStart = /usr/sbin/nginx\n[root@arm64v8 ~]#\n[root@arm64v8 ~]# systemctl daemon-reload\n[root@arm64v8 ~]# systemctl start nginx.service\n[root@arm64v8 ~]# systemctl status nginx.service\n\u25cf nginx.service - Rewrite by Brinnatt@gmail.com for understanding Type=forking\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; static; vendor preset: disabled)\n   Active: active (running) since Tue 2021-08-03 09:11:49 EDT; 6s ago\n  Process: 18029 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)\n Main PID: 18030 (nginx)\n   Memory: 59.4M\n   CGroup: /system.slice/nginx.service\n           \u251c\u250018030 nginx: master process /usr/sbin/nginx\n           \u251c\u250018031 nginx: worker process\n           \u251c\u250018032 nginx: worker process\n           \u251c\u250018033 nginx: worker process\n           \u251c\u250018034 nginx: worker process\n           \u251c\u250018035 nginx: worker process\n           \u251c\u250018036 nginx: worker process\n           \u251c\u250018037 nginx: worker process\n           \u251c\u250018038 nginx: worker process\n           \u251c\u250018039 nginx: worker process\n           \u251c\u250018040 nginx: worker process\n           \u251c\u250018041 nginx: worker process\n           \u251c\u250018042 nginx: worker process\n           \u251c\u250018043 nginx: worker process\n           \u251c\u250018044 nginx: worker process\n           \u251c\u250018045 nginx: worker process\n           \u2514\u250018046 nginx: worker process\n......\n[root@arm64v8 ~]#\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6ce8\u610f\u4e0a\u9762 status \u62a5\u544a\u7684\u4fe1\u606f\u4e2d\uff0cExecStart \u542f\u52a8\u7684 nginx \u7684\u8fdb\u7a0b PID=18029\uff0c\u4e14\u8be5\u8fdb\u7a0b\u7684\u72b6\u6001\u662f\u5df2\u9000\u51fa\uff0c\u9000\u51fa\u72b6\u6001\u7801\u4e3a 0\uff0c\u8fd9\u4e2a\u8fdb\u7a0b\u662f daemon \u7c7b\u8fdb\u7a0b\u521b\u5efa\u8fc7\u7a0b\u4e2d\u77ac\u95f4\u9000\u51fa\u7684\u4e2d\u95f4\u7236\u8fdb\u7a0b\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5728 forking \u7c7b\u578b\u4e2d\uff0c\u8be5\u8fdb\u7a0b\u79f0\u4e3a\u521d\u59cb\u5316\u8fdb\u7a0b\u3002\u540c\u65f6\u8fd8\u6709\u4e00\u884c Main PID: 18030 (nginx)\uff0c\u8fd9\u662f systemd \u771f\u6b63\u76d1\u63a7\u7684 nginx \u670d\u52a1\u4e3b\u8fdb\u7a0b\uff0c\u5176 PID=18030\uff0c\u662f PID=18029 \u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\u3002")),(0,a.kt)("p",null,"Type=forking \u7c7b\u578b\u4ee3\u8868\u4ec0\u4e48\u5462\uff1f\u8981\u89e3\u91ca\u6e05\u695a\u8be5 type\uff0c\u9700\u4ece\u8fdb\u7a0b\u521b\u5efa\u5f00\u59cb\u8bf4\u8d77\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"systemd fork daemon",src:n(90977).Z,width:"717",height:"805"})),(0,a.kt)("p",null,"\u4e0b\u9762\u6211\u4eec\u6765\u68b3\u7406\u4e00\u4e0b\u8fd9\u4e2a\u8fc7\u7a0b\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"systemd \u4f5c\u4e3a\u7528\u6237\u7a7a\u95f4\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\u7531\u5185\u6838\u52a0\u8f7d\u3002"),(0,a.kt)("li",{parentName:"ol"},"systemd \u8d1f\u8d23\u52a0\u8f7d\u6240\u6709\u7684 daemon \u8fdb\u7a0b\u3002",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"\u4ee5 nginx \u4e3a\u4f8b\uff0c\u5728 nginx \u670d\u52a1\u8fdb\u7a0b\u542f\u52a8\u65f6\uff0c\u7531 pid=1 \u7684 systemd \u8fdb\u7a0b fork() \u4e00\u4e2a\u5b50 systemd \u8fdb\u7a0b(pid=18029)\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u5b50 systemd \u8fdb\u7a0b\u5206\u652f\u901a\u8fc7 systemd.exec \u914d\u7f6e\u8be5\u5b50\u8fdb\u7a0b\u73af\u5883\uff0c\u7136\u540e\u4f7f\u7528 exec() \u53bb\u8c03\u7528 ExecStart \u6307\u5b9a\u7684 nginx \u670d\u52a1\u542f\u52a8\u547d\u4ee4\u3002"),(0,a.kt)("li",{parentName:"ol"},"exec() \u8c03\u7528\u7a0b\u5e8f\u65f6\u4f1a\u66ff\u6362\u5f53\u524d\u8fdb\u7a0b\uff0c\u6240\u4ee5\u542f\u52a8\u540e\u7684 nginx \u670d\u52a1\u8fdb\u7a0b(pid=18030) \u5c06\u4f1a\u66ff\u4ee3\u5b50 systemd \u8fdb\u7a0b(pid=18029)\uff0c\u6700\u7ec8 nginx \u670d\u52a1\u8fdb\u7a0b\u81ea\u8eab\u6210\u4e3a systemd(pid=1) \u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\u3002")))),(0,a.kt)("p",null,"\u5bf9\u4e8e Type=forking \u6765\u8bf4\uff0cpid=1 \u7684 systemd \u8fdb\u7a0b fork \u51fa\u6765\u7684\u5b50\u8fdb\u7a0b\u6b63\u662f\u77ac\u95f4\u9000\u51fa\u7684\u4e2d\u95f4\u7236\u8fdb\u7a0b\uff0c\u4e14 systemd \u4f1a\u5728\u4e2d\u95f4\u7236\u8fdb\u7a0b\u9000\u51fa\u540e\u5c31\u8ba4\u4e3a\u670d\u52a1\u542f\u52a8\u6210\u529f\uff0c\u6b64\u65f6 systemd \u53ef\u4ee5\u7acb\u5373\u53bb\u542f\u52a8\u540e\u7eed\u9700\u8981\u542f\u52a8\u7684\u670d\u52a1\u3002"),(0,a.kt)("p",null,"\u5982\u679c Type=forking \u670d\u52a1\u4e2d\u7684\u542f\u52a8\u547d\u4ee4\u662f\u4e00\u4e2a\u524d\u53f0\u547d\u4ee4\u4f1a\u5982\u4f55\u5462\uff1f\u6bd4\u5982\u5c06 sleep \u914d\u7f6e\u4e3a forking \u6a21\u5f0f\uff0c\u5c06 nginx daemon off \u914d\u7f6e\u4e3a forking \u6a21\u5f0f\u7b49\u3002"),(0,a.kt)("p",null,"\u7b54\u6848\u662f systemd \u4f1a\u4e00\u76f4\u7b49\u5f85\u4e2d\u95f4 ExecStart \u542f\u52a8\u7684\u8fdb\u7a0b\u4f5c\u4e3a\u4e2d\u95f4\u7236\u8fdb\u7a0b\u9000\u51fa\uff0c\u5728\u7b49\u5f85\u8fc7\u7a0b\u4e2d\uff0csystemctl start \u4f1a\u4e00\u76f4\u5361\u4f4f\uff0c\u76f4\u5230\u7b49\u5f85\u8d85\u65f6\u800c\u5931\u8d25\uff0c\u5728\u6b64\u9636\u6bb5\u4e2d\uff0csystemctl status \u5c06\u4f1a\u67e5\u770b\u5230\u670d\u52a1\u5904\u4e8e activating \u72b6\u6001\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/nginx.service\n[Unit]\nDescription = Rewrite by Brinnatt@gmail.com for understanding Type=forking\n\n[Service]\nType = forking\nExecStart = /usr/sbin/nginx -g 'daemon off;'\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# systemctl daemon-reload \n[root@arm64v8 ~]# systemctl start nginx.service\n`\u5361\u4f4f\u4e86`\n\n# \u590d\u5236\u4e00\u4e2a\u4f1a\u8bdd\u7ec8\u7aef\n[root@arm64v8 ~]# systemctl status nginx\n\u25cf nginx.service - Rewrite by Brinnatt@gmail.com for understanding Type=forking\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; static; vendor preset: disabled)\n   Active: activating (start) since Tue 2021-08-03 09:37:43 EDT; 20s ago\n  Control: 18118 (nginx)\n   Memory: 43.7M\n   CGroup: /system.slice/nginx.service\n           \u251c\u250018118 nginx: master process /usr/sbin/nginx -g daemon off;\n           \u251c\u250018119 nginx: worker process\n           \u251c\u250018120 nginx: worker process\n           \u251c\u250018121 nginx: worker process\n           \u251c\u250018122 nginx: worker process\n           \u251c\u250018123 nginx: worker process\n           \u251c\u250018124 nginx: worker process\n           \u251c\u250018125 nginx: worker process\n           \u251c\u250018126 nginx: worker process\n           \u251c\u250018127 nginx: worker process\n           \u251c\u250018128 nginx: worker process\n           \u251c\u250018129 nginx: worker process\n           \u251c\u250018130 nginx: worker process\n           \u251c\u250018131 nginx: worker process\n           \u251c\u250018132 nginx: worker process\n           \u251c\u250018133 nginx: worker process\n           \u2514\u250018134 nginx: worker process\n......\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u5f53\u8bbe\u7f6e Type=forking \u65f6\uff0c\u6709\u4e00\u4e2a GuessMainPID \u6307\u4ee4\u5176\u9ed8\u8ba4\u503c\u4e3a yes\uff0c\u5b83\u8868\u793a systemd \u4f1a\u901a\u8fc7\u4e00\u4e9b\u7b97\u6cd5\u53bb\u731c\u6d4bMain PID\uff0c\u56e0\u4e3a Main PID \u7684\u7236\u8fdb\u7a0b\u5df2\u77ac\u95f4\u9000\u51fa\uff0c\u5982\u679c\u731c\u9519\u4e86\u5c06\u5bfc\u81f4\u670d\u52a1\u542f\u52a8\u5f02\u5e38\uff0c\u8fd9\u4e5f\u662f\u6709\u53ef\u80fd\u7684\u3002"),(0,a.kt)("p",null,"\u597d\u5728\uff0cType=forking \u65f6\u7684 systemd \u63d0\u4f9b\u4e86 PIDFile \u6307\u4ee4( Type=forking \u901a\u5e38\u90fd\u4f1a\u7ed3\u5408 PIDFile \u6307\u4ee4)\uff0csystemd \u4f1a\u4ece PIDFile \u6307\u4ee4\u6240\u6307\u5b9a\u7684 PID \u6587\u4ef6\u4e2d\u83b7\u53d6\u670d\u52a1\u7684\u4e3b\u8fdb\u7a0b PID\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c\u7f16\u5199\u4e00\u4e2a nginx \u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/nginx.service\n[Unit]\nDescription = Rewrite by Brinnatt@gmail.com for understanding Type=forking\n\n[Service]\nType = forking\nPIDFile = /run/nginx.pid\nExecStartPre = /usr/bin/rm -f /run/nginx.pid\nExecStart = /usr/sbin/nginx\nExecStartPost = /usr/bin/sleep 0.1\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u5173\u4e8e PIDFile\uff0c\u6709\u5fc5\u8981\u53bb\u4e86\u89e3\u4e00\u4e9b\u6ce8\u610f\u4e8b\u9879\uff0c\u5426\u5219\u5b83\u4eec\u53ef\u80fd\u5c31\u4f1a\u6210\u4e3a\u4f60\u7684\u5751\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u9996\u5148\uff0cPIDFile \u53ea\u9002\u5408\u5728 Type=forking \u6a21\u5f0f\u4e0b\u4f7f\u7528\uff0c\u5176\u5b83\u65f6\u5019\u6ca1\u5fc5\u8981\u4f7f\u7528\uff0c\u56e0\u4e3a\u5176\u5b83\u7c7b\u578b\u7684 Service \u4e3b\u8fdb\u7a0b\u7684 PID \u90fd\u662f\u786e\u5b9a\u7684\u3002"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"systemd \u63a8\u8350 PIDFile \u6307\u5b9a\u7684 PID \u6587\u4ef6\u5728 /run \u76ee\u5f55\u4e0b\uff0c\u6240\u4ee5\uff0c\u53ef\u80fd\u9700\u8981\u4fee\u6539\u670d\u52a1\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5c06\u5176 PID \u6587\u4ef6\u8def\u5f84\u4fee\u6539\u4e3a /run \u76ee\u5f55\u4e4b\u4e0b\uff0c\u5f53\u7136\u8fd9\u5e76\u975e\u5fc5\u987b\u3002\u4f46\u6709\u4e00\u70b9\u5fc5\u987b\u6ce8\u610f\uff0cPIDFile \u6307\u4ee4\u7684\u503c\u8981\u548c\u670d\u52a1\u7a0b\u5e8f\u7684 PID \u6587\u4ef6\u8def\u5f84\u4fdd\u6301\u4e00\u81f4\u3002")),(0,a.kt)("p",{parentName:"li"},"\u4f8b\u5982 nginx \u7684\u76f8\u5173\u914d\u7f6e\uff1a"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'[root@arm64v8 ~]# grep -i "nginx.pid" /etc/nginx/nginx.conf\npid /run/nginx.pid;\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# grep -i "nginx.pid" /usr/lib/systemd/system/nginx.service\nPIDFile = /run/nginx.pid\nExecStartPre = /usr/bin/rm -f /run/nginx.pid\n[root@arm64v8 ~]#\n'))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u5176\u6b21\uff0csystemd \u4f1a\u5728\u4e2d\u95f4\u7236\u8fdb\u7a0b\u9000\u51fa\u540e\u7acb\u5373\u8bfb\u53d6\u8fd9\u4e2a PID \u6587\u4ef6\uff0c\u8bfb\u53d6\u6210\u529f\u540e\u5c31\u8ba4\u4e3a\u8be5\u670d\u52a1\u5df2\u7ecf\u542f\u52a8\u6210\u529f\u3002systemd \u8bfb\u53d6 PIDFile \u7684\u65f6\u5019\uff0c\u670d\u52a1\u4e3b\u8fdb\u7a0b\u53ef\u80fd\u8fd8\u672a\u5c06 PID \u5199\u5165\u5230 PID \u6587\u4ef6\u4e2d\uff0c\u8fd9\u65f6 systemd \u5c06\u51fa\u73b0\u95ee\u9898\u3002"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u6240\u4ee5\uff0c\u5bf9\u4e8e\u670d\u52a1\u7a0b\u5e8f\u7684\u5f00\u53d1\u4eba\u5458\u6765\u8bf4\uff0c\u5e94\u5c3d\u65e9\u5c06\u4e3b\u8fdb\u7a0b\u5199\u5165\u5230 PID \u6587\u4ef6\u4e2d\uff0c\u6bd4\u5982\u53ef\u4ee5\u5728\u4e2d\u95f4\u7236\u8fdb\u7a0b fork \u5b8c\u4e4b\u540e\u7acb\u5373\u5199\u5165 PID \u6587\u4ef6\uff0c\u7136\u540e\u518d\u9000\u51fa\uff0c\u800c\u4e0d\u662f\u5728 fork \u51fa\u6765\u7684\u670d\u52a1\u4e3b\u8fdb\u7a0b\u5185\u90e8\u7531\u4e3b\u8fdb\u7a0b\u8d1f\u8d23\u5199\u5165\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u4e07\u4e00\u67d0\u4e2a\u7248\u672c\u7684 nginx \u51fa\u73b0\u8be5\u95ee\u9898\uff0c\u89e3\u51b3\u529e\u6cd5\u662f\u4f7f\u7528 ExecStartPost=/usr/bin/sleep 0.1\uff0c\u8ba9 systemd \u5728\u521d\u59cb\u5316\u8fdb\u7a0b(\u5373\u4e2d\u95f4\u7236\u8fdb\u7a0b)\u9000\u51fa\u4e4b\u540e\u803d\u6401 0.1 \u79d2\u518d\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\uff0c\u5373\u63a8\u8fdf\u4e86 systemd \u8bfb\u53d6 PID \u7684\u8fc7\u7a0b\uff0c\u4fdd\u8bc1\u80fd\u8ba9 systemd \u4ece PID \u6587\u4ef6\u4e2d\u8bfb\u53d6\u5230\u503c\u3002")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/nginx.service\n[Unit]\nDescription=The nginx HTTP and reverse proxy server\nAfter=network.target remote-fs.target nss-lookup.target\n\n[Service]\nType=forking\nPIDFile=/run/nginx.pid\n# Nginx will fail to start if /run/nginx.pid already exists but has the wrong\n# SELinux context. This might happen when running nginx -t from the cmdline.\n# https://bugzilla.redhat.com/show_bug.cgi?id=1268621\nExecStartPre=/usr/bin/rm -f /run/nginx.pid\nExecStartPre=/usr/sbin/nginx -t\nExecStart=/usr/sbin/nginx\nExecStartPost=/usr/bin/sleep 0.1    # \u52a0\u8fd9\u4e00\u884c\nExecReload=/bin/kill -s HUP $MAINPID\nKillSignal=SIGQUIT\nTimeoutStopSec=5\nKillMode=process\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n[root@arm64v8 ~]#\n")))),(0,a.kt)("p",null,"\u6700\u540e\uff0csystemd \u53ea\u4f1a\u8bfb PIDFile \u6587\u4ef6\u800c\u4e0d\u4f1a\u5199\uff0c\u4e5f\u4e0d\u4f1a\u521b\u5efa\u5b83\u3002\u4f46\u662f\u5728\u505c\u6b62\u670d\u52a1\u7684\u65f6\u5019\uff0csystemd \u4f1a\u5c1d\u8bd5\u5220\u9664 PID \u6587\u4ef6\u3002\u4f46\u662f\u670d\u52a1\u8fdb\u7a0b\u53ef\u80fd\u4f1a\u5f02\u5e38\u7ec8\u6b62\uff0c\u5bfc\u81f4\u5df2\u7ec8\u6b62\u7684\u670d\u52a1\u8fdb\u7a0b\u7684 PID \u6587\u4ef6\u4ecd\u7136\u4fdd\u7559\u7740\uff0c\u6240\u4ee5\u5728\u4f7f\u7528 PIDFile \u6307\u4ee4\u65f6\uff0c\u901a\u5e38\u8fd8\u4f1a\u4f7f\u7528 ExecStartPre \u6307\u4ee4\u6765\u5220\u9664\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u7684 PID \u6587\u4ef6\u3002\u6b63\u5982\u4e0a\u9762\u7ed9\u51fa\u7684 nginx \u914d\u7f6e\u6587\u4ef6\u4e00\u6837\u3002"),(0,a.kt)("h4",{id:"11325systemd-servicetypesimple"},"11.3.2.5\u3001systemd service\uff1aType=simple"),(0,a.kt)("p",null,"Type=simple \u662f\u4e00\u79cd\u6700\u5e38\u89c1\u7684\u901a\u8fc7 systemd \u670d\u52a1\u7cfb\u7edf\u8fd0\u884c\u7528\u6237\u81ea\u5b9a\u4e49\u547d\u4ee4\u7684\u7c7b\u578b\uff0c\u4e5f\u662f\u7701\u7565 Type \u6307\u4ee4\u65f6\u7684\u9ed8\u8ba4\u7c7b\u578b\u3002\u9002\u5408\u90a3\u4e9b\u5728 shell \u4e0b\u8fd0\u884c\u5728\u524d\u53f0\u7684\u547d\u4ee4\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c\u7f16\u5199\u4e00\u4e2a /usr/lib/systemd/system/sleep.service \u8fd0\u884c sleep \u8fdb\u7a0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/sleep.service\n[Unit]\nDescription = written by Brinnatt@gmail.com for testing Type=simple\n\n[Service]\nType = simple\nExecStart = /usr/bin/sleep 10  # \u547d\u4ee4\u5fc5\u987b\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\n[root@arm64v8 ~]#  \n")),(0,a.kt)("p",null,"\u4f7f\u7528 daemon-reload \u91cd\u8f7d\u5e76\u542f\u52a8\u8be5\u670d\u52a1\u8fdb\u7a0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl daemon-reload \n[root@arm64v8 ~]# systemctl start sleep.service \n[root@arm64v8 ~]# systemctl status sleep.service\n\u25cf sleep.service - written by Brinnatt@gmail.com for testing Type=simple\n   Loaded: loaded (/usr/lib/systemd/system/sleep.service; static; vendor preset: disabled)\n   Active: active (running) since Tue 2021-08-03 23:54:54 EDT; 6s ago\n Main PID: 22677 (sleep)\n   Memory: 512.0K\n   CGroup: /system.slice/sleep.service\n           \u2514\u250022677 /usr/bin/sleep 10\n......\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"10 \u79d2\u5185\uff0csleep \u8fdb\u7a0b\u4ee5 daemon \u6a21\u5f0f\u8fd0\u884c\u5728\u540e\u53f0\uff0c\u5c31\u50cf\u4e00\u4e2a\u670d\u52a1\u8fdb\u7a0b\u4e00\u6837\u300210 \u79d2\u4e4b\u540e\uff0csleep \u9000\u51fa\uff0c\u4e8e\u662f systemd \u5c06\u8be5\u8fdb\u7a0b\u4ece\u76d1\u63a7\u961f\u5217\u4e2d\u8e22\u51fa\u3002\u518d\u6b21\u67e5\u770b\u8fdb\u7a0b\u7684\u72b6\u6001\u5c06\u662f inactive\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl status sleep.service\n\u25cf sleep.service - written by Brinnatt@gmail.com for testing Type=simple\n   Loaded: loaded (/usr/lib/systemd/system/sleep.service; static; vendor preset: disabled)\n   Active: inactive (dead)\n......\n")),(0,a.kt)("p",null,"\u4e0a\u9762\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"ExecStart")," \u6307\u4ee4\u6307\u5b9a\u542f\u52a8\u672c\u670d\u52a1\u65f6\u6267\u884c\u7684\u547d\u4ee4\uff0c\u5373\u542f\u52a8\u4e00\u4e2a\u672c\u8be5\u524d\u53f0\u8fd0\u884c\u7684 sleep \u8fdb\u7a0b\u4f5c\u4e3a\u670d\u52a1\u8fdb\u7a0b\u5728\u540e\u53f0\u8fd0\u884c\u3002"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"\u6ce8\u610f\uff1asystemd service \u7684\u547d\u4ee4\u884c\u4e2d\u5fc5\u987b\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\uff0c\u4e14\u53ea\u80fd\u7f16\u5199\u5355\u6761\u547d\u4ee4(Type=oneshot\u65f6\u9664\u5916)\uff0c\u5982\u679c\u8981\u547d\u4ee4\u7eed\u884c\uff0c\u53ef\u5728\u5c3e\u90e8\u4f7f\u7528\u53cd\u659c\u7ebf\u7b26\u53f7 ","\\"," \u7b49\u3002\u6b64\u5916\uff0c\u547d\u4ee4\u884c\u4e2d\u652f\u6301\u90e8\u5206\u7c7b\u4f3c Shell \u7684\u7279\u6b8a\u7b26\u53f7\uff0c\u4f46\u4e0d\u652f\u6301\u91cd\u5b9a\u5411 > >> << <\u3001\u7ba1\u9053 |\u3001\u540e\u53f0\u7b26\u53f7 &\uff0c\u5177\u4f53\u53ef\u53c2\u8003 man systemd.service \u4e2d command line \u6bb5\u843d\u7684\u89e3\u91ca\u8bf4\u660e\u3002")),(0,a.kt)("p",null,"\u5f53 Type=simple \u65f6\uff0csystemd \u5c06\u4f1a\u8ba4\u4e3a\u5728 main service process \u88ab fork \u4e4b\u540e unit \u5c31\u5df2\u7ecf\u542f\u52a8\u4e86\uff1b\u800c\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u4e2d ExecStart \u6307\u5b9a\u7684\u670d\u52a1\u5c31\u662f main service process\u3002"),(0,a.kt)("p",null,"\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u5982\u679c main sevice process \u8981\u4e3a\u5176\u5b83\u7cfb\u7edf\u8fdb\u7a0b\u63d0\u4f9b\u529f\u80fd\uff0c\u90a3\u4e48\u6c9f\u901a\u901a\u9053\u5c31\u5e94\u8be5\u5728 service \u542f\u52a8\u4e4b\u524d\u5efa\u7acb\u8d77\u6765\uff1b\u56e0\u4e3a systemd \u5c31\u5728\u521b\u5efa main service process \u4e4b\u540e\uff0c\u5728\u6267\u884c service \u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u4e4b\u524d\uff0c\u8981\u7ee7\u7eed\u542f\u52a8\u4e0b\u4e00\u6279 units\u3002"),(0,a.kt)("p",null,"\u8fd9\u5c31\u610f\u5473\u7740\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"systemctl start")," \u547d\u4ee4\u884c\u542f\u52a8\u7684 Type=simple \u670d\u52a1\uff0c\u5373\u4fbf\u662f services \u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u4e0d\u80fd\u6210\u529f\u6267\u884c\uff0c\u4e5f\u4f1a\u62a5\u544a\u6210\u529f\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u6210\u529f\u6267\u884c services \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u60c5\u51b5\uff0c\u6bd4\u5982\u8bf4 User= \u4e0d\u5b58\u5728\uff0cservices \u4e8c\u8fdb\u5236\u6587\u4ef6\u4e22\u5931\u7b49\u3002")),(0,a.kt)("p",null,"\u5982\u679c simple \u7c7b\u578b\u4e0b ExecStart \u542f\u52a8\u7684\u547d\u4ee4\u672c\u8eab\u5c31\u662f\u4ee5 daemon \u6a21\u5f0f\u8fd0\u884c\u7684\u5462\uff1f"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5176\u7ed3\u679c\u662f systemd \u9ed8\u8ba4\u4f1a\u7acb\u523b\u6740\u6389\u6240\u6709\u5c5e\u4e8e\u670d\u52a1\u7684\u8fdb\u7a0b\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u539f\u56e0\u4e5f\u5f88\u7b80\u5355\uff0cdaemon \u7c7b\u8fdb\u7a0b\u603b\u662f\u4f1a\u6709\u4e00\u4e2a\u77ac\u95f4\u9000\u51fa\u7684\u4e2d\u95f4\u7236\u8fdb\u7a0b\uff0c\u800c\u5728 simple \u7c7b\u578b\u4e0b\uff0csystemd \u6240 fork \u51fa\u6765\u7684\u5b50\u8fdb\u7a0b\u6b63\u662f\u8fd9\u4e2a\u4e2d\u95f4\u7236\u8fdb\u7a0b\uff0c\u6240\u4ee5 systemd \u4f1a\u7acb\u5373\u53d1\u73b0\u8fd9\u4e2a\u4e2d\u95f4\u7236\u8fdb\u7a0b\u7684\u9000\u51fa\uff0c\u4e8e\u662f\u6740\u6389\u5176\u5b83\u6240\u6709\u670d\u52a1\u8fdb\u7a0b\u3002")),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c\u4ee5\u8fd0\u884c bash -c '(sleep 3000 &)' \u7684 simple \u7c7b\u578b\u7684\u670d\u52a1\uff0c\u88ab systemd \u76d1\u63a7\u7684 bash \u8fdb\u7a0b\u4f1a\u5728\u542f\u52a8 sleep \u540e\u7acb\u5373\u9000\u51fa\uff0c\u4e8e\u662f systemd \u4f1a\u7acb\u5373\u6740\u6389\u5c5e\u4e8e\u8be5\u670d\u52a1\u7684 sleep \u8fdb\u7a0b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/sleep.service\n[Unit]\nDescription = written by Brinnatt@gmail.com for testing Type=simple\n\n[Service]\nType=simple\nExecStart=/usr/bin/bash -c '( /usr/bin/sleep 30 &)'\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# systemctl daemon-reload \n[root@arm64v8 ~]# systemctl start sleep.service \n[root@arm64v8 ~]# systemctl status sleep.service\n\u25cf sleep.service - written by Brinnatt@gmail.com for testing Type=simple\n   Loaded: loaded (/usr/lib/systemd/system/sleep.service; static; vendor preset: disabled)\n   Active: inactive (dead)\n")),(0,a.kt)("p",null,"\u518d\u4f8b\u5982\uff0cnginx \u547d\u4ee4\u9ed8\u8ba4\u662f\u4ee5 daemon \u6a21\u5f0f\u8fd0\u884c\u7684\uff0csimple \u7c7b\u578b\u4e0b\u76f4\u63a5\u4f7f\u7528 nginx \u547d\u4ee4\u542f\u52a8\u670d\u52a1\uff0csystemd \u4f1a\u7acb\u523b\u6740\u6389\u6240\u6709 nginx\uff0c\u5373 nginx \u65e0\u6cd5\u542f\u52a8\u6210\u529f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/nginx.service\n[Unit]\nDescription = Rewrite by Brinnatt@gmail.com for understanding Type=forking\n\n[Service]\nType = simple\nExecStart = /usr/sbin/nginx\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# systemctl daemon-reload \n[root@arm64v8 ~]# systemctl start nginx.service\n[root@arm64v8 ~]# systemctl status nginx.service\n\u25cf nginx.service - Rewrite by Brinnatt@gmail.com for understanding Type=forking\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; static; vendor preset: disabled)\n   Active: inactive (dead)\n")),(0,a.kt)("p",null,"\u4f46\u5982\u679c\u5c06 nginx \u8fdb\u7a0b\u4ee5\u975e daemon \u6a21\u5f0f\u8fd0\u884c\uff0csimple \u7c7b\u578b\u7684 nginx \u670d\u52a1\u5c06\u6b63\u5e38\u542f\u52a8\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/nginx.service\n[Unit]\nDescription = Rewrite by Brinnatt@gmail.com for understanding Type=forking\n\n[Service]\nType = simple\nExecStart = /usr/sbin/nginx -g 'daemon off;'\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# systemctl daemon-reload \n[root@arm64v8 ~]# systemctl start nginx.service\n[root@arm64v8 ~]# systemctl status nginx.service\n\u25cf nginx.service - Rewrite by Brinnatt@gmail.com for understanding Type=forking\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; static; vendor preset: disabled)\n   Active: active (running) since Thu 2021-08-05 01:16:27 EDT; 7s ago\n Main PID: 26463 (nginx)\n   Memory: 58.7M\n   CGroup: /system.slice/nginx.service\n           \u251c\u250026463 nginx: master process /usr/sbin/nginx -g daemon off;\n           \u251c\u250026464 nginx: worker process\n           \u251c\u250026465 nginx: worker process\n           \u251c\u250026466 nginx: worker process\n           \u251c\u250026467 nginx: worker process\n           \u251c\u250026468 nginx: worker process\n           \u251c\u250026469 nginx: worker process\n           \u251c\u250026470 nginx: worker process\n           \u251c\u250026471 nginx: worker process\n           \u251c\u250026472 nginx: worker process\n           \u251c\u250026473 nginx: worker process\n           \u251c\u250026474 nginx: worker process\n           \u251c\u250026475 nginx: worker process\n           \u251c\u250026476 nginx: worker process\n           \u251c\u250026477 nginx: worker process\n           \u251c\u250026478 nginx: worker process\n           \u2514\u250026479 nginx: worker process\n           ......\n")),(0,a.kt)("h4",{id:"11326systemd-service\u5176\u5b83-type"},"11.3.2.6\u3001Systemd Service\uff1a\u5176\u5b83 Type"),(0,a.kt)("p",null,"\u9664\u4e86 simple \u548c forking \u7c7b\u578b\uff0c\u8fd8\u6709 exec\u3001oneshot\u3001idle\u3001notify \u548c dbus \u7c7b\u578b\uff0c\u8fd9\u91cc\u4e0d\u8003\u8651 notify \u548c dbus\uff0c\u5269\u4e0b\u7684 exec\u3001oneshot \u548c idle \u90fd\u7c7b\u4f3c\u4e8e simple \u7c7b\u578b\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"simple\uff1a\u5728 fork \u51fa\u5b50 systemd \u8fdb\u7a0b\u540e\uff0csystemd \u5c31\u8ba4\u4e3a\u8be5\u670d\u52a1\u542f\u52a8\u6210\u529f\u4e86"),(0,a.kt)("li",{parentName:"ul"},"exec\uff1a\u5728 fork \u51fa\u5b50 systemd \u8fdb\u7a0b\u4e14\u5b50 systemd \u8fdb\u7a0b exec() \u8c03\u7528 ExecStart \u547d\u4ee4\u6210\u529f\u540e\uff0csystemd \u8ba4\u4e3a\u8be5\u670d\u52a1\u542f\u52a8\u6210\u529f"),(0,a.kt)("li",{parentName:"ul"},"oneshot\uff1a\u5728 ExecStart \u547d\u4ee4\u6267\u884c\u5b8c\u6210\u9000\u51fa\u540e\uff0csystemd \u624d\u8ba4\u4e3a\u8be5\u670d\u52a1\u542f\u52a8\u6210\u529f",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u56e0\u4e3a\u670d\u52a1\u8fdb\u7a0b\u9000\u51fa\u540e systemd \u624d\u7ee7\u7eed\u5de5\u4f5c\uff0c\u6240\u4ee5\u5728\u672a\u914d\u7f6e RemainAfterExit \u6307\u4ee4\u65f6\uff0coneshot \u7c7b\u578b\u7684\u670d\u52a1\u6c38\u8fdc\u65e0\u6cd5\u51fa\u73b0 active \u72b6\u6001\uff0c\u5b83\u76f4\u63a5\u4ece\u542f\u52a8\u72b6\u6001\u5230 activating \u5230 deactivating \u518d\u5230 dead \u72b6\u6001"),(0,a.kt)("li",{parentName:"ul"},"\u5f53\u7ed3\u5408 RemainAfterExit \u6307\u4ee4\u65f6\uff0c\u5728\u670d\u52a1\u8fdb\u7a0b\u9000\u51fa\u540e\uff0csystemd \u4f1a\u7ee7\u7eed\u76d1\u63a7\u8be5 Unit\uff0c\u6240\u4ee5\u670d\u52a1\u7684\u72b6\u6001\u4e3a active(exited)\uff0c\u901a\u8fc7\u8fd9\u4e2a\u72b6\u6001\u53ef\u4ee5\u8ba9\u7528\u6237\u77e5\u9053\uff0c\u8be5\u670d\u52a1\u66fe\u7ecf\u5df2\u7ecf\u8fd0\u884c\u6210\u529f\uff0c\u800c\u4e0d\u662f\u4ece\u672a\u8fd0\u884c\u8fc7"),(0,a.kt)("li",{parentName:"ul"},"\u901a\u5e38\u6765\u8bf4\uff0c\u5bf9\u4e8e\u90a3\u4e9b\u6267\u884c\u5355\u6b21\u4f46\u65e0\u9700\u957f\u4e45\u8fd0\u884c\u7684\u8fdb\u7a0b\u6765\u8bf4\uff0c\u53ef\u4ee5\u91c7\u7528 type=oneshot\uff0c\u6bd4\u5982\u542f\u52a8 iptables\uff0c\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u7684\u64cd\u4f5c\u3001\u5173\u673a\u6216\u91cd\u542f\u7684\u670d\u52a1\u7b49"))),(0,a.kt)("li",{parentName:"ul"},"idle\uff1aidle \u7684\u8868\u73b0\u884c\u4e3a\u8ddf simple \u5f88\u50cf\uff0c\u4f46\u662f service \u7a0b\u5e8f\u7684\u5b9e\u9645\u6267\u884c\u4f1a\u5ef6\u8fdf\uff0c\u76f4\u5230\u6240\u6709 active jobs \u88ab\u6d3e\u9063\u5b8c\u6210\u3002\u8fd9\u53ef\u4ee5\u7528\u6765\u907f\u514d shell \u670d\u52a1\u7684\u8f93\u51fa\u4e0e\u63a7\u5236\u53f0\u4e0a\u7684\u72b6\u6001\u8f93\u51fa\u76f8\u4ea4\u53c9\u3002\u6b64\u7c7b\u578b\u4ec5\u7528\u4e8e\u6539\u8fdb\u63a7\u5236\u53f0\u8f93\u51fa\uff0c\u5f88\u5c11\u4f1a\u6709\u4eba\u7528\u3002")),(0,a.kt)("h3",{id:"1133\u6a21\u677f\u578b\u670d\u52a1\u914d\u7f6e\u6587\u4ef6"},"11.3.3\u3001\u6a21\u677f\u578b\u670d\u52a1\u914d\u7f6e\u6587\u4ef6"),(0,a.kt)("p",null,"systemd service \u652f\u6301\u7b80\u5355\u7684\u6a21\u677f\u578b Unit \u914d\u7f6e\u6587\u4ef6\uff0c\u5728 Unit \u914d\u7f6e\u6587\u4ef6\u4e2d\u53ef\u4ee5\u4f7f\u7528 %n %N %p %i... \u7b49\u7279\u6b8a\u7b26\u53f7\u8fdb\u884c\u5360\u4f4d\uff0c\u5728 systemd \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u65f6\u4f1a\u5c06\u8fd9\u4e9b\u7279\u6b8a\u7b26\u53f7\u89e3\u6790\u5e76\u66ff\u6362\u6210\u5bf9\u5e94\u7684\u503c\u3002"),(0,a.kt)("p",null,"\u8fd9\u4e9b\u7279\u6b8a\u7b26\u53f7\u7684\u542b\u4e49\u53ef\u53c2\u89c1 man systemd.unit\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\u53ea\u4f1a\u4f7f\u7528\u5230 %i \u6216 %I\uff0c\u5176\u5b83\u7279\u6b8a\u7b26\u53f7\u7528\u5230\u7684\u673a\u4f1a\u8f83\u5c11\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4f7f\u7528 %i %I \u8fd9\u4e24\u4e2a\u7279\u6b8a\u7b26\u53f7\u65f6\uff0c\u8981\u6c42 Unit \u7684\u6587\u4ef6\u540d\u4ee5 @ \u4e3a\u540e\u7f00\uff0c\u5373\u6587\u4ef6\u540d\u683c\u5f0f\u4e3a Service","_",(0,a.kt)("a",{parentName:"li",href:"mailto:Name@.service"},"Name@.service"),"\u3002\u5f53\u4f7f\u7528 systemctl \u7ba1\u7406\u8fd9\u7c7b\u670d\u52a1\u65f6\uff0c@ \u7b26\u53f7\u540e\u9762\u7684\u5b57\u7b26\u4f1a\u4f20\u53c2\u5230 Unit \u6a21\u677f\u6587\u4ef6\u4e2d\u7684 %i \u6216 %I\uff0c\u5b98\u65b9\u79f0\u4e4b\u4e3a\u5b9e\u4f8b\u5316\u3002")),(0,a.kt)("p",null,"\u6709\u65f6\u5019\u8fd9\u662f\u5f88\u5b9e\u7528\u7684\u3002\u6bd4\u5982\u6709\u4e9b\u7a0b\u5e8f\u65e2\u662f\u670d\u52a1\u7aef\u7a0b\u5e8f\u53c8\u662f\u5ba2\u6237\u7aef\u7a0b\u5e8f\uff0c\u533a\u5206\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u4e0d\u540c\u914d\u7f6e\u6587\u4ef6\u3002"),(0,a.kt)("p",null,"\u5047\u8bbe\u7528\u6237\u60f3\u5728\u4e00\u4e2a\u673a\u5668\u4e0a\u540c\u65f6\u8fd0\u884c trojan \u7a0b\u5e8f\u7684\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\uff0c\u53ef\u7f16\u5199\u5982\u4e0b Unit \u670d\u52a1\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/trojan@.service\n[Unit]\nDescription = trojan to flee\n\n[Service]\nType = forking\nExecStart = /usr/local/bin/trojan --config /etc/trojan/%i.conf\n")),(0,a.kt)("p",null,"\u73b0\u5728\u7528\u6237\u53ef\u4ee5\u5728 /etc/trojan \u76ee\u5f55\u4e0b\u540c\u65f6\u63d0\u4f9b\u670d\u52a1\u7a0b\u5e8f\u7684\u670d\u52a1\u7aef\u914d\u7f6e\u6587\u4ef6\u548c\u5ba2\u6237\u7aef\u914d\u7f6e\u6587\u4ef6\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"/etc/trojan/server.conf\n/etc/trojan/client.conf\n")),(0,a.kt)("p",null,"\u5982\u679c\u8981\u7ba1\u7406\u8be5\u4e3b\u673a\u4e0a\u7684\u670d\u52a1\u7aef\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl start trojan@server.service\nsystemctl status trojan@server.service\nsystemctl stop trojan@server.service\nsystemctl enable trojan@server.service\nsystemctl disable trojan@server.service\n")),(0,a.kt)("p",null,"\u5982\u679c\u8981\u7ba1\u7406\u8be5\u4e3b\u673a\u4e0a\u7684\u5ba2\u6237\u7aef\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl start trojan@client.service\nsystemctl status trojan@client.service\nsystemctl stop trojan@client.service\nsystemctl enable trojan@client.service\nsystemctl disable trojan@client.service\n")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"\u6ce8\u610f\uff1aSystemd \u5728\u8fd0\u884c\u670d\u52a1\u65f6\uff0c\u603b\u662f\u4f1a\u5148\u5c1d\u8bd5\u627e\u5230\u4e00\u4e2a\u5b8c\u5168\u5339\u914d\u7684 Unit \u6587\u4ef6\uff0c\u5982\u679c\u6ca1\u6709\u627e\u5230\uff0c\u624d\u4f1a\u5c1d\u8bd5\u9009\u62e9\u5339\u914d\u6a21\u677f\u3002\u6bd4\u5982 systemctl start ",(0,a.kt)("a",{parentName:"em",href:"mailto:trojan@server.service"},"trojan@server.service"),"\uff0csystemd \u4f1a\u5148\u53bb\u627e\u5b8c\u5168\u5339\u914d\u7684 ",(0,a.kt)("a",{parentName:"em",href:"mailto:trojan@server.service"},"trojan@server.service")," \u8fd9\u4e2a Unit \u6587\u4ef6\uff1b\u5982\u679c\u627e\u4e0d\u5230\uff0c\u624d\u4f1a\u4f7f\u7528 ",(0,a.kt)("a",{parentName:"em",href:"mailto:trojan@.service"},"trojan@.service")," \u8fd9\u4e2a\u6a21\u677f\u6587\u4ef6\u5c06\u670d\u52a1\u5b9e\u4f8b\u5316\u3002")),(0,a.kt)("h3",{id:"1134\u4f7f\u7528-target-\u7ec4\u5408\u591a\u4e2a\u670d\u52a1"},"11.3.4\u3001\u4f7f\u7528 target \u7ec4\u5408\u591a\u4e2a\u670d\u52a1"),(0,a.kt)("p",null,"\u6709\u4e9b\u65f6\u5019\uff0c\u4e00\u4e2a\u5927\u578b\u670d\u52a1\u53ef\u80fd\u7531\u591a\u4e2a\u5c0f\u670d\u52a1\u7ec4\u6210\u3002"),(0,a.kt)("p",null,"\u6bd4\u5982 c \u670d\u52a1\u7531 a.service \u548c b.service \u7ec4\u6210\uff0c\u56e0\u4e3a\u7ec4\u5408\u4e86\u4e24\u4e2a\u670d\u52a1\uff0c\u6240\u4ee5 c \u670d\u52a1\u53ef\u4ee5\u5b9a\u4e49\u4e3a c.target\u3002"),(0,a.kt)("p",null,"a.service \u5185\u5bb9\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/a.service \n[Unit]\nDescription = a.service\nPartOf = c.target\nBefore = c.target\n\n[Service]\nExecStart = /usr/local/bin/pinga.sh\n[root@arm64v8 ~]# \n")),(0,a.kt)("p",null,"b.service \u5185\u5bb9\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/b.service \n[Unit]\nDescription = b.service\nPartOf = c.target\nBefore = c.target\n\n[Service]\nExecStart = /usr/local/bin/pingb.sh\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"c.target \u5185\u5bb9\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/c.target \n[Unit]\nDescription = c.service, consists of a.service and b.service\nAfter = a.service b.service\nWants = a.service b.service\n[root@arm64v8 ~]#\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl start c.target\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# systemctl status c.target a.service b.service\n\u25cf c.target - c.service, consists of a.service and b.service\n   Loaded: loaded (/usr/lib/systemd/system/c.target; static; vendor preset: disabled)\n   Active: active since Thu 2021-08-05 22:40:52 EDT; 13s ago\n\nAug 05 22:40:52 arm64v8 systemd[1]: Reached target c.service, consists of a.service and...ce.\nAug 05 22:40:52 arm64v8 systemd[1]: Starting c.service, consists of a.service and b.service.\n\n\u25cf a.service\n   Loaded: loaded (/usr/lib/systemd/system/a.service; static; vendor preset: disabled)\n   Active: active (running) since Thu 2021-08-05 22:40:52 EDT; 13s ago\n Main PID: 28788 (pinga.sh)\n   Memory: 3.6M\n   CGroup: /system.slice/a.service\n           \u251c\u250028788 /bin/bash /usr/local/bin/pinga.sh\n           \u2514\u250028790 ping 10.60.20.74\n\nAug 05 22:40:52 arm64v8 systemd[1]: Started a.service.\nAug 05 22:40:52 arm64v8 systemd[1]: Starting a.service...\n\n\u25cf b.service\n   Loaded: loaded (/usr/lib/systemd/system/b.service; static; vendor preset: disabled)\n   Active: active (running) since Thu 2021-08-05 22:40:52 EDT; 13s ago\n Main PID: 28789 (pingb.sh)\n   Memory: 4.9M\n   CGroup: /system.slice/b.service\n           \u251c\u250028789 /bin/bash /usr/local/bin/pingb.sh\n           \u2514\u250028791 ping 10.60.20.75\n\nAug 05 22:40:52 arm64v8 systemd[1]: Started b.service.\nAug 05 22:40:52 arm64v8 systemd[1]: Starting b.service...\nHint: Some lines were ellipsized, use -l to show in full.\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"c \u4e2d\u914d\u7f6e Wants \u8868\u793a a \u548c b \u5148\u542f\u52a8\uff0c\u4f46\u542f\u52a8\u5931\u8d25\u4e0d\u4f1a\u5f71\u54cd c \u7684\u542f\u52a8\u3002\u5982\u679c\u8981\u6c42 c.target \u548c a.service\u3001b.service \u7684\u542f\u52a8\u72b6\u6001\u4e00\u81f4\uff0c\u53ef\u5c06 Wants \u66ff\u6362\u6210 Requires \u6216 BindsTo \u6307\u4ee4\u3002"),(0,a.kt)("p",null,"PartOf \u6307\u4ee4\u8868\u660e a.service \u548c b.service \u662f c.target \u7684\u4e00\u90e8\u5206\uff0c\u505c\u6b62\u6216\u91cd\u542f c.target \u7684\u540c\u65f6\uff0c\u4e5f\u4f1a\u505c\u6b62\u6216\u91cd\u542f a \u548c b\u3002\u518d\u52a0\u4e0a c.target \u4e2d\u914d\u7f6e\u4e86 Wants \u6307\u4ee4(\u4e5f\u53ef\u4ee5\u6539\u6210 Requires \u6216 BindsTo)\uff0c\u4f7f\u5f97\u542f\u52a8 c \u7684\u65f6\u5019\uff0ca \u548c b \u4e5f\u5df2\u7ecf\u542f\u52a8\u5b8c\u6210\u3002"),(0,a.kt)("p",null,"\u4f46\u662f\u8981\u6ce8\u610f\uff0cPartOf \u662f\u5355\u5411\u7684\uff0c\u505c\u6b62\u548c\u91cd\u542f a \u6216 b \u7684\u65f6\u5019\u4e0d\u4f1a\u5f71\u54cd c\u3002"),(0,a.kt)("h3",{id:"1135systemd-\u5f00\u673a\u81ea\u542f\u4efb\u52a1"},"11.3.5\u3001systemd \u5f00\u673a\u81ea\u542f\u4efb\u52a1"),(0,a.kt)("p",null,"\u5982\u679c\u8981\u8ba9\u4efb\u52a1\u5f00\u673a\u81ea\u542f\u52a8\uff0c\u9700\u5c06\u5bf9\u5e94\u7684 Unit \u6587\u4ef6\u5b58\u653e\u4e8e /etc/systemd/system \u4e0b\u3002\u672c\u6587\u4ee5 Service Unit \u4e3a\u4f8b\uff0c\u4f46\u4e5f\u652f\u6301\u8ba9 path Unit\u3001timer Unit \u7b49\u7c7b\u578b\u7684\u4efb\u52a1\u5f00\u673a\u81ea\u542f\u52a8\u3002"),(0,a.kt)("h4",{id:"11351systemd-\u670d\u52a1\u5f00\u673a\u81ea\u542f"},"11.3.5.1\u3001systemd \u670d\u52a1\u5f00\u673a\u81ea\u542f"),(0,a.kt)("p",null,"\u7528\u6237\u53ef\u4ee5\u624b\u52a8\u5c06\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u81f3\u6b64\u8def\u5f84\uff0c\u4f46\u66f4\u5efa\u8bae\u91c7\u7528 systemd \u7cfb\u7edf\u63d0\u4f9b\u7684\u4e0a\u5c42\u5de5\u5177 systemctl \u6765\u64cd\u4f5c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5c06\u670d\u52a1\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8\nsystemctl enable Service_Name\n\n# \u7981\u6b62\u670d\u52a1\u5f00\u673a\u81ea\u542f\u52a8\nsystemctl disable Service_Name\n\n# \u67e5\u770b\u670d\u52a1\u662f\u5426\u5f00\u673a\u81ea\u542f\u52a8\nsystemctl is-enabled Service_Name\n\n# \u67e5\u770b\u6240\u6709\u5f00\u673a\u81ea\u542f\u52a8\u670d\u52a1\nsystemctl list-unit-files --type service | grep 'enabled'\n")),(0,a.kt)("p",null,"\u4f7f\u7528 systemctl \u547d\u4ee4\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a\u670d\u52a1\u540d\u79f0\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u670d\u52a1\u5bf9\u5e94\u7684\u670d\u52a1\u914d\u7f6e unit \u6587\u4ef6\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u662f\u7b49\u4ef7\u7684\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl enable sshd          # \u670d\u52a1\u540d\nsystemctl enable sshd.service  # \u670d\u52a1\u5bf9\u5e94\u7684unit\u6587\u4ef6\n")),(0,a.kt)("p",null,"systemctl \u7684\u5f88\u591a\u64cd\u4f5c\u90fd\u5177\u5907\u5e42\u7b49\u6027\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u8981\u64cd\u4f5c\u7684\u670d\u52a1\u5df2\u7ecf\u5904\u4e8e\u76ee\u6807\u72b6\u6001\uff0c\u5219\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u505a\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u662f\u672a\u5f00\u673a\u81ea\u542f\u52a8\u7684\u670d\u52a1\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8\u5462\uff1f\u6bd4\u5982\uff0c\u62f7\u8d1d sshd \u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u5c06\u62f7\u8d1d\u540e\u7684\u670d\u52a1 sshd1 \u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cp /usr/lib/systemd/system/{sshd,sshd1}.service\n\n[root@arm64v8 ~]# systemctl enable sshd1\nCreated symlink from /etc/systemd/system/multi-user.target.wants/sshd1.service to /usr/lib/systemd/system/sshd1.service.\n")),(0,a.kt)("p",null,"\u4ece\u7ed3\u679c\u53ef\u770b\u5230\uff0csystemctl \u5c06\u670d\u52a1\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8\u7684\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0a\u662f\u5728 /etc/systemd/system \u67d0\u4e2a target.wants \u76ee\u5f55\u4e0b\u521b\u5efa\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u7684\u8f6f\u94fe\u63a5\u6587\u4ef6\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# readlink /etc/systemd/system/multi-user.target.wants/sshd1.service \n/usr/lib/systemd/system/sshd1.service\n")),(0,a.kt)("p",null,"\u663e\u7136\uff0c\u7981\u7528\u670d\u52a1\u5f00\u673a\u81ea\u542f\u52a8\u7684\u64cd\u4f5c\u662f\u79fb\u9664\u8f6f\u94fe\u63a5\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl disable sshd1\nRemoved symlink /etc/systemd/system/multi-user.target.wants/sshd1.service.\n")),(0,a.kt)("p",null,"\u6700\u540e\uff0c\u5982\u679c\u670d\u52a1\u5df2\u7ecf\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8\uff0c\u4f46\u60f3\u8981\u518d\u6b21\u52a0\u5165(\u6bd4\u5982\u66f4\u65b0\u4e86 /usr/lib/systemd/system \u4e0b\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6)\uff0c\u53ef\u5728 enable \u65f6\u52a0\u4e0a \u2013force \u9009\u9879\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl --force enable Service_Name\n")),(0,a.kt)("h4",{id:"11352systemd-\u4e2d\u81ea\u5b9a\u4e49\u5f00\u673a\u81ea\u542f\u52a8\u547d\u4ee4\u811a\u672c"},"11.3.5.2\u3001systemd \u4e2d\u81ea\u5b9a\u4e49\u5f00\u673a\u81ea\u542f\u52a8\u547d\u4ee4/\u811a\u672c"),(0,a.kt)("p",null,"\u5728 SysV \u7cfb\u7edf\u4e2d\uff0c\u8981\u8ba9\u67d0\u4e2a\u547d\u4ee4\u6216\u67d0\u4e2a\u811a\u672c\u5f00\u673a\u81ea\u542f\u52a8\uff0c\u53ef\u4ee5\u5c06\u547d\u4ee4\u6216\u6267\u884c\u811a\u672c\u7684\u547d\u4ee4\u884c\u5199\u5165 /etc/rc.local\u3002"),(0,a.kt)("p",null,"\u5728 systemd \u4e2d\uff0c\u8981\u8ba9\u67d0\u4e2a\u547d\u4ee4\u6216\u67d0\u4e2a\u811a\u672c\u5f00\u673a\u81ea\u542f\u52a8\uff0c\u8981\u4e48\u5c06\u5176\u7f16\u5199\u6210\u4e00\u4e2a\u5f00\u673a\u81ea\u542f\u52a8\u670d\u52a1\uff0c\u8981\u4e48\u901a\u8fc7 systemd \u517c\u5bb9\u7684 /etc/rc.local\u3002"),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8ba9\u547d\u4ee4(\u811a\u672c)\u5f00\u673a\u81ea\u542f\u52a8\u7684\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/local/bin/ping.sh\n#!/bin/bash\nping 10.60.20.72 >> /tmp/ping.txt\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# cat /usr/lib/systemd/system/ping.service \n[Unit]\nDescription = ping shell script\nConditionFileIsExecutable = /usr/local/bin/ping.sh  # \u8981\u6c42\u811a\u672c\u5177\u6709\u53ef\u6267\u884c\u6743\u9650\n\n[Service]\nExecStart = /usr/local/bin/ping.sh  # \u6307\u5b9a\u8981\u8fd0\u884c\u7684\u547d\u4ee4\u3001\u811a\u672c\n\n[Install]\nWantedBy = multi-user.target    # \u8fd9\u6bb5\u4e0d\u80fd\u5c11\n\n[root@arm64v8 ~]# \n[root@arm64v8 ~]# systemctl daemon-reload \n[root@arm64v8 ~]# systemctl enable ping.service\nCreated symlink from /etc/systemd/system/multi-user.target.wants/ping.service to /usr/lib/systemd/system/ping.service.\n[root@arm64v8 ~]# systemctl start ping.service\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u5982\u679c\u8981\u4f7f\u7528 /etc/rc.local \u7684\u65b9\u5f0f\u5462\uff1fsystemd \u63d0\u4f9b\u4e86 rc-local.service \u670d\u52a1\u6765\u52a0\u8f7d /etc/rc.d/rc.local \u6587\u4ef6\u4e2d\u7684\u547d\u4ee4\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/rc-local.service \n#  This file is part of systemd.\n#\n#  systemd is free software; you can redistribute it and/or modify it\n#  under the terms of the GNU Lesser General Public License as published by\n#  the Free Software Foundation; either version 2.1 of the License, or\n#  (at your option) any later version.\n\n# This unit gets pulled automatically into multi-user.target by\n# systemd-rc-local-generator if /etc/rc.d/rc.local is executable.\n[Unit]\nDescription=/etc/rc.d/rc.local Compatibility\nConditionFileIsExecutable=/etc/rc.d/rc.local\nAfter=network.target\n\n[Service]\nType=forking\nExecStart=/etc/rc.d/rc.local start\nTimeoutSec=0\nRemainAfterExit=yes\n[root@arm64v8 ~]#\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u8fd9\u4e2a\u6587\u4ef6\u7f3a\u5c11\u4e86 ","[","Install","]"," \u6bb5\u4e14\u6ca1\u6709 WantedBy\uff0c\u540e\u9762\u5c06\u4f1a\u89e3\u91ca Install \u4e2d\u7684 WantedBy \u8868\u793a\u8bbe\u7f6e\u8be5\u670d\u52a1\u5f00\u673a\u81ea\u542f\u52a8\u65f6\uff0c\u8be5\u670d\u52a1\u52a0\u5165\u5230\u54ea\u4e2a ",(0,a.kt)("inlineCode",{parentName:"li"},"\u8fd0\u884c\u7ea7\u522b")," \u4e2d\u542f\u52a8\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u4f46\u8fd9\u4e2a\u6587\u4ef6\u7684\u6ce8\u91ca\u4e2d\u8bf4\u660e\u4e86\uff0c\u5982\u679c /etc/rc.d/rc.local \u6587\u4ef6\u5b58\u5728\u4e14\u5177\u6709\u53ef\u6267\u884c\u6743\u9650\uff0c\u5219 systemd-rc-local-generator \u5c06\u4f1a\u81ea\u52a8\u6dfb\u52a0\u5230 multi-user.target \u4e2d\uff0c\u6240\u4ee5\uff0c\u5373\u4f7f\u6ca1\u6709 Install \u548c WantedBy \u4e5f\u65e0\u5173\u7d27\u8981\u3002")),(0,a.kt)("p",null,"\u53e6\u4e00\u65b9\u9762\u9700\u8981\u6ce8\u610f\uff0c\u548c SysV \u98ce\u683c\u7cfb\u7edf\u5728\u7cfb\u7edf\u542f\u52a8\u7684\u6700\u540e\u9636\u6bb5\u8fd0\u884c rc.local \u4e0d\u592a\u4e00\u6837\uff0csystemd \u517c\u5bb9\u7684 rc.local \u662f\u5728 network.target \u5373\u7f51\u7edc\u76f8\u5173\u670d\u52a1\u542f\u52a8\u5b8c\u6210\u4e4b\u540e\u5c31\u542f\u52a8\u7684\uff0c\u8fd9\u610f\u5473\u7740 rc.local \u53ef\u80fd\u5728\u5f00\u673a\u542f\u52a8\u8fc7\u7a0b\u4e2d\u8f83\u65e9\u7684\u9636\u6bb5\u5c31\u5f00\u59cb\u8fd0\u884c\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u60f3\u8981\u5c06\u547d\u4ee4\u52a0\u5165\u5230 /etc/rc.local \u4e2d\u5b9e\u73b0\u5f00\u673a\u81ea\u542f\u52a8\uff0c\u76f4\u63a5\u5199\u5165\u8be5\u6587\u4ef6\uff0c\u5e76\u8bbe\u7f6e\u8be5\u6587\u4ef6\u53ef\u6267\u884c\u6743\u9650\u5373\u53ef\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"echo -e '#!/bin/bash\\ndate +\"%F %T\" >/tmp/a.log' >>/etc/rc.d/rc.local\nchmod +x /etc/rc.d/rc.local\n")),(0,a.kt)("h3",{id:"1136systemd-\u8fd0\u884c\u7ea7\u522b"},"11.3.6\u3001systemd \u8fd0\u884c\u7ea7\u522b"),(0,a.kt)("p",null,"\u5728 CentOS 6 \u53ca\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u6709\u8fd0\u884c\u7ea7\u522b\u7684\u6982\u5ff5\uff0cSystemd \u7cfb\u7edf\u5185\u6ca1\u6709\u76f4\u63a5\u5b9a\u4e49\u8fd0\u884c\u7ea7\u522b\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u901a\u8fc7 Target Unit \u517c\u5bb9\u6a21\u62df\u4e86\u8fd0\u884c\u7ea7\u522b\u3002"),(0,a.kt)("p",null,"\u53ef\u4ee5\u67e5\u770b /usr/lib/systemd/system/ \u4e0b\u7684\u4e00\u4e9b target \u6587\u4ef6\u3002\u4e3a\u4e86\u8282\u7701\u7bc7\u5e45\uff0c\u4e0b\u9762\u6211\u5217\u51fa\u4e86\u90e8\u5206 target\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# ls -l /usr/lib/systemd/system/*.target | grep -o '/.*'\n\n# /usr/lib/systemd/system/\u4e0b\u5b9a\u4e49\u7684\u9ed8\u8ba4\u8fd0\u884c\u7ea7\u522b\uff1agraphical\n/usr/lib/systemd/system/default.target -> graphical.target\n\n# \u7d27\u6025\u6a21\u5f0f\u3001\u6551\u63f4\u6a21\u5f0f\u3001\u591a\u7528\u6237\u6a21\u5f0f\u548c\u56fe\u5f62\u754c\u9762\u6a21\u5f0f\n/usr/lib/systemd/system/emergency.target\n/usr/lib/systemd/system/rescue.target\n/usr/lib/systemd/system/multi-user.target\n/usr/lib/systemd/system/graphical.target\n\n# \u5173\u673a\u548c\u91cd\u542f\u76f8\u5173\u64cd\u4f5c\n/usr/lib/systemd/system/ctrl-alt-del.target -> reboot.target\n/usr/lib/systemd/system/shutdown.target\n/usr/lib/systemd/system/poweroff.target\n/usr/lib/systemd/system/reboot.target\n/usr/lib/systemd/system/halt.target\n\n# \u8fd0\u884c\u7ea7\u522b0-6\uff0c\u6ce8\u610f\u591a\u7528\u6237\u6a21\u5f0f\u4e3amulti-user.target\n/usr/lib/systemd/system/runlevel0.target -> poweroff.target\n/usr/lib/systemd/system/runlevel1.target -> rescue.target\n/usr/lib/systemd/system/runlevel2.target -> multi-user.target\n/usr/lib/systemd/system/runlevel3.target -> multi-user.target\n/usr/lib/systemd/system/runlevel4.target -> multi-user.target\n/usr/lib/systemd/system/runlevel5.target -> graphical.target\n/usr/lib/systemd/system/runlevel6.target -> reboot.target\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u6ce8\u610f\u4e0a\u9762\u6709\u4e00\u4e2a /usr/lib/systemd/system/default.target \u6307\u5411 graphical.target\uff0c\u4f46\u5b83\u4e0d\u4e00\u5b9a\u5c31\u662f\u9ed8\u8ba4\u8fd0\u884c\u7ea7\u522b\uff0c\u56e0\u4e3a\u6709\u53ef\u80fd /etc/systemd/system \u4e0b\u4e5f\u6709\u4e00\u4e2a default.target\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# readlink /etc/systemd/system/default.target\n/lib/systemd/system/multi-user.target\n[root@arm64v8 ~]#\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u56e0\u4e3a /etc/systemd/system \u4e0b\u7684 unit \u90fd\u662f\u5f00\u673a\u65f6\u52a0\u8f7d\u7684\uff0c\u6240\u4ee5 ",(0,a.kt)("inlineCode",{parentName:"li"},"\u4f18\u5148\u7ea7")," \u66f4\u9ad8\u3002\u8fd9\u5c31\u610f\u5473\u7740\u4e0a\u9762\u7684\u793a\u4f8b\u9ed8\u8ba4\u8fd0\u884c\u7ea7\u522b\u4e3a multi-user.target\uff0c\u800c\u975e graphical.target\u3002")),(0,a.kt)("p",null,"target \u662f\u5982\u4f55\u6a21\u62df\u8fd0\u884c\u7ea7\u522b\u7684\u5462\uff1f\u7406\u89e3\u4e86\u8fd0\u884c\u7ea7\u522b\u7684\u672c\u8d28\u542b\u4e49\u540e\uff0c\u5c31\u5f88\u5bb9\u6613\u7406\u89e3\u4e86\u3002\u6240\u8c13\u8fd0\u884c\u7ea7\u522b\uff0c\u65e0\u975e\u662f\u5b9a\u4e49\u51e0\u79cd\u7cfb\u7edf\u7684\u8fd0\u884c\u6a21\u5f0f\uff0c\u5728\u4e0d\u540c\u8fd0\u884c\u6a21\u5f0f\u4e0b\uff0c\u542f\u52a8\u4e0d\u540c\u670d\u52a1\u6216\u6267\u884c\u4e0d\u540c\u7a0b\u5e8f\u3002\u6bd4\u5982\u56fe\u5f62\u754c\u9762\u4e0b\u4f1a\u8fd0\u884c\u56fe\u5f62\u754c\u9762\u670d\u52a1\u3002"),(0,a.kt)("p",null,"\u800c target \u7684\u4e3b\u8981\u4f5c\u7528\u662f\u5bf9\u670d\u52a1\u8fdb\u884c\u5206\u7ec4\u3001\u5f52\u7c7b\u3002\u6240\u4ee5\uff0c\u53ea\u9700\u8981\u5b9a\u4e49\u51e0\u4e2a\u4ee3\u8868\u4e0d\u540c\u8fd0\u884c\u7ea7\u522b\u7684 target\uff0c\u5e76\u5728\u4e0d\u540c\u7684 target \u4e2d\u653e\u5165\u4e0d\u540c\u7684\u670d\u52a1\u7a0b\u5e8f\u5373\u53ef(\u9664\u4e86\u670d\u52a1\u7a0b\u5e8f\u8fd8\u53ef\u4ee5\u5305\u542b\u5176\u5b83\u7684 Unit)\u3002"),(0,a.kt)("p",null,"target \u53c8\u662f\u5982\u4f55\u5bf9\u670d\u52a1\u8fdb\u884c\u5206\u7ec4\u3001\u5f52\u7c7b\u7684\u5462\uff1f\u4f5c\u4e3a\u521d\u6b65\u4e86\u89e3\uff0c\u53ef\u5728 /etc/systemd/system \u4e2d\u5bfb\u627e\u7b54\u6848\u3002\u5728\u6b64\u76ee\u5f55\u4e0b\uff0c\u6709\u4e00\u4e9b ",(0,a.kt)("inlineCode",{parentName:"p"},"*.target.wants")," \u76ee\u5f55\uff0c\u8be5\u76ee\u5f55\u5b9a\u4e49\u4e86\u8be5 target \u4e2d\u5305\u542b\u4e86\u54ea\u4e9b Unit\uff0csystemd \u4f1a\u5728\u5904\u7406\u5230\u5bf9\u5e94 target \u65f6\u4f1a\u5bfb\u627e wants \u540e\u7f00\u7684\u76ee\u5f55\uff0c\u5e76\u52a0\u8f7d\u542f\u52a8\u8be5\u76ee\u5f55\u4e0b\u7684\u6240\u6709 Unit\uff0c\u8fd9\u5c31\u662f target \u5bf9\u670d\u52a1(\u53ca\u5176\u5b83 Unit) \u5206\u7ec4\u7684\u65b9\u5f0f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# ls -1F /etc/systemd/system/\nbasic.target.wants/\ndbus-org.fedoraproject.FirewallD1.service@\ndefault.target@\ndefault.target.wants/\ngetty.target.wants/\nlocal-fs.target.wants/\nmulti-user.target.wants/\nnetwork-online.target.wants/\nsshd.service.d/\nsysinit.target.wants/\nsystem-update.target.wants/\n[root@arm64v8 ~]#\n\n# \u7cfb\u7edf\u73af\u5883\u521d\u59cb\u5316\u76f8\u5173\u670d\u52a1\n[root@arm64v8 ~]# ls -1 /etc/systemd/system/sysinit.target.wants/\nrhel-autorelabel.service\nrhel-domainname.service\nrhel-import-state.service\nrhel-loadmodules.service\n[root@arm64v8 ~]#\n\n# \u591a\u7528\u6237\u6a21\u5f0f\u4e0b\u5f00\u673a\u81ea\u542f\u52a8\u7684\u670d\u52a1\n[root@arm64v8 ~]# ls -1 /etc/systemd/system/multi-user.target.wants/\nauditd.service\nchronyd.service\ncrond.service\nfirewalld.service\nirqbalance.service\nkdump.service\nnginx@server.service\npostfix.service\nremote-fs.target\nrhel-configure.service\nrsyslog.service\nsshd.service\ntuned.service\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u4e4b\u6240\u4ee5\u6709\u8fd9\u4e9b wants \u76ee\u5f55\uff0c\u5e76\u4e14\u5176\u4e2d\u6709\u4e00\u4e9b Unit \u6587\u4ef6\uff0c\u662f\u56e0\u4e3a\u5728 Service \u914d\u7f6e\u6587\u4ef6(\u6216\u5176\u5b83 Unit) \u4e2d\u7684 ","[","Install","]"," \u6bb5\u843d\u4f7f\u7528\u4e86 WantedBy \u6307\u4ee4\u3002\u4f8b\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/sshd.service\n[Unit]\n......\n\n[Service]\n......\n\n[Install]\nWantedBy=multi-user.target  # \u5173\u952e\u53e5\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u5f53\u4f7f\u7528 systemctl enable Unit","_","Name \u8ba9 Unit","_","Name \u5f00\u673a\u81ea\u542f\u52a8\u65f6\uff0c\u4f1a\u5bfb\u627e\u8be5 ","[","Install","]"," \u4e2d\u7684 WantedBy \u548c RequiredBy\uff0c\u5e76\u5728\u5bf9\u5e94\u7684 /etc/systemd/system/xxx.target.wants \u6216 /etc/systemd/system/xxx.target.requires \u76ee\u5f55\u4e0b\u521b\u5efa\u8f6f\u94fe\u63a5\u3002"),(0,a.kt)("p",null,"\u5982\u679c Service \u914d\u7f6e\u6587\u4ef6\u4e2d\u6ca1\u6709\u5b9a\u4e49 WantedBy \u548c RequiredBy\uff0c\u5219 systemctl enable \u64cd\u4f5c\u4e0d\u4f1a\u6709\u4efb\u4f55\u6548\u679c\u3002"),(0,a.kt)("p",null,"\u6b64\u5916\uff0c\u53ef\u4ee5\u5728 target \u914d\u7f6e\u6587\u4ef6\u5185\u90e8\u4f7f\u7528 Wants\u3001Requires \u7b49\u8868\u793a\u4f9d\u8d56\u542b\u4e49\u7684\u6307\u4ee4\u6765\u5b9a\u4e49\u8be5 target \u4f9d\u8d56\u54ea\u4e9b Unit\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/sysinit.target\n[Unit]\nDescription=System Initialization\nDocumentation=man:systemd.special(7)\nConflicts=emergency.service emergency.target\nWants=local-fs.target swap.target           # \u5173\u952e\u53e5\nAfter=local-fs.target swap.target emergency.service emergency.target\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,".target \u6587\u4ef6\u4e2d Wants \u6307\u4ee4\u5b9a\u4e49\u7684\u66f4\u7b26\u5408\u4f9d\u8d56\u7684\u542b\u4e49\uff0c\u800c .target.wants \u76ee\u5f55\u66f4\u503e\u5411\u4e8e\u8868\u660e\u8be5 target \u4e2d\u5f52\u7c7b\u4e86\u54ea\u4e9b\u8981\u8fd0\u884c\u7684\u670d\u52a1\u3002"),(0,a.kt)("p",null,"\u6bd4\u5982\u8d1f\u8d23\u7cfb\u7edf\u73af\u5883\u521d\u59cb\u5316\u7684 sysinit.target\uff0c\u5176\u4e2d\u7684 Wants \u6307\u4ee4\u5b9a\u4e49\u4e86\u5fc5\u987b\u5148\u8fd0\u884c\u4e14\u6210\u529f\u8fd0\u884c\u6587\u4ef6\u7cfb\u7edf\u76f8\u5173\u4efb\u52a1(local-fs.target \u548c swap.target) \u540e\u624d\u8fd0\u884c sysinit.target\uff0c\u4e5f\u5c31\u662f\u5f00\u59cb\u542f\u52a8 .target.wants \u76ee\u5f55\u4e0b\u7684 Unit\u3002"),(0,a.kt)("p",null,"\u6267\u884c systemctl list-units --type target \u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u5f53\u524d\u5df2\u7ecf\u52a0\u8f7d\u7684\u6240\u6709 target\uff0c\u5305\u62ec\u90a3\u4e9b\u5f00\u673a\u81ea\u542f\u52a8\u8fc7\u7a0b\u4e2d\u542f\u52a8\u7684\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl list-units --type target \nUNIT                  LOAD   ACTIVE SUB    DESCRIPTION\nbasic.target          loaded active active Basic System\nc.target              loaded active active c.service, consists of a.service and b.service\ncryptsetup.target     loaded active active Local Encrypted Volumes\ngetty.target          loaded active active Login Prompts\nlocal-fs-pre.target   loaded active active Local File Systems (Pre)\nlocal-fs.target       loaded active active Local File Systems\nmulti-user.target     loaded active active Multi-User System\nnetwork-online.target loaded active active Network is Online\nnetwork-pre.target    loaded active active Network (Pre)\nnetwork.target        loaded active active Network\npaths.target          loaded active active Paths\nremote-fs.target      loaded active active Remote File Systems\nslices.target         loaded active active Slices\nsockets.target        loaded active active Sockets\nswap.target           loaded active active Swap\nsysinit.target        loaded active active System Initialization\ntimers.target         loaded active active Timers\n\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\n\n17 loaded units listed. Pass --all to see loaded but inactive units, too.\nTo show all installed unit files use 'systemctl list-unit-files'.\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u9664\u4e86\u4e0a\u9762\u5c55\u793a\u7684 target\uff0c\u5728 /usr/lib/systemd/system \u76ee\u5f55\u4e0b\u8fd8\u6709\u5f88\u591a target\u3002\u800c\u4e14\uff0c\u53ea\u8981\u7528\u6237\u60f3\u8981\u5bf9\u4e00\u7c7b Unit \u8fdb\u884c\u5206\u7ec4\u5f52\u7c7b\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49 target\u3002"),(0,a.kt)("p",null,"\u4f46\u9700\u8981\u660e\u786e\u7684\u662f\uff0ctarget \u53ef\u5206\u4e3a\u4e24\u7c7b\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u53ef\u76f4\u63a5\u5207\u6362\u7684 target(\u6a21\u62df\u8fd0\u884c\u7ea7\u522b)"),(0,a.kt)("li",{parentName:"ol"},"\u4e0d\u53ef\u76f4\u63a5\u5207\u6362\u7684 target")),(0,a.kt)("p",null,"\u5207\u6362\u662f\u4ec0\u4e48\u610f\u601d\uff1f\u6bd4\u5982\u4ece\u5f53\u524d\u7684\u8fd0\u884c\u7ea7\u522b 3 \u5207\u6362\u5230\u8fd0\u884c\u7ea7\u522b 5\uff0c\u5c06\u4f1a\u542f\u52a8\u8fd0\u884c\u7ea7\u522b 5 \u4e0a\u7684\u6240\u6709\u7a0b\u5e8f\u4ee5\u53ca\u4f9d\u8d56\u7a0b\u5e8f\uff0c\u5e76\u505c\u6b62\u5f53\u524d\u5df2\u542f\u52a8\u4f46\u8fd0\u884c\u7ea7\u522b 5 \u4e0d\u9700\u8981\u7684\u670d\u52a1\u7a0b\u5e8f\u3002\u8fd9\u5c31\u662f\u8fd0\u884c\u7ea7\u522b\u7684\u5207\u6362\uff0c\u53ea\u662f\u505c\u6b62\u4e00\u4e9b\u670d\u52a1(\u6216\u7a0b\u5e8f)\u3001\u5e76\u542f\u52a8\u53e6\u5916\u4e00\u4e9b\u670d\u52a1\u800c\u5df2\u3002"),(0,a.kt)("p",null,"\u5207\u6362 target \u4e5f\u4e00\u6837\uff0c\u6bd4\u5982\u5207\u6362\u5230 graphical.target \u65f6\uff0c\u4f1a\u542f\u52a8\u76ee\u6807 graphical.target \u9700\u8981\u7684\u6240\u6709\u670d\u52a1\uff0c\u5e76\u505c\u6b62\u5f53\u524d\u5df2\u8fd0\u884c\u4f46\u76ee\u6807 target \u4e0d\u9700\u8981\u7684\u670d\u52a1\u3002"),(0,a.kt)("p",null,"\u5207\u6362 target \u7684\u65b9\u5f0f\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5207\u6362\u5230\u5bf9\u5e94\u7684target\nsystemctl isolate Target_Name\n# \u5982\uff1a\nsystemctl isolate default.target  # \u5207\u6362\u5230\u9ed8\u8ba4\u8fd0\u884c\u7ea7\u522b\nsystemctl isolate rescue.target   # \u5207\u6362\u5230\u6551\u63f4\u6a21\u5f0f\n\n# \u8fd8\u652f\u6301\u5982\u4e0b\u547d\u4ee4\nsystemctl default\nsystemctl resuce\nsystemctl emergency\nsystemctl halt\nsystemctl poweroff\nsystemctl reboot\n")),(0,a.kt)("p",null,"\u53ef\u67e5\u770b\u6216\u8bbe\u7f6e\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl get-default\nsystemctl set-default Target_Name\n")),(0,a.kt)("p",null,"\u8bbe\u7f6e\u9ed8\u8ba4\u8fd0\u884c\u7ea7\u522b\uff0c\u5b9e\u9645\u4e0a\u662f\u521b\u5efa /etc/systemd/system/default.target \u6307\u5411\u5bf9\u5e94 target \u914d\u7f6e\u6587\u4ef6\u7684\u8f6f\u94fe\u63a5\u3002"),(0,a.kt)("p",null,"\u6bd4\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl set-default multi-user.target \nRemoved /etc/systemd/system/default.target.\nCreated symlink /etc/systemd/system/default.target \u2192 /usr/lib/systemd/system/multi-user.target.\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"target \u662f\u5426\u53ef\u76f4\u63a5\u5207\u6362\uff0c\u53d6\u51b3\u4e8e target \u914d\u7f6e\u6587\u4ef6\u4e2d\u662f\u5426\u5b9a\u4e49\u4e86 AllowIsolate=yes \u6307\u4ee4\u3002\u6bd4\u5982 multi-user.target \u662f\u6a21\u62df\u8fd0\u884c\u7ea7\u522b\u7684 target\uff0c\u80af\u5b9a\u5141\u8bb8\u76f4\u63a5\u5207\u6362\uff0c\u800c network.target \u5b9a\u4e49\u7684\u662f\u7f51\u7edc\u542f\u52a8\u4efb\u52a1\uff0c\u80af\u5b9a\u4e0d\u53ef\u4ee5\u76f4\u63a5\u5207\u6362\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl cat multi-user.target \n[Unit]\nDescription=Multi-User System\nDocumentation=man:systemd.special(7)\nRequires=basic.target\nConflicts=rescue.service rescue.target\nAfter=basic.target rescue.service rescue.target\nAllowIsolate=yes\n[root@arm64v8 ~]#\n\n[root@arm64v8 ~]# systemctl show -p AllowIsolate network.target\nAllowIsolate=no\n[root@arm64v8 ~]#\n")),(0,a.kt)("h3",{id:"1137systemd-timer-\u5b9a\u65f6\u4efb\u52a1"},"11.3.7\u3001systemd timer \u5b9a\u65f6\u4efb\u52a1"),(0,a.kt)("h4",{id:"11371cron-\u548c-systemd-timer"},"11.3.7.1\u3001Cron \u548c Systemd Timer"),(0,a.kt)("p",null,"Linux \u73af\u5883\u4e0b\uff0ccron \u662f\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u5b9a\u65f6\u4efb\u52a1\u5de5\u5177\uff0c\u4f46\u5b83\u6709\u4e00\u4e9b\u4e0d\u65b9\u4fbf\u7684\u5730\u65b9\u3002\u6bd4\u5982\u5b83\u9ed8\u8ba4\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u53ea\u652f\u6301\u5206\u949f\u7ea7\u522b\u7cbe\u5ea6\u7684\u5b9a\u65f6\u4efb\u52a1"),(0,a.kt)("li",{parentName:"ul"},"\u5b9a\u65f6\u89c4\u5219\u592a\u6b7b\u677f"),(0,a.kt)("li",{parentName:"ul"},"\u5f53\u8c03\u5ea6\u5230\u672c\u6b21\u4efb\u52a1\u65f6\uff0c\u5982\u679c\u4e0a\u6b21\u8c03\u5ea6\u7684\u4efb\u52a1\u4ecd\u5728\u6267\u884c\uff0c\u65e0\u6cd5\u963b\u6b62\u672c\u6b21\u4efb\u52a1\u91cd\u590d\u6267\u884c(\u9700\u7ed3\u5408 flock)"),(0,a.kt)("li",{parentName:"ul"},"\u65e0\u6cd5\u5bf9\u5b9a\u65f6\u4efb\u52a1\u53ef\u80fd\u6d88\u8017\u7684\u5927\u91cf\u8d44\u6e90\u505a\u51fa\u9650\u5236"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u652f\u6301\u53ea\u6267\u884c\u4e00\u6b21\u7684\u5b9a\u65f6\u70b9\u7684\u8ba1\u5212\u4efb\u52a1"),(0,a.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u4e0d\u76f4\u89c2\uff0c\u4e0d\u65b9\u4fbf\u8c03\u8bd5\u4efb\u52a1")),(0,a.kt)("p",null,"\u56e0\u4e3a cron \u4e0d\u539f\u751f\u652f\u6301\u4ee5\u4e0a\u529f\u80fd\uff0c\u6240\u4ee5\u5f53\u6709\u4ee5\u4e0a\u76f8\u5173\u9700\u6c42\u65f6\uff0c\u53ea\u80fd\u5728\u8981\u8c03\u5ea6\u7684\u547d\u4ee4\u5c42\u6b21\u4e0a\u5bfb\u627e\u89e3\u51b3\u65b9\u6848\u3002"),(0,a.kt)("p",null,"systemd \u7cfb\u7edf\u4e2d\u5305\u542b\u4e86 timer \u8ba1\u65f6\u5668\u7ec4\u4ef6\uff0ctimer \u53ef\u4ee5\u5b8c\u5168\u66ff\u4ee3 cron + at\uff0c\u5b83\u5177\u6709\u4ee5\u4e0b\u7279\u6027\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u53ef\u7cbe\u786e\u5230\u5fae\u5999\u7ea7\u522b\uff0c\u5176\u652f\u6301\u7684\u65f6\u95f4\u5355\u4f4d\u5305\u62ec\uff1a",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"us(\u5fae\u79d2)\u3001ms(\u6beb\u79d2)\u3001s(\u79d2)\u3001m(\u5206)\u3001h(\u65f6)\u3001d(\u65e5)\u3001w(\u5468)"),(0,a.kt)("li",{parentName:"ul"},"\u7c7b\u4f3c cron \u5b9a\u4e49\u65f6\u95f4\u7684\u65b9\u5f0f(\u67d0\u5e74\u67d0\u6708\u67d0\u65e5\u67d0\u65f6\u67d0\u5206\u67d0\u79d2\u4ee5\u53ca\u65f6\u95f4\u6bb5)"))),(0,a.kt)("li",{parentName:"ul"},"\u53ef\u5bf9\u5b9a\u65f6\u4efb\u52a1\u505a\u8d44\u6e90\u9650\u5236"),(0,a.kt)("li",{parentName:"ul"},"\u53ef\u66ff\u4ee3 cron \u548c at \u5de5\u5177\uff0c\u4e14\u652f\u6301\u6bd4 cron \u66f4\u52a0\u7075\u6d3b\u4e30\u5bcc\u7684\u5b9a\u65f6\u89c4\u5219"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u4f1a\u91cd\u590d\u6267\u884c\u5b9a\u65f6\u4efb\u52a1",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5982\u679c\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\u65f6\u53d1\u73b0\u4e0a\u6b21\u89e6\u53d1\u7684\u4efb\u52a1\u8fd8\u672a\u6267\u884c\u5b8c\uff0c\u90a3\u4e48\u672c\u6b21\u89e6\u53d1\u7684\u4efb\u52a1\u4e0d\u4f1a\u6267\u884c"),(0,a.kt)("li",{parentName:"ul"},"\u800c\u4e14 systemd \u542f\u52a8\u670d\u52a1\u7684\u64cd\u4f5c\u5177\u6709\u5e42\u7b49\u6027\uff0c\u5982\u679c\u670d\u52a1\u6b63\u5728\u8fd0\u884c\uff0c\u542f\u52a8\u64cd\u4f5c\u5c06\u4e0d\u505a\u4efb\u4f55\u4e8b\uff0c\u6240\u4ee5\uff0c\u751a\u81f3\u53ef\u4ee5\u75af\u72c2\u5230\u6bcf\u79d2\u6216\u6bcf\u51e0\u79d2\u542f\u52a8\u4e00\u6b21\u670d\u52a1\uff0c\u514d\u53bb\u5224\u65ad\u8fdb\u7a0b\u662f\u5426\u5b58\u5728\u7684\u8fc7\u7a0b"))),(0,a.kt)("li",{parentName:"ul"},"\u96c6\u6210\u5230 journal \u65e5\u5fd7\uff0c\u65b9\u4fbf\u8c03\u8bd5\u4efb\u52a1\uff0c\u65b9\u4fbf\u67e5\u770b\u4efb\u52a1\u8c03\u5ea6\u60c5\u51b5")),(0,a.kt)("h4",{id:"11372systemd-timer-\u793a\u4f8b\u6bcf-3-\u79d2\u8fd0\u884c\u4e00\u6b21"},"11.3.7.2\u3001systemd timer \u793a\u4f8b\uff1a\u6bcf 3 \u79d2\u8fd0\u884c\u4e00\u6b21"),(0,a.kt)("p",null,"\u4f7f\u7528 systemd timer \u5b9a\u65f6\u4efb\u52a1\u65f6\uff0c\u9700\u8981\u540c\u65f6\u7f16\u5199\u4e24\u4e2a\u6587\u4ef6\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u7f16\u5199\u4e00\u4e2a\u4ee5 ",(0,a.kt)("inlineCode",{parentName:"li"},".timer")," \u4e3a\u540e\u7f00\u7684 Systemd Unit\uff0c\u8be5\u6587\u4ef6\u63cf\u8ff0\u5b9a\u65f6\u4efb\u52a1\u5982\u4f55\u5b9a\u65f6"),(0,a.kt)("li",{parentName:"ul"},"\u7f16\u5199\u4e00\u4e2a\u4ee5 ",(0,a.kt)("inlineCode",{parentName:"li"},".service")," \u4e3a\u540e\u7f00\u7684 Systemd Service Unit\uff0c\u8be5\u6587\u4ef6\u63cf\u8ff0\u5b9a\u65f6\u4efb\u52a1\u8981\u6267\u884c\u7684\u64cd\u4f5c")),(0,a.kt)("p",null,"\u8fd9\u4e24\u4e2a\u6587\u4ef6\u540d\u79f0\u901a\u5e38\u4fdd\u6301\u4e00\u81f4(\u9664\u4e86\u540e\u7f00\u90e8\u5206)\uff0c\u5b83\u4eec\u53ef\u4ee5\u653e\u5728\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"/etc/systemd/system \u76ee\u5f55\u4e0b"),(0,a.kt)("li",{parentName:"ul"},"/usr/lib/systemd/system \u76ee\u5f55\u4e0b"),(0,a.kt)("li",{parentName:"ul"},"~/.config/systemd/user \u76ee\u5f55\u4e0b\uff0c\u8868\u793a\u5b9a\u4e49\u7528\u6237\u5b9a\u65f6\u4efb\u52a1\uff0c\u7528\u6237\u767b\u5f55\u540e\u624d\u89e6\u53d1")),(0,a.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"/usr/lib/systemd/system/foo.service\n/usr/lib/systemd/system/foo.timer\n\n/etc/systemd/system/foo.service\n/etc/systemd/system/foo.timer\n\n~/.config/systemd/user/foo.timer\n~/.config/systemd/user/foo.service\n")),(0,a.kt)("p",null,"\u5047\u8bbe\u5b9a\u4e49\u4e00\u4e2a\u6bcf 3 \u79d2\u6267\u884c\u4e00\u6b21\u7684\u4efb\u52a1\uff0c\u8be5\u4efb\u52a1\u7528\u4e8e\u68c0\u6d4b\u9875\u9762\u662f\u5426\u6b63\u5e38\uff0c\u5bf9\u5e94\u547d\u4ee4\u4e3a curl -s -o /dev/null -w '%{http","_","code}' '",(0,a.kt)("a",{parentName:"p",href:"https://github.xn--com%27%2C-l73kl4vl2ix41a7uty2eso7dob0akh7bjgxblqfjtf/"},"https://github.com","'","\uff0c\u5176\u7ed3\u679c\u4e3a\u8bbf\u95ee\u9875\u9762\u65f6\u54cd\u5e94\u7684")," HTTP \u72b6\u6001\u7801\u3002"),(0,a.kt)("p",null,"\u5148\u7f16\u5199\u5bf9\u5e94\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/curl_github.service\n[Unit]\nDescription = Written by Brinnatt@gmail.com for testing timer\n\n[Service]\nExecStart = /usr/bin/curl -s -o /dev/null -w '%{http_code}' 'https://github.com'\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u56e0\u4e3a\u547d\u4ee4\u6bcf\u6b21\u8c03\u7528\u90fd\u53ea\u6267\u884c\u4e00\u6b21\u4e14\u5feb\u901f\u9000\u51fa\uff0c\u6240\u4ee5 Service \u4e2d\u4f7f\u7528\u4e86\u9ed8\u8ba4\u7684 Type=simple\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 Type=oneshot\u3002"),(0,a.kt)("p",null,"\u518d\u7f16\u5199\u5b9a\u65f6\u5668\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /usr/lib/systemd/system/curl_github.timer\n[Unit]\nDescription = Written by Brinnatt@gmail.com for testing timer, curl per 3s\n\n[Timer]\nOnActiveSec = 1s\nOnUnitInactiveSec = 3s\nAccuracySec = 1us\nRandomizedDelaySec = 0\n\n[Install]\nWantedBy = timers.target\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u518d\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5373\u53ef\u8ba9\u5b9a\u65f6\u5668\u751f\u6548\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl daemon-reload \n[root@arm64v8 ~]# systemctl start curl_github.timer  # \u542f\u52a8\u5b9a\u65f6\u5668\n")),(0,a.kt)("p",null,"\u663e\u7136\uff0c\u8fd8\u652f\u6301\u5982\u4e0b\u547d\u4ee4\u6765\u7ba1\u7406\u5b9a\u65f6\u5668\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl status xxx.timer\nsystemctl stop xxx.timer\nsystemctl restart xxx.timer\n\n# \u548cWantedBy\u7684\u503c\u6709\u5173\uff0c\u82e5WantedBy=timers.target\uff0c\u5219\u672c\u547d\u4ee4\u591a\u4f59\nsystemctl enable xxx.timer\n")),(0,a.kt)("p",null,"\u56de\u5934\u6765\u5206\u6790\u4e00\u4e0b\u5b9a\u65f6\u5668\u914d\u7f6e\u6587\u4ef6\u4e2d\u6d89\u53ca\u5230\u7684\u6307\u4ee4\u3002"),(0,a.kt)("p",null,"\u9996\u5148\u662f\u8be5\u6587\u4ef6 ","[","Install","]"," \u6bb5\u4e2d\u7684\u6700\u540e\u4e00\u884c WantedBy=timers.target\uff0c\u5b83\u8868\u793a\u5728\u5f00\u673a\u65f6\u4f1a\u81ea\u52a8\u542f\u52a8\u8be5\u5b9a\u65f6\u5668\uff0c\u4e4b\u6240\u4ee5\u4f1a\u5f00\u673a\u81ea\u52a8\u6267\u884c\u8fd9\u4e9b timers \u5b9a\u65f6\u8ba1\u5212\uff0c\u662f\u56e0\u4e3a\u5728 basic.target \u4e2d\u5b9a\u4e49\u4e86 timer.target \u4f9d\u8d56\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl list-dependencies --reverse timers.target | head -2\ntimers.target\n\u25cf \u2514\u2500basic.target\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u518d\u770b Timer \u6bb5\u4e2d\u5b9a\u4e49\u5b9a\u65f6\u5668\u5c5e\u6027\u7684\u6307\u4ee4\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"OnActiveSec \u8868\u793a\u4ece\u8be5\u5b9a\u65f6\u5668\u542f\u52a8(\u5373systemctl start xxx.timer) \u4e4b\u540e\uff0c\u591a\u957f\u65f6\u95f4\u89e6\u53d1\u5b9a\u65f6\u5668\u5bf9\u5e94\u7684\u4efb\u52a1\uff0c\u5373\u6267\u884c\u5bf9\u5e94\u7684 Service \u670d\u52a1\u3002\u672c\u4f8b\u662f\u542f\u52a8\u5b9a\u65f6\u5668\u540e 1 \u79d2\uff0c\u5f00\u59cb\u7b2c\u4e00\u6b21\u6267\u884c\u4efb\u52a1\u5355\u5143 curl","_","github.service\u3002"),(0,a.kt)("li",{parentName:"ul"},"OnUnitInactiveSec \u8868\u793a\u4ece\u4e0a\u4e00\u6b21\u4efb\u52a1\u5355\u5143\u9000\u51fa\u540e\uff0c\u591a\u957f\u65f6\u95f4\u518d\u6b21\u89e6\u53d1\u5b9a\u65f6\u5668\u5bf9\u5e94\u7684\u4efb\u52a1\u3002\u6bd4\u5982\u5728\u672c\u4f8b\u4e2d\uff0c\u8868\u793a\u7684\u542b\u4e49\u662f\u6bcf\u6b21 curl","_","github.service \u6267\u884c\u5b8c\u6210(\u5373\u9875\u9762\u68c0\u6d4b\u5b8c\u6210\u540e\u9000\u51fa)\u540e 3 \u79d2\uff0c\u518d\u6b21\u89e6\u53d1\u8be5\u4efb\u52a1\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5269\u4f59\u4e24\u4e2a\u6307\u4ee4 AccuracySec \u548c RandomizedDelaySec\uff0c\u7a0d\u540e\u518d\u8be6\u7ec6\u89e3\u91ca\u3002\u56e0\u4e3a\u5728\u89e3\u91ca\u5b83\u4eec\u4e4b\u524d\uff0c\u9700\u8981\u5b66\u4f1a\u89c2\u5bdf\u5b9a\u65f6\u4efb\u52a1\u7684\u6267\u884c\u60c5\u51b5\u3002")),(0,a.kt)("h4",{id:"11373\u5b9a\u65f6\u4efb\u52a1\u7684\u6267\u884c\u65f6\u95f4\u70b9"},"11.3.7.3\u3001\u5b9a\u65f6\u4efb\u52a1\u7684\u6267\u884c\u65f6\u95f4\u70b9"),(0,a.kt)("p",null,"\u4f7f\u7528 systemctl list-timers \u53ef\u4ee5\u5217\u51fa\u5f53\u524d\u5df2\u7ecf\u751f\u6548\u7684\u5b9a\u65f6\u5668(\u5373\u5982\u679c\u4e0d\u505c\u6b62\u5b83\uff0c\u5219\u8fdf\u65e9\u4f1a\u89e6\u53d1\u5bf9\u5e94\u7684\u5b9a\u65f6\u4efb\u52a1)\u3002\u5b83\u4f1a\u6309\u7167\u4e0b\u6b21\u8981\u6267\u884c\u7684\u65f6\u95f4\u70b9\u5148\u540e\u8fdb\u884c\u6392\u5e8f\uff0c\u6700\u5feb\u8981\u6267\u884c\u7684\u4efb\u52a1\u5728\u6700\u524d\u9762\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl list-timers --no-pager\nNEXT                         LEFT          LAST                         PASSED       UNIT                         ACTIVATES\nFri 2021-08-06 00:36:40 EDT  1min 44s ago  Fri 2021-08-06 00:36:40 EDT  1min 44s ago curl_github.timer            curl_github.service\nFri 2021-08-06 02:37:58 EDT  1h 59min left Thu 2021-08-05 02:37:58 EDT  22h ago      systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service\nn/a                          n/a           Tue 2021-08-03 09:58:56 EDT  2 days ago   systemd-readahead-done.timer systemd-readahead-done.service\n\n3 timers listed.\nPass --all to see loaded but inactive timers, too.\n[root@arm64v8 ~]#\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"NEXT \u8868\u793a\u4e0b\u4e00\u6b21\u8981\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\u7684\u65f6\u95f4\u70b9"),(0,a.kt)("li",{parentName:"ul"},"LEFT \u8868\u793a\u73b0\u5728\u8ddd\u79bb\u4e0b\u6b21\u6267\u884c\u4efb\u52a1\u8fd8\u5269\u591a\u957f\u65f6\u95f4(\u5df2\u7ecf\u786e\u5b9a\u4e86\u4e0b\u4e00\u6b21\u6267\u884c\u7684\u65f6\u95f4\u70b9)\uff0c\u6216\u8005\u663e\u793a\u6700\u8fd1\u4e00\u6b21\u6267\u884c\u4efb\u52a1\u5df2\u7ecf\u8fc7\u53bb\u4e86\u591a\u957f\u65f6\u95f4(\u8fd8\u4e0d\u786e\u5b9a\u4e0b\u4e00\u6b21\u6267\u884c\u7684\u65f6\u95f4\u70b9)\uff0c\u7a0d\u540e\u89e3\u91ca\u4e86 AccuracySec \u548c RandomizedDelaySec \u5c31\u77e5\u9053\u4e3a\u4ec0\u4e48\u4f1a\u6709\u8fd9\u4e24\u79cd\u8868\u793a\u65b9\u5f0f"),(0,a.kt)("li",{parentName:"ul"},"LAST \u8868\u793a\u4e0a\u6b21\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\u7684\u65f6\u95f4\u70b9"),(0,a.kt)("li",{parentName:"ul"},"PASSED \u8868\u793a\u8ddd\u79bb\u4e0a\u4e00\u6b21\u6267\u884c\u4efb\u52a1\u5df2\u7ecf\u8fc7\u53bb\u591a\u4e45"),(0,a.kt)("li",{parentName:"ul"},"UNIT \u8868\u793a\u662f\u54ea\u4e2a\u5b9a\u65f6\u5668"),(0,a.kt)("li",{parentName:"ul"},"ACTIVATES \u8868\u793a\u8be5\u5b9a\u65f6\u5668\u6240\u89e6\u53d1\u7684\u4efb\u52a1")),(0,a.kt)("p",null,"\u867d\u7136\u4e0a\u9762\u7684\u542b\u4e49\u90fd\u6bd4\u8f83\u6e05\u6670\uff0c\u4f46\u662f\u60f3\u8981\u7406\u89e3\u900f\u5f7b\uff0c\u8fd8\u771f\u4e0d\u5bb9\u6613\u3002"),(0,a.kt)("p",null,"\u4e0d\u8fc7\uff0c\u8fd8\u6709\u5176\u5b83\u89c2\u5bdf\u5b9a\u65f6\u4efb\u52a1\u6267\u884c\u60c5\u51b5\u7684\u65b9\u5f0f\u3002\u7531\u4e8e systemd service \u9ed8\u8ba4\u96c6\u6210\u4e86 journald \u65e5\u5fd7\u7cfb\u7edf\uff0c\u547d\u4ee4\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u90fd\u4f1a\u8f93\u51fa\u5230 journal \u65e5\u5fd7\u4e2d\u3002"),(0,a.kt)("p",null,"\u6bd4\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528 systemctl status xxx.service \u89c2\u5bdf\u5b9a\u65f6\u5668\u5bf9\u5e94\u4efb\u52a1\u7684\u6267\u884c\u72b6\u51b5\uff0c\u5373\u6bcf\u6b21\u6267\u884c\u4efb\u52a1\u7684\u65f6\u95f4\u70b9\u4ee5\u53ca\u5b9a\u65f6\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u6807\u51c6\u8f93\u51fa\u3001\u6807\u51c6\u9519\u8bef\u4fe1\u606f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl status curl_github.service  # \u6ce8\u610f\u662f.service\u4e0d\u662f.timer\n\u25cf curl_github.service - Written by Brinnatt@gmail.com for testing timer\n   Loaded: loaded (/usr/lib/systemd/system/curl_github.service; static; vendor preset: disabled)\n   Active: active (running) since Fri 2021-08-06 12:42:42 CST; 1min 32s ago\n Main PID: 12172 (curl)\n   CGroup: /system.slice/curl_github.service\n           \u2514\u250012172 /usr/bin/curl -s -o /dev/null -w %{http_code} https://github.com\n\nAug 06 12:42:42 arm64v8 systemd[1]: Started Written by Brinnatt@gmail.com for testing timer.\nAug 06 12:42:42 arm64v8 systemd[1]: Starting Written by Brinnatt@gmail.com for testing ......\nHint: Some lines were ellipsized, use -l to show in full.\n[root@arm64v8 ~]#\n")),(0,a.kt)("p",null,"\u8fd8\u53ef\u4ee5\u4f7f\u7528 journalctl \u5de5\u5177\u6765\u67e5\u770b\u5b9a\u65f6\u4efb\u52a1\u7684\u65e5\u5fd7\u4fe1\u606f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'# \u67e5\u770b\u6307\u5b9a\u670d\u52a1\u7684\u6240\u6709journal\u65e5\u5fd7\u4fe1\u606f\n# xxx.service\u662f\u5b9a\u65f6\u4efb\u52a1\u7684\u540d\u79f0\njournalctl -u xxx.service\n\n# \u5b9e\u65f6\u76d1\u63a7\u5c3e\u90e8\u65e5\u5fd7\uff0c\u7c7b\u4f3ctail -f\njournalctl -f -u xxx.service\n\n# \u663e\u793a\u6307\u5b9a\u65f6\u95f4\u6bb5\u5185\u7684\u65e5\u5fd7\n# --since\uff1a\u4ece\u6307\u5b9a\u65f6\u95f4\u70b9\u5185\u5f00\u59cb\u7684\u65e5\u5fd7\n# --until\uff1a\u5230\u6307\u5b9a\u65f6\u95f4\u70b9\u4e3a\u6b62\u7684\u65e5\u5fd7\njournalctl -u xxx.service --since="2021-08-06 12:56:23"\njournalctl -u xxx.service --since="60s ago"\njournalctl -u xxx.service --since="1min ago"\njournalctl -u curl_github.service --since="-120s"\n')),(0,a.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'[root@arm64v8 ~]# journalctl -u curl_github.service --since="-30s"\n-- Logs begin at Tue 2021-08-03 21:58:10 CST, end at Fri 2021-08-06 12:59:36 CST. --\nAug 06 12:59:08 arm64v8 systemd[1]: Started Written by Brinnatt@gmail.com for testing timer.\nAug 06 12:59:08 arm64v8 systemd[1]: Starting Written by Brinnatt@gmail.com for testing timer.\nAug 06 12:59:14 arm64v8 curl[12355]: 200\nAug 06 12:59:17 arm64v8 systemd[1]: Started Written by Brinnatt@gmail.com for testing timer.\nAug 06 12:59:17 arm64v8 systemd[1]: Starting Written by Brinnatt@gmail.com for testing timer.\nAug 06 12:59:25 arm64v8 curl[12359]: 200\nAug 06 12:59:28 arm64v8 systemd[1]: Started Written by Brinnatt@gmail.com for testing timer.\nAug 06 12:59:28 arm64v8 systemd[1]: Starting Written by Brinnatt@gmail.com for testing timer.\nAug 06 12:59:36 arm64v8 curl[12363]: 200\n')),(0,a.kt)("p",null,"\u4ece\u7ed3\u679c\u53ef\u4ee5\u770b\u51fa\uff0c\u5728 Aug 06 12:59:08\u3001Aug 06 12:59:17 \u90fd\u6267\u884c\u4e86 page","_","test \u4efb\u52a1\u3002"),(0,a.kt)("h4",{id:"11374accuracysec-\u548c-randomizeddelaysec"},"11.3.7.4\u3001AccuracySec \u548c RandomizedDelaySec"),(0,a.kt)("p",null,"AccuracySec \u8868\u793a\u4efb\u52a1\u63a8\u8fdf\u6267\u884c\u7684\u5ef6\u8fdf\u8303\u56f4\uff0c\u5373\u4ece\u6bcf\u6b21\u6307\u5b9a\u8981\u6267\u884c\u4efb\u52a1\u7684\u7cbe\u786e\u65f6\u95f4\u70b9\u5230\u5ef6\u8fdf\u65f6\u95f4\u6bb5\u5185\u7684\u4e00\u4e2a\u968f\u673a\u65f6\u95f4\u70b9\u542f\u52a8\u4efb\u52a1\u3002\u4f7f\u7528\u8fd9\u79cd\u5ef6\u8fdf\uff0c\u4e3b\u8981\u662f\u4e3a\u4e86\u907f\u514d systemd \u9891\u7e41\u89e6\u53d1\u5b9a\u65f6\u5668\u4e8b\u4ef6\u800c\u9891\u7e41\u5524\u9192 CPU\uff0c\u4ece\u800c\u8ba9\u4e00\u5b9a\u65f6\u95f4\u6bb5\u5185\u9644\u8fd1\u7684\u5b9a\u65f6\u4efb\u52a1\u53ef\u4ee5\u96c6\u4e2d\u5728\u8fd9\u4e2a\u65f6\u95f4\u6bb5\u5185\u542f\u52a8\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6bd4\u5982\u8bf4\u6709\u591a\u4e2a\u5b9a\u65f6\u4efb\u52a1\u90fd\u8bbe\u7f6e\u4e86\u6bcf\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u90a3\u4e48\u5728\u6bcf\u5206\u949f\u65f6\u95f4\u6bb5\u5185\uff0csystemd \u53ef\u80fd\u5728\u8fd9\u4e00\u5206\u949f\u7684\u7b2c 10 \u79d2\u6267\u884c\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1\uff0c\u7b2c 11 \u79d2\u6267\u884c\u4e0b\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1\uff0c\u7b2c 12 \u79d2\u518d\u6267\u884c\u4e0b\u4e00\u4e2a\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u6240\u4ee5\uff0cAccuracySec \u7684\u76ee\u7684\u4fbf\u662f\u5c06\u4e00\u5b9a\u8303\u56f4\u5185\u7684\u5b9a\u65f6\u5668\u4e8b\u4ef6\u5408\u5e76\u5230\u8fd9\u4e2a\u65f6\u95f4\u6bb5\u5185\u7684\u540c\u4e00\u4e2a\u65f6\u95f4\u70b9\u4e0a\uff0c\u7136\u540e\u4e00\u6b21\u6027\u89e6\u53d1\u6240\u6709\u5728\u8303\u56f4\u5185\u7684\u5b9a\u65f6\u5668\u4efb\u52a1\u3002")),(0,a.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5b9a\u65f6\u5668\u542f\u52a8\u540e\uff0c\u518d\u8fc710\u5206\u949f\u7b2c\u4e00\u6b21\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\nOnActiveSec=10m\n# \u6bcf\u6b21\u6267\u884c\u5b8c\u4efb\u52a1\u540e\uff0c\u518d\u8fc715\u5206\u949f\u540e\u518d\u6b21\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\nOnUnitInactiveSec=15m\n# \u89e6\u53d1\u4e8b\u4ef6\u540e\uff0c\u5141\u8bb8\u63a8\u8fdf0-10\u5206\u949f\u518d\u6267\u884c\u88ab\u89e6\u53d1\u7684\u4efb\u52a1\nAccuracySec=10m\n")),(0,a.kt)("p",null,"\u6240\u4ee5\uff0c\u4ee5\u4e0a\u6307\u4ee4\u7684\u6548\u679c\u662f\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u542f\u52a8\u5b9a\u65f6\u5668\u540e\u7684 10m - 20m \u5185\u7684\u4efb\u4e00\u65f6\u95f4\u70b9\u89e6\u53d1\u7b2c\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1"),(0,a.kt)("li",{parentName:"ul"},"\u4e4b\u540e\u6bcf\u9694 15m - 25m \u518d\u6b21\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1")),(0,a.kt)("p",null,"AccuracySec \u7684\u9ed8\u8ba4\u503c\u4e3a 1 \u5206\u949f\uff0c\u6240\u4ee5\u5982\u679c\u4e0d\u5b9a\u4e49 AccuracySec \u7684\u8bdd\uff0c\u5373\u4f7f\u7528\u6237\u671f\u5f85\u7684\u662f\u6bcf\u79d2\u89e6\u53d1\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1\uff0c\u4f46\u4e8b\u5b9e\u5374\u662f\u4f1a\u5728 1s - 61s \u65f6\u95f4\u6bb5\u5185\u7684\u4e00\u4e2a\u968f\u673a\u65f6\u95f4\u70b9\u89e6\u53d1\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1\u3002"),(0,a.kt)("p",null,"\u4f46\u662f\uff0c\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\u7684\u65f6\u95f4\u70b9\u5e76\u4e0d\u8868\u793a\u8fd9\u662f\u6267\u884c\u4efb\u52a1\u7684\u65f6\u95f4\u70b9\u3002\u89e6\u53d1\u4e86\u5b9a\u65f6\u4efb\u52a1\uff0c\u8fd8\u9700\u8981\u6839\u636e RandomizedDelaySec \u7684\u503c\u6765\u51b3\u5b9a\u4f55\u65f6\u6267\u884c\u5b9a\u65f6\u4efb\u52a1\u3002"),(0,a.kt)("p",null,"RandomizedDelaySec \u6307\u5b9a\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\u540e\u8fd8\u9700\u5ef6\u8fdf\u4e00\u4e2a\u6307\u5b9a\u8303\u56f4\u5185\u7684\u968f\u673a\u65f6\u957f\u624d\u6267\u884c\u4efb\u52a1\u3002\u8be5\u6307\u4ee4\u9ed8\u8ba4\u503c\u4e3a 0\uff0c\u8868\u793a\u89e6\u53d1\u540e\u7acb\u5373\u6267\u884c\u4efb\u52a1\u3002"),(0,a.kt)("p",null,"\u4f7f\u7528 RandomizedDelaySec\uff0c\u4e3b\u8981\u662f\u4e3a\u4e86\u5728\u4e00\u4e2a\u65f6\u95f4\u8303\u56f4\u5185\u5206\u6563\u5927\u91cf\u88ab\u540c\u65f6\u89e6\u53d1\u7684\u5b9a\u65f6\u4efb\u52a1\uff0c\u4ece\u800c\u907f\u514d\u8fd9\u4e9b\u5b9a\u65f6\u4efb\u52a1\u96c6\u4e2d\u5728\u540c\u4e00\u65f6\u95f4\u70b9\u6267\u884c\u800c CPU \u4e89\u62a2\u3002"),(0,a.kt)("p",null,"\u53ef\u89c1\uff0cAccuracySec \u548c RandomizedDelaySec \u7684\u76ee\u7684\u662f\u76f8\u53cd\u7684\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u524d\u8005\u8ba9\u6307\u5b9a\u8303\u56f4\u5185\u7684\u5b9a\u65f6\u5668\u96c6\u4e2d\u5728\u540c\u4e00\u4e2a\u65f6\u95f4\u70b9\u4e00\u6b21\u6027\u89e6\u53d1\u5b83\u4eec\u7684\u5b9a\u65f6\u4efb\u52a1"),(0,a.kt)("li",{parentName:"ul"},"\u540e\u8005\u8ba9\u89e6\u53d1\u7684\u3001\u5c06\u8981\u88ab\u6267\u884c\u7684\u4efb\u52a1\u5747\u5300\u5206\u6563\u5728\u4e00\u4e2a\u65f6\u95f4\u6bb5\u8303\u56f4\u5185")),(0,a.kt)("p",null,"\u6839\u636e\u4ee5\u4e0a\u63cf\u8ff0\uff0c\u5982\u679c\u7528\u6237\u60f3\u8981\u8ba9\u5b9a\u65f6\u4efb\u52a1\u975e\u5e38\u7cbe\u786e\u5ea6\u5730\u6267\u884c\uff0c\u9700\u8981\u5c06\u5b83\u4eec\u8bbe\u7f6e\u7684\u8db3\u591f\u5c0f\u3002\u4f8b\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"AccuracySec = 1ms        # \u5b9a\u65f6\u5668\u5230\u70b9\u5c31\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\nRandomizedDelaySec = 0   # \u5b9a\u65f6\u4efb\u52a1\u4e00\u89e6\u53d1\u5c31\u7acb\u523b\u6267\u884c\u4efb\u52a1\n")),(0,a.kt)("h4",{id:"11375systemd-timer-\u652f\u6301\u7684\u5355\u8c03\u5b9a\u65f6\u89c4\u5219"},"11.3.7.5\u3001systemd timer \u652f\u6301\u7684\u5355\u8c03\u5b9a\u65f6\u89c4\u5219"),(0,a.kt)("p",null,"systemd timer \u8fd8\u652f\u6301\u51e0\u79cd\u5176\u5b83\u7684\u5b9a\u65f6\u5668\u89c4\u5219\u3002"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u5b9a\u65f6\u5668\u6307\u4ee4"),(0,a.kt)("th",{parentName:"tr",align:null},"\u542b\u4e49"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OnBootSec"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4ece\u5f00\u673a\u542f\u52a8\u540e\uff0c\u5373\u4ece\u5185\u6838\u5f00\u59cb\u8fd0\u884c\u7b97\u8d77\uff0c\u591a\u957f\u65f6\u95f4\u89e6\u53d1\u5b9a\u65f6\u5668\u5bf9\u5e94\u4efb\u52a1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OnStartupSec"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4ece systemd \u542f\u52a8\u540e\uff0c\u5373\u5185\u6838\u542f\u52a8 init \u8fdb\u7a0b\u7b97\u8d77\uff0c\u591a\u957f\u65f6\u95f4\u89e6\u53d1\u5b9a\u65f6\u5668\u5bf9\u5e94\u4efb\u52a1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OnActiveSec"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4ece\u8be5\u5b9a\u65f6\u5668\u542f\u52a8\u540e\uff0c\u591a\u957f\u65f6\u95f4\u89e6\u53d1\u5b9a\u65f6\u5668\u5bf9\u5e94\u7684\u4efb\u52a1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OnUnitInactiveSec"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4ece\u4e0a\u6b21\u4efb\u52a1\u5355\u5143\u9000\u51fa\u540e\uff0c\u591a\u957f\u65f6\u95f4\u518d\u6b21\u89e6\u53d1\u5b9a\u65f6\u5668\u5bf9\u5e94\u7684\u4efb\u52a1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OnUnitActiveSec"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4ece\u4e0a\u6b21\u89e6\u53d1\u7684\u4efb\u52a1\u5f00\u59cb\u6267\u884c(\u72b6\u6001\u8fbe\u5230 active) \u7b97\u8d77\uff0c\u591a\u957f\u65f6\u95f4\u518d\u6b21\u89e6\u53d1\u5b9a\u65f6\u5668\u5bf9\u5e94\u7684\u4efb\u52a1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"(1) \u5f53 Service \u6587\u4ef6\u4e2d Type=oneshot\uff0c\u8fd9\u7c7b\u4efb\u52a1\u4e0d\u4f1a\u51fa\u73b0 active \u72b6\u6001\uff0c\u9664\u975e\u914d\u7f6e\u4e86 RemainAfterExit \u6307\u4ee4(\u53c2\u8003 man systemd.service)"),(0,a.kt)("td",{parentName:"tr",align:null})),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"(2) \u8fd9\u4e2a\u5b9a\u65f6\u5668\u7528\u7684\u4e0d\u5982 OnUnitInactiveSec \u591a\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5b9a\u65f6\u5668\u662f\u4ee5\u542f\u52a8\u65f6\u95f4\u4e3a\u57fa\u51c6\u7684\uff0c\u6709\u53ef\u80fd\u4e0b\u6b21\u89e6\u53d1\u4efb\u52a1\u65f6\uff0c\u4e0a\u6b21\u4efb\u52a1\u8fd8\u6ca1\u6709\u6267\u884c\u5b8c\u6210\uff0csystemd \u4f1a\u5ffd\u7565\u4e0b\u6b21\u4efb\u52a1"),(0,a.kt)("td",{parentName:"tr",align:null})))),(0,a.kt)("p",null,"\u5176\u4e2d OnBootSec \u548c OnStartupSec \u6bd4\u8f83\u7279\u6b8a\uff0c\u56e0\u4e3a\u5b9a\u65f6\u5668\u81ea\u8eab\u7684\u542f\u52a8\u6bd4\u8fd9\u4e24\u4e2a\u65f6\u95f4\u70b9\u8981\u665a\uff0c\u5982\u679c\u5b9a\u65f6\u5668\u914d\u7f6e\u6587\u4ef6\u4e2d\u4ee5\u8fd9\u4e24\u4e2a\u6307\u4ee4\u4e3a\u5b9a\u65f6\u4efb\u52a1\u7684\u89e6\u53d1\u57fa\u51c6\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u8d85\u671f\u73b0\u8c61\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6bd4\u5982\u67d0\u5b9a\u65f6\u5668\u8bbe\u7f6e OnBootSec=1s\uff0c\u4f46\u5982\u679c\u4ece\u542f\u52a8\u5185\u6838\u5230\u542f\u52a8\u5b9a\u65f6\u5668\u5df2\u7ecf\u8fc7\u4e86 2s\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b9a\u65f6\u4efb\u52a1\u5c31\u8d85\u671f\u4e86\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u597d\u5728\uff0csystemd \u4f1a\u5bf9\u8fd9\u4e24\u4e2a\u7279\u6b8a\u7684\u6307\u4ee4\u7279\u6b8a\u5bf9\u5f85\uff0c\u5982\u679c\u8fd9\u7c7b\u5b9a\u65f6\u4efb\u52a1\u8d85\u671f\u4e86\uff0c\u5c06\u7acb\u5373\u6267\u884c\u5b9a\u65f6\u4efb\u52a1\u5b9e\u73b0\u8865\u6551\u3002")),(0,a.kt)("p",null,"\u4f46\u5bf9\u5176\u5b83\u4e09\u4e2a\u6307\u4ee4\u5b9a\u4e49\u7684\u5b9a\u65f6\u5668\uff0c\u8d85\u671f\u4e86\u5c31\u8d85\u671f\u4e86\uff0c\u4e0d\u4f1a\u518d\u5c1d\u8bd5\u53bb\u8865\u6551\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5373\u4f7f\u8fc7\u4e86\u6709\u6548\u671f\uff0c\u8fd9\u4e24\u7c7b\u5b9a\u65f6\u4efb\u52a1\u8fd8\u662f\u6709\u6548\u7684\uff0c\u800c\u5176\u5b83\u5b9a\u65f6\u4efb\u52a1\u5219\u5931\u6548\u3002"),(0,a.kt)("p",null,"\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u51e0\u4e2a\u5b9a\u65f6\u5668\u6307\u4ee4\u90fd\u662f\u5355\u8c03\u5b9a\u65f6\u5668\uff0c\u5373\uff1a\u8fd9\u4e9b\u4efb\u52a1\u7684\u89e6\u53d1\u65f6\u673a\uff0c\u603b\u662f\u4ee5\u67d0\u4e2a\u65f6\u95f4\u70b9\u4e3a\u57fa\u51c6\u5355\u8c03\u589e\u52a0\u7684\u3002"),(0,a.kt)("h4",{id:"11376\u66f4\u4e3a\u7075\u6d3b\u7684\u5b9a\u65f6\u89c4\u5219oncalendar"},"11.3.7.6\u3001\u66f4\u4e3a\u7075\u6d3b\u7684\u5b9a\u65f6\u89c4\u5219\uff1aOnCalendar"),(0,a.kt)("p",null,"cron \u5b9a\u65f6\u4efb\u52a1\u652f\u6301 ","*"," ","*"," ","*"," ","*"," ","*"," \u6765\u5b9a\u4e49\u5b9a\u65f6\u4efb\u52a1\uff0c\u8fd9 5 \u4e2a\u4f4d\u7f6e\u5206\u522b\u8868\u793a\u5206 \u65f6 \u65e5 \u6708 \u5468\u3002"),(0,a.kt)("p",null,"\u524d\u9762\u5df2\u7ecf\u4ecb\u7ecd\u7684 systemd timer \u7684\u5b9a\u65f6\u89c4\u5219\u5df2\u7ecf\u80fd\u591f\u5b9e\u73b0\u53ea\u6267\u884c\u4e00\u6b21\u548c\u6bcf\u9694\u591a\u4e45\u6267\u884c\u4e00\u6b21\u7684\u5b9a\u65f6\u89c4\u5219\u3002\u4e0b\u9762\u8981\u4ecb\u7ecd\u7684 OnCalendar \u57fa\u4e8e\u65e5\u5386\u7684\u5b9a\u65f6\u89c4\u5219\u5b8c\u5168\u53ef\u4ee5\u80dc\u4efb cron \u7684\u5b9a\u65f6\u89c4\u5219\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"OnCalendar = Thu,Fri 2012-*-1,5 11:12:13\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u8fd9\u8868\u793a 2012 \u5e74\u6bcf\u4e2a\u6708\u7684 1 \u6216 5 \u53f7\u7684 11 \u70b9 12 \u5206 13 \u79d2\uff0c\u540c\u65f6\u8981\u6c42\u662f\u5468\u56db\u6216\u5468\u4e94\u3002")),(0,a.kt)("p",null,"systemd timer \u53ef\u8bc6\u522b\u7684\u65f6\u95f4\u5355\u4f4d\u5305\u62ec\u4ee5\u4e0b\u51e0\u79cd\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5fae\u79d2\u7ea7\u5355\u4f4d\uff1ausec, us, \xb5s"),(0,a.kt)("li",{parentName:"ul"},"\u6beb\u79d2\u7ea7\u5355\u4f4d\uff1amsec, ms"),(0,a.kt)("li",{parentName:"ul"},"\u79d2\u7ea7\u5355\u4f4d(\u7701\u7565\u5355\u4f4d\u65f6\u7684\u9ed8\u8ba4\u5355\u4f4d)\uff1aseconds, second, sec, s"),(0,a.kt)("li",{parentName:"ul"},"\u5206\u949f\u7ea7\u5355\u4f4d\uff1aminutes, minute, min, m"),(0,a.kt)("li",{parentName:"ul"},"\u5c0f\u65f6\u7ea7\u5355\u4f4d\uff1ahours, hour, hr, h"),(0,a.kt)("li",{parentName:"ul"},"\u5929\u7684\u5355\u4f4d\uff1adays, day, d"),(0,a.kt)("li",{parentName:"ul"},"\u5468\u7684\u5355\u4f4d\uff1aweeks, week, w",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u5468\u5355\u4f4d\u65f6\uff0c\u5fc5\u987b\u4f7f\u7528\u4e09\u5b57\u6bcd\u8868\u793a\u6cd5\u6216\u82f1\u6587\u5168\u79f0\uff0c\u5982 Fri\u3001Sun\u3001Monday"))),(0,a.kt)("li",{parentName:"ul"},"\u6708\u7684\u5355\u4f4d\uff1amonths, month, M"),(0,a.kt)("li",{parentName:"ul"},"\u5e74\u7684\u5355\u4f4d(\u4e00\u5e74\u4ee5365.25\u5929\u7b97)\uff1ayears, year, y")),(0,a.kt)("p",null,"\u591a\u4e2a\u65f6\u95f4\u5355\u4f4d\u53ef\u7ed3\u5408\u4f7f\u7528\uff0c\u4e14\u65f6\u95f4\u7684\u51fa\u73b0\u987a\u5e8f\u65e0\u5173\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\u4e0b\u9762\u7684\u65f6\u95f4\u5355\u4f4d\u90fd\u662f\u6709\u6548\u7684\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"2 h              --\x3e 2\u5c0f\u65f6\n2hours           --\x3e 2\u5c0f\u65f6\n48hr             --\x3e 48\u5c0f\u65f6\n1y 12month       --\x3e 1\u5e7412\u4e2a\u6708\uff0c\u53732\u5e74\n55s500ms         --\x3e 55\u79d2+500\u6beb\u79d2\n300ms20s 5day    --\x3e 5\u5929+20\u79d2+300\u6beb\u79d2\uff0c\u987a\u5e8f\u65e0\u5173\n")),(0,a.kt)("p",null,"\u5728\u5b9a\u65f6\u5668\u91cc\uff0c\u8fd8\u4f1a\u7ecf\u5e38\u7528\u5230\u8868\u793a\u67d0\u5e74\u67d0\u6708\u67d0\u65e5\u3001\u67d0\u65f6\u67d0\u5206\u67d0\u79d2\u7684\u65f6\u95f4\u6233\u683c\u5f0f\u3002systemd \u5185\u90e8\u7684\u6807\u51c6\u65f6\u95f4\u6233\u683c\u5f0f\u4e3a\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"Fri 2012-11-23 11:12:13\nFri 2012-11-23 11:12:13 UTC\n")),(0,a.kt)("p",null,"\u6d89\u53ca\u5230\u65f6\u533a\u683c\u5f0f\uff0c\u53ef\u4ee5\u8bbe\u8ba1\u5f97\u66f4\u590d\u6742\uff0c\u4f46\u5b9e\u9645\u4e0a\u6ca1\u6709\u5fc5\u8981\uff0c\u8981\u4e48\u4e0d\u5e26\u65f6\u533a\u5373\u9ed8\u8ba4\u672c\u5730\uff0c\u8981\u4e48\u53ea\u5e26 UTC\u3002"),(0,a.kt)("p",null,"\u6700\u524d\u9762\u7684\u5468\u51e0\u53ef\u4ee5\u7701\u7565\uff0c\u4f46\u5982\u679c\u4e0d\u7701\u7565\uff0c\u5219\u5fc5\u987b\u53ea\u80fd\u4f7f\u7528\u4e09\u5b57\u6bcd\u8868\u793a\u6cd5\u6216\u82f1\u6587\u5168\u79f0\uff0c\u5373\u5408\u7406\u7684\u5468\u51e0\u7b26\u53f7\u5305\u62ec\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"Monday      Mon\nTuesday     Tue\nWednesday   Wed\nThursday    Thu\nFriday      Fri\nSaturday    Sat\nSunday      Sun\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"\u5e74-\u6708-\u65e5")," \u4e0e ",(0,a.kt)("inlineCode",{parentName:"p"},"\u65f6:\u5206:\u79d2")," \u4e8c\u8005\u53ef\u7701\u5176\u4e00\uff0c\u4f46\u4e0d\u53ef\u5168\u7701\u3002\u82e5\u7701\u524d\u8005\uff0c\u5219\u8868\u793a\u4f7f\u7528\u5f53\u524d\u65e5\u671f\uff0c\u82e5\u7701\u540e\u8005\u5219\u8868\u793a\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"00:00:00"),"\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"\u65f6:\u5206:\u79d2")," \u53ef\u4ee5\u7701\u7565 ",(0,a.kt)("inlineCode",{parentName:"p"},":\u79d2"),"\uff0c\u76f8\u5f53\u4e8e\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},":00"),"\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"\u5e74-\u6708-\u65e5")," \u4e2d\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"\u5e74")," \u53ef\u4ee5\u7701\u7565\u4e3a2\u4f4d\u6570\u5b57\u8868\u793a\uff0c\u76f8\u5f53\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"20xx"),"\uff0c\u4f46\u5f3a\u70c8\u5efa\u8bae\u4e0d\u8981\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u6307\u5b9a\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"\u661f\u671f")," \u4e0e ",(0,a.kt)("inlineCode",{parentName:"p"},"\u5e74-\u6708-\u65e5"),"(\u5373\u4f7f\u6b64\u90e8\u5206\u5df2\u88ab\u7701\u7565) \u4e0e\u5b9e\u9645\u4e0d\u76f8\u7b26\uff0c\u90a3\u4e48\u8be5\u65f6\u95f4\u6233\u65e0\u6548\u3002"),(0,a.kt)("p",null,"\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u65f6\u95f4\u6233\u5173\u952e\u5b57\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"now"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"today"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"yesterday"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"tomorrow"),"\u3002"),(0,a.kt)("p",null,"\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u76f8\u5bf9\u65f6\u95f4\u8868\u793a\u6cd5\uff1a\u65f6\u957f\u52a0\u4e0a ",(0,a.kt)("inlineCode",{parentName:"p"},"+")," \u524d\u7f00\u6216\u8005 ",(0,a.kt)("inlineCode",{parentName:"p"},"' left'")," \u540e\u7f00(\u6ce8\u610f\u6709\u7a7a\u683c)\uff0c\u8868\u793a\u4ee5\u6b64\u65f6\u95f4\u4e3a\u57fa\u51c6\u5411\u672a\u6765\u524d\u8fdb\u6307\u5b9a\u7684\u65f6\u957f\uff0c\u65f6\u957f\u52a0\u4e0a ",(0,a.kt)("inlineCode",{parentName:"p"},"-")," \u524d\u7f00\u6216\u8005 ",(0,a.kt)("inlineCode",{parentName:"p"},"' ago'")," \u540e\u7f00(\u6ce8\u610f\u6709\u7a7a\u683c)\uff0c\u8868\u793a\u4ee5\u6b64\u65f6\u95f4\u4e3a\u57fa\u51c6\u5411\u8fc7\u53bb\u5012\u9000\u6307\u5b9a\u7684\u65f6\u957f\u3002"),(0,a.kt)("p",null,"\u6700\u540e\uff0c\u65f6\u957f\u52a0\u4e0a ",(0,a.kt)("inlineCode",{parentName:"p"},"@")," \u524d\u7f00\u8868\u793a\u76f8\u5bf9\u4e8eUNIX\u65f6\u95f4\u539f\u70b9(1970-01-01 00:00:00 UTC) \u4e4b\u540e\u591a\u957f\u65f6\u95f4\u3002"),(0,a.kt)("p",null,"\u4ee5\u4e0b\u90fd\u662f\u6709\u6548\u65f6\u95f4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5047\u8bbe\u5f53\u524d\u65f6\u95f4\u4e3a2012-11-23 18:15:22\uff0c\u65f6\u533a\u4e3aUTC+8\uff0c\u4f8b\u5982\u201cTZ=:Asia/Shanghai\u201d):\n  Fri 2012-11-23 11:12:13 \u2192 Fri 2012-11-23 11:12:13\n      2012-11-23 11:12:13 \u2192 Fri 2012-11-23 11:12:13\n  2012-11-23 11:12:13 UTC \u2192 Fri 2012-11-23 19:12:13\n               2012-11-23 \u2192 Fri 2012-11-23 00:00:00\n                 12-11-23 \u2192 Fri 2012-11-23 00:00:00\n                 11:12:13 \u2192 Fri 2012-11-23 11:12:13\n                    11:12 \u2192 Fri 2012-11-23 11:12:00\n                      now \u2192 Fri 2012-11-23 18:15:22\n                    today \u2192 Fri 2012-11-23 00:00:00\n                today UTC \u2192 Fri 2012-11-23 16:00:00\n                yesterday \u2192 Fri 2012-11-22 00:00:00\n                 tomorrow \u2192 Fri 2012-11-24 00:00:00\ntomorrow Pacific/Auckland \u2192 Thu 2012-11-23 19:00:00\n                 +3h30min \u2192 Fri 2012-11-23 21:45:22\n                      -5s \u2192 Fri 2012-11-23 18:15:17\n                11min ago \u2192 Fri 2012-11-23 18:04:22\n              @1395716396 \u2192 Tue 2014-03-25 03:59:56\n")),(0,a.kt)("p",null,"OnCalendar \u6307\u4ee4\u4f7f\u7528\u57fa\u4e8e\u65e5\u5386\u7684\u5b9a\u65f6\u89c4\u5219\uff0c\u57fa\u4e8e\u65e5\u5386\u7684\u683c\u5f0f\u662f\u5bf9 systemd \u6807\u51c6\u65f6\u95f4\u6233\u7684\u6269\u5c55\uff1a\u5728\u6807\u51c6\u65f6\u95f4\u6233\u7684\u57fa\u7840\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u989d\u5916\u7684\u8bed\u6cd5\u3002\u8fd9\u4e9b\u989d\u5916\u7684\u8bed\u6cd5\u5305\u62ec\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u53ef\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},",")," \u5217\u51fa\u79bb\u6563\u503c\uff0c\u53ef\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"..")," \u8868\u793a\u4e00\u4e2a\u8303\u56f4")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u5bf9\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"\u5e74-\u6708-\u65e5")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"\u65f6:\u5206:\u79d2")," \u8fd9\u4e24\u90e8\u5206\u7684\u6bcf\u4e2a\u5b50\u90e8\u5206\uff1a"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u53ef\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"li"},"*")," \u8868\u793a\u5339\u914d\u4efb\u610f\u503c"),(0,a.kt)("li",{parentName:"ul"},"\u53ef\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"li"},"/N"),"(N\u662f\u6574\u6570) \u540e\u7f00\u8868\u793a\u6bcf\u9694 N \u4e2a\u5355\u4f4d\uff0c\u7279\u522b\u5730 ",(0,a.kt)("inlineCode",{parentName:"li"},"/1")," \u8868\u793a\u6bcf\u6b21\u589e\u52a0\u4e00\u4e2a\u5355\u4f4d"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u5bf9\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"\u5e74-\u6708-\u65e5")," \u90e8\u5206\uff0c\u53ef\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"\u6708~\u65e5")," \u66ff\u4ee3 ",(0,a.kt)("inlineCode",{parentName:"p"},"\u6708-\u65e5")," \u8868\u793a\u4e00\u4e2a\u6708\u4e2d\u7684\u5012\u6570\u7b2c N \u5929")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u5bf9\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"\u79d2"),"\uff0c\u53ef\u4f7f\u7528\u5c0f\u6570\u8868\u793a\u66f4\u9ad8\u7cbe\u5ea6\uff0c\u6700\u9ad8\u7cbe\u5ea6\u4e3a 6 \u4f4d\u5c0f\u6570")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u4ee5\u4e0b\u7279\u6b8a\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4f5c\u4e3a\u8f83\u957f\u7684\u89c4\u8303\u5316\u5f62\u5f0f\u7684\u7b80\u5199\uff1a"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"  minutely \u2192 *-*-* *:*:00\n    hourly \u2192 *-*-* *:00:00\n     daily \u2192 *-*-* 00:00:00\n   monthly \u2192 *-*-01 00:00:00\n    weekly \u2192 Mon *-*-* 00:00:00\n    yearly \u2192 *-01-01 00:00:00\n quarterly \u2192 *-01,04,07,10-01 00:00:00\nsemiannually \u2192 *-01,07-01 00:00:00\n")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"minutely\uff1a\u6bcf\u5206\u949f"),(0,a.kt)("li",{parentName:"ul"},"hourly\uff1a\u6bcf\u5c0f\u65f6"),(0,a.kt)("li",{parentName:"ul"},"daily\uff1a\u6bcf\u5929"),(0,a.kt)("li",{parentName:"ul"},"monthly\uff1a\u6bcf\u6708"),(0,a.kt)("li",{parentName:"ul"},"weekly\uff1a\u6bcf\u5468"),(0,a.kt)("li",{parentName:"ul"},"yearly\uff1a\u6bcf\u5e74"),(0,a.kt)("li",{parentName:"ul"},"quarterly\uff1a\u6bcf\u5b63\u5ea6"),(0,a.kt)("li",{parentName:"ul"},"semiannually\uff1a\u6bcf\u534a\u5e74")))),(0,a.kt)("p",null,"\u6709\u6548\u65f6\u95f4\u6233\u53ca\u5176\u89c4\u8303\u5316\u5f62\u5f0f\u7684\u793a\u4f8b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"  Sat,Thu,Mon..Wed,Sat..Sun \u2192 Mon..Thu,Sat,Sun *-*-* 00:00:00\n      Mon,Sun 12-*-* 2,1:23 \u2192 Mon,Sun 2012-*-* 01,02:23:00\n                    Wed *-1 \u2192 Wed *-*-01 00:00:00\n           Wed..Wed,Wed *-1 \u2192 Wed *-*-01 00:00:00\n                 Wed, 17:48 \u2192 Wed *-*-* 17:48:00\nWed..Sat,Tue 12-10-15 1:2:3 \u2192 Tue..Sat 2012-10-15 01:02:03\n                *-*-7 0:0:0 \u2192 *-*-07 00:00:00\n                      10-15 \u2192 *-10-15 00:00:00\n        monday *-12-* 17:00 \u2192 Mon *-12-* 17:00:00\n  Mon,Fri *-*-3,1,2 *:30:45 \u2192 Mon,Fri *-*-01,02,03 *:30:45\n       12,14,13,12:20,10,30 \u2192 *-*-* 12,13,14:10,20,30:00\n            12..14:10,20,30 \u2192 *-*-* 12..14:10,20,30:00\n  mon,fri *-1/2-1,3 *:30:45 \u2192 Mon,Fri *-01/2-01,03 *:30:45\n             03-05 08:05:40 \u2192 *-03-05 08:05:40\n                   08:05:40 \u2192 *-*-* 08:05:40\n                      05:40 \u2192 *-*-* 05:40:00\n     Sat,Sun 12-05 08:05:40 \u2192 Sat,Sun *-12-05 08:05:40\n           Sat,Sun 08:05:40 \u2192 Sat,Sun *-*-* 08:05:40\n           2003-03-05 05:40 \u2192 2003-03-05 05:40:00\n 05:40:23.4200004/3.1700005 \u2192 *-*-* 05:40:23.420000/3.170001\n             2003-02..04-05 \u2192 2003-02..04-05 00:00:00\n       2003-03-05 05:40 UTC \u2192 2003-03-05 05:40:00 UTC\n                 2003-03-05 \u2192 2003-03-05 00:00:00\n                      03-05 \u2192 *-03-05 00:00:00\n                     hourly \u2192 *-*-* *:00:00\n                      daily \u2192 *-*-* 00:00:00\n                  daily UTC \u2192 *-*-* 00:00:00 UTC\n                    monthly \u2192 *-*-01 00:00:00\n                     weekly \u2192 Mon *-*-* 00:00:00\n    weekly Pacific/Auckland \u2192 Mon *-*-* 00:00:00 Pacific/Auckland\n                     yearly \u2192 *-01-01 00:00:00\n                   annually \u2192 *-01-01 00:00:00\n                      *:2/3 \u2192 *-*-* *:02/3:00\n")),(0,a.kt)("p",null,"\u5f53\u4e0d\u660e\u786e\u4e00\u4e2a\u57fa\u4e8e\u65e5\u5386\u8868\u793a\u6cd5\u7684\u65f6\u95f4\u65f6\uff0c\u53ef\u4f7f\u7528\u795e\u5668 ",(0,a.kt)("inlineCode",{parentName:"p"},"systemd-analyize calendar")," \u547d\u4ee4\u6765\u5206\u6790(\u65e9\u671f systemd \u7248\u672c\u4e0d\u652f\u6301 calendar \u5b50\u547d\u4ee4)\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'[root@kylinv10 ~]# systemd-analyze calendar Sat,Mon..Wed\n  Original form: Sat,Mon..Wed             \nNormalized form: Mon..Wed,Sat *-*-* 00:00:00\n    Next elapse: Sat 2021-08-07 00:00:00 CST\n       (in UTC): Fri 2021-08-06 16:00:00 UTC\n       From now: 9h left                  \n[root@kylinv10 ~]#\n\n[root@kylinv10 ~]# systemd-analyze calendar "*-05~07/1"\n  Original form: *-05~07/1                \nNormalized form: *-05~07/1 00:00:00       \n    Next elapse: Wed 2022-05-25 00:00:00 CST\n       (in UTC): Tue 2022-05-24 16:00:00 UTC\n       From now: 9 months 17 days left    \n[root@kylinv10 ~]#\n\n[root@kylinv10 ~]# systemd-analyze calendar "Mon *-05~07/1"\n  Original form: Mon *-05~07/1            \nNormalized form: Mon *-05~07/1 00:00:00   \n    Next elapse: Mon 2022-05-30 00:00:00 CST\n       (in UTC): Sun 2022-05-29 16:00:00 UTC\n       From now: 9 months 22 days left    \n[root@kylinv10 ~]#\n')),(0,a.kt)("h4",{id:"11377unit-\u548c-persistent"},"11.3.7.7\u3001Unit \u548c Persistent"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"[Timer]")," \u6bb5\u4e2d\u8fd8\u53ef\u4ee5\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"Unit")," \u6307\u4ee4\u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"Persistent")," \u6307\u4ee4\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Unit=xxx.service\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ca.timer \u5bf9\u5e94\u8981\u6267\u884c\u7684\u4efb\u52a1\u6587\u4ef6\u662f a.service\uff0c\u4f7f\u7528 Unit \u6307\u4ee4\u53ef\u4ee5\u660e\u786e\u6307\u5b9a\u89e6\u53d1\u5b9a\u65f6\u4efb\u52a1\u4e8b\u4ef6\u65f6\u8981\u6267\u884c\u7684\u6587\u4ef6"),(0,a.kt)("li",{parentName:"ul"},"Persistent=yes/no\uff1a\u53ea\u5728\u4f7f\u7528\u4e86 OnCalendar \u65f6\u6709\u6548\uff0c\u9ed8\u8ba4\u503c no\u3002\u8bbe\u7f6e yes \u65f6\uff0c\u4f1a\u5c06\u4e0a\u6b21\u6267\u884c\u4efb\u52a1\u7684\u65f6\u95f4\u70b9\u4fdd\u5b58\u5728\u78c1\u76d8\u4e0a\uff0c\u4f7f\u5f97\u5b9a\u65f6\u5668\u518d\u6b21\u88ab\u542f\u52a8\u65f6\uff0c\u53ef\u4ee5\u7acb\u5373\u5224\u65ad\u662f\u5426\u8981\u6267\u884c\u4e22\u5931\u7684\u4efb\u52a1",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4ee5\u7a7a\u6587\u4ef6\u65b9\u5f0f\u4fdd\u5b58\uff0c\u4ee5\u8be5\u7a7a\u6587\u4ef6\u7684 atime/mtime/ctime \u4fe1\u606f\u8bb0\u5f55\u6267\u884c\u4efb\u52a1\u7684\u65f6\u95f4\u70b9"),(0,a.kt)("li",{parentName:"ul"},"\u6587\u4ef6\u4fdd\u5b58\u8def\u5f84\uff1a/var/lib/systemd/timers\uff0c\u6216 ~/.local/share/systemd/(\u7528\u6237\u7ea7\u5b9a\u65f6\u5668\u4fdd\u5b58\u8def\u5f84)"),(0,a.kt)("li",{parentName:"ul"},"\u53ef\u5220\u9664\u8fd9\u4e9b\u65f6\u95f4\u6233\u6587\u4ef6\uff0c\u4f7f\u5f97\u4e0d\u4f1a\u7acb\u5373\u89e6\u53d1\u4e22\u5931\u7684\u4efb\u52a1")))),(0,a.kt)("p",null,"\u6bd4\u5982\u4e0b\u9762\u7684\u5b9a\u65f6\u4efb\u52a1\u8868\u793a\u6bcf\u5929\u51cc\u6668\u6267\u884c\u4efb\u52a1\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"OnCalendar = 00:00\nPersistent = yes\n")),(0,a.kt)("p",null,"\u56e0\u4e3a\u4f7f\u7528\u4e86 Persistent\uff0c\u6240\u4ee5\u6bcf\u6b21\u6267\u884c\u5b8c\u4efb\u52a1\u540e\u90fd\u4f1a\u5c06\u672c\u6b21\u6267\u884c\u7684\u65f6\u95f4\u70b9\u8bb0\u5f55\u5728\u78c1\u76d8\u6587\u4ef6\u4e2d\uff0c\u5982\u679c\u5728 23:59:50 \u65f6\u9047\u5230\u4e00\u6b21\u91cd\u542f\u803d\u6401 1 \u5206\u949f\uff0c\u90a3\u4e48\u5728\u91cd\u542f\u6210\u529f\u540e\u4f1a\u7acb\u5373\u6267\u884c\u8be5\u4efb\u52a1\u3002"),(0,a.kt)("p",null,"\u5982\u679c Persistent=no\uff0c\u5219\u5728\u91cd\u542f\u540e\u4e0d\u4f1a\u7acb\u5373\u6267\u884c\u4efb\u52a1\uff0c\u800c\u662f\u7b49\u5230\u4e0b\u4e00\u4e2a\u51cc\u6668\u624d\u6267\u884c\u4efb\u52a1\u3002"),(0,a.kt)("h4",{id:"11378systemd-timer-\u7528\u6237\u7ea7\u5b9a\u65f6\u4efb\u52a1"},"11.3.7.8\u3001systemd timer \u7528\u6237\u7ea7\u5b9a\u65f6\u4efb\u52a1"),(0,a.kt)("p",null,"\u7528\u6237\u7ea7\u5b9a\u65f6\u5668\u5728\u7528\u6237\u767b\u5f55\u540e\u5f00\u59cb\u542f\u52a8\uff0c\u7528\u6237\u9000\u51fa\u65f6(\u6240\u6709\u4f7f\u7528\u8be5\u7528\u6237\u542f\u52a8\u7684\u7ec8\u7aef\u7684\u4f1a\u8bdd\u90fd\u65ad\u5f00) \u505c\u6b62\u3002"),(0,a.kt)("p",null,"\u7528\u6237\u7ea7\u5b9a\u65f6\u5668\u8981\u6c42\u5c06 .timer \u548c\u5bf9\u5e94\u7684 .service \u5b9a\u4e49\u5728 ~/.config/systemd/user/ \u76ee\u5f55\u4e0b\u3002\u5982\u679c\u4f7f\u7528\u4e86 OnCalendar \u548c Persisten \u6307\u4ee4\uff0c\u65f6\u95f4\u6233\u6587\u4ef6\u4fdd\u5b58\u5728 ~/.local/share/systemd/ \u76ee\u5f55\u4e0b\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@kylinv10 ~]# mkdir -p ~/.config/systemd/user\n[root@kylinv10 ~]# cat ~/.config/systemd/user/test.service\n[Unit]\nDescription = current time when task is been executed\n\n[Service]\nExecStart = /bin/bash -c '/usr/bin/date +\"%%T\" >>/tmp/a.log'\n\n[root@kylinv10 ~]# \n[root@kylinv10 ~]# cat ~/.config/systemd/user/test.timer\n[Unit]\nDescription = user login timer\n\n[Timer]\nAccuracySec = 1ms\nRandomizedDelaySec = 0\nOnCalendar = *:*:*\n\n[Install]\nWantedBy = timer.target\n[root@kylinv10 ~]#\n")),(0,a.kt)("p",null,"\u518d\u542f\u52a8\u7528\u6237\u5b9a\u65f6\u5668\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@kylinv10 ~]# systemctl --user daemon-reload \n[root@kylinv10 ~]# systemctl --user start test.timer \n[root@kylinv10 ~]# systemctl --user list-timers \nNEXT                         LEFT       LAST                         PASSED    UNIT       AC>\nFri 2021-08-06 15:01:57 CST  510ms left Fri 2021-08-06 15:01:56 CST  488ms ago test.timer te>\n\n1 timers listed.\nPass --all to see loaded but inactive timers, too.\n")),(0,a.kt)("p",null,"\u67e5\u770b\u5b9a\u65f6\u5668\u89e6\u53d1\u7684\u4efb\u52a1\u72b6\u6001\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@kylinv10 ~]# systemctl --user status test.service\n")),(0,a.kt)("p",null,"\u505c\u6b62\u5b9a\u65f6\u5668\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@kylinv10 ~]# systemctl --user stop test.timer\n")),(0,a.kt)("h4",{id:"11379systemd-\u4e34\u65f6\u5b9a\u65f6\u4efb\u52a1"},"11.3.7.9\u3001systemd \u4e34\u65f6\u5b9a\u65f6\u4efb\u52a1"),(0,a.kt)("p",null,"systemd-run \u547d\u4ee4\u652f\u6301\u5b9a\u65f6\u5668\u7c7b\u9009\u9879\uff0c\u6240\u4ee5\u901a\u8fc7 systemd-run \u53ef\u4ee5\u542f\u52a8\u4e34\u65f6\u7684\u5b9a\u65f6\u4efb\u52a1\u3002systemd-run \u652f\u6301\u7684\u5b9a\u65f6\u5668\u9009\u9879\u6709\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u2013on-boot"),(0,a.kt)("li",{parentName:"ul"},"\u2013on-startup"),(0,a.kt)("li",{parentName:"ul"},"\u2013on-unit-active"),(0,a.kt)("li",{parentName:"ul"},"\u2013on-unit-inactive"),(0,a.kt)("li",{parentName:"ul"},"\u2013on-active"),(0,a.kt)("li",{parentName:"ul"},"\u2013on-calendar")),(0,a.kt)("p",null,"\u6b64\u5916\u8fd8\u652f\u6301 --timer-property \u9009\u9879\u5b9a\u4e49 ","[","Timer","]"," \u4e2d\u7684\u6307\u4ee4\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff1a\u5b9a\u65f6 30 \u79d2\uff0c\u6267\u884c\u4e00\u6b21\u4efb\u52a1\u540e\u81ea\u52a8\u9000\u51fa"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'# \u6267\u884c\u5b8c\u8be5\u547d\u4ee4\u540e\uff0c\u518d\u8fc7 30 \u79d2\u6267\u884c sed\uff0c\u7cbe\u786e\u89e6\u53d1\n[root@kylinv10 ~]# cat /tmp/testfile \n#\n[root@kylinv10 ~]# systemd-run --on-active=30 --timer-property=AccuracySec=100ms sed -i "/^#$/a \\# hello world" /tmp/testfile\nRunning timer as unit: run-r8bfd007edb734b399027a2b1441a09a7.timer\nWill run service as unit: run-r8bfd007edb734b399027a2b1441a09a7.service\n[root@kylinv10 ~]#\n\n# 30\u79d2\u540e\n[root@kylinv10 ~]# cat /tmp/testfile\n#\n# hello world\n')),(0,a.kt)("p",null,"\u4f8b\u5982\uff1a\u6bcf\u9694 2 \u79d2\uff0c\u6267\u884c\u4e00\u6b21\u4efb\u52a1"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'[root@kylinv10 ~]# systemd-run --on-calendar="*:*:1/2" --timer-property="AccuracySec=1us" --timer-property="RandomizedDelaySec=0" sed -i "/^#$/a \\# hello world" /tmp/testfile\nRunning timer as unit: run-r0235cfa3d8b34083ab5c5f68f5f7bf29.timer\nWill run service as unit: run-r0235cfa3d8b34083ab5c5f68f5f7bf29.service\n[root@kylinv10 ~]# \n[root@kylinv10 ~]# wc -l /tmp/testfile\n3 /tmp/testfile\n[root@kylinv10 ~]# wc -l /tmp/testfile\n4 /tmp/testfile\n[root@kylinv10 ~]# wc -l /tmp/testfile\n5 /tmp/testfile\n[root@kylinv10 ~]#\n')),(0,a.kt)("p",null,"\u6267\u884c\u5b8c\u6210\u540e\uff0c\u4f1a\u62a5\u544a\u6240\u6267\u884c\u7684 timer unit \u548c service unit\uff0c\u53ef\u901a\u8fc7\u8fd9\u4e2a\u503c\u6765\u67e5\u770b\u72b6\u6001\u6216\u7ba1\u7406\u5b83\u4eec\u3002\u4f8b\u5982\uff0c\u505c\u6b62\u8fd9\u4e2a\u4e34\u65f6\u5b9a\u65f6\u5668\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@kylinv10 ~]# systemctl stop run-r0235cfa3d8b34083ab5c5f68f5f7bf29.timer\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"\u6ce8\u610f\uff1a\u4e0a\u9762\u4e24\u4e2a\u4f8b\u5b50\u4f7f\u7528 sed \u662f\u4e3a\u4e86\u8fbe\u5230\u5b9e\u9a8c\u6548\u679c\uff0c\u5343\u4e07\u8981\u5c0f\u5fc3\uff0c\u4f7f\u7528 systemd-run \u547d\u4ee4\u751f\u6210\u7684 service \u9ed8\u8ba4\u662f\u4f7f\u7528 Type=simple \u7c7b\u578b\uff0c\u5982\u679c\u60f3\u8981\u81ea\u5b9a\u4e49\u7c7b\u578b\u8bf7\u4f7f\u7528 -u \u9009\u9879\u6307\u5b9a service \u6587\u4ef6\u3002"))),(0,a.kt)("h4",{id:"113710\u9650\u5236\u5b9a\u65f6\u4efb\u52a1\u7684\u8d44\u6e90\u4f7f\u7528\u91cf"},"11.3.7.10\u3001\u9650\u5236\u5b9a\u65f6\u4efb\u52a1\u7684\u8d44\u6e90\u4f7f\u7528\u91cf"),(0,a.kt)("p",null,"\u6709\u4e9b\u5b9a\u65f6\u4efb\u52a1\u53ef\u80fd\u4f1a\u6d88\u8017\u5927\u91cf\u8d44\u6e90\uff0c\u6bd4\u5982\u6267\u884c rsync \u7684\u5b9a\u65f6\u4efb\u52a1\u3001\u6267\u884c\u6570\u636e\u5e93\u5907\u4efd\u7684\u5b9a\u65f6\u4efb\u52a1\uff0c\u7b49\u7b49\uff0c\u5b83\u4eec\u53ef\u80fd\u4f1a\u6d88\u8017\u7f51\u7edc\u5e26\u5bbd\uff0c\u6d88\u8017 IO \u5e26\u5bbd\uff0c\u6d88\u8017 CPU \u7b49\u8d44\u6e90\u3002"),(0,a.kt)("p",null,"\u60f3\u8981\u63a7\u5236\u8fd9\u4e9b\u5b9a\u65f6\u4efb\u52a1\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u56e0\u4e3a\u771f\u6b63\u6267\u884c\u4efb\u52a1\u7684\u662f .service\uff0c\u800c Service \u914d\u7f6e\u6587\u4ef6\u4e2d\u53ef\u4ee5\u8f7b\u677e\u5730\u914d\u7f6e\u4e00\u4e9b\u8d44\u6e90\u63a7\u5236\u6307\u4ee4\u6216\u76f4\u63a5\u4f7f\u7528 Slice \u5b9a\u4e49\u7684 CGroup\u3002\u8fd9\u4e9b\u8d44\u6e90\u63a7\u5236\u7c7b\u7684\u6307\u4ee4\u53ef\u53c2\u8003 man systemd.resource-control\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c\u76f4\u63a5\u5728 ","[","Service","]"," \u4e2d\u5b9a\u4e49\u8d44\u6e90\u63a7\u5236\u6307\u4ee4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[Service]\nType=simple\nMemoryLimit=20M\nExecStart=/usr/bin/backup.sh\n")),(0,a.kt)("p",null,"\u53c8\u6216\u8005\u8ba9 Service \u4f7f\u7528\u5b9a\u4e49\u597d\u7684 Slice\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[Service]\nExecStart=/usr/bin/backup.sh\nSlice=backup.slice\n")),(0,a.kt)("p",null,"\u5176\u4e2d backup.slice \u7684\u5185\u5bb9\u4e3a\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"[root@kylinv10 ~]# cat /usr/lib/systemd/system/backup.slice\n[Unit]\nDescription=Limited resources Slice\nDefaultDependencies=no\nBefore=slices.target\n\n[Slice]\nCPUQuota=50%\nMemoryLimit=20M\n")))}p.isMDXComponent=!0},90977:function(e,t,n){t.Z=n.p+"assets/images/systemd fork daemon-8c72d2eea58f2346b3596e7879afd041.png"}}]);
<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-linux/test/linux-test-1">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">第 1 章 SPEC CPU 2017 测试 - Linux技术分享</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://zhangqf.com/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://zhangqf.com/img/logo.png"><meta data-rh="true" property="og:url" content="https://zhangqf.com/docs/linux-test-1"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="第 1 章 SPEC CPU 2017 测试 - Linux技术分享"><meta data-rh="true" name="description" content="1.1、测试简介"><meta data-rh="true" property="og:description" content="1.1、测试简介"><meta data-rh="true" name="keywords" content="linux,SPEC"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zhangqf.com/docs/linux-test-1"><link data-rh="true" rel="alternate" href="https://zhangqf.com/en/docs/linux-test-1" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://zhangqf.com/docs/linux-test-1" hreflang="zh"><link data-rh="true" rel="alternate" href="https://zhangqf.com/docs/linux-test-1" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://9B0V5WT2X8-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S4SD5NXWXF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S4SD5NXWXF",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Linux技术分享" href="/opensearch.xml">
<link rel="preconnect" href="https://zhangqf.com/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://zhangqf.com/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script>


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c9a3849aa75f9c4a4e65f846cd1a5155",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="zhangqf RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="zhangqf Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="zhangqf JSON Feed">

<link rel="icon" href="/img/logo.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)"><link rel="stylesheet" href="/assets/css/styles.86c9ae18.css">
<link rel="preload" href="/assets/js/runtime~main.9b8cde08.js" as="script">
<link rel="preload" href="/assets/js/main.98aacc98.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><span>更新 <a href="/website">网址导航</a> 带你发现感兴趣的技术</span></div><button type="button" aria-label="关闭" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">zhangqf</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/linux">Linux</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/category/Linux基础">Linux 基础</a></li><li><a class="dropdown__link" href="/docs/category/Linux进阶">Linux 进阶</a></li><li><a class="dropdown__link" href="/docs/category/Linux测试">Linux 测试</a></li><li><a class="dropdown__link" href="/docs/category/LinuxCICD">Linux CICD研发</a></li><li><a class="dropdown__link" href="/docs/skill/">笔记</a></li><li><a class="dropdown__link" href="/docs/tools/">工具推荐</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Blog</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags">标签</a></li><li><a class="dropdown__link" href="/archive">归档</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">工具</a><ul class="dropdown__menu"><li><a href="https://api.kuizuo.cn" target="_blank" rel="noopener noreferrer" class="dropdown__link">API服务</a></li><li><a href="https://js-de-obfuscator.vercel.app" target="_blank" rel="noopener noreferrer" class="dropdown__link">JS代码还原</a></li><li><a href="https://cipher.kuizuo.cn" target="_blank" rel="noopener noreferrer" class="dropdown__link">CyberChef加密</a></li></ul></div><a class="navbar__item navbar__link" href="/website">导航</a><a class="navbar__item navbar__link" href="/project">项目</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--dark_i4oU"><b>zhangqf</b></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/linux">linux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linux基础">Linux基础</a><button aria-label="打开/收起侧边栏菜单「Linux基础」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linux进阶">Linux进阶</a><button aria-label="打开/收起侧边栏菜单「Linux进阶」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/linux测试">Linux测试</a><button aria-label="打开/收起侧边栏菜单「Linux测试」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/linux-test-1">第 1 章 SPEC CPU 2017 测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-test-2">第 2 章 STREAM 内存测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-test-3">第 3 章 FIO 磁盘性能测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-test-4">第 4 章 Netperf 网络测试</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linuxcicd">Linux CICD研发</a><button aria-label="打开/收起侧边栏菜单「Linux CICD研发」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/linux测试"><span itemprop="name">Linux测试</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">第 1 章 SPEC CPU 2017 测试</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>第 1 章 SPEC CPU 2017 测试</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11测试简介">1.1、测试简介<a class="hash-link" href="#11测试简介" title="标题的直接链接">​</a></h2><p>官方文档：<a href="https://www.spec.org/cpu2017/Docs/" target="_blank" rel="noopener noreferrer">https://www.spec.org/cpu2017/Docs/</a></p><p>SPEC 成立于 1988 年，是由斯坦福大学、清华大学、微软、等全球几十所知名大学、研究机构、IT 企业组成，是一个全球性的、权威的第三方应用性能测试组织，它旨在确立、修改以及认定一系列应用性能评估的标准。</p><p>SPEC CPU 2017 是一套 CPU 子系统测试工具，包括 4 大种类共 43 个测试，包括在测试整型速度、浮点运算速度的性能测试 SPECspeed 2017、SPECspeed 2017 Floating Point 以及测试整型并发速率和浮点并发速率 SPECrate 2017 Integer 和 SPECrate 2017 Floating Point 。借助于 OpenMP 多线程 API，SPEC CPU 2017 还可以在测试过程中监控功耗。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="111套件和指标介绍">1.1.1、套件和指标介绍<a class="hash-link" href="#111套件和指标介绍" title="标题的直接链接">​</a></h3><table><thead><tr><th>简称</th><th>套件名</th><th>内容</th><th>指标</th><th>备注</th></tr></thead><tbody><tr><td>Intspeed</td><td>SPECspeed2017Integer</td><td>10 integer benchmarks</td><td>SPECspeed2017<!-- -->_<!-- -->int<!-- -->_<!-- -->base<br>SPECspeed2017<!-- -->_<!-- -->int<!-- -->_<!-- -->peak</td><td>SPECspeed套件为每个基准运行一个副本；<br>得分高的意味着花费的时间越少。</td></tr><tr><td>Fpspeed</td><td>SPECspeed2017 Floating Point</td><td>10 floating point benchmark</td><td>SPECspeed2017<!-- -->_<!-- -->fp<!-- -->_<!-- -->base<br>SPECspeed2017<!-- -->_<!-- -->fp<!-- -->_<!-- -->peak</td><td>SPECspeed套件为每个基准运行一个副本；<br>得分高的意味着花费的时间越少。</td></tr><tr><td>Intrate</td><td>SPECrate2017Integer</td><td>10 integer benchmarks</td><td>SPECrate2017<!-- -->_<!-- -->int<!-- -->_<!-- -->base<br>SPECrate2017<!-- -->_<!-- -->int<!-- -->_<!-- -->peak</td><td>SPECrate套件为每个基准运行多个并发的副本；<br>由测试人员选择多少个副本；<br>得分高的意味着有更高的吞吐量。</td></tr><tr><td>fprate</td><td>SPECrate2017Floating Point</td><td>13 floating point benchmark</td><td>SPECrate2017<!-- -->_<!-- -->fp<!-- -->_<!-- -->base<br>SPECrate2017<!-- -->_<!-- -->fp<!-- -->_<!-- -->peak</td><td>SPECrate套件为每个基准运行多个并发的副本；<br>得分高的意味着有更高的吞吐量。<br>由测试人员选择多少个副本；</td></tr></tbody></table><ul><li>可以根据自己的需要选择相应的套件运行（无需全部运行），并且选择会影响硬件的要求，SPECspeed 和 SPECrate 对内存和磁盘空间的要求都不相同；</li><li>如果使用 SPEC 公开的测试结果，则必须运行套件中的所有基准并至少产生基本度量；峰值指标是可选的，如果同时产生基础和峰值，则需要更多的磁盘空间；</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="112specspeed-指标和-specrate-指标">1.1.2、SPECspeed 指标和 SPECrate 指标<a class="hash-link" href="#112specspeed-指标和-specrate-指标" title="标题的直接链接">​</a></h3><p>有许多方法可以衡量计算机性能。其中最常见的是：</p><ul><li>时间 —— 例如，完成工作量所需的秒数。</li><li>吞吐量 —— 每单位时间完成的工作，例如每小时的工作。</li></ul><p>SPECspeed 是基于时间的指标；SPECrate 是吞吐量指标。</p><table><thead><tr><th>SPECspeed 指标</th><th>SPECrate 指标</th></tr></thead><tbody><tr><td>套件中每个基准测试运行一个副本</td><td>测试人员自己定义运行的并发副本数</td></tr><tr><td>测试人员可以选择使用多少个 OpenMP 线程</td><td>禁用 OpenMP</td></tr><tr><td>对于每个基准，性能比计算如下:<br>参考机器所用时间/SUT上的时间</td><td>对于每个基准，性能比计算如下:<br>副本数(参考机器所用的时间/SUT上的时间)</td></tr><tr><td>所用时间越少，分数越高</td><td>每单位时间做的工作越多，分数越高</td></tr></tbody></table><ul><li>对于 SPECspeed 和 SPECrate，所选比率均使用 &quot;几何平均值&quot; 进行平均，该几何平均值被报告为总体度量。</li><li>参考计算机是一台历史悠久的 Sun Microsystems 服务器，即具有 2100 MHz UltraSPARC-IV + 芯片的 Sun Fire V490。UltraSPARC-IV + 于 2006 年推出，比 CPU 2000 和 CPU 2006 参考计算机（300 MHz 1997 UltraSPARC II）中使用的芯片更新。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12前置条件">1.2、前置条件<a class="hash-link" href="#12前置条件" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="121cpu-要求">1.2.1、CPU 要求<a class="hash-link" href="#121cpu-要求" title="标题的直接链接">​</a></h3><p>SPEC 提供了用于 ARM，Power ISA，SPARC 或 X86 的工具集；支持物理 CPU、虚拟 CPU、SMP、OpenMP，可以使用 SPEC CPU 2017 来测量具有物理或虚拟 CPU/处理器 的系统的计算性能；可以选择测量系统或子集中的所有处理器；</p><p>通常，SPEC CPU 用于测量带所有物理 CPU 芯片的整个系统，不过也可以使用 SPEC CPU 2017 来测量系统上 CPU 资源的一个子集，例如使用虚拟机（VM），分区，区域，域，容器，处理器集，核心，硬件线程或其他子集；如果使用子集（例如 VM），则子集必须具有足够的内存和磁盘；</p><p>可以使用 SPEC CPU 2017 来评估任意数量的处理器的性能。通常，如果您的操作系统可以处理它，则 SPEC CPU工具集也可以处理它。</p><p><strong>SPECrate 套件</strong>可同时运行多个相同的作业。通常，操作系统使用称为 SMP（对称多处理）的功能将它们分布在 CPU 上。</p><p><strong>SPECspeed 套件</strong>一次运行一项工作。有些作业可以通过 OpenMP 或编译器自动并行化使用多个 CPU 。</p><p>以上几点总结在下表中：</p><table><thead><tr><th>注意事项</th><th>SPECspeed</th><th>SPECrate</th></tr></thead><tbody><tr><td>副本数</td><td>每个基准一次只能运行一个副本。</td><td>每个基准的多个副本同时运行。</td></tr><tr><td>编译器并行</td><td>可以使用 OpenMP 或编译器自动并行性进行编译。</td><td>禁止使用 OpenMP 和编译器 autopar。</td></tr><tr><td>如何使用？</td><td>在构建时，启用 OpenMP。 使用 runcpu --threads = N 或相应的配置文件功能。</td><td>使用 runcpu --copies 或相应的配置文件功能。</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="122内存需求">1.2.2、内存需求<a class="hash-link" href="#122内存需求" title="标题的直接链接">​</a></h3><p>物理内存：</p><table><thead><tr><th>测试项</th><th>说明</th></tr></thead><tbody><tr><td>SPECrate</td><td>每个副本 1GB（如果针对 32 位地址空间进行编译）</td></tr><tr><td>每个副本 2GB（如果为针对 64 位地址空间进行编译）</td><td></td></tr><tr><td>SPECspeed</td><td>16GB 最小系统主内存</td></tr></tbody></table><p>虚拟内存：</p><table><thead><tr><th>测试项</th><th>说明</th></tr></thead><tbody><tr><td>SPECrate</td><td>-<!-- -->m32 你可以选择 32 位或 64 位编译器，这取决于你的系统、编译器和库</td></tr><tr><td>-<!-- -->m64 检查你的编译器文档切换 -m64 和 -m32</td><td></td></tr><tr><td>SPECspeed</td><td>-<!-- -->m64 这个 SPECspeed 基准不适合运行在 32 位；编译它们需要 64 位；进程限制必须允许最大堆栈</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="123磁盘需求">1.2.3、磁盘需求<a class="hash-link" href="#123磁盘需求" title="标题的直接链接">​</a></h3><p>下面的磁盘空间仅仅是估算，不同的环境需求会不一样：</p><table><thead><tr><th>安装方式</th><th>预期用途</th><th>详细信息</th></tr></thead><tbody><tr><td>开发 250GB+1.2GB/副本</td><td>在单个系统上安装、编译和运行 做调试运行；<br>测试编译器选项保留 2 到 4 套构建和运行；<br>最后还是需要清理磁盘空间。</td><td>2.5GB 安装 SPEC CPU 2017；<br>26GB 为所有 4 件套打造基础+高峰；<br>34GB 可报告的目录，基本+峰值，4 个套件，1 个副本；<br>0.6 GB 将另一个副本添加到 intrate 和 fprate(基本+峰值)。</td></tr><tr><td>基本可报告的 40GB+0.8GB/副本</td><td>安装在其他位置构建的二进制文件；<br>对一套构建使用 --reportable(intrate，fprate，intspeed 或 fpspeed)需要在套件之间进行清理；<br>无法使用一个 runcpu 命令选择多个套件。</td><td>2.5 GB 安装 SPEC CPU 2017<br>5 GB 为所有 4 个套件安装基准二进制文件(基准+峰值)；<br>10 GB 可报告的目录，基本+峰值，1个套件，1个副本；<br>0.4 GB 添加另一个副本，基本+峰值，1套套件。</td></tr><tr><td>最小10GB+0.2GB/副本</td><td>无法执行可报告的运行。<br>无法建立完整套件(intrate，fprate，intspeed，fpspeed) 可以建立并运行1个基准测试(例如 500.perlbench<!-- -->_<!-- -->r)必须使用minimal<!-- -->_<!-- -->builddirs。必须经常运行 cpu --action = clobber。</td><td>2.5 GB 安装SPEC CPU 2017<br>2.5 GB 建立并运行最大的单一基准，minimum<!-- -->_<!-- -->builddirs，仅基于基准 0.1 GB 添加另一个副本，仅基于基准，最大的单个基准。</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="124操作系统">1.2.4、操作系统<a class="hash-link" href="#124操作系统" title="标题的直接链接">​</a></h3><p>SPEC CPU 2017 V1.0 支持的工具集：</p><table><thead><tr><th>工具集</th><th>描述</th></tr></thead><tbody><tr><td>AIX</td><td>运行 AIX V7.1 或更高版本的 64 位 PowerPC 系统。</td></tr><tr><td>linux-aarch64</td><td>运行 Linux 的 64 位 AArch64 系统</td></tr><tr><td>linux-armv7l</td><td>具有 ARM Cortex-A7 兼容 CPU 的 Linux 系统。</td></tr><tr><td>linux-ppc</td><td>运行 Linux 的 32 位 PowerPC 系统</td></tr><tr><td>linux-ppc64</td><td>64 位大端 PowerPC Linux 系统</td></tr><tr><td>linux-ppc64le</td><td>64 位 Little-endian PowerPC Linux 系统</td></tr><tr><td>linux-sparc</td><td>SPARC 硬件上的 64 位 Linux 系统</td></tr><tr><td>linux-x86<!-- -->_<!-- -->64</td><td>x86<!-- -->_<!-- -->64 Linux 系统</td></tr><tr><td>macosx-x86</td><td>英特尔系统上的 MacOS X 10.6+</td></tr><tr><td>solaris-sparc</td><td>运行 Solaris 10 08/11 或更高版本（包括 Solaris 11 和更高版本）的 64 位 SPARC 系统</td></tr><tr><td>solaris-x86</td><td>运行 Solaris 10 08/11 或更高版本（包括 Solaris 11 和更高版本）的 x86 系统</td></tr><tr><td>Windows x64</td><td>运行 Windows 7 或更高版本的 Windows 系统</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="125编译器或二进制文件">1.2.5、编译器或二进制文件<a class="hash-link" href="#125编译器或二进制文件" title="标题的直接链接">​</a></h3><p>SPEC 以源代码形式提供基准。因此，您将需要：一组编译器。这三个都是必需的：C99、C ++ 2003、Fortran 2003；或者，一组预编译的基准二进制文件（可执行文件），由同一版本的 SPEC CPU 2017 的另一个用户提供给您。</p><ul><li>请注意，SPEC 不提供二进制文件。如上所述，SPEC 提供了源代码。</li><li>由不同版本的 SPEC CPU 2017 生成的二进制文件将不起作用。</li><li>您可能还需要针对这些可执行文件的一组运行时库。</li><li>请注意，即使别人编译基准测试中，测试人员负责遵守的规则：不要不接受来自不受信任来源的二进制文件。</li><li>整数套件是 CPU 2017 的新增功能，其中包括 Fortran 基准测试。</li><li>所有套件的可报告运行都需要所有三种语言（C，C ++，Fortran）的编译。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13测试环境说明">1.3、测试环境说明<a class="hash-link" href="#13测试环境说明" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="131硬件准备">1.3.1、硬件准备<a class="hash-link" href="#131硬件准备" title="标题的直接链接">​</a></h3><table><thead><tr><th>配置</th><th>x86</th><th>arm64-single</th><th>arm64-double</th></tr></thead><tbody><tr><td>CPU</td><td>X86(Gold 6138)</td><td>arm64-64core</td><td>arm64-128core</td></tr><tr><td>MEM</td><td>256G</td><td>256G</td><td>256G</td></tr><tr><td>DISK</td><td>480G(SSD)</td><td>480G(SSD)</td><td>480G(SSD)</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="132配置-spec-cpu-2017">1.3.2、配置 spec cpu 2017<a class="hash-link" href="#132配置-spec-cpu-2017" title="标题的直接链接">​</a></h3><ol><li>安装 spec cpu 2017</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 mnt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mount -o loop cpu2017-1_0_5.iso /mnt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 mnt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cd /mnt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 mnt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ./install.sh -d /opt/spec2017</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Installation successful.  Source the shrc or cshrc </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/opt/spec2017</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">to </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> up your environment </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> the benchmark.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 mnt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cd /opt/spec2017/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">benchspec  cshrc        install.sh   PTDaemon    Revisions  tmp           uninstall.sh</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bin        Docs         LICENSE.txt  README.txt  shrc       tools         version.txt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">config     install.bat  MANIFEST     result      shrc.bat   TOOLS.sha512</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># source shrc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li><p>配置 runspec 运行测试的环境配置文件</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># yum install gcc gcc-c++ gcc-gfortran -y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># which gcc g++ gfortran </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/bin/gcc</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/bin/g++</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/bin/gfortran</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cd /opt/spec2017/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cp config/Example-gcc-linux-aarch64.cfg config/brinnatt.cfg</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># vim config/brinnatt.cfg</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#      Use:                 %   define gcc_dir /opt/rh/devtoolset-6/root/usr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#      Use:                 %   define gcc_dir /disk1/mybuild/gcc-8.1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#      Use:                 %   define gcc_dir /usr 这里要指向刚查看的 gcc g++ gfortran 的路径</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>编译器 gcc g++ gfortran 三者缺一不可。</li><li>配置文件我们就借鉴官方的 Example-gcc-linux-aarch64.cfg 文件，取名为 brinnatt.cfg。</li><li>把 brinnatt.cfg 稍作修改，特别是 define gcc<!-- -->_<!-- -->dir 同时定义的是 gcc，g++ 和 gfortran 路径，若三者路径不一致需各自定义。</li></ul></li><li><p>配置编译器参数描述文件，不然生成的报告会出现 invalid 水印</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cp config/flags/gcc.xml config/flags/brinnatt.xml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>直接借用官方 gcc.xml 描述文件，取名为 brinnatt.xml。</p></li><li><p>注意，如果不手动指定描述文件也是可以的，但必须在环境配置文件中提前指定，以手动指定优先级最高，比如，brinnatt.cfg 配置文件中已指定如下。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">flagsurl             </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">top</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">/config/flags/gcc.xml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>查看 runcpu 测试命令的用法</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># runcpu --help</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--config </span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -c file: 用于指定本次运行的配置文件</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--size </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -i:             规模选择，分为test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">简单规模模式，测试时间最短</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">、train</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">中级规模模式，测试时间居中</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">、ref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">高级规模模式，测试时间最长</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">；</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--tune </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -T:             测试基准，分为base</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">基准值</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">和peak</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">峰值</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">，all表示SPEC CPU2017将运行基准测试程序中的所有测试项目；</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--iterations</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -n:     测试次数，官方建议为3次，设置3次可自动计算分数，设置1次需要手算分数；</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--copies </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -C:               测试核数，如-C </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain">；</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--reportable </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -s:           生成可报告的结果</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--threads:                   测试speed则需添加。如果选择speed度量方式，其核数固定为1，不可更改。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--flagsurl </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -F gcc.xml: 去除pdf报告水印。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>这里只给出了我常用的几个选项，可以自行查看帮助信息。</li><li>runcpu --update 可连接外网更新 benchmark 套件，example flag files 和 config files。目前手上 speccpu2017 安装包版本为 V1.0.5，连外网可升级到最新版本 V1.1.0。</li></ul></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="14运行-runcpu-测试">1.4、运行 runcpu 测试<a class="hash-link" href="#14运行-runcpu-测试" title="标题的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># runcpu --config /opt/spec2017/config/brinnatt.cfg --flags /opt/spec2017/config/flags/brinnatt.xml --reportable --tune base --iterations=3 intrate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># runcpu --config /opt/spec2017/config/brinnatt.cfg --flags /opt/spec2017/config/flags/brinnatt.xml --reportable --tune base --iterations=3 intspeed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># runcpu --config /opt/spec2017/config/brinnatt.cfg --flags /opt/spec2017/config/flags/brinnatt.xml --reportable --tune base --iterations=3 fprate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># runcpu --config /opt/spec2017/config/brinnatt.cfg --flags /opt/spec2017/config/flags/brinnatt.xml --reportable --tune base --iterations=3 fpspeed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>在测试 fpspeed 时，627.cam4<!-- -->_<!-- -->s 对堆栈使用过大，默认的 120M 不能满足需求，需改为 1G 或更大；</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># vim config/brinnatt.cfg</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">fpspeed:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 627.cam4 needs a big stack; the preENV will apply it to all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># benchmarks in the set, as required by the rules.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    preENV_OMP_STACKSIZE </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> 120M --</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> 改成 1G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>还需要调整操作系统的内核堆栈大小；</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 查看一下当前系统的一些限制</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ulimit -a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">core </span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"> size          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">blocks, -c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">data seg size           </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -d</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">scheduling priority             </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"> size               </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">blocks, -f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pending signals                 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1036505</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">max locked memory       </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -l</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">max memory size         </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token plain"> files                      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pipe size            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes, -p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">POSIX message queues     </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">bytes, -q</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">819200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">real-time priority              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stack size              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8192</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cpu </span><span class="token function" style="color:rgb(0, 0, 255)">time</span><span class="token plain">               </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">seconds, -t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">max user processes              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-u</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1036505</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virtual memory          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"> locks                      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 解开 stack size 的限制</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ulimit -s unlimited</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ulimit -a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">core </span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"> size          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">blocks, -c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">data seg size           </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -d</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">scheduling priority             </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"> size               </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">blocks, -f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pending signals                 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1036505</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">max locked memory       </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -l</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">max memory size         </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">open</span><span class="token plain"> files                      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pipe size            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">512</span><span class="token plain"> bytes, -p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">POSIX message queues     </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">bytes, -q</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">819200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">real-time priority              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stack size              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">cpu </span><span class="token function" style="color:rgb(0, 0, 255)">time</span><span class="token plain">               </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">seconds, -t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">max user processes              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-u</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1036505</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virtual memory          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">kbytes, -v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain"> locks                      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">-x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 spec2017</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>为了方便，我这里是直接改成了 unlimited，注意这个设置只在当前 shell 生效，想要永久生效，写在 /etc/security/limits.conf 配置文件中。</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="15测试结果">1.5、测试结果<a class="hash-link" href="#15测试结果" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="151物理服务器满核测试结果">1.5.1、物理服务器满核测试结果<a class="hash-link" href="#151物理服务器满核测试结果" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="cpu full" src="/assets/images/cpu full-30e7b0e5b21c44088a455c8a1bb9aa98.png" width="808" height="860" class="img_ev3q"></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="152物理服务器运行-64-个副本并发的测试结果">1.5.2、物理服务器运行 64 个副本并发的测试结果<a class="hash-link" href="#152物理服务器运行-64-个副本并发的测试结果" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="cpu 64" src="/assets/images/cpu 64-7cd5c89b10b74210601cc7569336ee88.png" width="808" height="864" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="a附录">A、附录<a class="hash-link" href="#a附录" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="a1performancetest-测试">A1、PerformanceTEST 测试<a class="hash-link" href="#a1performancetest-测试" title="标题的直接链接">​</a></h3><p>SPEC CPU 2017 虽说是业内比较权威的 CPU 测试方案，但是使用起来没有那么便捷。相比较而言，PerformanceTEST 这个工具使用起来就非常简单，这个工具同样是一款商业软件，在 windows 上应用比较广泛，类似 &quot;鲁大师跑分&quot;，针对 Linux、MAC 和 Android 免费。</p><p>官方地址：<a href="https://www.passmark.com/products/performancetest/" target="_blank" rel="noopener noreferrer">https://www.passmark.com/products/performancetest/</a></p><p>在 4c8g 的 arm64 台式机上测试：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># wget wget https://www.passmark.com/downloads/pt_linux_arm64.zip</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">pt_linux_arm64.zip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># unzip pt_linux_arm64.zip </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">存档文件:  pt_linux_arm64.zip</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   creating: PerformanceTest/</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  inflating: PerformanceTest/pt_linux_arm64  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  inflating: PerformanceTest/readme.txt  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># cd PerformanceTest/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~/PerformanceTest</span><span class="token comment" style="color:rgb(0, 128, 0)"># ./pt_linux_arm64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                          PassMark PerformanceTest Linux</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Phytium,FT-2000/4 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">aarch64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> cores @ </span><span class="token number" style="color:rgb(9, 134, 88)">2600</span><span class="token plain"> MHz  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">7.7</span><span class="token plain"> GiB RAM</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Number of Processes: </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  Test Iterations: </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">  Test Duration: Medium</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CPU Mark:                          </span><span class="token number" style="color:rgb(9, 134, 88)">1685</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Integer Math                     </span><span class="token number" style="color:rgb(9, 134, 88)">17435</span><span class="token plain"> Million Operations/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Floating Point Math              </span><span class="token number" style="color:rgb(9, 134, 88)">6058</span><span class="token plain"> Million Operations/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Prime Numbers                    </span><span class="token number" style="color:rgb(9, 134, 88)">16.8</span><span class="token plain"> Million Primes/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Sorting                          </span><span class="token number" style="color:rgb(9, 134, 88)">7362</span><span class="token plain"> Thousand Strings/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Encryption                       </span><span class="token number" style="color:rgb(9, 134, 88)">343</span><span class="token plain"> MB/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Compression                      </span><span class="token number" style="color:rgb(9, 134, 88)">12827</span><span class="token plain"> KB/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  CPU Single Threaded              </span><span class="token number" style="color:rgb(9, 134, 88)">680</span><span class="token plain"> Million Operations/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Physics                          </span><span class="token number" style="color:rgb(9, 134, 88)">222</span><span class="token plain"> Frames/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Extended Instructions </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">NEON</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">1128</span><span class="token plain"> Million Matrices/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Memory Mark:                       </span><span class="token number" style="color:rgb(9, 134, 88)">1130</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Database Operations              </span><span class="token number" style="color:rgb(9, 134, 88)">1536</span><span class="token plain"> Thousand Operations/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Memory Read Cached               </span><span class="token number" style="color:rgb(9, 134, 88)">9472</span><span class="token plain"> MB/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Memory Read Uncached             </span><span class="token number" style="color:rgb(9, 134, 88)">6558</span><span class="token plain"> MB/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Memory Write                     </span><span class="token number" style="color:rgb(9, 134, 88)">7239</span><span class="token plain"> MB/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Available RAM                    </span><span class="token number" style="color:rgb(9, 134, 88)">5277</span><span class="token plain"> Megabytes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Memory Latency                   </span><span class="token number" style="color:rgb(9, 134, 88)">107</span><span class="token plain"> Nanoseconds</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Memory Threaded                  </span><span class="token number" style="color:rgb(9, 134, 88)">14138</span><span class="token plain"> MB/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Results not submitted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Upload results to cpubenchmark.net? </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">Y/n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Use ESC or CTRL-C to </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">A: Run All Tests   C: Run CPU Tests   M: Run Memory Tests   U: Upload Test Results</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="a2stress-ng-测试">A2、stress-ng 测试<a class="hash-link" href="#a2stress-ng-测试" title="标题的直接链接">​</a></h3><p>stress-ng 以各种可选择的方式对计算机系统进行压力测试。它被设计用来测试计算机的各种物理子系统以及各种操作系统内核接口。stress-ng 特点：</p><ul><li>超过 260 种压力测试</li><li>85 种以上的 CPU 特定的压力测试，用来测试浮点、整数、位操作和控制流</li><li>超过 20 个虚拟内存压力测试</li><li>可移植性强，支持 Linux、Solaris、BSD、Android、MacOS X 以及 windows 等操作系统；同时支持 x86-64、i386、s390x、ppc64el、armhf、arm64、sparc64、risc-v、m68k 以及 mips64 等硬件架构。</li></ul><p>stress-ng 设计的初衷是让操作系统在苛刻的环境下运行，把硬件的极限表达出来，在一些硬件或操作系统有漏洞的情况下，可能发生意想不到的热运行，导致无法停止，甚至使操作系统受到重创。所以要做好提前预防。</p><p>在 root 权限下运行 stress-ng 将调整 Linux 系统上的内存设置，以使压力源在内存不足的情况下不被杀死，因此要谨慎使用这种方法。使用适当的特权，stress-ng 可以允许调整 ionice 类和 ionice 级别，同样，要谨慎使用。</p><p>另外 stress-ng 不是一个专业的性能测试套件，也无法像 spec cpu 2017 那样得到专业的数据分析报告。因此，使用 stress-ng 只是对你的硬件和操作系统进行一次压力测试，让你对即将使用的这套设备有足够的了解。</p><p>下面我们使用 rpm 自带的安装源进行 stress-ng 安装，做一些初级测试；如果想使用 stress-ng 源码编译安装，不防参考 <a href="https://github.com/ColinIanKing/stress-ng" target="_blank" rel="noopener noreferrer">https://github.com/ColinIanKing/stress-ng</a>。</p><ol><li><p>运行 8 个 workers 虚拟内存压力源，填充可用内存的 80%，运行 1 个小时；因此每个压力源占据可用内存的 10%。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --vm </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> --vm-bytes </span><span class="token number" style="color:rgb(9, 134, 88)">80</span><span class="token plain">% -t 1h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>运行 4 个 cpu workers 压力源；运行 2 个 io workers 压力源；运行 1 个虚拟内存 work 压力源，映射虚拟内存 1G；运行 60 秒。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --cpu </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> --io </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> --vm </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> --vm-bytes 1G --timeout 60s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>运行 2 个 mixed I/O 实例，占据可用文件系统空间的 10%，运行 10 分钟；也就是每一个压力源占据可用文件系统空间的 5%。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --iomix </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> --iomix-bytes </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">% -t 10m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>通过 hdd 压力源测量 real time 调度延迟，它使用高分辨率纳秒时钟来测量 10000 纳秒睡眠期间的延迟。1 分钟的压力测试之后，将显示间隔为 2500 ns 的时延分布。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --cyclic </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> --cyclic-dist </span><span class="token number" style="color:rgb(9, 134, 88)">2500</span><span class="token plain"> --cyclic-method clock_ns --cyclic-prio </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> --cyclic-sleep </span><span class="token number" style="color:rgb(9, 134, 88)">10000</span><span class="token plain"> --hdd </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> -t 1m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>注意：必须与 CAP<!-- -->_<!-- -->SYS<!-- -->_<!-- -->NICE 功能一起运行，以启用实时调度以获得精确的测量。</li></ul></li><li><p>运行 8 个 cpu 压力源，经过 800000 bogo 操作后停止</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --cpu </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> --cpu-ops </span><span class="token number" style="color:rgb(9, 134, 88)">800000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>Bogo Ops：stress -ng 使用 &quot;bogus operations per second&quot; 也就是每秒伪操作来度量压力测试的 &quot;吞吐量&quot;。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># stress-ng --cpu 4 --cpu-ops 8000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9175</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> defaulting to a </span><span class="token number" style="color:rgb(9, 134, 88)">86400</span><span class="token plain"> second run per stressor</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9175</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> dispatching hogs: </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> cpu</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9175</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> cache allocate: using built-in defaults as unable to determine cache details</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9175</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> cache allocate: default cache size: 2048K</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9175</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> successful run completed </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain">.11s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)"># stress-ng --cpu 4 --cpu-ops 8000 --metrics-brief</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9206</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> defaulting to a </span><span class="token number" style="color:rgb(9, 134, 88)">86400</span><span class="token plain"> second run per stressor</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9206</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> dispatching hogs: </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> cpu</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9206</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> cache allocate: using built-in defaults as unable to determine cache details</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9206</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> cache allocate: default cache size: 2048K</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9206</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> successful run completed </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain">.62s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9206</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> stressor      bogo ops real </span><span class="token function" style="color:rgb(0, 0, 255)">time</span><span class="token plain">  usr </span><span class="token function" style="color:rgb(0, 0, 255)">time</span><span class="token plain">  sys </span><span class="token function" style="color:rgb(0, 0, 255)">time</span><span class="token plain">   bogo ops/s   bogo ops/s</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9206</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">secs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">secs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">secs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">   </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">real </span><span class="token function" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">usr+sys </span><span class="token function" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng: info:  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">9206</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> cpu               </span><span class="token number" style="color:rgb(9, 134, 88)">8000</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">23.56</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">93.66</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0.00</span><span class="token plain">       </span><span class="token number" style="color:rgb(9, 134, 88)">339.50</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">85.42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">root@arm64v8:~</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>使用 --metrics-brief 选项显示 bogo ops。</li></ul></li></ul></li><li><p>其它示例</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># run 2 simultaneous instances of all the stressors sequentially one by one, each for 2 minutes and summarise with performance metrics at the end.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --sequential </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> --timeout 2m --metrics</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run 4 FFT cpu stressors, stop after 10000 bogo operations and produce a summary just for the FFT results.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --cpu </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> --cpu-method fft --cpu-ops </span><span class="token number" style="color:rgb(9, 134, 88)">10000</span><span class="token plain"> --metrics-brief</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run cpu stressors on all online CPUs working through all the available CPU stressors for 1 hour, loading the CPUs at 90% load capacity.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --cpu -1 --cpu-method all -t 1h --cpu-load </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run cpu stressors on all configured CPUs working through all the available CPU stressors for 20 minutes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --cpu </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> --cpu-method all -t 20m</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run 4 instances of all the stressors for 5 minutes.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --all </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> --timeout 5m</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run 64 stressors that are randomly chosen from all the available stressors.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --random </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run 64 instances of all the different cpu stressors and verify that the computations are correct for 10 minutes with a bogo operations summary at the end.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --cpu </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain"> --cpu-method all --verify -t 10m --metrics-brief</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run all the stressors one by one for 10 minutes, with the number of instances of each stressor matching the number of online CPUs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --sequential -1 -t 10m</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run all the stressors in the io class one by one for 5 minutes each, with 8 instances of each stressor running concurrently and show overall time utilisation statistics at  the  end  of  the run.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --sequential </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> --class io -t 5m --times</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run all the stressors (1 instance of each per online CPU) simultaneously, maximize the settings (memory sizes, file allocations, etc.) and select the most demanding/aggressive options.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --all -1 --maximize --aggressive</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run 32 randomly selected stressors and exclude the numa, hdd and key stressors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --random </span><span class="token number" style="color:rgb(9, 134, 88)">32</span><span class="token plain"> -x numa,hdd,key</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run 4 instances of the VM stressors one after each other, excluding the bigheap, brk and stack stressors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --sequential </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> --class vm --exclude bigheap,brk,stack</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># run 3 instances of the CPU stressor and pin them to CPUs 0, 2 and 3.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">stress-ng --taskset </span><span class="token number" style="color:rgb(9, 134, 88)">0,2</span><span class="token plain">-3 --cpu </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p>由于本附录只是作为一个关于 cpu 的补充测试，所以没有针对 stress-ng 这个工具做深入的探讨，想要更深入，不防参考 <code>man stress-ng</code>，<a href="https://wiki.ubuntu.com/Kernel/Reference/stress-ng" target="_blank" rel="noopener noreferrer">https://wiki.ubuntu.com/Kernel/Reference/stress-ng</a> 等相关的文章。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/linux测试"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Linux测试</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/linux-test-2"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">第 2 章 STREAM 内存测试</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#11测试简介" class="table-of-contents__link toc-highlight">1.1、测试简介</a><ul><li><a href="#111套件和指标介绍" class="table-of-contents__link toc-highlight">1.1.1、套件和指标介绍</a></li><li><a href="#112specspeed-指标和-specrate-指标" class="table-of-contents__link toc-highlight">1.1.2、SPECspeed 指标和 SPECrate 指标</a></li></ul></li><li><a href="#12前置条件" class="table-of-contents__link toc-highlight">1.2、前置条件</a><ul><li><a href="#121cpu-要求" class="table-of-contents__link toc-highlight">1.2.1、CPU 要求</a></li><li><a href="#122内存需求" class="table-of-contents__link toc-highlight">1.2.2、内存需求</a></li><li><a href="#123磁盘需求" class="table-of-contents__link toc-highlight">1.2.3、磁盘需求</a></li><li><a href="#124操作系统" class="table-of-contents__link toc-highlight">1.2.4、操作系统</a></li><li><a href="#125编译器或二进制文件" class="table-of-contents__link toc-highlight">1.2.5、编译器或二进制文件</a></li></ul></li><li><a href="#13测试环境说明" class="table-of-contents__link toc-highlight">1.3、测试环境说明</a><ul><li><a href="#131硬件准备" class="table-of-contents__link toc-highlight">1.3.1、硬件准备</a></li><li><a href="#132配置-spec-cpu-2017" class="table-of-contents__link toc-highlight">1.3.2、配置 spec cpu 2017</a></li></ul></li><li><a href="#14运行-runcpu-测试" class="table-of-contents__link toc-highlight">1.4、运行 runcpu 测试</a></li><li><a href="#15测试结果" class="table-of-contents__link toc-highlight">1.5、测试结果</a><ul><li><a href="#151物理服务器满核测试结果" class="table-of-contents__link toc-highlight">1.5.1、物理服务器满核测试结果</a></li><li><a href="#152物理服务器运行-64-个副本并发的测试结果" class="table-of-contents__link toc-highlight">1.5.2、物理服务器运行 64 个副本并发的测试结果</a></li></ul></li><li><a href="#a附录" class="table-of-contents__link toc-highlight">A、附录</a><ul><li><a href="#a1performancetest-测试" class="table-of-contents__link toc-highlight">A1、PerformanceTEST 测试</a></li><li><a href="#a2stress-ng-测试" class="table-of-contents__link toc-highlight">A2、stress-ng 测试</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">学习</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tags">标签</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">归档</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/skill">技术笔记</a></li><li class="footer__item"><a class="footer__link-item" href="/project">实战项目</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/linux">Linux</a></li></ul></div><div class="col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">关于我</a></li><li class="footer__item"><a href="https://github.com/zqingfa" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/friends">友链</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/website">导航</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p><a href="http://beian.miit.gov.cn/">浙ICP备20024502号-1</a></p><p>Copyright © 2022 - PRESENT zhangqf Built with Docusaurus.</p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.9b8cde08.js"></script>
<script src="/assets/js/main.98aacc98.js"></script>
</body>
</html>
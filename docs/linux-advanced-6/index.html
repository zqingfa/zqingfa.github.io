<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-linux/advanced/linux-advanced-6">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">第 6 章 Linux httpd 服务基础配置 - Linux技术分享</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://zhangqf.com/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://zhangqf.com/img/logo.png"><meta data-rh="true" property="og:url" content="https://zhangqf.com/docs/linux-advanced-6"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="第 6 章 Linux httpd 服务基础配置 - Linux技术分享"><meta data-rh="true" name="description" content="目前最流行的 web 服务器软件叫做 httpd，httpd 还有一个俗称叫 apache，Apache 是一个软件基金会，httpd 也是这个软件基金会的一个项目。"><meta data-rh="true" property="og:description" content="目前最流行的 web 服务器软件叫做 httpd，httpd 还有一个俗称叫 apache，Apache 是一个软件基金会，httpd 也是这个软件基金会的一个项目。"><meta data-rh="true" name="keywords" content="linux,httpd"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zhangqf.com/docs/linux-advanced-6"><link data-rh="true" rel="alternate" href="https://zhangqf.com/en/docs/linux-advanced-6" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://zhangqf.com/docs/linux-advanced-6" hreflang="zh"><link data-rh="true" rel="alternate" href="https://zhangqf.com/docs/linux-advanced-6" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://9B0V5WT2X8-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S4SD5NXWXF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S4SD5NXWXF",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Linux技术分享" href="/opensearch.xml">
<link rel="preconnect" href="https://zhangqf.com/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://zhangqf.com/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script>


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?77dc6b24cf1d939292e9fe13be271a96",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="zhangqf RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="zhangqf Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="zhangqf JSON Feed">

<link rel="icon" href="/img/logo.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)"><link rel="stylesheet" href="/assets/css/styles.86c9ae18.css">
<link rel="preload" href="/assets/js/runtime~main.6d616132.js" as="script">
<link rel="preload" href="/assets/js/main.26bbf6d2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><span>更新 <a href="/website">网址导航</a> 带你发现感兴趣的技术</span></div><button type="button" aria-label="关闭" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">zhangqf</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/linux">Linux</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/category/Linux基础">Linux 基础</a></li><li><a class="dropdown__link" href="/docs/category/Linux进阶">Linux 进阶</a></li><li><a class="dropdown__link" href="/docs/category/Linux测试">Linux 测试</a></li><li><a class="dropdown__link" href="/docs/category/LinuxCICD">Linux CICD研发</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Blog</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags">标签</a></li><li><a class="dropdown__link" href="/archive">归档</a></li></ul></div><a class="navbar__item navbar__link" href="/website">导航</a><a class="navbar__item navbar__link" href="/project">项目</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文</a><ul class="dropdown__menu"><li><a href="/en/docs/linux-advanced-6" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-GB">English</a></li><li><a href="/docs/linux-advanced-6" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">中文</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--dark_i4oU"><b>zhangqf</b></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/linux">linux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linux基础">Linux基础</a><button aria-label="打开/收起侧边栏菜单「Linux基础」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/linux进阶">Linux进阶</a><button aria-label="打开/收起侧边栏菜单「Linux进阶」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-1">第 1 章 Linux 进阶命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-2">第 2 章 Linux 防火墙</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-3">第 3 章 Linux NFS 网络文件系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-4">第 4 章 Linux DHCP 服务</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-5">第 5 章 Linux DNS 服务</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/linux-advanced-6">第 6 章 Linux httpd 服务基础配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-7">第 7 章 Linux httpd 服务进阶配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-8">第 8 章 Linux httpd 服务高级配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-9">第 9 章 Linux Nginx 服务配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-10">第 10 章 Linux Tomcat 服务基础配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-11">第 11 章 Linux Tomcat 服务实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-12">第 12 章 Linux haproxy 服务基础配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-13">第 13 章 Linux haproxy 服务进阶配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-14">第 14 章 Linux haproxy 服务高级配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-15">第 15 章 Linux LVS 服务配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-advanced-16">第 16 章 Linux Keepalived 服务配置</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linux测试">Linux测试</a><button aria-label="打开/收起侧边栏菜单「Linux测试」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linuxcicd">Linux CICD研发</a><button aria-label="打开/收起侧边栏菜单「Linux CICD研发」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/linux进阶"><span itemprop="name">Linux进阶</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">第 6 章 Linux httpd 服务基础配置</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>第 6 章 Linux httpd 服务基础配置</h1></header><p>目前最流行的 web 服务器软件叫做 httpd，httpd 还有一个俗称叫 apache，Apache 是一个软件基金会，httpd 也是这个软件基金会的一个项目。</p><p>httpd 是一个开源软件，市场应用非常广泛，功能也十分丰富。当然这就造成 httpd 体系庞大，结构臃肿，好在 httpd 是一个高度模块化软件，由核心（core）和模块（module）组成。这些模块大都是动态模块，因此可以随时加载。</p><p>本文主要针对 httpd 的基础配置和基本指令加以说明。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="61httpdapachectl-命令">6.1、httpd/apachectl 命令<a class="hash-link" href="#61httpdapachectl-命令" title="标题的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># httpd -h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Usage: httpd </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-D name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-d directory</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-f file</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-C </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;directive&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-c </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;directive&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-k start</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">restart</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">graceful</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">graceful-stop</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">stop</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-V</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-h</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-l</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-L</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-S</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-X</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Options:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -D name            </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 在</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> IfDefine name </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">中定义配置参数，当服务启动或者重启时执行命令或设置条件。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -d directory       </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 指定ServerRoot</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -f </span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 指定配置文件</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -C </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;directive&quot;</span><span class="token plain">     </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 指定在加载配置文件前要处理的指令</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">directive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -c </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;directive&quot;</span><span class="token plain">     </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 指定在加载配置文件后要处理的指令</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -e level           </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示httpd启动时的日志调试级别</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -E </span><span class="token function" style="color:rgb(0, 0, 255)">file</span><span class="token plain">            </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 将启动信息记录到指定文件中</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -v                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示版本号</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -V                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示编译配置选项</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -h                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示帮助信息</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -l                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示已编译但非动态编译的模块，即静态编译的模块</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -L                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示静态模块可用的指令列表</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -t -D DUMP_VHOSTS  </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示虚拟主机的设置信息</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -t -D DUMP_RUN_CFG </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示运行参数</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -S                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 等价于-t -D DUMP_VHOSTS -D DUMP_RUN_CFG。在调试如何解析配置文件时非常非常有用</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -t -D DUMP_MODULES </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 显示所有已被加载的模块，包括静态和动态编译的模块</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -M                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 等价于-t -D DUMP_MODULES</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -t                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 检查配置文件语法</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -T                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 不检查DocumentRoot，直接启动</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -X                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 调试模式，此模式下httpd进程依赖于终端</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -k                 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain"> 管理httpd进程，接受start</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">restart</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">graceful</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">graceful-stop</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">stop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>apachectl 命令和 httpd 命令基本相同。httpd 接受的选项，apachectl 都接受。但 apachectl 还可以省略 &quot;-k&quot; 选项直接管理 httpd 进程。</p><ul><li><code>apachectl [-k] start</code>：按照默认路径，读取默认配置文件，并启动 httpd。</li><li><code>apachectl [-k] stop</code>：关闭 httpd 进程。</li><li><code>apachectl [-k] restart</code>：重启 httpd 进程。</li><li><code>apachectl [-k] graceful-stop</code>：graceful stop，表示让已运行的 httpd 进程不再接受新请求，并给他们足够的时间处理当前正在处理的事情，处理完成后才退出。所以在进程退出前，日志文件暂时不会关闭，正在进行的连接暂时不会断开。</li><li><code>apachectl [-k] graceful</code>：graceful restart，即 graceful-stop+start。</li><li><code>apachectl [-k] configtest</code>：语法检查。</li></ul><p>在 systemd 环境下，还可以使用 <code>apacectl status</code> 或 <code>systemctl status httpd</code> 查看 httpd 进程的详细信息。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="62配置文件规则和常见指令">6.2、配置文件规则和常见指令<a class="hash-link" href="#62配置文件规则和常见指令" title="标题的直接链接">​</a></h2><p>httpd 的核心体现在配置文件，各种功能都通过配置文件来实现。使用 rpm 包安装的 httpd 默认配置文件为 /etc/httpd/conf/httpd.conf。可以使用 <code>httpd -f config_path</code> 指定要加载的配置文件。</p><p>配置文件中全是一些指令配置，每个指令都是某个模块提供的。以下是配置文件的一些规则：</p><ol><li>指令生效方式是从上往下读取，这一点非常非常重要。很多指令的位置强烈建议不要改变，例如 <code>Include conf.d/*.conf</code> 指令建议不要移动位置。</li><li>&quot;#&quot; 开头的行为注释行，只能行头注释，不能行中注释。</li><li>对大小写不敏感，但是建议指令名称采用 &quot;驼峰式&quot; 命名。例如 ServerRoot，DocumentRoot。</li><li>一行写不下的可以使用 <code>&quot;\&quot;</code> 续行，但是 <code>&quot;\&quot;</code> 后不能有任何字符，包括空格也不允许。</li><li>指令配置格式为 &quot;Directive value&quot;，例如 &quot;ServerRoot /etc/httpd&quot;，如果 value 中包含特殊字符或空格，则必须使用双引号包围。</li><li>由于可以通过 Include 指令包含其他配置文件，又支持各种路径的容器，所以在 httpd 启动时会先进行配置文件的合并。理解合并规则非常重要，具体见 <a href="https://www.brinnatt.com/further/%e7%ac%ac-6-%e7%ab%a0-linux-httpd-%e6%9c%8d%e5%8a%a1%e5%9f%ba%e7%a1%80%e9%85%8d%e7%bd%ae/#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%90%88%E5%B9%B6%E8%A7%84%E5%88%99" target="_blank" rel="noopener noreferrer">配置文件合并规则</a>。</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="621listen-指令">6.2.1、Listen 指令<a class="hash-link" href="#621listen-指令" title="标题的直接链接">​</a></h3><p>设置监听套接字。设置方式很简单，包括以下几种情况：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 监听两个端口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Listen </span><span class="token number" style="color:rgb(9, 134, 88)">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Listen </span><span class="token number" style="color:rgb(9, 134, 88)">8000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 监听套接字绑定在给定地址和端口上</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Listen </span><span class="token number" style="color:rgb(9, 134, 88)">192.170</span><span class="token plain">.2.1:80</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Listen </span><span class="token number" style="color:rgb(9, 134, 88)">192.170</span><span class="token plain">.2.5:8000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="622serverroot-指令">6.2.2、ServerRoot 指令<a class="hash-link" href="#622serverroot-指令" title="标题的直接链接">​</a></h3><p>该指令设置 httpd 的安装位置，也就是常称之为的 basedir，在此目录下应该具有 module、logs 等目录。rpm 安装的 httpd 的 ServerRoot 默认为 /etc/httpd，编译安装的 ServerRoot 路径由 &quot;--prefix&quot; 选项指定，例如 /usr/local/apache。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ll /usr/local/apache/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">total </span><span class="token number" style="color:rgb(9, 134, 88)">52</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 bin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 build</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 cgi-bin</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 error</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:02 htdocs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 icons</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 include</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 logs</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 </span><span class="token function" style="color:rgb(0, 0, 255)">man</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> root root </span><span class="token number" style="color:rgb(9, 134, 88)">12288</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:02 manual</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> root root  </span><span class="token number" style="color:rgb(9, 134, 88)">4096</span><span class="token plain"> Oct </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> 06:36 modules</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这个指令很关键，安装好 apache 后一般不会去做任何修改，因为很多指令的路径以及相对路径都是基于此路径的。严格地说，<strong>除了网络路径，基本上所有本地文件系统类的路径只要不是绝对路径，相对路径都基于此路径展开</strong>。</p><p>例如，当指定 &quot;ServerRoot /usr/local/apache&quot; 时，下面几个指令中描述的本地路径，等号前面的采用的都是相对路径，等号右边的都是他们等价的绝对路径写法。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">DocumentRoot </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;htdocs&quot;</span><span class="token plain">                    </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> DocumentRoot </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/usr/local/apache/htdocs&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LoadModule dir_module modules/mod_dir.so </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> LoadModule dir_module /usr/local/apache/modules/mod_dir.so</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ErrorLog </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;logs/error_log&quot;</span><span class="token plain">                </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ErrorLog /usr/local/apache/logs/error_log</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Alias /net_path local_fs_path            </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> Alias /net_path /usr/local/apache/local_fs_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Include conf.d/vhost.conf                </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> Include /usr/local/apache/conf.d/vhost.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>但注意，容器 &lt; Directory PATH &gt; 的 PATH 一般设置为文件系统的绝对路径，因为它是<strong>路径匹配</strong>性质的。但它仍可以使用相对路径时，此时它相对的是根文件系统的 &quot;/&quot;，而非 ServerRoot。</p><p>所以，这个指令强烈不建议做任何修改，修改是很简单，但是牵一发而动全身。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="623documentroot-指令">6.2.3、DocumentRoot 指令<a class="hash-link" href="#623documentroot-指令" title="标题的直接链接">​</a></h3><p>如果说，ServerRoot 是 httpd 中本地文件相对路径的根，那么 DocumentRoot 就是网络路径相对路径的根。</p><p>顾名思义，DocumentRoot 是文档的根目录，这个文档的意思是展现在网络上的文档。使用 rpm 包安装的 httpd 的 DocumentRoot 默认值为 &quot;/var/www&quot;，编译安装的 httpd，其 DocumentRoot 默认为 &quot;PREFIX/htdocs&quot;，也就是 <code>$ServerRoot/htdocs</code>。</p><p>设置 DocumentRoot 后，将需要在网络上访问的文件都放进此目录下即可。</p><p>例如，假设 httpd 所在主机 IP 为 192.168.0.88，DocumentRoot 使用默认的 /usr/local/apache/htdocs，那么下面几个 URL 中，左边的是浏览器中输入的值，右边的是其访问的服务器上的资源路径。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">http://192.168.0.88/index.html         </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> /usr/local/apache/htdocs/index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">http://192.168.0.88/index.php          </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> /usr/local/apache/htdocs/index.php</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">http://192.168.0.88/subdir/index.html  </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> /usr/local/apache/htdocs/subdir/index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">http://192.168.0.88/subdir/index.php   </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> /usr/local/apache/htdocs/subdir/php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>也就是说，DocumentRoot 的值对应的是 <code>http://192.168.0.88/</code> 的 &quot;/&quot;。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="624directoryindex-指令">6.2.4、DirectoryIndex 指令<a class="hash-link" href="#624directoryindex-指令" title="标题的直接链接">​</a></h3><p>该指令设置的是 &quot;当搜索的 URL 中的路径使用了 &quot;/&quot; 结尾时，httpd 将搜索该指令所指定的文件响应给客户端&quot;。也就是说，当 url 表示搜索的是目录时，将查找该目录下的 DirectoryIndex。</p><p>注意，很多时候如果没有给定尾部的 &quot;/&quot;，httpd 的 dir<!-- -->_<!-- -->module 模块会自行加上 &quot;/&quot;，当然，是否补齐尾随的 &quot;/&quot;，也是可以控制的，见 <a href="http://httpd.apache.org/docs/2.4/mod/mod_dir.html#directoryslash" target="_blank" rel="noopener noreferrer">DirectorySlash</a> 指令。</p><p>DirectoryIndex 的设置格式为：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">DirectoryIndex disabled </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> local-url </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">local-url</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>例如，当设置 &quot;DirectoryIndex index.html&quot; 时，如果在浏览器中输入下面左边的几个 URL，httpd 将响应右边对应的文件。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">http://192.168.0.88           </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$DocumentRoot</span><span class="token plain">/index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">http://192.168.0.88/newdir/   </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(9, 134, 88)">$DocumentRoot</span><span class="token plain">/newdir/index.html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以指定多个 index 文件，它们将按顺序从左向右依次查找，并返回第一个找到的 index 文件。例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">IfModule dir_module</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    DirectoryIndex index.php index.html /mydir/index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/IfModule</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当浏览器中输入 <code>http://192.168.0.88/</code> 时，将首先搜索 index.php，如果该文件不存在，则再搜索 index.html，如果还找不到，则再找该目录的子目录下的文件 /mydir/index.html。但这不表示 <code>http://192.168.0.88/mydir/</code> 会搜索 /mydir/index.html。</p><p>可以使用多个 DirectoryIndex 指令进行追加设置，它等价于单行设置多个值，例如下面的设置等价于 <code>DirectoryIndex index.php index.html</code>：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">DirecotryIndex index.php</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DirectoryIndex index.html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果要替换某个值，则直接修改或使用 disabled 关键字禁用其前面的 Directoryindex。例如禁用 index.php，只提供 index.html 的索引。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">DirectoryIndex index.php</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DirectoryIndex disabled</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DirectoryIndex index.html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>但注意，&quot;disabled&quot; 关键字必须独自占用一个 DirectoryIndex 指令，否则它将被解析成字面意思，也就是说将其当作一个 index 文件响应给客户端。</p><p>DirectoryIndex 指令可以设置在 Server、Virtual host、Location 和 Directory 上下文。所以，当设置在 location 或 Directory 容器中时，它将覆盖全局设置。例如，当 DocumentRoot 为 /usr/local/apache/htdocs 时：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">DirectoryIndex index.php</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">directory /usr/local/apache/htdocs/newdir</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    DirectoryIndex index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 或者</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">location /newdir</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    DirectoryIndex index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/location</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>在输入 <code>http://IP/newdir/</code> 时，将提供 index.html 而非 index.php。</li></ul><p>当 DirectoryIndex 提供的索引文件都不存在时，将根据 Options 中的 Indexes 选项设置决定是否列出文件列表，除非是提供文件下载，否则出于安全考虑，这个选项是强烈建议关闭的。</p><p>例如以下设置为打开：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">directory /usr/local/apache/htdocs/newdir</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Options Indexes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    DirectoryIndex index.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="625servername-和-serveralias">6.2.5、ServerName 和 ServerAlias<a class="hash-link" href="#625servername-和-serveralias" title="标题的直接链接">​</a></h3><p>ServerName 用于唯一标识提供 web 服务的主机名，只有在基于名称的虚拟主机中该指令才是必须提供的。</p><p>也就是说，如果不是在基于名称的虚拟主机中，可以任意指定该指令的值，只要你认为它能唯一标识你的主机。但如果不设置该指令，那么 httpd 在启动时，将会反解操作系统的 IP 地址。</p><p>唯一标识主机的方式，也即 ServerName 的语法为：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ServerName </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">domain-name</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">ip-address</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">:port</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>例如，在主机 web.brinnatt.com 上提供了一个 httpd web 服务，如果还想使用 <a href="http://www.brinnatt.com" target="_blank" rel="noopener noreferrer">www.brinnatt.com</a> 提供同样的服务，还想效率更高点，则在设置 DNS 别名后再配置：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ServerName www.brinnatt.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ServerAlias 用于定义 ServerName 的别名。如果在定义 ServerName 之后再定义 ServerAlias，那么 ServerName 和 ServerAlias 没有任何区别。当然，为了区分基于名称的虚拟主机，还是必须要定义 ServerName。</p><p>例如，下面几个 ServerName 和 ServerAlias 是完全等价的。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">VirtualHost *:8</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">0</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ServerName  server.example.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ServerAlias server server2.example.com server2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ServerAlias *.example.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/VirtualHost</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="626include-指令">6.2.6、Include 指令<a class="hash-link" href="#626include-指令" title="标题的直接链接">​</a></h3><p>在 httpd 启动时，首先会解析配置文件。httpd 支持 include 指令来包含其他文件，在解析配置文件时会进行配置合并。</p><p>支持通配符 <code>&quot;*&quot;、&quot;?&quot;</code> 和 <code>&quot;[]&quot;</code>，但它们不能匹配斜线 &quot;/&quot;，如有必要，它们会按照<strong>文件名的字母顺序依次</strong>进行加载。</p><p>如果 include 指令中指定包含一个目录，则会按照字母顺序加载该目录内的所有文件，这比较容易出错，因为有些时候会产生一些临时文件或非配置类的文件。</p><p>例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Include /usr/local/apache/conf/ssl.conf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Include /usr/local/apache/conf/vhosts/*.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以使用绝对路径，也可以使用相对路径，如果使用相对路径，则它相对于 ServerRoot。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Include conf/ssl.conf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Include conf/vhosts/*.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果 include 包含的文件不存在时，将报错。这时可以使用 IncludeOptional 指令进行加载，这表示存在则加载，不存在就算了。</p><p>例如下面的第一条指令中，如果 vhosts 下没有子目录，或者子目录中没有 &quot;.conf&quot; 文件都将失败，而第二条指令则不会。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Include conf/vhosts/*/*.conf</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IncludeOptional conf/vhosts/*/*.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="627define-和-undefine-指令">6.2.7、Define 和 UnDefine 指令<a class="hash-link" href="#627define-和-undefine-指令" title="标题的直接链接">​</a></h3><p>该指令用于定义参数或定义向后全局生效的变量。语法格式为：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Define param </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当只给定一个 param 时，表示定义一个参数，这个参数用于 &lt; IfDefine param &gt; 容器进行判断，只有定义了的参数 param，该容器才返回真，其内封装的指令才生效。它的等价行为是在 httpd 启动时(必须是启动时)，使用 &quot;-D&quot; 选项定义参数。例如下面两个方法是等价的：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># startup command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> httpd -DMyName </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># in config </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Define MyName</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当给定了两个参数，即还指定了 value 时，将表示定义一个变量，该变量具有<strong>向后全局性</strong>。也就是说，定义在某个虚拟主机中的变量在后面的另一个虚拟主机中也有效。引用变量时，使用 <code>${var}</code> 的方式。注意，变量名中不能包含冒号 <code>&quot;:&quot;</code>。</p><p>例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">IfDefine </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">TEST</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  Define servername www.example.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/IfDefine</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DocumentRoot </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/var/www/</span><span class="token string variable" style="color:rgb(9, 134, 88)">${servername}</span><span class="token string" style="color:rgb(163, 21, 21)">/htdocs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用 UnDefine 指令则是取消 Define 定义的参数或变量。语法为 <code>UnDefine param</code>。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="628virtualhost-指令">6.2.8、VirtualHost 指令<a class="hash-link" href="#628virtualhost-指令" title="标题的直接链接">​</a></h3><p>无疑，这是最重要的指令之一。用于封装一组指令只作用于指定主机名或 IP 地址的虚拟主机上。</p><p>语法格式为：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">VirtualHost addr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">:port</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">addr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">:port</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">. </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/VirtualHost</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中 addr 部分可以是以下几种情况：</p><ul><li>虚拟主机的 IP 地址</li><li>虚拟主机 IP 地址对应的 FQDN(不推荐)</li><li>字符 <code>&quot;*&quot;</code>，匹配任意 IP 地址</li><li>字符串 <code>&quot;_default_&quot;</code>，是 <code>&quot;*&quot;</code> 的别名</li></ul><p>例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">VirtualHost </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.2.3:8</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">0</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ServerAdmin webmaster@host.example.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  DocumentRoot </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/www/docs/host.example.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ServerName host.example.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ErrorLog </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;logs/host.example.com-error_log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  TransferLog </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;logs/host.example.com-access_log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/VirtualHost</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>需要为虚拟主机指定 ServerName，否则它将会从主配置继承。对于基于名称的虚拟主机，ServerName 更是不可缺少，否则将继承操作系统的 FQDN。</p><p>当一个请求到达时，将按照最佳匹配进行主机匹配：通配的内容越少，优先级越高，也就越佳。例如 <code>&quot;192.168.0.88:80&quot;</code> 的优先级高于 <code>&quot;*:80&quot;</code>。</p><p>如果基于名称的虚拟主机无法匹配上，则采用虚拟主机列表中的第一个虚拟主机作为响应主机。如果所有虚拟主机都无法匹配上，则采用从主配置段落中的主机，如果主配置段落中注释了 DocumentRoot，则返回对应的错误。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="629options-和-allowoverride-指令">6.2.9、Options 和 AllowOverride 指令<a class="hash-link" href="#629options-和-allowoverride-指令" title="标题的直接链接">​</a></h3><p>Options 启用或禁用指定目录下的某些特性。有效值包括：All、None、ExecCGI、FollowSymLinks、Includes、IncludesNOEXEC、Indexes、MultiViews、SymLinksIfOwnerMatch。</p><p>不指定 options 时，默认为 all。一般除了提供下载服务会开启一个 Indexes 选项，其他选项都会关掉，即使用：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Options None</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>AllowOverride 指令用于控制是否读取 &quot;.htaccess&quot; 配置文件。</p><p>如何设置这个指令要看具体情况，有以下几种值，此外还可以设置为 all 和 none，表示启用、禁用所有特性。</p><ul><li>AuthConfig：基于用户认证时设置该值，此时将可以使用 AuthGroupFile, AuthName, AuthType, AuthUserFile, equire 等认证相关指令。</li><li>FileInfo： 控制文档类型时使用该值，此时将可以使用 ErrorDocument, SetHandler，以及一些 URL 重写的指令。</li><li>Indexes：控制目录索引时使用该值，此时可以使用 AddIcon, DirectoryIndex。</li><li>Limit：是否允许使用 order、allow、deny 指令，这三个指令已经废弃，目前还存在是为了兼容老版本。</li></ul><p>例如下面的指令使得在使用非认证类和索引控制类指令时，将产生服务器类的错误。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">AllowOverride AuthConfig Indexes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6210require-指令">6.2.10、Require 指令<a class="hash-link" href="#6210require-指令" title="标题的直接链接">​</a></h3><p>参见 <a href="https://www.brinnatt.com/high/%e7%ac%ac-6-%e7%ab%a0-linux-httpd-%e6%9c%8d%e5%8a%a1%e8%bf%9b%e9%98%b6%e9%85%8d%e7%bd%ae/#623%E3%80%81Require_%E6%8C%87%E4%BB%A4" target="_blank" rel="noopener noreferrer">Require 指令</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6211长连接相关指令">6.2.11、长连接相关指令<a class="hash-link" href="#6211长连接相关指令" title="标题的直接链接">​</a></h3><p>KeepAlive 指令用于开启和关闭长连接功能。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">KeepAlive on/off</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在没有开启长连接时，客户端每请求一个资源都需重新建立一次 TCP 连接，而使用了长连接后，客户端只需在最初请求一次 TCP 连接，之后就可以使用同一个 TCP 连接发送其他的 http 请求。</p><p>长连接的状态是指在服务端处理完某一个请求后，它立即进入长连接状态以保持 TCP 连接不断开，等待客户端再次发送请求。</p><p>但长连接自身的缺陷是会一直占用着连接不释放，所以必须得给出一个长连接的超时时间。这个超时时间由 KeepAliveTimeout 指令控制，进入长连接后如果在此时间间隔内客户端还没有发送新请求，则 TCP 连接自动断开。</p><p>如果在长连接状态下，客户端再次发送了请求，则服务端处理请求，并在处理完请求后又再次进入长连接状态并计算 KeepAliveTimeout。</p><p>此外，还可以通过指令 MaxKeepAliveRequests 控制每个长连接下的 TCP 连接的能接受的最大请求数。无疑，这个值应该设置的大一些，设置为 0 表示无限制。这个指令是从数量的角度控制长连接的 TCP 应该何时断开。</p><p>例如，在长连接超时时间内接受同一个客户端的 500 个请求才断开，然后该客户端再有新的请求只能重新建立 TCP 连接。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">MaxKeepAliveRequests </span><span class="token number" style="color:rgb(9, 134, 88)">500</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="63容器类指令">6.3、容器类指令<a class="hash-link" href="#63容器类指令" title="标题的直接链接">​</a></h2><p>路径和条件判断容器包括：</p><ul><li>&lt; Directory &gt;、&lt; DirectoryMatch &gt;</li><li>&lt; Files &gt;、&lt; FilesMatch &gt;</li><li>&lt; Location &gt;、&lt; LocationMatch &gt;</li><li>&lt; <em>IfModule</em> &gt;</li><li>&lt; <em>IfDefine</em> &gt;</li><li>&lt; <em>IfVersion</em> &gt;</li><li>&lt; <em>if</em> &gt;</li><li>&lt; <em>elseif</em> &gt;</li><li>&lt; <em>else</em> &gt;</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="631容器--directory--和--files-">6.3.1、容器 &lt; Directory &gt; 和 &lt; Files &gt;<a class="hash-link" href="#631容器--directory--和--files-" title="标题的直接链接">​</a></h3><p>还包括它们的正则匹配容器 &lt; DirectoryMatch &gt;、&lt; FilesMatch &gt;。</p><p>&lt; Directory &gt; 容器的作用是 &quot;对于匹配到的目录，封装一组指令，这些指令只作用于该目录以及它的子目录中的文件&quot;。注意，<strong>&lt; Directory &gt; 容器通常都是用绝对路径，即 &lt; Directory /PATH/to/DIR &gt;，如果使用相对路径，则它相对于根文件系统的 &quot;/&quot;</strong>。例如 &lt; directory newdir &gt; 等价于 &lt; directory /newdir &gt;。</p><p>例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    AllowOverride none</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    require all denied</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/usr/local/apache/htdocs&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    require all granted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>第一个容器表示拒绝所有对 &quot;/&quot; 下内容的访问，包括子目录中的文件，这个根是根文件系统的根，而不是 ServerRoot。而第二个容器则表示允许 /usr/local/apache/htdocs 目录下文件的访问。</p><p>由此可以想象得出，出于安全考虑，应该总是先将父目录进行限制，再在需要放宽权限的子目录中指定特定的权限。正如上面的设置，将最顶级目录 &quot;/&quot; 完全限制，然后在小范围的 htdocs 目录中放行。</p><p>再看 &lt; Files &gt; 容器，它针对的是某个或某些特定的能被匹配上的文件。它匹配的范围是它所在的上下文。</p><p>例如，下面的指令如果写在 server 上下文，那么将对任意 private.html 文件拒绝。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Files private.html</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    require all denied</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Files</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>而如果将其写在 &lt; directory &gt; 容器中，则只对该目录容器中的所有 private.html 生效。由于 &lt; directory &gt; 会递归到子目录中，所以子目录中的 private.html 也会拒绝，但非 private.html 将被允许。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/usr/local/apache/htdocs&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    require all granted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Files private.html</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        require all denied</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Files</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>&lt; directory &gt; 和 &lt; files &gt; 容器可以使用通配符，<code>&quot;*&quot;</code> 表示任意字符，<code>&quot;?&quot;</code> 表示任意单个字符，<code>&quot;[]&quot;</code> 表示范围，如 <!-- -->[<!-- -->a-z<!-- -->]<!-- -->、<!-- -->[<!-- -->0-9<!-- -->]<!-- -->，但是这些通配符都不能匹配 &quot;/&quot;。所以要跨目录匹配时，必须显式指定各个目录的 &quot;/&quot; 符号。</p><p>例如，<code>&lt;directory /*/public.html&gt;</code> 无法匹配 /home/user/public.html，但 <code>directory /home/*/public.html</code> 可以匹配。</p><p>它还可以使用正则表达式匹配，只需使用一个 <code>&quot;~&quot;</code> 符号即可。这时和使用 &lt; DirectoryMatch &gt;、&lt; FilesMatch &gt; 是一样的，只不过 Match 类指令不需要使用 <code>&quot;~&quot;</code> 符号。</p><p>例如，下面的设置。其中后两个 Directory 容器是等价的。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 匹配不区分大小写的gif/jpg/jpeg/png</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">FilesMatch </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;\.(?i:gif|jpe?g|png)$&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Require all denied</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/FilesMatch</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory ~ </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;^/usr/local/apache/htdocs/[0-9]{3}&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    DirectoryIndex digest.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">DirectoryMatch </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;^/usr/local/apache/htdocs/[0-9]{3}&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    DirectoryIndex digest.html</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/DirectoryMatch</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>需要注意的是，httpd 采用的 pcre 库提供的 perl 兼容正则。以下是官方手册提供的一个示例，使用的命名捕获语法，它将匹配 /var/www/combined/ 目录下的一级子目录，但不进行递归。</p><p>将每个匹配到的结果保存到命名的分组 sitename 中，并通过环境变量 &quot;MATCH<!-- -->_<!-- -->capturename&quot; 进行引用，其中 capturename 必须转为大写字母，因为它就是这样赋值的。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">DirectoryMatch </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;^/var/www/combined/(?&lt;sitename&gt;[^/]+)&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Require ldap-group </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">cn</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">%</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">env:MATCH_SITENAME</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">,ou</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">combined,o</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">Example</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/DirectoryMatch</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>目前已经不能使用未命名的后向引用，例如 <code>$0,$1...</code>。在 URL 重写时，正则语法至关重要，像 grep/sed/awk 中天然支持的基础正则和扩展正则语法虽然能解决大部分问题，但想要实现复杂的需求，只能使用语义丰富、完整的正则，如 pcre 提供的正则。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="632容器--location-">6.3.2、容器 &lt; Location &gt;<a class="hash-link" href="#632容器--location-" title="标题的直接链接">​</a></h3><p>该容器和 &lt; Directory &gt;、&lt; Files &gt; 容器差不多，都是对满足匹配条件的路径封装一组指令，这些指令只生效于这些能匹配的路径。但是 &lt; Location &gt; 和 &lt; Directory &gt;、&lt; Files &gt; 最大的区别是：前者匹配的目标是 WebSpace，即匹配 URL 中的路径，而后两者匹配的是本地文件系统的路径。</p><p>例如，当设置下面的 location 容器时，将匹配 <code>http://192.168.0.88/newdir/index.html</code>。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Location </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/newdir&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Location</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>location 支持三种匹配模式：</p><ul><li>精确匹配：location 的模式和 URL 中的路径部分精确对应。</li><li>加尾随斜线：location 的模式中加了尾随斜线时，将匹配该目录里面的内容。</li><li>无尾随斜线：location 的模式中没有尾随斜线时，将匹配该目录和目录里面的内容。</li></ul><p>例如，下面两个容器，第一个将匹配 /private1、/private1/ 和 /private1/file.txt，但不能匹配 /private1other，而第二个将匹配 /private2/ 和 /private2/file.txt，但不能匹配 /private2 和 /private2other。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Location </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/private1&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Location</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Location </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/private2/&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Location</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>location 和 sethandler 指令一起使用时很方便。例如，开启状态信息页面：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Location </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/server-status&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    SetHandler server-status</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Require all granted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Location</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>同样，除了支持 <code>&quot;*&quot;、&quot;?&quot;、&quot;[]&quot;</code> 的通配符匹配，还支持 <code>&quot;~&quot;</code> 和 LocationMatch 指令的正则匹配。方法见上面的 &lt; Directory &gt; 容器。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="633-ifdefine--ifmodule--和--ifversion--条件判断">6.3.3、&lt; IfDefine &gt;、&lt; IfModule &gt; 和 &lt; IfVersion &gt; 条件判断<a class="hash-link" href="#633-ifdefine--ifmodule--和--ifversion--条件判断" title="标题的直接链接">​</a></h3><p>这三个容器都是条件判断容器，<strong>且都只在 httpd 启动时进行判断</strong>，判断为真，则封装在其内的指令生效，否则忽略。且都可以在条件前加一个 &quot;!&quot; 以实现条件的否定，而且都可以嵌套以实现更复杂的配置。</p><p>&lt; IfModule &gt; 容器是指当启动时加载了某模块时，该容器内的指令生效。可以是静态加载的模块，或者使用 LoadModule 指令加载的，但如果这样的话，加载对应模块的 LoadModule 指令必须在 &lt; IfModule &gt; 指令之前。例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">LoadModule status_module modules/mod_status.so</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">IfModule </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;status_module&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Location </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/server-status&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        SetHandler server-status</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Require all granted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Location</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/IfModule</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>&lt; IfDefine param &gt; 容器用于判断参数 param 是否已经定义，如果定义了，则条件为真，封装在其内的指令生效，否则忽略。加上感叹号则表示取反，例如 &lt; IfDefine !param &gt;。</p><p>那么如何定义参数呢？有两种方法：使用 httpd 命令的 &quot;-D&quot; 选项；使用 Define 指令。</p><p>例如，在使用 httpd 启动时，加上一个 &quot;-D&quot; 选项定义 MyName 参数。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">httpd -DMyName </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>或者在配置文件中使用 Define 指令进行定义，但必须在 &lt; IfDefine &gt; 容器之前定义。例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Define MyName</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>&lt; IfDefine &gt; 可以进行嵌套。例如下面是官方的一个示例：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">httpd -DReverseProxy -DUseCache -DMemCache </span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">IfDefine ReverseProxy</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  LoadModule proxy_module   modules/mod_proxy.so</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  LoadModule proxy_http_module   modules/mod_proxy_http.so</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">IfDefine UseCache</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    LoadModule cache_module   modules/mod_cache.so</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">IfDefine MemCache</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      LoadModule mem_cache_module   modules/mod_mem_cache.so</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/IfDefine</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">IfDefine </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">MemCache</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      LoadModule cache_disk_module   modules/mod_cache_disk.so</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/IfDefine</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/IfDefine</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/IfDefine</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>&lt; IfVersion &gt; 容器用于判断 httpd 的版本。例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">IfVersion </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">.</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">4</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)"># this happens only in versions greater or equal 2.4.0.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/IfVersion</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="634-if--elseif--和--else--容器">6.3.4、&lt; If &gt;、&lt; ElseIf &gt; 和 &lt; Else &gt; 容器<a class="hash-link" href="#634-if--elseif--和--else--容器" title="标题的直接链接">​</a></h3><p>意义不言自明。&lt;\ If &gt;...&lt; /If &gt; 判断表达式是否为真，如果为真，则封装在其内的指令生效；&lt; ElseIf &gt;...&lt; /ElseIf &gt; 作用于 &lt; If &gt;...&lt; /If &gt; 之后，而 &lt; Else &gt;...&lt; /Else &gt; 则作用于最后。</p><p>表达式的写法和 shell 脚本的表达式差不多，例如数值比较 <code>&quot;-eq&quot;、&quot;-gt&quot;</code>，字符串比较 <code>&quot;==&quot;、&quot;&gt;=&quot;</code>，以及其他一些表达式 <code>&quot;-z&quot;、&quot;-n&quot;、&quot;-f&quot;</code> 等，此外，它还支持正则匹配表达式 <code>&quot;~=&quot;、&quot;!~&quot;</code>。具体相关函数、变量、表达式、语法等见 <a href="http://httpd.apache.org/docs/2.4/expr.html" target="_blank" rel="noopener noreferrer">http://httpd.apache.org/docs/2.4/expr.html</a>。</p><p>例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 请求首部没有Host字段时，该段指令将生效。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">If </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-z req(&#x27;Host&#x27;)&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/If</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 如果请求主机地址属于0/16，则if段生效，否则如果属于0/8，则elseif段生效，否则else生效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">If </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-R &#x27;10.1.0.0/16&#x27;&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">#...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/If</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">ElseIf </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-R &#x27;10.0.0.0/8&#x27;&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">#...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/ElseIf</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Else</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">#...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Else</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="64配置文件的合并规则">6.4、配置文件的合并规则<a class="hash-link" href="#64配置文件的合并规则" title="标题的直接链接">​</a></h2><p>配置文件的段落以一种非常特殊的顺序生效。理解配置文件的合并规则非常重要，否则配置了半天可能发现根本不会生效。</p><p>以下是 5 个组类合并的顺序：</p><ol><li>&lt; Directory &gt; (正则匹配的容器除外)</li><li>&lt; DirectoryMatch &gt; (以及 &lt; Directory &quot;~&quot; &gt;)</li><li>&lt; Files &gt; 和 &lt; FilesMatch &gt; 同时处理</li><li>&lt; Location &gt; 和 &lt; LocationMatch &gt; 同时处理</li><li>&lt; <em>If</em> &gt;</li></ol><p>此外，还需要注意的一些规则是：</p><ul><li>除了 &lt; Directory &gt; 容器，每个组以它们出现的顺序进行合并。例如一个 /foo 请求可以匹配 &lt; Location &quot;/foo/bar&quot; &gt; 和 &lt; Location &quot;/foo&quot; &gt;，它们都属于上面列出的第 4 组，所以对于这两个 Location 容器，谁配置在前面就匹配谁。</li><li>&lt; Directory &gt; 容器即上面的第一组处理的顺序是先处理路径 &quot;短&quot; 的，再处理路径长的。这里的短指的是离根文件系统的 &quot;/&quot; 越近就越短。由于这个组不包含正则匹配的表达式(即 &lt; Directory ~ &gt;)，所以这里的 &quot;短&quot; 就代表它的路径表达式短。例如 &lt; Directory &quot;/var/web/dir&quot; &gt; 将优先于 &lt; Directory &quot;/var/web/dir/subdir&quot; &gt; 被处理。</li><li>如果出现多个 &lt; Directory &gt; 的路径完全一样的极端情况，那么将按照出现顺序处理。</li><li>使用 Include 指令包含的文件将被插入到该指令的位置，然后按规则进行处理。</li><li>&lt; VirtualHost &gt; 段落的配置将在外部对应的段处理完毕以后再处理，这样就允许虚拟主机覆盖主服务器的设置。</li><li>当请求是由 mod<!-- -->_<!-- -->proxy 处理的时候，&lt; Proxy &gt; 容器将会在处理顺序中取代 &lt; Directory &gt; 容器的位置。</li></ul><p>需要注意的是，配置文件中的指令都是由各个模块提供的，所以各指令是由各对于模块来解析、处理、合并的，配置文件的作用只不过是将各个模块的指令整合在一起方便定义。另外，上面定义的 5 个组别都是由 httpd 的核心模块提供的，因此它们才有处理顺序的要求。</p><p>当在运行时进行请求匹配，将先按照上面合并规则提供的顺序进行匹配，如果某个组中出现了能成功匹配请求的模块，将提升一次合并的层次，使得这次模块的匹配变为第三次匹配。</p><p>例如下面的配置使用了由 mod<!-- -->_<!-- -->headers 提供的 Header 指令用于设置 HTTP 的首部，如果请求 /example/index.html，那么最终设置的 CustomHeaderName 首部的值是什么呢？</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Header </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> CustomHeaderName one</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">FilesMatch </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;.*&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Header </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> CustomHeaderName three</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/FilesMatch</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/example&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Header </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> CustomHeaderName two</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>首先按照前面提供的合并顺序匹配到 &quot;/&quot;，这会初始化设置 CustomHeaderName 的值为 one，再匹配到 /example，CustomHeaderName 被设置为 two。最后分组中提供的指令 FilesMatch 匹配成功，提升一次合并的层次，这是第三次匹配，导致 CustomHeaderName 最终设置为 three。</p><p>下面的例子中，如果这些指令都对请求生效，它们将按照 &quot;A &gt; B &gt; C &gt; D &gt; E&quot; 的顺序生效。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Location </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    E</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Location</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Files </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;f.html&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    D</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Files</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">VirtualHost *</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/a/b&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    B</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/VirtualHost</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">DirectoryMatch </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;^.*b$&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    C</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/DirectoryMatch</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/a/b&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    A</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>D 和 E 无疑是最后生效的。再看三个 Directory 类的容器，对于 Directory 和 DirectoryMatch，前者先生效，所以 C 排在 A 和 B 后，对于 A 和 B，虚拟主机会在外部段落处理完后再处理，所以在 A 和 B 进行合并时，B 将覆盖 A，也即 A 先生效。所以顺序为 &quot;A&gt;B&gt;C&gt;D&gt;E&quot;。但如果将上面的 A 段落改为：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/a/b&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    A</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">FilesMatch f.html</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        D1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Files</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>那么最终的顺序为 &quot;A&gt;B&gt;C&gt;D&gt;D1&gt;E&quot;。</p><p>以下示例则更有教育意义。尽管 Directory 设置了更严格的权限，但因为 Location 比 Directory 更后生效，它对所有访问都不做任何限制。也就是说，Directory 在这里的权限设置是完全多余的。所以说，理解配置文件的合并规则对写配置文件至关重要。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Location </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Require all granted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Location</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># Whoops!  This &lt;Directory&gt; section will have no effect</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Directory </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">RequireAll</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Require all granted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Require not </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> badguy.example.com</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/RequireAll</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">/Directory</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/linux-advanced-5"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">第 5 章 Linux DNS 服务</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/linux-advanced-7"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">第 7 章 Linux httpd 服务进阶配置</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#61httpdapachectl-命令" class="table-of-contents__link toc-highlight">6.1、httpd/apachectl 命令</a></li><li><a href="#62配置文件规则和常见指令" class="table-of-contents__link toc-highlight">6.2、配置文件规则和常见指令</a><ul><li><a href="#621listen-指令" class="table-of-contents__link toc-highlight">6.2.1、Listen 指令</a></li><li><a href="#622serverroot-指令" class="table-of-contents__link toc-highlight">6.2.2、ServerRoot 指令</a></li><li><a href="#623documentroot-指令" class="table-of-contents__link toc-highlight">6.2.3、DocumentRoot 指令</a></li><li><a href="#624directoryindex-指令" class="table-of-contents__link toc-highlight">6.2.4、DirectoryIndex 指令</a></li><li><a href="#625servername-和-serveralias" class="table-of-contents__link toc-highlight">6.2.5、ServerName 和 ServerAlias</a></li><li><a href="#626include-指令" class="table-of-contents__link toc-highlight">6.2.6、Include 指令</a></li><li><a href="#627define-和-undefine-指令" class="table-of-contents__link toc-highlight">6.2.7、Define 和 UnDefine 指令</a></li><li><a href="#628virtualhost-指令" class="table-of-contents__link toc-highlight">6.2.8、VirtualHost 指令</a></li><li><a href="#629options-和-allowoverride-指令" class="table-of-contents__link toc-highlight">6.2.9、Options 和 AllowOverride 指令</a></li><li><a href="#6210require-指令" class="table-of-contents__link toc-highlight">6.2.10、Require 指令</a></li><li><a href="#6211长连接相关指令" class="table-of-contents__link toc-highlight">6.2.11、长连接相关指令</a></li></ul></li><li><a href="#63容器类指令" class="table-of-contents__link toc-highlight">6.3、容器类指令</a><ul><li><a href="#631容器--directory--和--files-" class="table-of-contents__link toc-highlight">6.3.1、容器 &lt; Directory &gt; 和 &lt; Files &gt;</a></li><li><a href="#632容器--location-" class="table-of-contents__link toc-highlight">6.3.2、容器 &lt; Location &gt;</a></li><li><a href="#633-ifdefine--ifmodule--和--ifversion--条件判断" class="table-of-contents__link toc-highlight">6.3.3、&lt; IfDefine &gt;、&lt; IfModule &gt; 和 &lt; IfVersion &gt; 条件判断</a></li><li><a href="#634-if--elseif--和--else--容器" class="table-of-contents__link toc-highlight">6.3.4、&lt; If &gt;、&lt; ElseIf &gt; 和 &lt; Else &gt; 容器</a></li></ul></li><li><a href="#64配置文件的合并规则" class="table-of-contents__link toc-highlight">6.4、配置文件的合并规则</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">学习</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tags">标签</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">归档</a></li><li class="footer__item"><a class="footer__link-item" href="/project">实战项目</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/linux">Linux</a></li></ul></div><div class="col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">关于我</a></li><li class="footer__item"><a href="https://github.com/zqingfa" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/friends">友链</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/website">导航</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p><a href="http://beian.miit.gov.cn/">浙ICP备20024502号-1</a></p><p>Copyright © 2023 - PRESENT zhangqf Built with Docusaurus.</p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.6d616132.js"></script>
<script src="/assets/js/main.26bbf6d2.js"></script>
</body>
</html>
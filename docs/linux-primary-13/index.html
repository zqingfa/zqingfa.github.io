<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-linux/primary/linux-primary-13">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">第 13 章 Linux 网络管理 - Linux技术分享</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://zhangqf.com/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://zhangqf.com/img/logo.png"><meta data-rh="true" property="og:url" content="https://zhangqf.com/docs/linux-primary-13"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="第 13 章 Linux 网络管理 - Linux技术分享"><meta data-rh="true" name="description" content="在解释 Linux 网络管理相关的内容时，我觉得有必要先解释数据包转发功能以及因此涉及到的路由决策，这对理清路由和未来的防火墙配置有重要帮助。然后再介绍网络配置命令和相关文件。"><meta data-rh="true" property="og:description" content="在解释 Linux 网络管理相关的内容时，我觉得有必要先解释数据包转发功能以及因此涉及到的路由决策，这对理清路由和未来的防火墙配置有重要帮助。然后再介绍网络配置命令和相关文件。"><meta data-rh="true" name="keywords" content="linux,Network"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zhangqf.com/docs/linux-primary-13"><link data-rh="true" rel="alternate" href="https://zhangqf.com/en/docs/linux-primary-13" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://zhangqf.com/docs/linux-primary-13" hreflang="zh"><link data-rh="true" rel="alternate" href="https://zhangqf.com/docs/linux-primary-13" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://9B0V5WT2X8-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S4SD5NXWXF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S4SD5NXWXF",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Linux技术分享" href="/opensearch.xml">
<link rel="preconnect" href="https://zhangqf.com/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://zhangqf.com/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script>


<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c9a3849aa75f9c4a4e65f846cd1a5155",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="code-rqLUw5reVS">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="zhangqf RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="zhangqf Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="zhangqf JSON Feed">

<link rel="icon" href="/img/logo.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(51 139 255)"><link rel="stylesheet" href="/assets/css/styles.86c9ae18.css">
<link rel="preload" href="/assets/js/runtime~main.839460ba.js" as="script">
<link rel="preload" href="/assets/js/main.6b7778c5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><span>更新 <a href="/website">网址导航</a> 带你发现感兴趣的技术</span></div><button type="button" aria-label="关闭" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">zhangqf</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/linux">Linux</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/category/Linux基础">Linux 基础</a></li><li><a class="dropdown__link" href="/docs/category/Linux进阶">Linux 进阶</a></li><li><a class="dropdown__link" href="/docs/category/Linux测试">Linux 测试</a></li><li><a class="dropdown__link" href="/docs/category/LinuxCICD">Linux CICD研发</a></li><li><a class="dropdown__link" href="/docs/skill/">笔记</a></li><li><a class="dropdown__link" href="/docs/tools/">工具推荐</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Blog</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags">标签</a></li><li><a class="dropdown__link" href="/archive">归档</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">工具</a><ul class="dropdown__menu"><li><a href="https://api.kuizuo.cn" target="_blank" rel="noopener noreferrer" class="dropdown__link">API服务</a></li><li><a href="https://js-de-obfuscator.vercel.app" target="_blank" rel="noopener noreferrer" class="dropdown__link">JS代码还原</a></li><li><a href="https://cipher.kuizuo.cn" target="_blank" rel="noopener noreferrer" class="dropdown__link">CyberChef加密</a></li><li><a href="https://pan.kuizuo.cn" target="_blank" rel="noopener noreferrer" class="dropdown__link">网盘</a></li></ul></div><a class="navbar__item navbar__link" href="/website">导航</a><a class="navbar__item navbar__link" href="/project">项目</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.webp" alt="zhangqf" class="themedImage_ToTc themedImage--dark_i4oU"><b>zhangqf</b></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/linux">linux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/linux基础">Linux基础</a><button aria-label="打开/收起侧边栏菜单「Linux基础」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-1">第 1 章 Linux 基础命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-2">第 2 章 Linux 系统用户</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-3">第 3 章 Linux 文件权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-4">第 4 章 Linux ext 文件系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-5">第 5 章 Linux 磁盘管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-6">第 6 章 Linux LVM 存储管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-7">第 7 章 Linux Raid 存储管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-8">第 8 章 Linux 包管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-9">第 9 章 Linux 进程和信号</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-10">第 10 章 Linux 系统资源监控</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-11">第 11 章 Linux 服务管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-12">第 12 章 Linux 定时任务</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/linux-primary-13">第 13 章 Linux 网络管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux-primary-14">第 14 章 Linux 开机启动流程(UEFI+systemd)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linux进阶">Linux进阶</a><button aria-label="打开/收起侧边栏菜单「Linux进阶」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linux测试">Linux测试</a><button aria-label="打开/收起侧边栏菜单「Linux测试」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linuxcicd">Linux CICD研发</a><button aria-label="打开/收起侧边栏菜单「Linux CICD研发」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/linux基础"><span itemprop="name">Linux基础</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">第 13 章 Linux 网络管理</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>第 13 章 Linux 网络管理</h1></header><p>在解释 Linux 网络管理相关的内容时，我觉得有必要先解释数据包转发功能以及因此涉及到的路由决策，这对理清路由和未来的防火墙配置有重要帮助。然后再介绍网络配置命令和相关文件。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="131linux-处理数据包过程">13.1、Linux 处理数据包过程<a class="hash-link" href="#131linux-处理数据包过程" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="networking" src="/assets/images/networking-c82624047f0f52d2b7d6f24540689c3a.png" width="869" height="619" class="img_ev3q"></p><p>数据包的流转是个很复杂的过程，期间主要由多种 hook 函数和路由策略决定数据包从哪里来到哪里去：</p><ol><li>数据包从网卡流入后需要对它做路由决策，根据其目标决定是流入本机数据还是转发给其他主机，如果是流入本机的数据，则数据会从内核空间进入用户空间(被应用程序接收、处理)。</li><li>当用户空间响应(应用程序生成新的数据包)时，响应数据包是本机产生的新数据包，在响应包流出之前，需要做路由决策，根据目标决定从哪个网卡流出。</li><li>如果不是流入本机的，而是要转发给其他主机的，则必然涉及到另一个流出网卡，此时数据包必须从流入网卡完整地转发给流出网卡，这要求 Linux 主机能够完成这样的转发。</li><li>但 Linux 主机默认未开启 ip<!-- -->_<!-- -->forward 功能，这使得数据包无法转发而被丢弃。<ul><li>Linux 主机和路由器不同，路由器本身就是为了转发数据包，所以路由器内部默认就能在不同网卡间转发数据包，而 Linux 主机默认则不能转发。</li></ul></li></ol><p><em>注意：IP 地址是属于内核的，不尽如此，整个 tcp/ip 协议栈都属于内核，包括端口号；这个概念在使用 iptables 时尤其要注意，可能会疑惑，为什么 ip<!-- -->_<!-- -->forward 没有打开，两个不同的 ip 地址段之间可以通信，因为 IP 地址是属于内核的，不是属于网卡的。</em></p><ul><li><p><em>举例：某 Linux 主机有两网卡 eth0:172.16.10.5 和 eth1:192.168.100.20，某 192.168.100.22 主机网关指向 192.168.100.20，若它 ping 172.16.10.5，结果将是通的，因为地址属于内核，从 eth1 进来的数据包被内核分析时，发现目标地址为本机地址，直接就回应 192.168.100.22，回应数据包继续从 eth1 出去。</em></p></li><li><p><em>举例：Linux 主机 A 有两网卡 eth0:172.16.10.5 和 eth1:192.168.100.20，某 192.168.100.22 主机网关指向 192.168.100.20，某 172.16.10.7 主机网关指向 172.16.10.5；若 192.168.100.22 直接 ping 172.16.10.7 是不通的，必须开启 Linux 主机 A 的 ip<!-- -->_<!-- -->forward 功能才能通起来。</em></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">方法1： </span><span class="token comment" style="color:rgb(0, 128, 0)"># echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">方法2： </span><span class="token comment" style="color:rgb(0, 128, 0)"># sysctl -w net.ipv4.ip_forward=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><em>以上两种方法是临时生效的，若要永久生效，则应该写入配置文件，建议写在 /etc/sysctl.d/<!-- -->*<!-- -->.conf 中，这是 systemd 提供自定义内核修改项的目录。</em></li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;net.ipv4.ip_forward=1&quot; &gt; /etc/sysctl.d/ip_forward.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>可以使用以下几种方式查看是否开启了转发功能。</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># sysctl net.ipv4.ip_forward</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">net.ipv4.ip_forward </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cat /proc/sys/net/ipv4/ip_forward</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># sysctl -a | grep ip_forward</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">net.ipv4.ip_forward </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">net.ipv4.ip_forward_use_pmtu </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="132网络配置文件">13.2、网络配置文件<a class="hash-link" href="#132网络配置文件" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1321网卡配置文件">13.2.1、网卡配置文件<a class="hash-link" href="#1321网卡配置文件" title="标题的直接链接">​</a></h3><p>在 /etc/sysconfig/network-scripts/ 目录下有不少文件，绝大部分都是脚本类的文件，但有一类 <strong>ifcfg 开头</strong> 的文件为网卡配置文件(interface config)，所有 ifcfg 开头的文件在启动网络服务的时候都会被加载读取，但具体的文件名 ifcfg-XX 的 XX 可以随意命名。</p><p>以下是一个 Aarch64 CentOS 7上 ifcfg-XX 文件的内容示例：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /etc/sysconfig/network-scripts/ifcfg-*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/etc/sysconfig/network-scripts/ifcfg-enp1s0f0  /etc/sysconfig/network-scripts/ifcfg-enp1s0f3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/etc/sysconfig/network-scripts/ifcfg-enp1s0f1  /etc/sysconfig/network-scripts/ifcfg-lo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/etc/sysconfig/network-scripts/ifcfg-enp1s0f2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cat /etc/sysconfig/network-scripts/ifcfg-enp1s0f0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">TYPE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">Ethernet</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">PROXY_METHOD</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">none</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">BROWSER_ONLY</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">no</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">BOOTPROTO</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">static</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">DEFROUTE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">IPV4_FAILURE_FATAL</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">no</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">IPV6INIT</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">IPV6_AUTOCONF</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">IPV6_DEFROUTE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">IPV6_FAILURE_FATAL</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">no</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">IPV6_ADDR_GEN_MODE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">stable-privacy</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">NAME</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">enp1s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">UUID</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">d4838e7b-fd55-48b3-bf03-91c0bc2a6df9</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">DEVICE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">enp1s0f0     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 显示的名称，必须 /sys/class/net/ 目录下的某个网卡名相同</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ONBOOT</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">yes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">IPADDR</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">10.60</span><span class="token plain">.20.74</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">GATEWAY</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">10.60</span><span class="token plain">.20.250</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">DNS1</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">223.5</span><span class="token plain">.5.5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">NETMASK</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>服务器通常有多块网卡，有板载集成的，同时也有插在 PCIe 插槽的。Linux 系统的命名原来是 eth0, eth1 这样的形式，但是这个编号往往不一定准确对应网卡接口的物理顺序。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13211一致网络设备命名规范">13.2.1.1、一致网络设备命名规范<a class="hash-link" href="#13211一致网络设备命名规范" title="标题的直接链接">​</a></h4><p>在 Centos5 的时候，我们习惯了 eth0 这样的网络设备命名。在 Centos6 发现网络设备变成了 em1 这样的命名，这是 dell 开发的 biosdevname 方案所致。那时我们启动系统时，给内核启动参数加上 biosdevname=0，就可以继续使用 eth0 这样的命名。</p><p>升级到 Centos7 后，发现原有的参数 biosdevname=0 不起作用了，网络设备变成了 eno1 这样的名称。</p><p>Centos7 这种变化的原因是由于 systemd v197 和 udev 引入了一种新的网络设备命名方式：一致网络设备命名。一致网络设备命名规范，支持 biosdevname 和 net.ifnames 两种命名规范。</p><blockquote><p>biosdevname 命名规范</p></blockquote><table><thead><tr><th>设备</th><th>旧名称</th><th>新名称</th><th>示例</th></tr></thead><tbody><tr><td>内嵌网络接口（LOM）</td><td>eth<!-- -->[<!-- -->0123…<!-- -->]</td><td>em<!-- -->[<!-- -->1234...<!-- -->]<!-- -->[<!-- -->a<!-- -->]</td><td>em1</td></tr><tr><td>PCI 卡网络接口</td><td>eth<!-- -->[<!-- -->0123…<!-- -->]</td><td>pp<!-- -->[<!-- -->b<!-- -->]</td><td>p3p4</td></tr><tr><td>虚拟功能</td><td>eth<!-- -->[<!-- -->0123…<!-- -->]</td><td>pp<!-- -->_</td><td>p3p4<!-- -->_<!-- -->1</td></tr></tbody></table><p><em>注：新枚举从 1 开始。</em></p><blockquote><p>net.ifnames 命令规范</p></blockquote><p>net.ifnames 命名规范为：设备类型 + 设备位置 + 数字</p><p><strong>设备类型</strong></p><table><thead><tr><th>字符串</th><th>含义</th></tr></thead><tbody><tr><td>en</td><td>代表以太网</td></tr><tr><td>wl</td><td>代表无线局域网(WLAN)</td></tr><tr><td>ww</td><td>代表无线广域网(WWAN)</td></tr></tbody></table><p><strong>设备命名</strong></p><table><thead><tr><th>格式</th><th>描述</th></tr></thead><tbody><tr><td>o ：on-board device index number</td><td>板载设备索引号</td></tr><tr><td>s<!-- -->[<!-- -->f<!-- -->]<!-- -->[<!-- -->d<!-- -->]<!-- --> ：hotplug slot index number</td><td>热插拔插槽索引号</td></tr><tr><td>x：MAC address</td><td>MAC 地址</td></tr><tr><td>ps<!-- -->[<!-- -->f<!-- -->]<!-- -->[<!-- -->d<!-- -->]<!-- -->： PCI geographical location</td><td>PCI 地理位置</td></tr><tr><td>ps<!-- -->[<!-- -->f<!-- -->]<!-- -->[<!-- -->u<!-- -->]<!-- -->[<!-- -->..<!-- -->]<!-- -->[<!-- -->i<!-- -->]<!-- -->：USB port number chain</td><td>USB 端口链</td></tr></tbody></table><p><strong>示例</strong></p><ul><li><code>eno1</code> 板载 1 号网卡</li><li><code>enp0s2</code> PCI 扩展卡的 2 号端口</li><li><code>ens33</code> 热插拔插槽 3 号 PCI-E 插槽的 3 号端口</li><li><code>wlp3s0</code> 第 3 号 PCI 扩展卡的 0 号端口</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13212系统默认命令规则">13.2.1.2、系统默认命令规则<a class="hash-link" href="#13212系统默认命令规则" title="标题的直接链接">​</a></h4><p>默认情况下，systemd 会使用以下策略，采用支持的命名方案为接口命名：</p><ul><li>Scheme 1（方案 1）: 如果从 BIOS 中能够取到可用的，板载网卡的索引号，则使用这个索引号命名，例如: eno1，如不能则尝试 Scheme 2</li><li>Scheme 2（方案 2）: 如果从 BIOS 中能够取到可以用的，网卡所在的 PCI-E 热插拔插槽的索引号，则使用这个索引号命名，例如: ens1，如不能则尝试 Scheme 3</li><li>Scheme 3（方案 3）: 如果能拿到设备所连接的物理位置信息，则使用这个信息命名，例如: enp2s0，如不能则尝试 Scheme 5</li><li>Scheme 4（方案 4）: 使用网卡的 MAC 地址来命名，这个方法一般不使用。</li><li>Scheme 5（方案 5）: 传统的 kernel 命名方法，例如: eth0，这种命名方法的结果不可预知的，即可能第二块网卡对应 eth0，第一块网卡对应 eth1。</li></ul><p>操作系统内核在 boot 过程是默认使用 ethX 方式来命名的，每次启动的时候都不确定，启动后再通过 systemd 和 udev 重新 rename。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13213rename-流程">13.2.1.3、rename 流程<a class="hash-link" href="#13213rename-流程" title="标题的直接链接">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 按照如下顺序执行 udev 的 rule</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">./usr/lib/udev/rules.d/60-net.rules</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">./usr/lib/udev/rules.d/71-biosdevname.rules</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">./lib/udev/rules.d/75-net-description.rules</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain">./usr/lib/udev/rules.d/80-net-name-slot.rules</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>step1 依据 /usr/lib/udev/rules.d/60-net.rules， 查看是否有 ifcfg-xx 配置文件（路径在 /etc/sysconfig/network-scripts/)，是否有定义了指定 MAC 地址的配置文件（ifcfg-xx ，xx 必须和配置文件的内容 DEVICE 一致），如果有，则命名该网卡；</p></li><li><p>step2 依据 /usr/lib/udev/rules.d/71-biosdevname.rules，如果 biosdevname 开启了（安装了 biosdevname 这个包，且内核启动参数显式设置为 1），且网卡没有在 step1 中定义，则按照 biosdevname 命名规则 rename 网卡；</p><ul><li><em>注意：如果没有安装 biosdevname 这个包，就没有这个文件</em></li></ul></li><li><p>step3 依据 /lib/udev/rules.d/75-net-description.rules，udev 工具将会根据 device 属性填写网卡的属性命名，可能一个网卡会有多个维度的名称；</p><ul><li><p>系统识别网卡有好几种维度，比如上一小节中的 Scheme 1-3(eno1 ens1 enp1)；</p></li><li><p>同一个网卡通常同时具有多个维度的名称，systemd 在选取的时候，按照有先后次序，使用先命中的；</p></li><li><p>顺序可以简单理解为 eno1 -&gt; ens1 -&gt; enp1</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># udevadm info /sys/class/net/enp1s0f0 | grep ID_NET_NAME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">E: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ID_NET_NAME_MAC</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">enx00073e9088a9</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">E: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ID_NET_NAME_PATH</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">enp1s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>step4 udev 根据 step3 中的赋值，按照指定的 scheme 规则，去给在 step1 step2 中没有命名的网卡命名；</p></li></ul><p><em>注意：这个 step 顺序是在我们没有自定义自己的 rules 的前提下，如果用户自定义了自己的 rules，则用户自定义的优先级最高；</em></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13214用户自定义网卡名">13.2.1.4、用户自定义网卡名<a class="hash-link" href="#13214用户自定义网卡名" title="标题的直接链接">​</a></h4><ol><li>在用户没有自定义 rules 文件前提下，step1 中的网卡命名方式也可认为是一种用户自定义的网卡命名；<ul><li>即在 /etc/sysconfig/network-scripts/ifcfg-xx 文件，xx 就是这个网卡名称，文件内容中体现MAC<!-- -->_<!-- -->ADDRESS、NAME，这种情况下，则会按照配置文件中指定的名称来命名网卡；</li></ul></li><li>如果用户自定义了 rules 文件，放在 /etc/udev/rules.d/ 目录下，则这个优先级是最高的；比 1 中 ifcfg-xx 方式优先级更高，但是如果两者不一致，则在重启 network 服务时，会依据 ifcfg-xx 命名，所以用户不应该同时采用这两种方式给同一个网卡命不同的名称；</li></ol><p>/etc/udev/udev.conf 是 udev 主配置文件，用户定制的规则文件在 /etc/udev/rules.d 目录下。对于网卡设备的配置一般社区约定的是 /etc/udev/rules.d/70-persistent-net.rules 文件。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token assign-left variable" style="color:rgb(9, 134, 88)">SUBSYSTEM</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;net&quot;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">ACTION</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;add&quot;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">DRIVERS</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;?*&quot;</span><span class="token plain">, ATTR</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;00:07:3e:90:88:a9&quot;</span><span class="token plain">, ATTR</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;1&quot;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">KERNEL</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;eth*&quot;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">NAME</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;eth0&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>具体的 udev 规则集语法这里不详细介绍，可以参考 <code>https://wiki.debian.org/udev</code>，这里只介绍上述规则集的含义。<ul><li>规则集文件的写法都是 key/value 格式，但分为匹配 key/vaule 和动作 key/value。上述例子中，从 SUBSYSTEM 直到 KERNEL 都是使用 &quot;==&quot; 号，表示匹配 key/value，最后一个 NAME 使用单 &quot;=&quot; 号，表示赋值 key/value。</li><li>所以上述文件的意思是：当 /sys 中的某设备各信息都能匹配上述某条规则，则赋值该设备名称为 eth0，/sys/class/net 目录下也由此名称命名设备信息的目录，<strong>ifcfg-<!-- -->*<!-- --> 配置文件中的 DEVICE 的值必须和它们相同</strong>。</li></ul></li><li>克隆虚拟机时，总是会出现 MAC 地址冲突，这是因为规则集文件和 ifcfg 配置文件都被克隆了，而新克隆出来的机器中 MAC 地址又是新的，所以会生成新的规则集，但克隆过来的 ifcfg 配置文件中的 DEVICE 值和该规则对应不上，导致克隆主机的网络将启动不了。<ul><li>解决办法是清空该文件，然后重启克隆主机，这样内核将新生成对应新 MAC 地址的规则集文件。当然，在克隆前清空模板主机的规则集文件，然后再克隆也是可以的。</li></ul></li><li>值得一提的是，在 CentOS 7 中，systemd 已经将 udevd 的功能整合在了一起，udev 的规则集文件几乎都放到了 /usr/lib/udev/rules.d/ 目录下，但却更方便了，克隆 CentOS 7 主机时，根本就不会出现 MAC 地址冲突的可能。不过，显式书写在 /etc/udev/rules.d/ 目录下的规则集文件仍然是生效的。</li><li>注意，<strong>网络规则集文件会由内核检测到设备时自动生成或写入，因此清空它不会有任何影响</strong>。</li></ul><p><em>注意：<strong>/etc/udev/rules.d/70-persistent-net.rules</strong> 和 <strong>/lib/udev/write<!-- -->_<!-- -->net<!-- -->_<!-- -->rules</strong> 这两个配套使用的文件已经废弃了，但是目前在 Centos 7 上依然可以使用。</em></p><blockquote><p>内核启动参数 biosdevnane、net.ifnames</p></blockquote><p>默认就是内核启动参数没有 biosdevname 也没有 net.ifnames 参数；</p><p>其实默认是 net.ifnames=1,biosdevname=0；这种情况下就按照 rename 中进行网卡命名；eno-ens-enp 的方式逐个匹配。</p><p>但是如果开启了 biosdevname，则会使用 biosdevname 命名 step1 中没有命名的网卡；要么是 em 开头，要么是 p 开头；</p><blockquote><p>biosdevname</p></blockquote><p>怎么开启 biosdevname 呢？</p><ol><li>安装 biosdevname 包；</li><li>在内核启动参数中明确 biosdevname=1，否则开启不了；</li><li>如果用户自定义了udev rules，则用户自定义的 rules 优先。</li></ol><blockquote><p>net.ifname</p></blockquote><p>如果在内核启动参数中增加 net.ifname=0，这个参数会在 /lib/udev/rule.d/80-net-name-slot.rules 文件中体现使用价值，告诉系统不用 scheme 的方式来命名，这个时候，会恢复 ethx 这种不确定性的命名方式；</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># vim /etc/sysconfig/grub</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">GRUB_CMDLINE_LINUX</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;crashkernel=auto rd.lvm.lv=cl/root rd.lvm.lv=cl/swap net.ifnames=0 biosdevname=0 rhgb quiet&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># grub2-mkconfig -o /boot/grub2/grub.cfg</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># mv /etc/sysconfig/network-scripts/ifcfg-enp1s0f0 /etc/sysconfig/network-scripts/ifcfg-eth0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">NAME</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">eth0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">DEVICE</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">eth0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># systemctl restart network.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1322dns-配置文件">13.2.2、DNS 配置文件<a class="hash-link" href="#1322dns-配置文件" title="标题的直接链接">​</a></h3><p>/etc/resolv.conf 用于设置 DNS 指向，以及解析顺序。该文件格式如下：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">domain  domain_name       </span><span class="token comment" style="color:rgb(0, 128, 0)"># 声明本地域名，即解析时自动隐式补齐的域名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">search  domain_name_list  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 指定域名搜索顺序(最多6个)，和domain不能共存，若共存了，则后面的行生效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nameserver  IP1           </span><span class="token comment" style="color:rgb(0, 128, 0)"># 设置DNS指向，最多3个</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nameserver  IP2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nameserver  IP3  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">options timeout:n attempts:n  </span><span class="token comment" style="color:rgb(0, 128, 0)"># 指定解析超时时间(默认5秒)和解析次数(默认2次)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>例如将 /etc/resolv.conf 设置如下所示，为了测试，暂且不设置 nameserver。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">domain brinnatt.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当解析不带点 &quot;.&quot; 的主机名时，如 &quot;www&quot;，认为不是 fqdn，将自动加上 &quot;.brinnatt.com&quot; 变成解析 &quot;<a href="http://www.brinnatt.com%22%E3%80%82" target="_blank" rel="noopener noreferrer">www.brinnatt.com&quot;。</a></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># host -a www</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Trying </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;www.brinnatt.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> connection timed out</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> no servers could be reached</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当解析的名称末尾不带点但中间带了点的，如 &quot;www.host&quot;，认为是 fqdn，将直接解析 &quot;www.host&quot;</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># host -a www.host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Trying </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;www.host&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> connection timed out</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> no servers could be reached</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>search 关键字的作用和 domain 是一样的，只不过 search 同时还暗含域名搜索的顺序。例如设置 search 为如下内容：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">search brinnatt.com britural.com yidam.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此时若解析 &quot;www&quot;，将依次解析 &quot;<a href="http://www.brinnatt.com%22%EF%BC%8C%22www.britural.com%22%EF%BC%8C%22www.yidam.com%22%E3%80%82" target="_blank" rel="noopener noreferrer">www.brinnatt.com&quot;，&quot;www.britural.com&quot;，&quot;www.yidam.com&quot;。</a></p><p>domain 部分和 search 部分不能共存，如果共存了，则最后出现的行有效。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1323服务端口定义文件">13.2.3、服务端口定义文件<a class="hash-link" href="#1323服务端口定义文件" title="标题的直接链接">​</a></h3><p>/etc/services 中记录的是端口和服务的对应关系。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># grep -E &quot;^ftp|^ssh&quot; /etc/services </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftp-data        </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain">/tcp</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftp-data        </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain">/udp</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">ftp</span><span class="token plain">             </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain">/tcp</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">ftp</span><span class="token plain">             </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain">/udp          fsp fspd</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">ssh</span><span class="token plain">             </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">/tcp                          </span><span class="token comment" style="color:rgb(0, 128, 0)"># The Secure Shell (SSH) Protocol</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">ssh</span><span class="token plain">             </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">/udp                          </span><span class="token comment" style="color:rgb(0, 128, 0)"># The Secure Shell (SSH) Protocol</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftp-data        </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain">/sctp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># FTP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">ftp</span><span class="token plain">             </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain">/sctp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># FTP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">ssh</span><span class="token plain">             </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">/sctp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># SSH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftp-agent       </span><span class="token number" style="color:rgb(9, 134, 88)">574</span><span class="token plain">/tcp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># FTP Software Agent System</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftp-agent       </span><span class="token number" style="color:rgb(9, 134, 88)">574</span><span class="token plain">/udp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># FTP Software Agent System</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sshell          </span><span class="token number" style="color:rgb(9, 134, 88)">614</span><span class="token plain">/tcp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># SSLshell</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sshell          </span><span class="token number" style="color:rgb(9, 134, 88)">614</span><span class="token plain">/udp                 </span><span class="token comment" style="color:rgb(0, 128, 0)">#       SSLshell</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftps-data       </span><span class="token number" style="color:rgb(9, 134, 88)">989</span><span class="token plain">/tcp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># ftp protocol, data, over TLS/SSL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftps-data       </span><span class="token number" style="color:rgb(9, 134, 88)">989</span><span class="token plain">/udp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># ftp protocol, data, over TLS/SSL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftps            </span><span class="token number" style="color:rgb(9, 134, 88)">990</span><span class="token plain">/tcp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># ftp protocol, control, over TLS/SSL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ftps            </span><span class="token number" style="color:rgb(9, 134, 88)">990</span><span class="token plain">/udp                 </span><span class="token comment" style="color:rgb(0, 128, 0)"># ftp protocol, control, over TLS/SSL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ssh-mgmt        </span><span class="token number" style="color:rgb(9, 134, 88)">17235</span><span class="token plain">/tcp               </span><span class="token comment" style="color:rgb(0, 128, 0)"># SSH Tectia Manager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ssh-mgmt        </span><span class="token number" style="color:rgb(9, 134, 88)">17235</span><span class="token plain">/udp               </span><span class="token comment" style="color:rgb(0, 128, 0)"># SSH Tectia Manager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="133网络接口和主机名配置">13.3、网络接口和主机名配置<a class="hash-link" href="#133网络接口和主机名配置" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1331ifconfig-命令">13.3.1、ifconfig 命令<a class="hash-link" href="#1331ifconfig-命令" title="标题的直接链接">​</a></h3><p>该命令虽然在 man 文档中被说明已废弃，但大众显然无法忘记它。ifconfig 命令是一个接口配置命令，但更多的被用来显示已激活的网络接口信息。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">ifconfig</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> interface </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -a </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">ifconfig</span><span class="token plain"> interface options</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">interface：指定被操作的网络接口名，如eth0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">up       ：激活指定的网络接口，如果在命令行中为网络接口分配了IP地址，则默认会up</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">down     ：将指定的接口设置为down状态</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">arp   ：启用或禁用该接口上使用ARP协议，如</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;ifconfig eth0 -arp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mtu N    ：设置指定接口的最大传输单元</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">MTU</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">netmask  ：设置该接口的IP netmask，默认会采用A/B/C类地址的掩码位数</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">address  ：要分配给该接口的IP地址</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ifconfig 示例：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig enp1s0f0:1 192.168.100.20 netmask 255.255.255.0 up   # 添加IP地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig enp1s0f0:2 192.168.100.21/24 up                      # 也可使用CIDR格式掩码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">flags</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">416</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">3</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">UP,BROADCAST,RUNNING,MULTICAST</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">  mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inet </span><span class="token number" style="color:rgb(9, 134, 88)">10.60</span><span class="token plain">.20.74  netmask </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0  broadcast </span><span class="token number" style="color:rgb(9, 134, 88)">10.60</span><span class="token plain">.20.255</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inet6 fe80::207:3eff:fe90:88a9  prefixlen </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain">  scopeid 0x2</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">0</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">link</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ether 00:07:3e:90:88:a9  txqueuelen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        RX packets </span><span class="token number" style="color:rgb(9, 134, 88)">1021846</span><span class="token plain">  bytes </span><span class="token number" style="color:rgb(9, 134, 88)">182866067</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">174.3</span><span class="token plain"> MiB</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        RX errors </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  dropped </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  overruns </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  frame </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        TX packets </span><span class="token number" style="color:rgb(9, 134, 88)">612715</span><span class="token plain">  bytes </span><span class="token number" style="color:rgb(9, 134, 88)">116383304</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">110.9</span><span class="token plain"> MiB</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        TX errors </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  dropped </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> overruns </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  carrier </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  collisions </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        device memory 0x61e00000-61e1ffff  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0:1: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">flags</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">416</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">3</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">UP,BROADCAST,RUNNING,MULTICAST</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">  mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inet </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.20  netmask </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0  broadcast </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.255</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ether 00:07:3e:90:88:a9  txqueuelen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        device memory 0x61e00000-61e1ffff  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0:2: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">flags</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">416</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">3</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">UP,BROADCAST,RUNNING,MULTICAST</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">  mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inet </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.21  netmask </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0  broadcast </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.255</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ether 00:07:3e:90:88:a9  txqueuelen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        device memory 0x61e00000-61e1ffff</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig eth1 up       # 激活该网络接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig eth1 down     # 临时down掉eth1接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig eth1 -arp     # 抑制eth1上的arp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig eth1 arp      # 启用eth1上的arp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>需要注意的是，ifconfig 所有的配置都是应用于内核的，所以只会临时生效，重启网络服务后会立即失效。</p><p>对于 slave 地址，即别名地址，若要永久生效，应该建立对应的别名接口配置文件，如 /ets/sysconfig/network-scripts/ifcfg-eth0:0，然后在该文件中的 DEVICE 关键字上给定 eth0:0 名称，该 DEVICE 项必须配置正确。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1332hostname-命令">13.3.2、hostname 命令<a class="hash-link" href="#1332hostname-命令" title="标题的直接链接">​</a></h3><p>用于设置主机名，但也有几个其它好用的功能。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">hostname</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-I</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-d</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">hostname</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-I         ：获取该主机上所有非环回IP地址，该选项不依赖于主机名解析</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-f,--fqdn  ：获取fqdn</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-d,--domain：获取fqdn的域名部分，等价于命令dnsdomainname</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-s,--short ：获取fqdn的主机名部分，严格地说是获取第一个</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;.&quot;</span><span class="token plain">前的部分，例如</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;www.baidu.com&quot;</span><span class="token plain">将获取为</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;www&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用 -I 选项可以直接获取该主机上的所有 IP 地址，包括别名地址，这在某些时候太方便了。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># hostname -I</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.60</span><span class="token plain">.20.74 </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.20 </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.21 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>hostname 修改的主机名为临时生效，它修改的其实是 /proc/sys/kernel/hostname 文件。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cat /proc/sys/kernel/hostname </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">arm64v8</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>想要永久生效，直接使用 hostnamctl set-hostname <!-- -->\<!-- -->&lt;\NAME&gt; 即可，实际上修改了配置文件 /etc/hostname(CentOS 7+)；如果是 Centos 6-，手动写入 /etc/sysconfig/network(CentOS 6)。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="134网关和路由">13.4、网关和路由<a class="hash-link" href="#134网关和路由" title="标题的直接链接">​</a></h2><p>Linux 上分为 3 种路由：</p><ol><li>主机路由：直接指明到某台具体的主机怎么走，主机路由也就是所谓的静态路由</li><li>网络路由：指明某类网络怎么走</li><li>默认路由：不走主机路由的和网络路由的就走默认路由。操作系统上设置的默认路由一般也称为网关。</li></ol><p><strong>若 Linux 上到某主机有多条路由可以选择，这时候会挑选优先级高的路由。在 Linux 中，路由条目的优先级确定方式是先匹配掩码位长度，再比较管理距离(比如 metric)。</strong></p><ul><li>也就是说，掩码位长的路由条目优先级一定比掩码位短的优先级高，所以主机路由的优先级最高，然后是直连网络(即同网段) 的路由(也算是网络路由) 次之，再是网络路由，最后才是默认路由。</li><li>若路由条目的掩码长度相同，则比较节点之间的管理距离，管理距离短的生效。</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># route -n</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Kernel IP routing table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.230.2   </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         UG    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens35</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">169.254</span><span class="token plain">.0.0     </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.0.0     U     </span><span class="token number" style="color:rgb(9, 134, 88)">1002</span><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.0.0     </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.0.0     </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.230.129 </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.0.0     UG    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens35</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.230.0   </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens35</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.230.129 </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.230.131 </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.255 UGH   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens35</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>如果 ping 192.168.10.7，首先匹配 192.168.230.129，发现行不通；再匹配 192.168.230.0，还是不对；再匹配 192.168.0.0，终于能匹配，于是走这条路由。至于能不能到达目的地，那是下一步的事情。</li><li>以上路由条目由我特意设计，看起来很怪，但是可以说明问题。</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># route -n</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Kernel IP routing table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.0.1     </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         UG    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0        </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0        </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">101</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens35</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">169.254</span><span class="token plain">.0.0     </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.0.0     U     </span><span class="token number" style="color:rgb(9, 134, 88)">1002</span><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.0.0     </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.230.0   </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> ens35</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>如果 ping 10.1.1.10，则匹配第 2 条和第 3 条，但是 Metric 距离短的优先，所以最终匹配 Metric 为 100 这条路由。</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1341route-命令">13.4.1、route 命令<a class="hash-link" href="#1341route-命令" title="标题的直接链接">​</a></h3><p>route 命令用于显示和管理路由表。当使用了 add 或 del 选项时，route 命令将设置路由条目，否则 route 命令将显示路由表。</p><p>要显示路由表信息，只需简单的 route -n 即可，其中 -n 选项表示不解析主机名。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@computer1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># route -n</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Kernel IP routing table</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.254      </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         UG    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> enp11s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0        </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> enp11s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0        </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> enp11s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.3.0        </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> bond1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">169.254</span><span class="token plain">.0.0     </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.0.0     U     </span><span class="token number" style="color:rgb(9, 134, 88)">1002</span><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> enp11s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">169.254</span><span class="token plain">.0.0     </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.0.0     U     </span><span class="token number" style="color:rgb(9, 134, 88)">1008</span><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> bond1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">169.254</span><span class="token plain">.64.0    </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.192.0   U     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> br_conn_all_ns</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">172.17</span><span class="token plain">.0.0      </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0         </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.0.0     U     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> docker0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@computer1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Centos 7+ 版本的内核不再使用 Metric 和 Ref，保留的原因是有些路由软件可能会用上。</li><li>对于 Flags 列，如果没有安装路由软件，则只可能出现下面的 3 种值：<ul><li>U (route is up)</li><li>H (target is a host)</li><li>G (use gateway，下一跳的路由条目)</li></ul></li></ul><p>若要管理路由表，则使用 add 或 del 选项：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">route </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">add/del</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-host/-net/default</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">/mask</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">netmask</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">gw</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">dev</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">add/del:    增加或删除路由条目</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-net:       增加或删除的是一条网络路由</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-host:      增加或删除的是一条主机路由</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">default:    增加或删除的是一条默认路由</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">netmask:    明确使用netmask关键字指定掩码，要可以不使用该选项直接在地址上使用cidr格式的掩码，即IP/MASK。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">gw:         指定下一跳的地址。要求下一跳地址必须是能到达的，且一般是和本网段直连的接口。</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">dev:        强制将路由条目关联到指定的接口上。一般内核会自动判断路由条目应该关联到哪个网络接口。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li><p>添加和删除默认路由</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> default gw </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.10   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 可以使用 0.0.0.0 替代 default 关键字</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route del default</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route del default gw </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.10   </span><span class="token comment" style="color:rgb(0, 128, 0)"># 若有多条默认路由，则再加上 gw 即可唯一删除指定条目</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>添加和删除网络路由</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> -net </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.10.0/24 gw </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.70</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> -net </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.10.0 netmask </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0 gw </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.70</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>若实在不知道下一跳给谁，那么指定本机接口也是可以的。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> -net </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.10.0/24 dev eth0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>删除路由可以直接在增加路由的语句上将 add 改为 del 关键字</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route del -net </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.10.0/24 gw </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.70</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route del -net </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.10.0 netmask </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0 gw </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.70</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route del -net </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.10.0/24 dev eth0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>但大多数时候，可以偷懒，只要能唯一确定删除的是哪条路由即可</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route del -net </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.10.0/24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>添加和删除主机路由</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> -host </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.10.55 gw </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.10.20</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">shell</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> route del -host </span><span class="token number" style="color:rgb(9, 134, 88)">172.16</span><span class="token plain">.100.55</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1342配置永久路由">13.4.2、配置永久路由<a class="hash-link" href="#1342配置永久路由" title="标题的直接链接">​</a></h3><p>根据接口创建路由配置文件 /etc/syconfig/network-scripts/route-ethX，要从那个接口出去 X 就是几。</p><p>路由配置文件的配置格式非常简单，每一行一个路由条目，先是要到达的目标，然后是 via 关键字，最后是下一跳地址。要求下一跳必须能到达，且一般都和 ethX 同网段。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">DEST    via     nexthop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>例如 eth0 网卡的 IP 地址是 192.168.10.123，要通过网卡 eth0 出去到达 10.0.0.10，那么下一跳的地址要和 eth0 的地址在同网段，如 192.168.10.222。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token number" style="color:rgb(9, 134, 88)">10.0</span><span class="token plain">.0.0 via </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.10.222</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>添加主机路由、默认路由、网段路由示例如下，其中 dev 是可以省略的，因为没有任何用处，配置在哪个 eth 文件中就会从哪个接口出去。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">#默认路由</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">default             via     </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0/0           via     </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#网段路由</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.10.0/24     via     </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">#主机路由</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.52/32   via     </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.33 dev eth1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>配置完后，重启 network 服务即可立即生效。</li></ul><p>配置永久路由时，需要注意几点：</p><ol><li>route-ethX 的对应网卡配置文件 ifcfg-ethX 必须存在，否则路由无效。</li><li>如果在文件中配置永久默认路由，则必须保证所有使用了 DHCP 服务的网卡配置文件 ifcfg-ethX 中的 DEFROUTE 指令设置为 &quot;no&quot;，表示 DHCP 不设置默认路由。</li><li>如果在 route-ethX 文件中配置永久路由，且该网卡使用了 DHCP 服务分配地址，则必须保证该网卡的 ifcfg-ethX 文件中的 PEERROUTES 指令设置为 &quot;no&quot;，表示 DHCP 设置的路由允许被覆盖。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="135arp-和-arping-命令">13.5、arp 和 arping 命令<a class="hash-link" href="#135arp-和-arping-命令" title="标题的直接链接">​</a></h2><p>维护或查看系统 arp 缓存，该命令已废弃，使用 ip neigh 代替。arp 为地址解析协议，将给定的 ipv4 地址在网络中查找其对应的 MAC 地址。一般会使用 arp 协议获取局域网内的主机 MAC，所以局域网主机之间也互称为网络邻居。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1351arp-命令">13.5.1、arp 命令<a class="hash-link" href="#1351arp-命令" title="标题的直接链接">​</a></h3><p>arp 命令语法：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">arp -n -v -i           </span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看arp缓存</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">arp -i -d </span><span class="token function" style="color:rgb(0, 0, 255)">hostname</span><span class="token plain">     </span><span class="token comment" style="color:rgb(0, 128, 0)"># 删除arp缓存条目</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-n：不解析ip地址为名称</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-v：详细信息</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-i：指定操作的接口</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-d：删除一个arp条目</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>hostname：操作该主机的 arp 条目，除了删除还有其他动作，如手动添加主机的 arp 条目，此处就不解释该用法了</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># arp -n</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Address                  HWtype  HWaddress           Flags Mask            Iface</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.14                ether   00:07:3e:92:7b:4d   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.15                ether   00:09:06:2a:3a:92   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.12                ether   00:07:3e:92:52:9c   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.254               ether   </span><span class="token number" style="color:rgb(9, 134, 88)">98</span><span class="token plain">:35:ed:31:44:4b   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.13                ether   00:07:3e:92:53:20   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.10                        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">incomplete</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">                              ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.11                ether   00:07:3e:92:52:60   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.111               ether   fa:f0:b1:bc:dd:00   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.4                 ether   00:09:06:2a:3a:8e   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.9                 ether   00:09:06:2a:3a:8e   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.22                ether   00:07:3e:92:df:80   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.199               ether   00:e0:4c:36:01:01   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2                 ether   00:09:06:2a:3a:76   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.3                 ether   00:09:06:2a:3a:a4   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.23                ether   00:07:3e:92:e0:b8   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.21                ether   00:07:3e:92:53:5f   C                     ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其实查看的信息是 /proc/net/arp 文件中的内容</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># cat /proc/net/arp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP address       HW </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain">     Flags       HW address            Mask     Device</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.14        0x1         0x2         00:07:3e:92:7b:4d     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.15        0x1         0x2         00:09:06:2a:3a:92     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.12        0x1         0x2         00:07:3e:92:52:9c     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.254       0x1         0x2         </span><span class="token number" style="color:rgb(9, 134, 88)">98</span><span class="token plain">:35:ed:31:44:4b     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.13        0x1         0x2         00:07:3e:92:53:20     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.10        0x1         0x0         00:00:00:00:00:00     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.11        0x1         0x2         00:07:3e:92:52:60     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.111       0x1         0x2         fa:f0:b1:bc:dd:00     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.4         0x1         0x2         00:09:06:2a:3a:8e     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.9         0x1         0x2         00:09:06:2a:3a:8e     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.22        0x1         0x2         00:07:3e:92:df:80     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.199       0x1         0x2         00:e0:4c:36:01:01     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2         0x1         0x2         00:09:06:2a:3a:76     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.3         0x1         0x2         00:09:06:2a:3a:a4     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.23        0x1         0x2         00:07:3e:92:e0:b8     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.21        0x1         0x2         00:07:3e:92:53:5f     *        ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># arp -d 10.1.1.21 -i ens1      # 删除arp缓存条目</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>arp 命令一次只能删除一条 arp 条目，要批量删除或清空整个 arp 条目，使用 ip neigh flush 命令。如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip neigh flush all        # 清空所有</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip neigh flush dev ens1   # 删除ens1上缓存的arp条目</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1352arping-命令">13.5.2、arping 命令<a class="hash-link" href="#1352arping-命令" title="标题的直接链接">​</a></h3><p>arping 用于发送 arp 请求报文，解析并获取目标地址的 MAC。默认将先发送广播报文，收到回复后再发送单播报文，局域网内所有主机都能收到广播报文，但只有目标主机才会回复自己的 MAC 地址。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">arping </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-fqbDU</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-c count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-w timeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-I device</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-s source</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> destination</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-f:             收到第一个reply就立即退出</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-q:             安静模式，什么都不输出</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-b:             只发送广播，不发送单播</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-D:             地址冲突检测</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-U:             主动更新邻居的arp缓存</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Unsolicited ARP mode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-c count:       发送多少个arp请求包后退出</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-w timeout:     等待reply的超时时间</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-I device:      使用哪个接口发送请求包。发送arp请求包接口的MAC地址将缓存在目标主机上</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-s source:      指定arp请求报文中源地址，若发送的接口和源地址不同，则目标主机将缓存该地址和接口的MAC地址，而非该源地址所在接口的MAC地址</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> destination:   向谁发送arp请求报文，即要获取该IP或主机名的MAC地址</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li><p>请求解析 10.1.1.21 主机的 MAC 地址</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># arping -f 10.1.1.21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ARPING </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.21 from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1 ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Unicast reply from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.21 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">00:07:3E:92:53:5F</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">.598ms</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sent </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> probes </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> broadcast</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Received </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这将会发送广播报文，直到收到 10.1.1.21 的回复才退出。</p><p>同时，10.1.1.21 也会缓存本机的 IP 和 MAC 对应条目，由于此处没有指定请求报文的发送接口和源地址，所以发送报文时是根据路由表来选择接口和对应该接口地址的。</p></li><li><p>指定发送一个请求报文给 10.1.1.21 就退出，发送报文的接口为 ens1，并指定请求报文中的源地址为本机 ens1 接口上的地址 10.1.1.10</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># arping -c 1 -I ens2 -s 10.1.1.10 10.1.1.21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ARPING </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.21 from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.10 ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Unicast reply from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.21 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">00:07:3E:92:53:5F</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">.613ms</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sent </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> probes </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> broadcast</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Received </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>发送这样的 arp 请求包，将会使得目标主机 10.1.1.21 缓存本机的 arp 条目为 &quot;10.1.1.10 MAC<!-- -->_<!-- -->ens2&quot;，但实际上，10.1.1.10 所在接口的 MAC 地址为 MAC<!-- -->_<!-- -->ens1。</p><p>arping 命令仅能实现这种简单的 arp 欺骗，更多的 arp 欺骗方法可以使用专门的工具。</p></li><li><p>探测对方主机是否存活</p><p>例如发送 4 个探测报文，有回复就说明对方存活</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># arping -c 4 -I ens1 10.1.1.13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ARPING </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.13 from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1 ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Unicast reply from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.13 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">00:07:3E:92:53:20</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">.608ms</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Unicast reply from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.13 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">00:07:3E:92:53:20</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">.586ms</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Unicast reply from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.13 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">00:07:3E:92:53:20</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">.573ms</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Unicast reply from </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.13 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">00:07:3E:92:53:20</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">.571ms</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Sent </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> probes </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> broadcast</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Received </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller1 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可见发送了 4 个探测报文，其中第一个报文是广播报文，并且收到了 4 个回复。</p></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="136ip-命令">13.6、ip 命令<a class="hash-link" href="#136ip-命令" title="标题的直接链接">​</a></h2><p>这是一个极其强大的命令，前面所有的网络信息显示和管理的命令，都可以由 ip 命令来替代完成。它是一个严格模式化的命令。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1361ip-命令帮助">13.6.1、ip 命令帮助<a class="hash-link" href="#1361ip-命令帮助" title="标题的直接链接">​</a></h3><p>先简单说明下 ip 命令的基础和获取帮助的方法。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@computer4 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip -h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Usage: </span><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> OPTIONS </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> OBJECT </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> COMMAND </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -force </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> -batch filename</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">where  OBJECT :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> address </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> addrlabel </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> route </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> rule </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> neigh </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ntable </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                   tunnel </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> tuntap </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> maddress </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> mroute </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> mrule </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> monitor </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> xfrm </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                   netns </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> l2tp </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> fou </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> macsec </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> tcp_metrics </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> netconf </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ila </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                   vrf </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> sr </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> nexthop </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       OPTIONS :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> -V</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ersion</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">tatistics</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -d</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">etails</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">esolve</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    -h</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">uman-readable</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -iec </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -j</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">son</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">retty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    -f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">amily</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> inet </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> inet6 </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> mpls </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> bridge </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    -4 </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -6 </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -I </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -D </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -M </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -B </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -0 </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    -l</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">oops</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> maximum-addr-flush-attempts </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -br</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ief</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    -o</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">neline</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">imestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -ts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">hort</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">atch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">filename</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    -rc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">vbuf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">etns</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> name </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -N</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">umeric</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                    -c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">olor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@computer4 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可见命令非常复杂，有很多 options，还有很多 object，每个 Object 又对应不同的命令。但其实常用到的就几个object：addr/route/neigh/link。</p><p>使用 ip object help 可以获取到该 object 的语法帮助。例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@computer4 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip addr help</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Usage: </span><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> address </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">add</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">change</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">replace</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> IFADDR dev IFNAME </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> LIFETIME </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> CONFFLAG-LIST </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> address del IFADDR dev IFNAME </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">mngtmpaddr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> address </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">save</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">flush</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> dev IFNAME </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> scope SCOPE-ID </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> to PREFIX </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> FLAG-LIST </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> label LABEL </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">up</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> address </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> show </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> dev IFNAME </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> scope SCOPE-ID </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> master DEVICE </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                         </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> TYPE </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> to PREFIX </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> FLAG-LIST </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                         </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> label LABEL </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">up</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> vrf NAME </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       </span><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> address </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">showdump</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">restore</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IFADDR :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> PREFIX </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ADDR peer PREFIX</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> broadcast ADDR </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> anycast ADDR </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> label IFNAME </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> scope SCOPE-ID </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> metric METRIC </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">SCOPE-ID :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> global </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> NUMBER </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FLAG-LIST :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> FLAG-LIST </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> FLAG</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FLAG  :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> permanent </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> dynamic </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> secondary </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> primary </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">tentative </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">deprecated </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">dadfailed </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> temporary </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">           CONFFLAG-LIST </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CONFFLAG-LIST :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> CONFFLAG-LIST </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> CONFFLAG</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CONFFLAG  :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> home </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> nodad </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> mngtmpaddr </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> noprefixroute </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> autojoin </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LIFETIME :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> valid_lft LFT </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> preferred_lft LFT </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LFT :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> forever </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token environment constant" style="color:rgb(129, 31, 63)">SECONDS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">TYPE :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> vlan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> veth </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> vcan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> vxcan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> dummy </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ifb </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> macvlan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> macvtap </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          bridge </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> bond </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ipoib </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ip6tnl </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ipip </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> sit </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> vxlan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> lowpan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          gre </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> gretap </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> erspan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ip6gre </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ip6gretap </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ip6erspan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> vti </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          nlmon </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> can </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> bond_slave </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ipvlan </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> geneve </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> bridge_slave </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          hsr </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> macsec </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> netdevsim </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@computer4 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在 ip 命令行下，任何 object 都可以写其全名，也可以写其缩写名，例如 address 这个 object，可以简写为 addr，也可以简写为一个字母 a。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@computer4 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip a help       # 等价于ip address help和ip addr help</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>尽管还有一个 a 开头的 object 为 addrlabel。这时因为 ip 会从上述语法给出的 object 顺序从前向后匹配，例如 &quot;ip m&quot; 将匹配到 &quot;ip maddr&quot;，如果想匹配别的，如 addrlabel，则写长一点即可 &quot;ip addrl&quot;。</p><p>对于 CentOS 6，man ip 时会输出整个 ip 的帮助文档，包括每个 object 的命令和说明。在 CentOS 7 中，则要对每个 object 独立进行 man，例如 addr 这个 object。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@computer4 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># man ip-address</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以下是所有 Object 的 man 列表。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># rpm -ql iproute | grep &quot;man8/ip-&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-address.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-addrlabel.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-fou.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-gue.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-l2tp.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-link.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-macsec.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-maddress.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-monitor.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-mroute.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-neighbour.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-netconf.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-netns.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-ntable.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-route.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-rule.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-tcp_metrics.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-token.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-tunnel.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-vrf.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/usr/share/man/man8/ip-xfrm.8.gz</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1362ip-address-命令">13.6.2、ip address 命令<a class="hash-link" href="#1362ip-address-命令" title="标题的直接链接">​</a></h3><p>ip address 用于管理网络设备上的 ip 地址，也可以查看 ip 地址的属性信息。在老版本的 Linux 中，一块网卡上设置多个 IP，这些 IP 称为别名 IP，但是从 CentOS 6 开始，这些 IP 称为 secondary IP 或 slave IP，因为这些 IP 自身也可以附带属性。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13621ip-address-adddel-子命令">13.6.2.1、ip address add/del 子命令<a class="hash-link" href="#13621ip-address-adddel-子命令" title="标题的直接链接">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> address </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> del </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> IFADDR dev STRING</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IFADDR :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> PREFIX </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> broadcast ADDR </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> anycast ADDR </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> label STRING </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">dev NAME:                   指定要设置IP地址的网卡</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">local</span><span class="token plain"> ADDRESS </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">default</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:    接口的IP地址。IP地址的格式依赖于是ipv4还是ipv6。对于ipv4而言，给定地址，可能还需要给定cidr的掩码位长度</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">broadcast ADDRESS:          接口的广播地址</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">label NAME:                 为该接口的IP地址设置label名，label名称必须以网络接口名开头后接冒号，如eth0:X</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">del和add的参数相同，且dev是必须要给定的，其余的参数可选，因为del的时候是通配del，如果删除时有多个满足条件的条目，则删除第一个条目。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip -4 add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">: ens1: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"> qdisc mq state UP group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24 brd </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.255 scope global ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip addr add 192.168.10.7/24 dev ens1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip -4 add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">: ens1: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"> qdisc mq state UP group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24 brd </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.255 scope global ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.10.7/24 scope global ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig ens1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ens1: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">flags</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">416</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">3</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">UP,BROADCAST,RUNNING,MULTICAST</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">  mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inet </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2  netmask </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0  broadcast </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.255</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inet6 fe80::209:6ff:fe2a:3a76  prefixlen </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain">  scopeid 0x2</span><span class="token operator file-descriptor important" style="color:rgb(0, 0, 0)">0</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">link</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        ether 00:09:06:2a:3a:76  txqueuelen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        RX packets </span><span class="token number" style="color:rgb(9, 134, 88)">191797931</span><span class="token plain">  bytes </span><span class="token number" style="color:rgb(9, 134, 88)">77343172607</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">72.0</span><span class="token plain"> GiB</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        RX errors </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  dropped </span><span class="token number" style="color:rgb(9, 134, 88)">1868146</span><span class="token plain">  overruns </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  frame </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        TX packets </span><span class="token number" style="color:rgb(9, 134, 88)">184903392</span><span class="token plain">  bytes </span><span class="token number" style="color:rgb(9, 134, 88)">24743236828</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">23.0</span><span class="token plain"> GiB</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        TX errors </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  dropped </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> overruns </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  carrier </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  collisions </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        device memory 0x80061200000-800612fffff  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>此方式添加的地址不会在 ifconfg 命令中显示，ifconfg 能捕捉到的是别名，所以可以为地址加上 label，以让 secondary 被 ifconfig 查看到。例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip addr add 192.168.10.8/24 dev ens1 label ens1:0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip -4 addr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">: lo:  mtu </span><span class="token number" style="color:rgb(9, 134, 88)">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  inet </span><span class="token number" style="color:rgb(9, 134, 88)">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">: ens1:  mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"> qdisc mq state UP group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  inet </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24 brd </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.255 scope global ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  inet </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.10.7/24 scope global ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  inet </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.10.8/24 scope global secondary ens1:0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ens1: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">flags</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">4163</span><span class="token plain">  mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      inet </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2  netmask </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0  broadcast </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.255</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      inet6 fe80::209:6ff:fe2a:3a76  prefixlen </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain">  scopeid 0x20</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      ether 00:09:06:2a:3a:76  txqueuelen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      RX packets </span><span class="token number" style="color:rgb(9, 134, 88)">191801282</span><span class="token plain">  bytes </span><span class="token number" style="color:rgb(9, 134, 88)">77344392183</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">72.0</span><span class="token plain"> GiB</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      RX errors </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  dropped </span><span class="token number" style="color:rgb(9, 134, 88)">1868177</span><span class="token plain">  overruns </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  frame </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      TX packets </span><span class="token number" style="color:rgb(9, 134, 88)">184906493</span><span class="token plain">  bytes </span><span class="token number" style="color:rgb(9, 134, 88)">24743634534</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">23.0</span><span class="token plain"> GiB</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      TX errors </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  dropped </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> overruns </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  carrier </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">  collisions </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      device memory 0x80061200000-800612fffff  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ens1:0: </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">flags</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">4163</span><span class="token plain">  mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      inet </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.10.8  netmask </span><span class="token number" style="color:rgb(9, 134, 88)">255.255</span><span class="token plain">.255.0  broadcast </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      ether 00:09:06:2a:3a:76  txqueuelen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      device memory 0x80061200000-800612fffff</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>要删除 ip，则简单的多，但必须指定 dev，且最好也指定 cidr 的掩码长度。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip address del 192.168.10.7/24 dev ens1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip address del 192.168.10.8/24 dev ens1 label ens1:0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip -4 add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">: ens1: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"> qdisc mq state UP group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24 brd </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.255 scope global ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13622ip-addr-show-子命令">13.6.2.2、ip addr show 子命令<a class="hash-link" href="#13622ip-addr-show-子命令" title="标题的直接链接">​</a></h4><p>其实刚才使用 ip addr 就相当于 ip addr show，这是 ip 命令使用起来很方便的地方，支持灵活缩写。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip add show</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet6 ::1/128 scope </span><span class="token function" style="color:rgb(0, 0, 255)">host</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">: ens1: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"> qdisc mq state UP group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    link/ether 00:09:06:2a:3a:76 brd ff:ff:ff:ff:ff:ff</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24 brd </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.255 scope global ens1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inet6 fe80::209:6ff:fe2a:3a76/64 scope </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13623ip-addr-flush-子命令">13.6.2.3、ip addr flush 子命令<a class="hash-link" href="#13623ip-addr-flush-子命令" title="标题的直接链接">​</a></h4><p>用于批量删除地址，该命令其实非常危险，一个不小心就会误伤无辜，所幸的是 flush 的时候不给定任何参数或者没有任何条目可以匹配上的时候将不执行 flush 动作，总之该命令要小心使用。同样也必须给定 dev 参数。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip a flush dev ens1           # 删除ens1上所有地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip a f secondary dev ens1     # 删除ens1上所有的secondary地址</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1363ip-route-命令">13.6.3、ip route 命令<a class="hash-link" href="#1363ip-route-命令" title="标题的直接链接">​</a></h3><p>该命令维护和查看内核中的路由表。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13631ip-route-addreplacemore-子命令">13.6.3.1、ip route add/replace/MORE 子命令<a class="hash-link" href="#13631ip-route-addreplacemore-子命令" title="标题的直接链接">​</a></h4><p>语法格式为：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> route </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> del </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> change </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> append </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> replace </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> dest</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">/cidr_mask</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> via ADDRESS </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> dev STRING </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中 dest 为目标地址，可以是主机地址、网段地址，一般在地址后都会带上 cidr 格式的掩码长度，不带时默认为 32 位长度。如果 dest 为 &quot;0/0&quot; 或者写为 &quot;default&quot;，则表示默认路由。</p><p>例如添加/修改/替换普通路由：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route add/change/replace 192.168.10.0/24 via 10.10.10.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>添加/修改/替换默认路由：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route add/change/replace default via 10.10.10.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route add/change/replace 0/0 via 10.10.10.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>删除某路由：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route del 192.168.10.0/24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route del default          # 删除默认路由</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13632ip-route-show-子命令">13.6.3.2、ip route show 子命令<a class="hash-link" href="#13632ip-route-show-子命令" title="标题的直接链接">​</a></h4><p>语法格式为：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> route show </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">to </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> root </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> match </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> exact </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> ADDR_pattern </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> via ADDR </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>其中 to 关键字是默认关键字，用来匹配路由的目标地址，其后可以跟上修饰符 root/match/exact。<ul><li>exact 为默认修饰符，表示精确匹配掩码位长度；</li><li>root 修饰符表示匹配的掩码位长度大于或等于 ADDR<!-- -->_<!-- -->pattern 给定的掩码位长度；</li><li>match 修饰符匹配短于或等于 ADDR<!-- -->_<!-- -->pattern 掩码位长度。</li></ul></li><li>例如 &quot;to match 16.0/16&quot; 将能匹配到 &quot;16.0/16&quot;、&quot;16/8&quot; 和 &quot;0/0&quot;，但却无法匹配 &quot;16.1/16&quot; 和 &quot;16.0/24&quot; 以及 &quot;16.0.1/24&quot;，而 &quot;to root 16.0/16&quot; 将能匹配 &quot;16.0/24&quot; 和 &quot;16.0.1/24&quot;。</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route show | column -t</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">default         via  </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.254  dev    ens1                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24     dev  ens1        proto  kernel  scope   </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain">  src  </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">169.254</span><span class="token plain">.0.0/16  dev  ens1        scope  </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain">    metric  </span><span class="token number" style="color:rgb(9, 134, 88)">1002</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route show to match 10.1.1.0/24 | column -t</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">default      via  </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.254  dev    ens1                </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24  dev  ens1        proto  kernel  scope  </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain">  src  </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route show to root 10.1/16 | column -t</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24  dev  ens1  proto  kernel  scope  </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain">  src  </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13633ip-route-flush-子命令">13.6.3.3、ip route flush 子命令<a class="hash-link" href="#13633ip-route-flush-子命令" title="标题的直接链接">​</a></h4><p>批量删除路由表条目。参数和 ip route show 的参数一样。</p><p>例如删除由 ens1 出去的路由条目。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route flush ens1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>删除下一跳为 10.10.10.1 的路由条目。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip r flush via 10.10.10.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>删除目标为 192.168.0.0/16 网段的路由</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route flush 192.168/16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13634ip-route-saverestore-子命令">13.6.3.4、ip route save/restore 子命令<a class="hash-link" href="#13634ip-route-saverestore-子命令" title="标题的直接链接">​</a></h4><p>用于保存当前的路由表以及恢复路由表。保存路由表时，路由表将以二进制裸数据的格式输出，也就是看不懂的二进制文件。</p><p>恢复路由表时，要求设备的设置和保存路由表时是一样的，恢复时已存在于路由表中的路由条目将被忽略。</p><p>例如当前路由表信息如下：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">default via </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.254 dev ens1 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24 dev ens1 proto kernel scope </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain"> src </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">169.254</span><span class="token plain">.0.0/16 dev ens1 scope </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain"> metric </span><span class="token number" style="color:rgb(9, 134, 88)">1002</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>保存当前路由表。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route save &gt; /tmp/route.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>删除几条路由表。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route flush dev ens1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>恢复路由表。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip route restore &lt; /tmp/route.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1364ip-link-命令">13.6.4、ip link 命令<a class="hash-link" href="#1364ip-link-命令" title="标题的直接链接">​</a></h3><p>link 表示 link layer 的意思，即链路层。该命令用于管理和查看网络接口，甚至可以添加虚拟网络接口，将网络接口分组进行管理。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13641ip-link-set-子命令">13.6.4.1、ip link set 子命令<a class="hash-link" href="#13641ip-link-set-子命令" title="标题的直接链接">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> DEVICE  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> up </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> down </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> arp </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> on </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> off </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> name NEWNAME </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> address LLADDR </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">dev DEVICE:         指定要操作的设备名</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">up and down:        启动或停用该设备</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">arp on or arp off:  启用或禁用该设备的arp协议</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">name NAME:          修改指定设备的名称，建议不要在该接口处于运行状态或已分配IP地址时重命名</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">address LLADDRESS:  设置指定接口的MAC地址</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>例如，启用/禁用 ens1 网卡。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip link set ens1 up/down</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其实等价于：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ifconfig ens1 up/down</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>修改网卡 ens1 的 MAC 地址。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip link set ens1 address 00:09:06:2a:3a:76</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13642ip-link-show-子命令">13.6.4.2、ip link show 子命令<a class="hash-link" href="#13642ip-link-show-子命令" title="标题的直接链接">​</a></h4><p>语法格式：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">ip</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -s </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> -h </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">link</span><span class="token plain"> show </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">dev DEV</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">选项说明：</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-s：将显示各网络接口上的流量统计信息</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">-h：以人类可读的方式显式，即单位转换。注：</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;-h&quot;</span><span class="token plain">在CentOS </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain">上才支持。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>例如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ip -s -h link show dev ens1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">: ens1: </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"> qdisc mq state UP mode DEFAULT group default qlen </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    link/ether 00:09:06:2a:3a:76 brd ff:ff:ff:ff:ff:ff</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    RX: bytes  packets  errors  dropped overrun mcast   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">77</span><span class="token plain">.8G      193M     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">       </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">.88M   </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">       </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    TX: bytes  packets  errors  dropped carrier collsns </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain">.9G      186M     </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">       </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">       </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">       </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@controller2 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="137nmcli-命令">13.7、nmcli 命令<a class="hash-link" href="#137nmcli-命令" title="标题的直接链接">​</a></h2><p>nmcli 实用工具是由 NetworkManager(网络管理器) 包提供，Centos7+ 默认已经安装。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli help</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Usage: nmcli </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">OPTIONS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> OBJECT </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> COMMAND </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OPTIONS</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -t</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">erse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                                       terse output</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -p</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">retty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                                      pretty output</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> tabular</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">multiline                      output mode</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">olors</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> auto</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">no                          whether to use colors </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> output</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ields</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">field1,field2,</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;|</span><span class="token plain">all</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">common       specify fields to output</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -g</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">et-values</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">field1,field2,</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;|</span><span class="token plain">all</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">common   shortcut </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> -m tabular -t -f</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">scape</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain">no                               escape columns separators </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> values</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">sk</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                                         ask </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> missing parameters</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">how-secrets</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                                allow displaying passwords</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -w</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ait</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">seconds</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">                              </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">timeout</span><span class="token plain"> waiting </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> finishing operations</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -v</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">ersion</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                                     show program version</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  -h</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">elp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">                                        print this </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OBJECT</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  g</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">eneral</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">       NetworkManager</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;s general status and operations</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">  n[etworking]    overall networking control</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">  r[adio]         NetworkManager radio switches</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">  c[onnection]    NetworkManager&#x27;</span><span class="token plain">s connections</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  d</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">evice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">        devices managed by NetworkManager</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">gent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">         NetworkManager secret agent or polkit agent</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">onitor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">       monitor NetworkManager changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>nmcli 命令通用的常用选项 -t 简洁输出、-p 美化输出、-f 指定输出字段、-h 查看使用帮助。</p></li><li><p>nmcli 支持对象操作，上述帮助文档已经非常简洁明了，如果想查看每个 OBJECT 的详细使用方法，可以使用 nmcli OBJECT help 获取帮助。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli general help</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Usage: nmcli general </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> COMMAND </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">help</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">COMMAND :</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> status </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">hostname</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> permissions </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> logging </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">status</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">hostname</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">permissions</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">logging </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">level </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">domains </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>当然，使用 man nmcli 可以一览无余。</p></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1371nmcli-general-命令">13.7.1、nmcli general 命令<a class="hash-link" href="#1371nmcli-general-命令" title="标题的直接链接">​</a></h3><p>命令格式：<code>nmcli general {status|hostname|permissions|logging}</code>
命令描述：使用此命令可以显示网络管理器状态和权限，你可以获取和更改系统主机名，以及网络管理器日志记录级别和域。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13711status-子命令">13.7.1.1、status 子命令<a class="hash-link" href="#13711status-子命令" title="标题的直接链接">​</a></h4><p>显示网络管理器的整体状态。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli general status </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">STATE      CONNECTIVITY  WIFI-HW  WIFI     WWAN-HW  WWAN  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">connected  full          enabled  enabled  enabled  enabled </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13712hostname-子命令">13.7.1.2、hostname 子命令<a class="hash-link" href="#13712hostname-子命令" title="标题的直接链接">​</a></h4><p>获取主机名或更改主机名，在没有给定参数的情况下，打印配置的主机名，当指定了参数，它将被移交给NetworkManager，以设置为新的系统主机名。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli general hostname </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">arm64v8</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli general hostname arm64v8_by_Brinnatt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli general hostname </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">arm64v8_by_Brinnatt</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13713permissions-子命令">13.7.1.3、permissions 子命令<a class="hash-link" href="#13713permissions-子命令" title="标题的直接链接">​</a></h4><p>显示当前用户对网络管理器可允许的操作权限。 如启用和禁用网络、更改 WI-FI 和 WWAN 状态、修改连接等。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli general permissions </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PERMISSION                                                        VALUE </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-network             </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-wifi                </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-wwan                </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-wimax               </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.sleep-wake                         </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.network-control                    </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.wifi.share.protected               </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.wifi.share.open                    </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.settings.modify.system             </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.settings.modify.own                </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.settings.modify.hostname           </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.settings.modify.global-dns         </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.reload                             </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.checkpoint-rollback                </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-statistics          </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-connectivity-check  </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13714loggin-子命令">13.7.1.4、loggin 子命令<a class="hash-link" href="#13714loggin-子命令" title="标题的直接链接">​</a></h4><p>获取和更改网络管理器日志记录级别和域，没有任何参数则显示当前日志记录级别和域。为了更改日志记录状态，请提供级别和域参数，有关可用级别和域值，参阅 <strong>NetworkManager.conf(5)</strong>。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli -p general logging </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  NetworkManager logging</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LEVEL  DOMAINS                                                                                                                                                                                                                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">INFO   PLATFORM,RFKILL,ETHER,WIFI,BT,MB,DHCP4,DHCP6,PPP,IP4,IP6,AUTOIP4,DNS,VPN,SHARING,SUPPLICANT,AGENTS,SETTINGS,SUSPEND,CORE,DEVICE,OLPC,INFINIBAND,FIREWALL,ADSL,BOND,VLAN,BRIDGE,TEAM,CONCHECK,DCB,DISPATCH,AUDIT,SYSTEMD,PROXY </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1372nmcli-networking-命令">13.7.2、nmcli networking 命令<a class="hash-link" href="#1372nmcli-networking-命令" title="标题的直接链接">​</a></h3><p>命令格式：<code>nmcli networking {on|off|connectivity}</code></p><p>命令描述：查询网络管理器网络状态，开启和关闭网络</p><p>选项：</p><ul><li><strong>on</strong>：开启 NetworkManager 管理所有网络接口</li><li><strong>off</strong>：禁用 NetworkManager 管理所有网络接口</li><li><strong>connectivity</strong> <!-- -->[<!-- -->check<!-- -->]<!-- -->：获取网络连接状态，可选参数 <!-- -->[<!-- -->check<!-- -->]<!-- --> 告诉网络管理器重新检查连接性，否则显示最近已知的状态，而无需重新检查。<ul><li>可能的状态有：</li><li>none：主机没有连接任何网络。</li><li>portal：主机被囚禁在一个门户网站后面，无法访问整个互联网。</li><li>limited：主机连接到一个网络，但是不能访问互联网。</li><li>full：主机连接到一个网络，并且完全可以访问互联网。</li><li>unknown：未知的连接状态。</li></ul></li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli networking connectivity </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">full</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli networking connectivity check </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">full</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1373nmcli-radio-命令">13.7.3、nmcli radio 命令<a class="hash-link" href="#1373nmcli-radio-命令" title="标题的直接链接">​</a></h3><p>命令格式：<code>nmcli radio {all|wifi|wwan}</code></p><p>显示无线开关状态，或启用和禁用开关</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli radio all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WIFI-HW  WIFI     WWAN-HW  WWAN  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enabled  enabled  enabled  enabled </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli radio all off</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli radio all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WIFI-HW  WIFI      WWAN-HW  WWAN   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enabled  disabled  enabled  disabled </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli radio wifi on</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli radio wwan on</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli radio all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WIFI-HW  WIFI     WWAN-HW  WWAN  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enabled  enabled  enabled  enabled </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8_by_Brinnatt ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1374nmcli-monitor-命令">13.7.4、nmcli monitor 命令<a class="hash-link" href="#1374nmcli-monitor-命令" title="标题的直接链接">​</a></h3><p>活动监视器（ACTIVITY MONITOR）</p><p>观察 NetworkManager 活动。监视设备连接状态的变化或配置文件的变化。</p><p>另请参阅 <code>nmcli connection monitor</code> 和 <code>nmcli device monitor</code> 监视某些设备或连接中的更改。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1375nmcli-connection-命令">13.7.5、nmcli connection 命令<a class="hash-link" href="#1375nmcli-connection-命令" title="标题的直接链接">​</a></h3><p>命令格式：<code>nmcli connection {show|up|down|modify|add|edit|clone|delete|monitor|reload|load|import|export}</code></p><p>NetworkManager 将所有网络配置存储为 &quot;connections&quot;，它是描述如何创建或者连接网络的数据(二层链路、三层 IP 等) 集合；当一个设备用一个 connection 的配置创建或者连接一个网络时，则表示这个 connection 是活动状态。一个设备可能有多个 connections，但是任何一个时刻，只能有一个 connection 是活动状态。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13751show-子命令">13.7.5.1、show 子命令<a class="hash-link" href="#13751show-子命令" title="标题的直接链接">​</a></h4><blockquote><p>列出活动的连接，或进行排序（ + - 为升降序）</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 查看所有连接状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection show</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME      UUID                                  TYPE      DEVICE   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0  3b71932d-657e-4c79-9dd6-3dd56b3a9c4c  ethernet  enp1s0f0 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virbr0    e597548d-e652-41a1-a044-176f0e7277b7  bridge    virbr0   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f1  </span><span class="token number" style="color:rgb(9, 134, 88)">83634972</span><span class="token plain">-548c-40c9-8acb-ca0279e0a616  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f2  89ab6348-29b0-4ff9-807a-f37518c4b297  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f3  7dbfb2be-4a88-42f8-b293-cb05763fbbf8  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 以活动的连接进行排序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection show --order +active</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME      UUID                                  TYPE      DEVICE   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0  3b71932d-657e-4c79-9dd6-3dd56b3a9c4c  ethernet  enp1s0f0 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virbr0    e597548d-e652-41a1-a044-176f0e7277b7  bridge    virbr0   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f2  89ab6348-29b0-4ff9-807a-f37518c4b297  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f3  7dbfb2be-4a88-42f8-b293-cb05763fbbf8  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f1  </span><span class="token number" style="color:rgb(9, 134, 88)">83634972</span><span class="token plain">-548c-40c9-8acb-ca0279e0a616  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 将所有连接以名称排序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection show --order +name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME      UUID                                  TYPE      DEVICE   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0  3b71932d-657e-4c79-9dd6-3dd56b3a9c4c  ethernet  enp1s0f0 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f1  </span><span class="token number" style="color:rgb(9, 134, 88)">83634972</span><span class="token plain">-548c-40c9-8acb-ca0279e0a616  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f2  89ab6348-29b0-4ff9-807a-f37518c4b297  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f3  7dbfb2be-4a88-42f8-b293-cb05763fbbf8  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virbr0    e597548d-e652-41a1-a044-176f0e7277b7  bridge    virbr0   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 将所有连接以类型排序(倒序)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection show --order -type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME      UUID                                  TYPE      DEVICE   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virbr0    e597548d-e652-41a1-a044-176f0e7277b7  bridge    virbr0   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f2  89ab6348-29b0-4ff9-807a-f37518c4b297  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0  3b71932d-657e-4c79-9dd6-3dd56b3a9c4c  ethernet  enp1s0f0 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f3  7dbfb2be-4a88-42f8-b293-cb05763fbbf8  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f1  </span><span class="token number" style="color:rgb(9, 134, 88)">83634972</span><span class="token plain">-548c-40c9-8acb-ca0279e0a616  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>查看指定连接的详细信息</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection show enp1s0f0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">connection.id:                          enp1s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">connection.uuid:                        3b71932d-657e-4c79-9dd6-3dd56b3a9c4c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">connection.stable-id:                   --</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">connection.type:                        </span><span class="token number" style="color:rgb(9, 134, 88)">802</span><span class="token plain">-3-ethernet</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">connection.interface-name:              enp1s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">connection.autoconnect:                 </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">connection.autoconnect-priority:        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13752up-子命令">13.7.5.2、up 子命令<a class="hash-link" href="#13752up-子命令" title="标题的直接链接">​</a></h4><p>激活连接，提供连接名称或 uuid 进行激活，若未提供，则可以使用 ifname 指定设备名进行激活。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 以连接名进行激活</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up enp1s0f1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 以uuid进行激活</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up 83634972-548c-40c9-8acb-ca0279e0a616</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 以设备接口名进行激活</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up ifname enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Connection successfully activated </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/7</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13753down-子命令">13.7.5.3、down 子命令<a class="hash-link" href="#13753down-子命令" title="标题的直接链接">​</a></h4><p>停用连接，提供连接名或 uuid 进行停用，若未提供，则可以使用 ifname 指定设备名进行激活。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 以连接名进行停用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection down enp1s0f1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 以uuid进行停用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection down 83634972-548c-40c9-8acb-ca0279e0a616</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 以设备接口名进行停用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection down ifname enp1s0f1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13754modify-子命令">13.7.5.4、modify 子命令<a class="hash-link" href="#13754modify-子命令" title="标题的直接链接">​</a></h4><p>属性可以用 <code>nmcli connection show &lt;INTERFACE&gt;</code> 进行获取，然后可以修改、添加或删除属性，若要设置属性，只需指定属性名称后跟值，空值将删除属性值，同一属性添加多个值使用 <code>+</code>。同一属性删除指定值用 <code>-</code> 加索引。</p><blockquote><p>添加多个 ip</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 添加三个</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify enp1s0f0 +ipv4.addresses 192.168.100.101/24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify enp1s0f0 +ipv4.addresses 192.168.100.102/24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify enp1s0f0 +ipv4.addresses 192.168.100.103/24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli -f IP4 connection show enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.GATEWAY:                            </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0/0, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.DNS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                             </span><span class="token number" style="color:rgb(9, 134, 88)">223.5</span><span class="token plain">.5.5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 启用配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up enp1s0f0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Connection successfully activated </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 再次查看</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli -f IP4 connection show enp1s0f0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.101/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.102/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.103/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.GATEWAY:                            </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0/0, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.DNS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                             </span><span class="token number" style="color:rgb(9, 134, 88)">223.5</span><span class="token plain">.5.5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>删除指定 ip</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli -f IP4 connection show enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.101/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.102/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.103/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.GATEWAY:                            </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0/0, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.DNS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                             </span><span class="token number" style="color:rgb(9, 134, 88)">223.5</span><span class="token plain">.5.5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 删除索当前索引为2的地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify enp1s0f0 -ipv4.addresses 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli -f IP4 connection show enp1s0f0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.101/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.102/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.103/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.GATEWAY:                            </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0/0, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.DNS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                             </span><span class="token number" style="color:rgb(9, 134, 88)">223.5</span><span class="token plain">.5.5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 再次激活</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up enp1s0f0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Connection successfully activated </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/9</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 查看</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli -f IP4 connection show enp1s0f0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.101/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.103/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.GATEWAY:                            </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0/0, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.DNS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                             </span><span class="token number" style="color:rgb(9, 134, 88)">223.5</span><span class="token plain">.5.5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>说明：</p><ol><li>nmcli connection modify 是直接修改 /etc/sysconfig/network-scripts/ifcfg-INTERFACE 网络接口配置文件。</li><li>网络接口配置文件修，不代表直接生效了，需要使用 nmcli connection up INTERFACE 激活配置，相当于使用 systemctl restart network 重启网络服务。</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13755add-子命令">13.7.5.5、add 子命令<a class="hash-link" href="#13755add-子命令" title="标题的直接链接">​</a></h4><p>这是创建一个新的连接，需要指定新创建连接的属性，语法与 modify 相同。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli con add con-name &quot;default&quot; type ethernet ip4 192.168.100.1/24 gw4 192.168.100.254 autoconnect yes ifname enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># con-name          (别名)connection.id，连接名称，如果不指定，默认格式为 &lt;type&gt;[-&lt;ifname&gt;][-&lt;num&gt;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># type              (别名)connection.type，连接类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># ip4               (别名)ipv4.addresses，同时设置 ipv4.method to manual</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># gw4               (别名)ipv4.gateway</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># autoconnect       (别名)connection.autoconnect，是否自动连接</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># ifname            (别名)connection.interface-name，连接到的设备名称</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其实我们常用的也不过如此，在项目中，可能用到的比较多的还有 type bond 方式，可以参见 man nmcli-examples。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13756clone-子命令">13.7.5.6、clone 子命令<a class="hash-link" href="#13756clone-子命令" title="标题的直接链接">​</a></h4><p>克隆连接，克隆一个存在的连接，除了连接名称和 uuid 是新生成的，其他都是一样的。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection clone enp1s0f0 enp1s0f0_clone</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">3b71932d-657e-4c79-9dd6-3dd56b3a9c4c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> cloned as enp1s0f0_clone </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a9700e49-28fa-40aa-94a9-4e29fcd754fe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /etc/sysconfig/network-scripts/ifcfg-enp1s0f0*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/etc/sysconfig/network-scripts/ifcfg-enp1s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/etc/sysconfig/network-scripts/ifcfg-enp1s0f0_clone</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13757delete-子命令">13.7.5.7、delete 子命令<a class="hash-link" href="#13757delete-子命令" title="标题的直接链接">​</a></h4><p>删除连接，这将删除一个连接。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection delete enp1s0f0_clone </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Connection </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;enp1s0f0_clone&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a9700e49-28fa-40aa-94a9-4e29fcd754fe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> successfully deleted.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># ls /etc/sysconfig/network-scripts/ifcfg-enp1s0f0*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">/etc/sysconfig/network-scripts/ifcfg-enp1s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13758load-子命令">13.7.5.8、load 子命令<a class="hash-link" href="#13758load-子命令" title="标题的直接链接">​</a></h4><p>从磁盘加载或重新加载一个或多个连接文件，例如你手动创建了一个 <code>/etc/sysconfig/network-scripts/ifcfg-ethx</code> 连接文件，你可以将其加载到网络管理器，以便管理。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># echo -e &quot;TYPE=Ethernet\nNAME=ethx&quot; &gt; /etc/sysconfig/network-scripts/ifcfg-ethx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection show</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME      UUID                                  TYPE      DEVICE   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0  3b71932d-657e-4c79-9dd6-3dd56b3a9c4c  ethernet  enp1s0f0 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virbr0    e597548d-e652-41a1-a044-176f0e7277b7  bridge    virbr0   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f1  </span><span class="token number" style="color:rgb(9, 134, 88)">83634972</span><span class="token plain">-548c-40c9-8acb-ca0279e0a616  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f2  89ab6348-29b0-4ff9-807a-f37518c4b297  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f3  7dbfb2be-4a88-42f8-b293-cb05763fbbf8  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection load /etc/sysconfig/network-scripts/ifcfg-ethx </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection show</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">NAME      UUID                                  TYPE      DEVICE   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0  3b71932d-657e-4c79-9dd6-3dd56b3a9c4c  ethernet  enp1s0f0 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virbr0    e597548d-e652-41a1-a044-176f0e7277b7  bridge    virbr0   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f1  </span><span class="token number" style="color:rgb(9, 134, 88)">83634972</span><span class="token plain">-548c-40c9-8acb-ca0279e0a616  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f2  89ab6348-29b0-4ff9-807a-f37518c4b297  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f3  7dbfb2be-4a88-42f8-b293-cb05763fbbf8  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ethx      d45d97fb-8530-60e2-2d15-d92c0df8b0fc  ethernet  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13759monitor-子命令">13.7.5.9、monitor 子命令<a class="hash-link" href="#13759monitor-子命令" title="标题的直接链接">​</a></h4><p>监视连接配置文件活动。每当指定的连接更改时, 此命令都会打印一行。要监视的连接由其名称、UUID 或 D 总线路径标识。</p><p>如果 ID 不明确, 则可以使用关键字 id、uuid 或路径。有关 ID 指定关键字的说明, 请参阅 nmcli con show。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># 第一个终端监视着</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection monitor enp1s0f0 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0: connection profile changed    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 说明有人动了配置文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0: connection profile changed    </span><span class="token comment" style="color:rgb(0, 128, 0)"># 说明有人动了配置文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># 第二个终端修改一下被监视接口的配置文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify enp1s0f0 +ipv4.addresses 192.168.100.101/24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify enp1s0f0 -ipv4.addresses 192.168.100.101/24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="137510示例配置-ip-隧道">13.7.5.10、示例：配置 IP 隧道<a class="hash-link" href="#137510示例配置-ip-隧道" title="标题的直接链接">​</a></h4><p>与 VPN 类似，IP 隧道通过网络（如互联网）直接连接两个网络。然而，不是所有的隧道协议都支持加密。两个建立隧道网络的路由器至少需要两个接口：</p><ul><li>一个连接到本地网络的接口</li><li>一个连接到建立隧道的网络的接口。</li></ul><p>NetworkManager 支持以下 IP 隧道：</p><ul><li>通用路由封装（GRE）</li><li>IPv6 上的通用路由封装（IP6GRE）</li><li>通用路由封装终端接入点（GRETAP）</li><li>通用路由登录在 IPv6（IP6GRETAP）上</li><li>IPv4 over IPv4（IPIP）</li><li>IPv4 over IPv6（IPIP6）</li><li>IPv6 over IPv6（IP6IP6）</li><li>简单的互联网转换（SIT）</li></ul><p>根据类型，这些通道在 Open Systems Interconnection（OSI）的第 2 层或 3 层动作。</p><blockquote><p>使用 nmcli 配置 IPIP 隧道来封装 IPv4 数据包中的 IPv4 流量</p></blockquote><p>IP over IP（IPIP）隧道在 OSI 层 3 上运行，并封装 IPv4 数据包中的 IPv4 流量，如 <a href="https://tools.ietf.org/html/rfc2003" target="_blank" rel="noopener noreferrer">RFC 2003 所述</a>。</p><p><em>注意：通过 IPIP 隧道发送的数据没有加密。出于安全考虑，只在已经加密的数据中使用隧道，比如 HTTPS。IPIP 隧道只支持单播数据包。如果您需要支持多播的 IPv4 隧道，请参考下面使用 nmcli 配置 GRE 隧道来封装 IPv4 数据包中的第 3 层流量。</em></p><p>此流程描述了如何在两个 RHEL 路由器之间创建 IPIP 隧道以通过互联网连接两个内部子网，如下图所示：</p><p><img loading="lazy" alt="IPIP-tunnel" src="/assets/images/IPIP-tunnel-5e46645f9d9a1ecce6454da8e0832d3d.png" width="952" height="436" class="img_ev3q"></p><p><strong>先决条件</strong></p><ul><li>每个 RHEL 路由器都有一个网络接口，它连接到其本地子网。</li><li>每个 RHEL 路由器都有一个网络接口，它连接到互联网。</li><li>您需要通过隧道发送的流量是 IPv4 单播。</li></ul><p><strong>流程</strong></p><ol><li><p>在网络 A 的 RHEL 路由器上：</p><ol><li><p>创建名为 <code>tun0</code> 的 IPIP 隧道接口：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type ip-tunnel ip-tunnel.mode ipip con-name tun0 ifname tun0 remote 198.51.100.5 local 203.0.113.10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>remote</code> 和 <code>local</code> 参数设置远程和本地路由器的公共 IP 地址。</li></ul></li><li><p>将 IPv4 地址设置为 <code>tun0</code> 设备：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify tun0 ipv4.addresses &#x27;10.0.1.1/30&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>请注意，有两个可用的 IP 地址的 <code>/30</code> 子网足以满足隧道的需要。</li></ul></li><li><p>将 <code>tun0</code> 连接配置为使用手动 IPv4 配置：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify tun0 ipv4.method manual</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>添加将流量路由到 <code>172.16.0.0/24</code> 网络的静态路由到路由器 B 的隧道 IP：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify tun0 +ipv4.routes &quot;172.16.0.0/24 10.0.1.2&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>启用 <code>tun0</code> 连接。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up tun0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>启用数据包转发：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;net.ipv4.ip_forward=1&quot; &gt; /etc/sysctl.d/95-IPv4-forwarding.conf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># sysctl -p /etc/sysctl.d/95-IPv4-forwarding.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol></li><li><p>在网络 B 中的 RHEL 路由器中：</p><ol><li><p>创建名为 <code>tun0</code> 的 IPIP 隧道接口：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type ip-tunnel ip-tunnel.mode ipip con-name tun0 ifname tun0 remote 203.0.113.10 local 198.51.100.5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>remote</code> 和 <code>local</code> 参数设置远程和本地路由器的公共 IP 地址。</li></ul></li><li><p>将 IPv4 地址设置为 <code>tun0</code> 设备：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify tun0 ipv4.addresses &#x27;10.0.1.2/30&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>将 <code>tun0</code> 连接配置为使用手动 IPv4 配置：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify tun0 ipv4.method manual</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>添加将流量路由到 <code>192.0.2.0/24</code> 网络的静态路由到路由器 A 的隧道 IP:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify tun0 +ipv4.routes &quot;192.0.2.0/24 10.0.1.1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>启用 <code>tun0</code> 连接。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up tun0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>启用数据包转发：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;net.ipv4.ip_forward=1&quot; &gt; /etc/sysctl.d/95-IPv4-forwarding.conf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># sysctl -p /etc/sysctl.d/95-IPv4-forwarding.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol></li></ol><p><strong>验证步骤</strong></p><p>从每个 RHEL 路由器中，ping 路由器的内部接口的 IP 地址：</p><ul><li><p>在路由器 A 中，ping <code>172.16.0.1</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># ping 172.16.0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>在路由器 B 中，ping <code>192.0.2.1</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># ping 192.0.2.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><blockquote><p>使用 nmcli 配置 GRE 隧道来封装 IPv4 数据包中的层 3 流量</p></blockquote><p>Generic Routing Encapsulation（GRE）隧道封装 IPv4 数据包中的第 3 层流量，如 <a href="https://tools.ietf.org/html/rfc2784" target="_blank" rel="noopener noreferrer">RFC 2784</a> 所述。GRE 隧道可以使用有效的以太网类型封装任何第 3 层协议。</p><p><em>注意：通过 GRE 隧道发送的数据没有加密。出于安全考虑，只在已经加密的数据中使用隧道，比如 HTTPS。</em></p><p>此流程描述了如何在两个 RHEL 路由器之间创建 GRE 隧道以通过互联网连接两个内部子网，如下图所示：</p><p><img loading="lazy" alt="GRE-tunnel" src="/assets/images/GRE-tunnel-65ddebf251792809da0490991feeafdc.png" width="955" height="438" class="img_ev3q"></p><p><em>注意：<code>gre0</code> 设备名称被保留。为该设备使用 <code>gre1</code> 或者不同名称。</em></p><p><strong>先决条件</strong></p><ul><li>每个 RHEL 路由器都有一个网络接口，它连接到其本地子网。</li><li>每个 RHEL 路由器都有一个网络接口，它连接到互联网。</li></ul><p><strong>流程</strong></p><ol><li><p>在网络 A 的 RHEL 路由器上：</p><ol><li><p>创建名为 <code>gre1</code> 的 GRE 隧道接口：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type ip-tunnel ip-tunnel.mode gre con-name gre1 ifname gre1 remote 198.51.100.5 local 203.0.113.10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>remote</code> 和 <code>local</code> 参数设置远程和本地路由器的公共 IP 地址。</li></ul></li><li><p>将 IPv4 地址设置为 <code>gre1</code> 设备：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify gre1 ipv4.addresses &#x27;10.0.1.1/30&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>请注意，有两个可用的 IP 地址的 <code>/30</code> 子网足以满足隧道的需要。</li></ul></li><li><p>将 <code>gre1</code> 连接配置为使用手动 IPv4 配置：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify gre1 ipv4.method manual</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>添加将流量路由到 <code>172.16.0.0/24</code> 网络的静态路由到路由器 B 的隧道 IP：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify tun0 +ipv4.routes &quot;172.16.0.0/24 10.0.1.2&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>启用 <code>gre1</code> 连接。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up gre1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>启用数据包转发：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;net.ipv4.ip_forward=1&quot; &gt; /etc/sysctl.d/95-IPv4-forwarding.conf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># sysctl -p /etc/sysctl.d/95-IPv4-forwarding.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol></li><li><p>在网络 B 中的 RHEL 路由器中：</p><ol><li><p>创建名为 <code>gre1</code> 的 GRE 隧道接口：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type ip-tunnel ip-tunnel.mode ipip con-name gre1 ifname gre1 remote 203.0.113.10 local 198.51.100.5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>remote</code> 和 <code>local</code> 参数设置远程和本地路由器的公共 IP 地址。</li></ul></li><li><p>将 IPv4 地址设置为 <code>gre1</code> 设备：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify gre1 ipv4.addresses &#x27;10.0.1.2/30&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>将 <code>gre1</code> 连接配置为使用手动 IPv4 配置：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify gre1 ipv4.method manual</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>添加将流量路由到 <code>192.0.2.0/24</code> 网络的静态路由到路由器 A 的隧道 IP:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify tun0 +ipv4.routes &quot;192.0.2.0/24 10.0.1.1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>启用 <code>gre1</code> 连接。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up gre1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>启用数据包转发：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># echo &quot;net.ipv4.ip_forward=1&quot; &gt; /etc/sysctl.d/95-IPv4-forwarding.conf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># sysctl -p /etc/sysctl.d/95-IPv4-forwarding.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol></li></ol><p><strong>验证步骤</strong></p><p>从每个 RHEL 路由器中，ping 路由器的内部接口的 IP 地址：</p><ul><li><p>在路由器 A 中，ping <code>172.16.0.1</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># ping 172.16.0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>在路由器 B 中，ping <code>192.0.2.1</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># ping 192.0.2.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><blockquote><p>配置 GRETAP 隧道来通过 IPv4 传输以太网帧</p></blockquote><p>Generic Routing Encapsulation Terminal Access Point(GRETAP)隧道在 OSI 级别 2 上运行,并封装 IPv4 数据包中的以太网流量,如 <a href="https://tools.ietf.org/html/rfc2784" target="_blank" rel="noopener noreferrer">RFC 2784</a> 所述。</p><p><em>注意：通过 GRETAP 隧道发送的数据没有加密。出于安全考虑，通过 VPN 或不同的加密连接建立隧道。</em></p><p>此流程描述了如何在两个 RHEL 路由器之间创建 GRETAP 隧道以使用桥接连接两个网络，如下图所示：</p><p><img loading="lazy" alt="GRETAP-tunnel" src="/assets/images/GRETAP-tunnel-7c948b56a321b0accad1f5ddfb3e26c0.png" width="957" height="508" class="img_ev3q"></p><p><em>注意：<code>gretap0</code> 设备名称被保留。为该设备使用 <code>gretap1</code> 或者不同名称。</em></p><p><strong>先决条件</strong></p><ul><li>每个 RHEL 路由器都有一个网络接口，它连接到其本地网络，接口没有分配 IP 配置。</li><li>每个 RHEL 路由器都有一个网络接口，它连接到互联网。</li></ul><p><strong>流程</strong></p><ol><li><p>在网络 A 的 RHEL 路由器上：</p><ol><li><p>创建名为 <code>bridge0</code>的网桥接口：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type bridge con-name bridge0 ifname bridge0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>配置网桥的 IP 设置：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify bridge0 ipv4.addresses &#x27;192.0.2.1/24&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify bridge0 ipv4.method manual</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>为连接到本地网络的接口添加新连接配置集到网桥：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type ethernet slave-type bridge con-name bridge0-port1 ifname enp1s0 master bridge0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>为网桥添加 GRETAP 隧道接口的新连接配置集：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type ip-tunnel ip-tunnel.mode gretap slave-type bridge con-name bridge0-port2 ifname gretap1 remote 198.51.100.5 local 203.0.113.10 master bridge0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>remote</code> 和 <code>local</code> 参数设置远程和本地路由器的公共 IP 地址。</li></ul></li><li><p>可选：如果您不需要，STP（Spanning Tree Protocol）：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify bridge0 bridge.stp no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>默认情况下，STP 被启用并导致在使用连接前出现延迟。</li></ul></li><li><p>配置激活 <code>bridge0</code> 连接会自动激活网桥端口：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify bridge0 connection.autoconnect-slaves 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>激活 <code>bridge0</code> 连接：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up bridge0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol></li><li><p>在网络 B 中的 RHEL 路由器中：</p><ol><li><p>创建名为 <code>bridge0</code>的网桥接口：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type bridge con-name bridge0 ifname bridge0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>配置网桥的 IP 设置：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify bridge0 ipv4.addresses &#x27;192.0.2.2/24&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify bridge0 ipv4.method manual</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>为连接到本地网络的接口添加新连接配置集到网桥：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type ethernet slave-type bridge con-name bridge0-port1 ifname enp1s0 master bridge0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>为网桥添加 GRETAP 隧道接口的新连接配置集：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type ip-tunnel ip-tunnel.mode gretap slave-type bridge con-name bridge0-port2 ifname gretap1 remote 203.0.113.10 local 198.51.100.5 master bridge0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>remote</code> 和 <code>local</code> 参数设置远程和本地路由器的公共 IP 地址。</li></ul></li><li><p>可选：如果您不需要，STP（Spanning Tree Protocol）：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify bridge0 bridge.stp no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>配置激活 <code>bridge0</code> 连接会自动激活网桥端口：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection modify bridge0 connection.autoconnect-slaves 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>激活 <code>bridge0</code> 连接：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection up bridge0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol></li></ol><p><strong>验证步骤</strong></p><ol><li><p>在两个路由器中,验证 <code>enp1s0</code> 和 <code>gretap1</code> 连接是否已连接,并且 <code>CONNECTION</code> 列显示了端口的连接名称：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nmcli device</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DEVICE   TYPE      STATE      CONNECTION</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">bridge0  bridge    connected  bridge0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0   ethernet  connected  bridge0-port1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">gretap1  iptunnel  connected  bridge0-port2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>从每个 RHEL 路由器中，ping 路由器的内部接口的 IP 地址：</p><ul><li><p>在路由器 A 中，ping <code>192.0.2.2</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># ping 192.0.2.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>在路由器 B 中，ping <code>192.0.2.1</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># ping 192.0.2.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1376nmcli-device-命令">13.7.6、nmcli device 命令<a class="hash-link" href="#1376nmcli-device-命令" title="标题的直接链接">​</a></h3><p>命令格式：<code>nmcli device {status|show|set|connect|reapply|modify|disconnect|delete|monitor|wifi|lldp}</code></p><p>显示和管理网络接口。nmcli device 功能也很强大，下面介绍一些常见的用法。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13761status-子命令">13.7.6.1、status 子命令<a class="hash-link" href="#13761status-子命令" title="标题的直接链接">​</a></h4><p>显示所有设备状态信息，如果 nmcli device 不接子命令，status 就是默认的动作。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device status </span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">DEVICE      TYPE      STATE        CONNECTION </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f0    ethernet  connected    enp1s0f0   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virbr0      bridge    connected    virbr0   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f1    ethernet  unavailable  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f2    ethernet  unavailable  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">enp1s0f3    ethernet  unavailable  --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">lo          loopback  unmanaged    --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">virbr0-nic  tun       unmanaged    --   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13762show-子命令">13.7.6.2、show 子命令<a class="hash-link" href="#13762show-子命令" title="标题的直接链接">​</a></h4><blockquote><p>show <!-- -->[<!-- -->ifname<!-- -->]</p></blockquote><p>显示设备的详细信息，如果后面不接参数，所有设备将被检测一遍；想要获得某接口详细信息，则必须指定接口。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device show enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.DEVICE:                         enp1s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.TYPE:                           ethernet</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.HWADDR:                         00:07:3E:90:88:A9</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.MTU:                            </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.STATE:                          </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">connected</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.CONNECTION:                     enp1s0f0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.CON-</span><span class="token environment constant" style="color:rgb(129, 31, 63)">PATH</span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain">                       /org/freedesktop/NetworkManager/ActiveConnection/11</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WIRED-PROPERTIES.CARRIER:               on</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.GATEWAY:                            </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.0/24, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.0</span><span class="token plain">.0.0/0, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.1, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.DNS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                             </span><span class="token number" style="color:rgb(9, 134, 88)">223.5</span><span class="token plain">.5.5</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP6.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         fe80::6f3:8a3e:587:7dc8/64</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP6.GATEWAY:                            --</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP6.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ff00::/8, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ::, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">256</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">table</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">255</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP6.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> fe80::/64, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ::, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">256</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP6.ROUTE</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                           dst </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> fe80::/64, nh </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ::, mt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13763set-子命令">13.7.6.3、set 子命令<a class="hash-link" href="#13763set-子命令" title="标题的直接链接">​</a></h4><blockquote><p>set <!-- -->[<!-- -->ifname<!-- -->]<!-- --> ifname <!-- -->[<!-- -->autoconnect {yes | no}<!-- -->]<!-- --> <!-- -->[<!-- -->managed {yes | no}<!-- -->]</p></blockquote><p>设置设备属性</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device set enp1s0f0 autoconnect yes managed yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13764connect-子命令">13.7.6.4、connect 子命令<a class="hash-link" href="#13764connect-子命令" title="标题的直接链接">​</a></h4><blockquote><p>connect ifname</p></blockquote><p>连接设备，NetworkManager 会偿试找到一个合适的连接，并且激活；如果不指定 --wait 超时时间，默认为 90 秒。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device connect enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Device </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;enp1s0f0&#x27;</span><span class="token plain"> successfully activated with </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;3b71932d-657e-4c79-9dd6-3dd56b3a9c4c&#x27;</span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13765reapply-子命令">13.7.6.5、reapply 子命令<a class="hash-link" href="#13765reapply-子命令" title="标题的直接链接">​</a></h4><blockquote><p>reapply ifname</p></blockquote><p>NetworkManager 偿试将未生效的设备更改更新到 connection 中去，使其生效。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device reapply enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Connection successfully reapplied to device </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;enp1s0f0&#x27;</span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13766modify-子命令">13.7.6.6、modify 子命令<a class="hash-link" href="#13766modify-子命令" title="标题的直接链接">​</a></h4><blockquote><p>modify ifname {option value | <!-- -->[<!-- -->+|-<!-- -->]<!-- -->setting.property value}...</p></blockquote><p>更改当前活动设备的设置，这个命令会临时更改活动设备的配置信息，但是不会保存到 connection 配置文件当中；语法跟 nmcli connection modify 一样，但是 nmcli connection modify 会立即将配置写入 connection 配置文件持久化。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device modify enp1s0f0 +ipv4.addresses 192.168.100.101/24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Connection successfully reapplied to device </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;enp1s0f0&#x27;</span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli -f IP4.ADDRESS device show enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.101/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device modify enp1s0f0 -ipv4.addresses 192.168.100.101/24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Connection successfully reapplied to device </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;enp1s0f0&#x27;</span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli -f IP4.ADDRESS device show enp1s0f0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IP4.ADDRESS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">:                         </span><span class="token number" style="color:rgb(9, 134, 88)">10.1</span><span class="token plain">.1.2/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13767disconnect-子命令">13.7.6.7、disconnect 子命令<a class="hash-link" href="#13767disconnect-子命令" title="标题的直接链接">​</a></h4><blockquote><p>disconnect ifname</p></blockquote><p>断开设备连接，并且阻止设备自动激活 connection，除非人工干预。注意断开连接的软件设备将会消失。如果 --wait 不指定超时时间，默认超时间为 10 秒。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device disconnect enp1s0f1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13768delete-子命令">13.7.6.8、delete 子命令<a class="hash-link" href="#13768delete-子命令" title="标题的直接链接">​</a></h4><blockquote><p>delete ifname</p></blockquote><p>删除一个设备，这个命令将会移除操作系统中的网络接口，注意移除接口只适用于软件设备，比如 bonds、bridges、teams等；硬件设备不能被这个命令删除。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli connection add type bond ifname mybond0 mode active-backup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Connection </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;bond-mybond0-1&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">2ebb2f18-8bff-4832-b809-cd32018f2aed</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> successfully added.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device show mybond0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.DEVICE:                         mybond0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.TYPE:                           bond</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.HWADDR:                         0A:85:96:46:70:52</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.MTU:                            </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.STATE:                          </span><span class="token number" style="color:rgb(9, 134, 88)">70</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">connecting </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">getting IP configuration</span><span class="token punctuation" style="color:rgb(4, 81, 165)">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.CONNECTION:                     bond-mybond0-1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.CON-</span><span class="token environment constant" style="color:rgb(129, 31, 63)">PATH</span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">:</span><span class="token plain">                       /org/freedesktop/NetworkManager/ActiveConnection/14</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device delete mybond0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Device </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;mybond0&#x27;</span><span class="token plain"> successfully removed.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device show mybond0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Error: Device </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;mybond0&#x27;</span><span class="token plain"> not found.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13769wifi-子命令">13.7.6.9、wifi 子命令<a class="hash-link" href="#13769wifi-子命令" title="标题的直接链接">​</a></h4><blockquote><p>wifi <!-- -->[<!-- -->list <!-- -->[<!-- -->--rescan | auto | no | yes<!-- -->]<!-- --> <!-- -->[<!-- -->ifname ifname<!-- -->]<!-- --> <!-- -->[<!-- -->bssid BSSID<!-- -->]<!-- -->]</p></blockquote><p>列出可用的 Wi-Fi 热点，ifname 和 bssid 选项可以分别列出某个特定接口上的 AP 或者列出某个特定的 bssid。默认情况下，nmcli 可以保证热点处于 30s 内刷新状态，如果使用 --rescan 则会强制立即刷新。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device wifi list --rescan yes ifname wlp6s0u1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IN-USE  SSID             MODE   CHAN  RATE        SIGNAL  BARS  SECURITY</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        CMCC-NaAn        Infra  </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">130</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain">     ▂▄▆█  WPA1 WPA2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">*       Britural-router  Infra  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">195</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">79</span><span class="token plain">      ▂▄▆_  WPA2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        CU-5D60          Infra  </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">130</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">72</span><span class="token plain">      ▂▄▆_  WPA1 WPA2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        MERCURY_07D8     Infra  </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">270</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">69</span><span class="token plain">      ▂▄▆_  --</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device wifi list bssid C8:3A:35:3D:8C:91</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">IN-USE  SSID             MODE   CHAN  RATE        SIGNAL  BARS  SECURITY</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        Britural-router  Infra  </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">195</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain">     ▂▄▆█  WPA2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># nmcli device wifi list bssid Britural-router</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Success</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">root@arm64v8 ~</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token comment" style="color:rgb(0, 128, 0)"># </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>wifi connect (B)SSID <!-- -->[<!-- -->password password<!-- -->]<!-- --> <!-- -->[<!-- -->wep-key-type {key | phrase}<!-- -->]<!-- --> <!-- -->[<!-- -->ifname ifname<!-- -->]<!-- --> <!-- -->[<!-- -->bssid BSSID<!-- -->]<!-- --> <!-- -->[<!-- -->name name<!-- -->]<!-- --> <!-- -->[<!-- -->private {yes | no}<!-- -->]<!-- --> <!-- -->[<!-- -->hidden {yes | no}<!-- -->]</p></blockquote><p>通过指定 SSID/ESSID(WLAN名) 或者 BSSID(AP MAC地址) 连接到一个 Wi-Fi 网络。</p><p>这个命令会通过一个合适设备找到一个合适的连接并且激活它，实际上这是在图形界面上点击 SSID 图标对应的命令行机制。</p><p>如果连接已经存在，该命令会偿试激活连接(nmcli connection up id &lt;<em>name</em>&gt;)。注意，如果不存在以前的连接，则只支持开放的 WEP 和 WPA-PSK 网络，期间假设 IP 配置是通过 DHCP 获得的。--wait 选项如果不手动指定，默认为 90s 超时时间。</p><p>可使用的选项如下：</p><table><thead><tr><th>字段</th><th>含义</th></tr></thead><tbody><tr><td>password</td><td>接入安全网络的密码</td></tr><tr><td>wep-key-type</td><td>WEP 密码类型，密钥为 ASCII/HEX 密钥或密码短语</td></tr><tr><td>ifname</td><td>用来激活的接口</td></tr><tr><td>bssid</td><td>如果指定 BSSID，创建的 connection 就会限制于 BSSID</td></tr><tr><td>name</td><td>如果指定 name，connection 将会使用该名字；或者 NM 自动创建一个名字</td></tr><tr><td>private</td><td>如果设置为 yes，connection 只为创建者可见；默认是系统级别，所有人可见</td></tr><tr><td>hidden</td><td>当第一次连接一个不广播 SSID 的 AP 时，要设置为 yes；否则 SSID 找不到，连接失败</td></tr></tbody></table><blockquote><p>wifi hotspot <!-- -->[<!-- -->ifname ifname<!-- -->]<!-- --> <!-- -->[<!-- -->con-name name<!-- -->]<!-- --> <!-- -->[<!-- -->ssid SSID<!-- -->]<!-- --> <!-- -->[<!-- -->band {a | bg}<!-- -->]<!-- --> <!-- -->[<!-- -->channel channel<!-- -->]<!-- --> <!-- -->[<!-- -->password password<!-- -->]</p></blockquote><p>创建一个 Wi-Fi 热点，该命令会根据 Wi-Fi 设备的能力创建一个热点 connection 配置文件并且激活该设备。如果设备支持则使用 WPA 加密，否则使用 WEP 加密。使用 connection down 或 device disconnect 关闭热点。</p><p>可使用的选项如下：</p><table><thead><tr><th>字段</th><th>含义</th></tr></thead><tbody><tr><td>ifname</td><td>使用的 Wi-Fi 设备</td></tr><tr><td>con-name</td><td>创建热点 connection 配置文件的名字</td></tr><tr><td>ssid</td><td>热点的 SSID</td></tr><tr><td>band</td><td>将要使用的 Wi-Fi 带宽</td></tr><tr><td>channel</td><td>将要使用的 Wi-Fi 频道</td></tr><tr><td>password</td><td>设置接入密码，如果不提供，nmcli 会自动创建一个密码，密码是 WPA 预共享密钥或者 WEP 密钥。</td></tr><tr><td>-<!-- -->-show-secrets 全局选项可以用来打印热点密码，这在自动生成密码时非常有用。</td><td></td></tr></tbody></table><blockquote><p>wifi rescan <!-- -->[<!-- -->ifname ifname<!-- -->]<!-- --> <!-- -->[<!-- -->ssid SSID...<!-- -->]</p></blockquote><p>让 NetworkManager 立即扫描可用的热点，虽然 NetworkManager 自动间期性重扫描，但是有时还是需要手动进行扫描，特别对于隐藏的 APs 很实用。</p><p>这个命令并不会显示 APs，要使用 nmcli device wifi list 显示可用热点。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1377示例nmcli-examples">13.7.7、示例(nmcli-examples)<a class="hash-link" href="#1377示例nmcli-examples" title="标题的直接链接">​</a></h3><p>上面已经很详细介绍了 nmcli 的用法，并且分别举了一些实际生产中的例子，只要吃透上面的用法，使用 nmcli 就会得心应手。下面例出官方的例子，用来作为参照。</p><blockquote><p>Example 1. Listing available Wi-Fi APs</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli device wifi list</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">*  SSID               MODE    CHAN  RATE       SIGNAL  BARS  SECURITY</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   netdatacomm_local  Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">37</span><span class="token plain">      ▂▄__  WEP</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">*  F1                 Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">98</span><span class="token plain">      ▂▄▆█  WPA1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   LoremCorp          Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">62</span><span class="token plain">      ▂▄▆_  WPA2 </span><span class="token number" style="color:rgb(9, 134, 88)">802</span><span class="token plain">.1X</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   Internet           Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">29</span><span class="token plain">      ▂___  WPA1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   HPB110a.F2672A     Ad-Hoc  </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">      ▂___  --</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   Jozinet            Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">      ▂___  WEP</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   VOIP               Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain">      ▂___  WEP</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   MARTINA            Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">32</span><span class="token plain">      ▂▄__  WPA2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   N24PU1             Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">      ▂___  --</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   alfa               Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">67</span><span class="token plain">      ▂▄▆_  WPA2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   bertnet            Infra   </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain">     </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> Mbit/s  </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain">      ▂___  WPA1 WPA2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 2. Showing general information and properties for a Wi-Fi interface</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli -p -f general,wifi-properties device show wlan0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Device details </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">wlan0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.DEVICE:           wlan0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.TYPE:             wifi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.VENDOR:           Intel Corporation</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.PRODUCT:          PRO/Wireless </span><span class="token number" style="color:rgb(9, 134, 88)">5100</span><span class="token plain"> AGN </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">Shiloh</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> Network Connection</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.DRIVER:           iwlwifi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.DRIVER-VERSION:   </span><span class="token number" style="color:rgb(9, 134, 88)">3.8</span><span class="token plain">.13-100.fc17.x86_64</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.FIRMWARE-VERSION: </span><span class="token number" style="color:rgb(9, 134, 88)">8.83</span><span class="token plain">.5.1 build </span><span class="token number" style="color:rgb(9, 134, 88)">33692</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.HWADDR:           00:1E:65:37:A1:D3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.MTU:              </span><span class="token number" style="color:rgb(9, 134, 88)">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.STATE:            </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">connected</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.REASON:           </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">No reason given</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.UDI:              /sys/devices/pci0000:00/0000:00:1c.1/net/wlan0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL.IP-IFACE:         wlan0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 3. Listing NetworkManager polkit permissions</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli general permissions</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PERMISSION                                                VALUE</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-network     </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-wifi        </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-wwan        </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">org.freedesktop.NetworkManager.enable-disable-wimax       </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 4. Listing NetworkManager log level and domains</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli general logging</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LEVEL  DOMAINS</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">INFO   PLATFORM,RFKILL,ETHER,WIFI,BT,MB,DHCP4,DHCP6,PPP,WIFI_SCAN,IP4,IP6,A</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">UTOIP4,DNS,VPN,SHARING,SUPPLICANT,AGENTS,SETTINGS,SUSPEND,CORE,DEVICE,OLPC,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">WIMAX,INFINIBAND,FIREWALL,ADSL,BOND,VLAN,BRIDGE,DBUS_PROPS,TEAM,CONCHECK,DC</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">B,DISPATCH</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 5. Changing NetworkManager logging</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli g log level DEBUG domains CORE,ETHER,IP</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli g log level INFO domains DEFAULT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 6. Activating a VPN connection profile requiring interactive password input</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli --ask con up my-vpn-con</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 7. Adding a bonding master and two slave connection profiles</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> bond ifname mybond0 mode active-backup</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> ethernet ifname eth1 master mybond0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> ethernet ifname eth2 master mybond0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 8. Adding a team master and two slave connection profiles</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> team con-name Team1 ifname Team1 config team1-master-json.con</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">f</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> ethernet con-name Team1-slave1 ifname em1 master Team1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> ethernet con-name Team1-slave2 ifname em2 master Team1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con up Team1-slave1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con up Team1-slave2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 9. Adding a bridge and two slave profiles</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> bridge con-name TowerBridge ifname TowerBridge</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> ethernet con-name br-slave-1 ifname ens3 master TowerBridge</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> ethernet con-name br-slave-2 ifname ens4 master TowerBridge</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con modify TowerBridge bridge.stp no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 10. Adding an ethernet connection profile with manual IP configuration</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> con-name my-con-em1 ifname em1 </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> ethernet </span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ip4 </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.100/24 gw4 </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.100.1 ip4 </span><span class="token number" style="color:rgb(9, 134, 88)">1.2</span><span class="token plain">.3.4 ip6 abbe::cafe</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con mod my-con-em1 ipv4.dns </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;8.8.8.8 8.8.4.4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con mod my-con-em1 +ipv4.dns </span><span class="token number" style="color:rgb(9, 134, 88)">1.2</span><span class="token plain">.3.4</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con mod my-con-em1 ipv6.dns </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;2001:4860:4860::8888 2001:4860:4860::8844&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli -p con show my-con-em1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 11. Convenient field values retrieval for scripting</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli -g ip4.address connection show my-con-eth0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.1.12/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli -g ip4.address,ip4.dns connection show my-con-eth0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.1.12/24</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">192.168</span><span class="token plain">.1.1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli -g ip4 connection show my-con-eth0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  IP4:192.168.1.12/24:192.168.1.1::192.168.1.1::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 12. Adding an Ethernet connection and configuring SR-IOV VFs</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">type</span><span class="token plain"> ethernet con-name EthernetPF ifname em1</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con modify EthernetPF sriov.total-vfs </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> sriov.autoprobe-drivers </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con modify EthernetPF sriov.vfs </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;0 mac=00:11:22:33:44:55 vlans=10, 1 trust\</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">  =true spoof-check=false&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli con modify EthernetPF +sriov.vfs </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2 max-tx-rate=20&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 13. Escaping colon characters in tabular mode</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">$ nmcli -t -f general -e </span><span class="token function" style="color:rgb(0, 0, 255)">yes</span><span class="token plain"> -m tab dev show eth0</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">GENERAL:eth0:ethernet:Intel Corporation:82567LM Gigabit Network Connection:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">e1000e:2.1.4-k:1.8-3:00</span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain">:22</span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain">:68</span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain">:15</span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain">:29</span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain">:21:1500:100 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">connected</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:0 </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">No reas</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">on given</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">:/sys/devices/pci0000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain">:00/0000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain">:00</span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain">:19.0/net/eth0:eth0:yes:yes:no:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ethernet-13:89cbcbc6-dc85-456c-9c8b-bd828fee3917:/org/freedesktop/NetworkMa</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">nager/ActiveConnection/9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Example 14. nmcli usage in a NetworkManager dispatcher script to make Ethernet and Wi-Fi mutually exclusive</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:rgb(129, 31, 63)">LC_ALL</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">C</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function-name function" style="color:rgb(0, 0, 255)">enable_disable_wifi</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token assign-left variable" style="color:rgb(9, 134, 88)">result</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token variable" style="color:rgb(9, 134, 88)">$(</span><span class="token variable" style="color:rgb(9, 134, 88)">nmcli dev </span><span class="token variable operator" style="color:rgb(0, 0, 0)">|</span><span class="token variable" style="color:rgb(9, 134, 88)"> </span><span class="token variable function" style="color:rgb(0, 0, 255)">grep</span><span class="token variable" style="color:rgb(9, 134, 88)"> </span><span class="token variable string" style="color:rgb(163, 21, 21)">&quot;ethernet&quot;</span><span class="token variable" style="color:rgb(9, 134, 88)"> </span><span class="token variable operator" style="color:rgb(0, 0, 0)">|</span><span class="token variable" style="color:rgb(9, 134, 88)"> </span><span class="token variable function" style="color:rgb(0, 0, 255)">grep</span><span class="token variable" style="color:rgb(9, 134, 88)"> -w </span><span class="token variable string" style="color:rgb(163, 21, 21)">&quot;connected&quot;</span><span class="token variable" style="color:rgb(9, 134, 88)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> -n </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string variable" style="color:rgb(9, 134, 88)">$result</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        nmcli radio wifi off</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        nmcli radio wifi on</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string variable" style="color:rgb(9, 134, 88)">$2</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;up&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    enable_disable_wifi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token string variable" style="color:rgb(9, 134, 88)">$2</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;down&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    enable_disable_wifi</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">This dispatcher script makes Wi-Fi mutually exclusive with wired networking. When a wired interface is connected, Wi-Fi will be </span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">set</span><span class="token plain"> to airplane mode </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rfkilled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">. When the wired interface is disconnected, Wi-Fi will be turned back on. Name this script e.g. </span><span class="token number" style="color:rgb(9, 134, 88)">70</span><span class="token plain">-wifi-wired-exclusive.sh and put it into /etc/NetworkManager/dispatcher.d/ directory. See NetworkManager</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> manual page </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">more</span><span class="token plain"> information about NetworkManager dispatcher scripts.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/linux-primary-12"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">第 12 章 Linux 定时任务</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/linux-primary-14"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">第 14 章 Linux 开机启动流程(UEFI+systemd)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#131linux-处理数据包过程" class="table-of-contents__link toc-highlight">13.1、Linux 处理数据包过程</a></li><li><a href="#132网络配置文件" class="table-of-contents__link toc-highlight">13.2、网络配置文件</a><ul><li><a href="#1321网卡配置文件" class="table-of-contents__link toc-highlight">13.2.1、网卡配置文件</a><ul><li><a href="#13211一致网络设备命名规范" class="table-of-contents__link toc-highlight">13.2.1.1、一致网络设备命名规范</a></li><li><a href="#13212系统默认命令规则" class="table-of-contents__link toc-highlight">13.2.1.2、系统默认命令规则</a></li><li><a href="#13213rename-流程" class="table-of-contents__link toc-highlight">13.2.1.3、rename 流程</a></li><li><a href="#13214用户自定义网卡名" class="table-of-contents__link toc-highlight">13.2.1.4、用户自定义网卡名</a></li></ul></li><li><a href="#1322dns-配置文件" class="table-of-contents__link toc-highlight">13.2.2、DNS 配置文件</a></li><li><a href="#1323服务端口定义文件" class="table-of-contents__link toc-highlight">13.2.3、服务端口定义文件</a></li></ul></li><li><a href="#133网络接口和主机名配置" class="table-of-contents__link toc-highlight">13.3、网络接口和主机名配置</a><ul><li><a href="#1331ifconfig-命令" class="table-of-contents__link toc-highlight">13.3.1、ifconfig 命令</a></li><li><a href="#1332hostname-命令" class="table-of-contents__link toc-highlight">13.3.2、hostname 命令</a></li></ul></li><li><a href="#134网关和路由" class="table-of-contents__link toc-highlight">13.4、网关和路由</a><ul><li><a href="#1341route-命令" class="table-of-contents__link toc-highlight">13.4.1、route 命令</a></li><li><a href="#1342配置永久路由" class="table-of-contents__link toc-highlight">13.4.2、配置永久路由</a></li></ul></li><li><a href="#135arp-和-arping-命令" class="table-of-contents__link toc-highlight">13.5、arp 和 arping 命令</a><ul><li><a href="#1351arp-命令" class="table-of-contents__link toc-highlight">13.5.1、arp 命令</a></li><li><a href="#1352arping-命令" class="table-of-contents__link toc-highlight">13.5.2、arping 命令</a></li></ul></li><li><a href="#136ip-命令" class="table-of-contents__link toc-highlight">13.6、ip 命令</a><ul><li><a href="#1361ip-命令帮助" class="table-of-contents__link toc-highlight">13.6.1、ip 命令帮助</a></li><li><a href="#1362ip-address-命令" class="table-of-contents__link toc-highlight">13.6.2、ip address 命令</a><ul><li><a href="#13621ip-address-adddel-子命令" class="table-of-contents__link toc-highlight">13.6.2.1、ip address add/del 子命令</a></li><li><a href="#13622ip-addr-show-子命令" class="table-of-contents__link toc-highlight">13.6.2.2、ip addr show 子命令</a></li><li><a href="#13623ip-addr-flush-子命令" class="table-of-contents__link toc-highlight">13.6.2.3、ip addr flush 子命令</a></li></ul></li><li><a href="#1363ip-route-命令" class="table-of-contents__link toc-highlight">13.6.3、ip route 命令</a><ul><li><a href="#13631ip-route-addreplacemore-子命令" class="table-of-contents__link toc-highlight">13.6.3.1、ip route add/replace/MORE 子命令</a></li><li><a href="#13632ip-route-show-子命令" class="table-of-contents__link toc-highlight">13.6.3.2、ip route show 子命令</a></li><li><a href="#13633ip-route-flush-子命令" class="table-of-contents__link toc-highlight">13.6.3.3、ip route flush 子命令</a></li><li><a href="#13634ip-route-saverestore-子命令" class="table-of-contents__link toc-highlight">13.6.3.4、ip route save/restore 子命令</a></li></ul></li><li><a href="#1364ip-link-命令" class="table-of-contents__link toc-highlight">13.6.4、ip link 命令</a><ul><li><a href="#13641ip-link-set-子命令" class="table-of-contents__link toc-highlight">13.6.4.1、ip link set 子命令</a></li><li><a href="#13642ip-link-show-子命令" class="table-of-contents__link toc-highlight">13.6.4.2、ip link show 子命令</a></li></ul></li></ul></li><li><a href="#137nmcli-命令" class="table-of-contents__link toc-highlight">13.7、nmcli 命令</a><ul><li><a href="#1371nmcli-general-命令" class="table-of-contents__link toc-highlight">13.7.1、nmcli general 命令</a><ul><li><a href="#13711status-子命令" class="table-of-contents__link toc-highlight">13.7.1.1、status 子命令</a></li><li><a href="#13712hostname-子命令" class="table-of-contents__link toc-highlight">13.7.1.2、hostname 子命令</a></li><li><a href="#13713permissions-子命令" class="table-of-contents__link toc-highlight">13.7.1.3、permissions 子命令</a></li><li><a href="#13714loggin-子命令" class="table-of-contents__link toc-highlight">13.7.1.4、loggin 子命令</a></li></ul></li><li><a href="#1372nmcli-networking-命令" class="table-of-contents__link toc-highlight">13.7.2、nmcli networking 命令</a></li><li><a href="#1373nmcli-radio-命令" class="table-of-contents__link toc-highlight">13.7.3、nmcli radio 命令</a></li><li><a href="#1374nmcli-monitor-命令" class="table-of-contents__link toc-highlight">13.7.4、nmcli monitor 命令</a></li><li><a href="#1375nmcli-connection-命令" class="table-of-contents__link toc-highlight">13.7.5、nmcli connection 命令</a><ul><li><a href="#13751show-子命令" class="table-of-contents__link toc-highlight">13.7.5.1、show 子命令</a></li><li><a href="#13752up-子命令" class="table-of-contents__link toc-highlight">13.7.5.2、up 子命令</a></li><li><a href="#13753down-子命令" class="table-of-contents__link toc-highlight">13.7.5.3、down 子命令</a></li><li><a href="#13754modify-子命令" class="table-of-contents__link toc-highlight">13.7.5.4、modify 子命令</a></li><li><a href="#13755add-子命令" class="table-of-contents__link toc-highlight">13.7.5.5、add 子命令</a></li><li><a href="#13756clone-子命令" class="table-of-contents__link toc-highlight">13.7.5.6、clone 子命令</a></li><li><a href="#13757delete-子命令" class="table-of-contents__link toc-highlight">13.7.5.7、delete 子命令</a></li><li><a href="#13758load-子命令" class="table-of-contents__link toc-highlight">13.7.5.8、load 子命令</a></li><li><a href="#13759monitor-子命令" class="table-of-contents__link toc-highlight">13.7.5.9、monitor 子命令</a></li><li><a href="#137510示例配置-ip-隧道" class="table-of-contents__link toc-highlight">13.7.5.10、示例：配置 IP 隧道</a></li></ul></li><li><a href="#1376nmcli-device-命令" class="table-of-contents__link toc-highlight">13.7.6、nmcli device 命令</a><ul><li><a href="#13761status-子命令" class="table-of-contents__link toc-highlight">13.7.6.1、status 子命令</a></li><li><a href="#13762show-子命令" class="table-of-contents__link toc-highlight">13.7.6.2、show 子命令</a></li><li><a href="#13763set-子命令" class="table-of-contents__link toc-highlight">13.7.6.3、set 子命令</a></li><li><a href="#13764connect-子命令" class="table-of-contents__link toc-highlight">13.7.6.4、connect 子命令</a></li><li><a href="#13765reapply-子命令" class="table-of-contents__link toc-highlight">13.7.6.5、reapply 子命令</a></li><li><a href="#13766modify-子命令" class="table-of-contents__link toc-highlight">13.7.6.6、modify 子命令</a></li><li><a href="#13767disconnect-子命令" class="table-of-contents__link toc-highlight">13.7.6.7、disconnect 子命令</a></li><li><a href="#13768delete-子命令" class="table-of-contents__link toc-highlight">13.7.6.8、delete 子命令</a></li><li><a href="#13769wifi-子命令" class="table-of-contents__link toc-highlight">13.7.6.9、wifi 子命令</a></li></ul></li><li><a href="#1377示例nmcli-examples" class="table-of-contents__link toc-highlight">13.7.7、示例(nmcli-examples)</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">学习</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tags">标签</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">归档</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/skill">技术笔记</a></li><li class="footer__item"><a class="footer__link-item" href="/project">实战项目</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/linux">Linux</a></li></ul></div><div class="col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">关于我</a></li><li class="footer__item"><a href="https://github.com/zqingfa" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/friends">友链</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/website">导航</a></li><li class="footer__item"><a href="https://docusaurus.io/zh-CN/" target="_blank"><img style="height:50px;margin-top:0.5rem" src="/img/buildwith.png"><a></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p><a href="http://beian.miit.gov.cn/">浙ICP备20024502号-1</a></p><p>Copyright © 2022 - PRESENT zhangqf Built with Docusaurus.</p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.839460ba.js"></script>
<script src="/assets/js/main.6b7778c5.js"></script>
</body>
</html>
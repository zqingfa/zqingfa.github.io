"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3707],{3905:function(e,t,a){a.d(t,{Zo:function(){return c},kt:function(){return m}});var n=a(67294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},p=Object.keys(e);for(n=0;n<p.length;n++)a=p[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(n=0;n<p.length;n++)a=p[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var i=n.createContext({}),s=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(i.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,p=e.originalType,i=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=s(a),m=l,u=d["".concat(i,".").concat(m)]||d[m]||h[m]||p;return a?n.createElement(u,r(r({ref:t},c),{},{components:a})):n.createElement(u,r({ref:t},c))}));function m(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var p=a.length,r=new Array(p);r[0]=d;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o.mdxType="string"==typeof e?e:l,r[1]=o;for(var s=2;s<p;s++)r[s]=a[s];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},69134:function(e,t,a){a.r(t),a.d(t,{assets:function(){return c},contentTitle:function(){return i},default:function(){return m},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return h}});var n=a(87462),l=a(63366),p=(a(67294),a(3905)),r=["components"],o={id:"linux-advanced-8",slug:"/linux-advanced-8",title:"\u7b2c 8 \u7ae0 Linux httpd \u670d\u52a1\u9ad8\u7ea7\u914d\u7f6e",authors:"zhangqf",keywords:["linux","httpd"]},i=void 0,s={unversionedId:"linux/advanced/linux-advanced-8",id:"linux/advanced/linux-advanced-8",title:"\u7b2c 8 \u7ae0 Linux httpd \u670d\u52a1\u9ad8\u7ea7\u914d\u7f6e",description:"\u672c\u6587\u4e3b\u8981\u9488\u5bf9 httpd \u5728 ARM64 \u67b6\u6784\u4e0b\u8fdb\u884c\u7f16\u8bd1\u914d\u7f6e\uff0c\u7136\u540e\u642d\u5efa\u4e00\u5957\u7ecf\u4e45\u4e0d\u8870\u7684 LAMP \u67b6\u6784\u73af\u5883\u3002",source:"@site/docs/linux/advanced/\u7b2c 8 \u7ae0 Linux httpd \u670d\u52a1\u9ad8\u7ea7\u914d\u7f6e.md",sourceDirName:"linux/advanced",slug:"/linux-advanced-8",permalink:"/docs/linux-advanced-8",draft:!1,tags:[],version:"current",frontMatter:{id:"linux-advanced-8",slug:"/linux-advanced-8",title:"\u7b2c 8 \u7ae0 Linux httpd \u670d\u52a1\u9ad8\u7ea7\u914d\u7f6e",authors:"zhangqf",keywords:["linux","httpd"]},sidebar:"linux",previous:{title:"\u7b2c 7 \u7ae0 Linux httpd \u670d\u52a1\u8fdb\u9636\u914d\u7f6e",permalink:"/docs/linux-advanced-7"},next:{title:"\u7b2c 9 \u7ae0 Linux Nginx \u670d\u52a1\u914d\u7f6e",permalink:"/docs/linux-advanced-9"}},c={},h=[{value:"6.1\u3001\u89e3\u51b3 httpd \u7f16\u8bd1\u4f9d\u8d56",id:"61\u89e3\u51b3-httpd-\u7f16\u8bd1\u4f9d\u8d56",level:2},{value:"6.2\u3001httpd \u7f16\u8bd1\u9009\u9879",id:"62httpd-\u7f16\u8bd1\u9009\u9879",level:2},{value:"6.3\u3001\u6a21\u5757\u52a8\u9759\u6001\u7f16\u8bd1",id:"63\u6a21\u5757\u52a8\u9759\u6001\u7f16\u8bd1",level:2},{value:"6.4\u3001\u52a8\u9759\u6001\u7f16\u8bd1\u7684\u4f18\u5148\u7ea7\u89c4\u5219",id:"64\u52a8\u9759\u6001\u7f16\u8bd1\u7684\u4f18\u5148\u7ea7\u89c4\u5219",level:2},{value:"6.5\u3001MPM \u7684\u5b89\u88c5",id:"65mpm-\u7684\u5b89\u88c5",level:2},{value:"6.6\u3001\u5173\u4e8e &quot;--enable-so&quot;",id:"66\u5173\u4e8e---enable-so",level:2},{value:"6.7\u3001\u5f00\u59cb\u7f16\u8bd1 httpd",id:"67\u5f00\u59cb\u7f16\u8bd1-httpd",level:2},{value:"6.8\u3001\u7f16\u8bd1\u540e\u7684\u89c4\u8303\u5316\u64cd\u4f5c",id:"68\u7f16\u8bd1\u540e\u7684\u89c4\u8303\u5316\u64cd\u4f5c",level:2},{value:"6.9\u3001\u642d\u5efa LAMP \u73af\u5883",id:"69\u642d\u5efa-lamp-\u73af\u5883",level:2},{value:"6.9.1\u3001\u7f16\u8bd1 httpd",id:"691\u7f16\u8bd1-httpd",level:3},{value:"6.9.2\u3001\u7f16\u8bd1 php",id:"692\u7f16\u8bd1-php",level:3},{value:"6.9.2.1\u3001php \u7f16\u8bd1\u9009\u9879\u8bf4\u660e",id:"6921php-\u7f16\u8bd1\u9009\u9879\u8bf4\u660e",level:4},{value:"6.9.2.2\u3001php \u7f16\u8bd1\u8fc7\u7a0b",id:"6922php-\u7f16\u8bd1\u8fc7\u7a0b",level:4},{value:"6.9.2.3\u3001\u914d\u7f6e httpd \u4f7f\u5176\u8f6c\u53d1\u52a8\u6001\u8bf7\u6c42\u7ed9 php-fpm",id:"6923\u914d\u7f6e-httpd-\u4f7f\u5176\u8f6c\u53d1\u52a8\u6001\u8bf7\u6c42\u7ed9-php-fpm",level:4},{value:"6.9.3\u3001\u4e3a php \u5b89\u88c5 xcache",id:"693\u4e3a-php-\u5b89\u88c5-xcache",level:3},{value:"6.9.4\u3001\u5b89\u88c5 MySQL(MariaDB)",id:"694\u5b89\u88c5-mysqlmariadb",level:3},{value:"6.9.5\u3001\u6d4b\u8bd5 LAMP\u2014\u2014\u642d\u5efa discuz \u8bba\u575b",id:"695\u6d4b\u8bd5-lamp\u642d\u5efa-discuz-\u8bba\u575b",level:3}],d={toc:h};function m(e){var t=e.components,o=(0,l.Z)(e,r);return(0,p.kt)("wrapper",(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,p.kt)("p",null,"\u672c\u6587\u4e3b\u8981\u9488\u5bf9 httpd \u5728 ARM64 \u67b6\u6784\u4e0b\u8fdb\u884c\u7f16\u8bd1\u914d\u7f6e\uff0c\u7136\u540e\u642d\u5efa\u4e00\u5957\u7ecf\u4e45\u4e0d\u8870\u7684 LAMP \u67b6\u6784\u73af\u5883\u3002"),(0,p.kt)("h2",{id:"61\u89e3\u51b3-httpd-\u7f16\u8bd1\u4f9d\u8d56"},"6.1\u3001\u89e3\u51b3 httpd \u7f16\u8bd1\u4f9d\u8d56"),(0,p.kt)("p",null,"\u672c\u6587\u4ee5 httpd 2.4.51 \u7248\u672c\u4e3a\u4f8b\u3002"),(0,p.kt)("p",null,"apache \u81ea\u5df1\u7684\u7ad9\u70b9\u63d0\u4f9b\u4e86\u57fa\u91d1\u4f1a\u4e0b\u6240\u6709\u7684(\u5305\u62ec\u6240\u6709\u7248\u672c)\u8d44\u6e90\uff0c\u5305\u62ec httpd\u3002"),(0,p.kt)("p",null,"\u5730\u5740\uff1a",(0,p.kt)("a",{parentName:"p",href:"https://dlcdn.apache.org/"},"https://dlcdn.apache.org/")),(0,p.kt)("p",null,"httpd \u4e0b\u8f7d\u5730\u5740\uff1a",(0,p.kt)("a",{parentName:"p",href:"https://dlcdn.apache.org/httpd/"},"https://dlcdn.apache.org/httpd/")),(0,p.kt)("p",null,"httpd \u540c\u6837\u4f7f\u7528 ",(0,p.kt)("inlineCode",{parentName:"p"},'"./configure"'),"\u3001",(0,p.kt)("inlineCode",{parentName:"p"},'"make && make install"')," \u7684\u7f16\u8bd1\u6d41\u7a0b\u7f16\u8bd1\u3002\u4f46\u662f\u5b83\u6709\u4e00\u4e9b\u4f9d\u8d56\u5305\u9700\u8981\u63d0\u524d\u88c5\u597d\u3002\u5b98\u65b9\u4e0a\u6307\u5b9a\u7684\u4f9d\u8d56\u73af\u5883\u6709\uff1aapr\u3001apr-util\u3001pcre\u3001pcre-devle\uff0c\u6b64\u5916\u8fd8\u9700\u8981 expat-devel \u5305\u3002\u5176\u4e2d pcre\u3001pcre-devel \u548c expat.devel \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 yum \u5b89\u88c5\uff0capr \u548c apr-util \u9700\u8981\u7f16\u8bd1\u5b89\u88c5\u3002"),(0,p.kt)("p",null,"apr \u548c apr-util \u4e0b\u8f7d\u5730\u5740\uff1a",(0,p.kt)("a",{parentName:"p",href:"https://apr.apache.org/"},"https://apr.apache.org/")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# yum install pcre pcre-devel expat-devel\n")),(0,p.kt)("p",null,"\u7f16\u8bd1 apr\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# tar -xf apr-1.7.0.tar.bz2 \n[root@arm64v8 ~]# cd apr-1.7.0/\n[root@arm64v8 apr-1.7.0]# ./configure --prefix=/usr/local/apr\n[root@arm64v8 apr-1.7.0]# make && make install\n")),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},(0,p.kt)("p",{parentName:"li"},"\u95ee\u98981\uff1a"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"rm: cannot remove 'libtoolT': No such file or directory\n")),(0,p.kt)("ul",{parentName:"li"},(0,p.kt)("li",{parentName:"ul"},"\u89e3\u51b3\u65b9\u6cd5\uff1a")),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 apr-1.7.0]# vim configure\n\u5c06 RM='$RM' \u6539\u6210 RM='$RM -f'\n")))),(0,p.kt)("p",null,"\u7f16\u8bd1 apr-util\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# tar xf apr-util-1.6.1.tar.bz2 \n[root@arm64v8 ~]# cd apr-util-1.6.1/\n[root@arm64v8 apr-util-1.6.1]# ./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr\n[root@arm64v8 apr-util-1.6.1]# make && make install\n")),(0,p.kt)("p",null,'\u7136\u540e\u662f\u7f16\u8bd1 httpd\uff0chttpd \u7f16\u8bd1\u5bf9\u521a\u63a5\u89e6\u7684\u4eba\u6765\u8bf4\u53ef\u80fd\u6709\u4e9b\u9ebb\u70e6\uff0c\u56e0\u4e3a\u7f16\u8bd1\u9009\u9879\u592a\u591a\uff0c\u5176\u4e2d\u7684\u4e00\u4e9b "\u6f5c\u89c4\u5219" \u4e5f\u4e0d\u592a\u719f\u6089\u3002\u6240\u4ee5\u4e0b\u9762\u8be6\u7ec6\u5730\u8bf4\u660e\u3002'),(0,p.kt)("h2",{id:"62httpd-\u7f16\u8bd1\u9009\u9879"},"6.2\u3001httpd \u7f16\u8bd1\u9009\u9879"),(0,p.kt)("p",null,"httpd \u7684\u7f16\u8bd1\u9009\u9879\u975e\u5e38\u591a\u3002\u4ee5\u4e0b\u662f\u622a\u53d6 ",(0,p.kt)("inlineCode",{parentName:"p"},"./configure -h"),' \u4e2d\u7684\u4e00\u90e8\u5206\uff0c\u4f7f\u7528 "......" \u8868\u793a\u7701\u7565\u4e86\u4e00\u5806\u4fe1\u606f\u3002'),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},'Configuration:\n  -h, --help              display this help and exit\n      --help=short        display options specific to this package\n      --help=recursive    display the short help of all the included packages\n  -V, --version           display version information and exit\n  -q, --quiet, --silent   do not print `checking ...\' messages\n      --cache-file=FILE   cache test results in FILE [disabled]\n  -C, --config-cache      alias for `--cache-file=config.cache\'\n  -n, --no-create         do not create output files\n      --srcdir=DIR        find the sources in DIR [configure dir or `..\']\n\nInstallation directories:\n  --prefix=PREFIX         install architecture-independent files in PREFIX\n                          [/usr/local/apache2]\n  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX\n                          [PREFIX]\n\nBy default, `make install\' will install all the files in\n`/usr/local/apache2/bin\', `/usr/local/apache2/lib\' etc.  You can specify\nan installation prefix other than `/usr/local/apache2\' using `--prefix\',\nfor instance `--prefix=$HOME\'.\n\nFor better control, use the options below.\n\nFine tuning of the installation directories:\n  --bindir=DIR            user executables [EPREFIX/bin]\n  --sbindir=DIR           system admin executables [EPREFIX/sbin]\n  --libexecdir=DIR        program executables [EPREFIX/libexec]\n  --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]\n  --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]\n  --localstatedir=DIR     modifiable single-machine data [PREFIX/var]\n  --libdir=DIR            object code libraries [EPREFIX/lib]\n........................................\n\nSystem types:\n  --build=BUILD     configure for building on BUILD [guessed]\n  --host=HOST       cross-compile to build programs to run on HOST [BUILD]\n  --target=TARGET   configure for building compilers for TARGET [HOST]\n\nOptional Features:\n  --disable-option-checking  ignore unrecognized --enable/--with options\n  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)\n  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]\n  --enable-layout=LAYOUT\n  --enable-dtrace         Enable DTrace probes\n  --enable-hook-probes    Enable APR hook probes\n  --enable-exception-hook Enable fatal exception hook\n  --enable-load-all-modules\n                          Load all modules\n  --enable-maintainer-mode\n                          Turn on debugging and compile time warnings and load\n                          all compiled modules\n  --enable-debugger-mode  Turn on debugging and compile time warnings and turn\n                          off optimization\n  --enable-pie            Build httpd as a Position Independent Executable\n  --enable-modules=MODULE-LIST\n                          Space-separated list of modules to enable | "all" |\n                          "most" | "few" | "none" | "reallyall"\n  --enable-mods-shared=MODULE-LIST\n                          Space-separated list of shared modules to enable |\n                          "all" | "most" | "few" | "reallyall"\n  --enable-mods-static=MODULE-LIST\n                          Space-separated list of static modules to enable |\n                          "all" | "most" | "few" | "reallyall"\n.........................................\n\nOptional Packages:\n  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]\n  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)\n  --with-included-apr     Use bundled copies of APR/APR-Util\n  --with-apr=PATH         prefix for installed APR or the full path to\n                             apr-config\n  --with-apr-util=PATH    prefix for installed APU or the full path to\n                             apu-config\n  --with-pcre=PATH        Use external PCRE library\n....................\n')),(0,p.kt)("p",null,"\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7f16\u8bd1\u914d\u7f6e\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/usr/local/apache --sysconfdir=/etc/apache --enable-so --enable-ssl --enable-cgi --enable-rewrite --enable-modules=most --enable-mpms-shared=all --with-z --with-pcre --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --with-mpm=event\n")),(0,p.kt)("p",null,"\u4f46\u8fd9\u4e2a\u914d\u7f6e\u4e2d\u6709\u4e9b\u9879\u662f\u591a\u4f59\u7684\uff0c\u4ee5\u4e0b\u662f\u7b49\u4ef7\u7f16\u8bd1\u914d\u7f6e\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/usr/local/apache --sysconfdir=/etc/apache --enable-mpms-shared=all --with-z --with-pcre --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --with-mpm=event\n")),(0,p.kt)("p",null,"\u4e3a\u4ec0\u4e48\u8bf4\u6709\u4e9b\u9879\u591a\u4f59\u5462\uff0c\u53ef\u4ee5\u7ee7\u7eed\u5f80\u4e0b\u770b\u3002"),(0,p.kt)("h2",{id:"63\u6a21\u5757\u52a8\u9759\u6001\u7f16\u8bd1"},"6.3\u3001\u6a21\u5757\u52a8\u9759\u6001\u7f16\u8bd1"),(0,p.kt)("p",null,"httpd \u662f\u9ad8\u5ea6\u6a21\u5757\u5316\u7684\u7a0b\u5e8f\uff0c\u5404\u4e2a\u529f\u80fd\u901a\u8fc7\u52a0\u8f7d\u5404\u4e2a\u6a21\u5757\u6765\u5b9e\u73b0\u3002\u4f46\u524d\u63d0\u662f\u5c06\u529f\u80fd\u5bf9\u5e94\u7684\u6a21\u5757\u5148\u7f16\u8bd1\u597d\uff0c\u4ee5\u4f9b httpd \u52a0\u8f7d\u3002"),(0,p.kt)("p",null,"httpd \u5bf9\u6a21\u5757\u6709\u4e24\u79cd\u7f16\u8bd1\u65b9\u5f0f\uff1a\u9759\u6001\u7f16\u8bd1\u548c\u52a8\u6001\u7f16\u8bd1\u3002"),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},"\u9759\u6001\u7f16\u8bd1\uff1a\u5c06\u6a21\u5757\u76f4\u63a5\u7f16\u8bd1\u8fdb httpd \u7684\u6838\u5fc3\u4e2d\u3002\u9759\u6001\u7f16\u8bd1\u7684\u6240\u6709\u6a21\u5757\u90fd\u4f1a\u968f\u7740 httpd \u7684\u542f\u52a8\u800c\u542f\u52a8\u3002"),(0,p.kt)("li",{parentName:"ul"},"\u52a8\u6001\u7f16\u8bd1\uff1a\u5c06\u6a21\u5757\u7f16\u8bd1\u597d\uff0c\u4f46\u4e0d\u7f16\u8bd1\u5230 httpd \u7684\u6838\u5fc3\u4e2d\u3002\u8981\u542f\u52a8\u52a8\u6001\u7f16\u8bd1\u7684\u6a21\u5757\uff0c\u9700\u8981\u5728 httpd \u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528 LoadModule \u6307\u4ee4\u52a0\u8f7d\u3002")),(0,p.kt)("p",null,"httpd \u7684\u4e00\u4e2a\u4f18\u70b9\u662f\u53ef\u4ee5\u5b9e\u73b0\u52a8\u6001\u6a21\u5757\u7684\u70ed\u63d2\u62d4\u3002\u56e0\u4e3a httpd \u662f\u72ec\u7acb\u4e8e\u7ec8\u7aef\u7684\u5b88\u62a4\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001 HUP \u4fe1\u53f7\u7ed9 httpd \u8ba9\u5176\u91cd\u8bfb\u914d\u7f6e\u6587\u4ef6\u3002"),(0,p.kt)("p",null,"\u800c\u662f\u5426\u52a0\u8f7d\u52a8\u6001\u7f16\u8bd1\u6a21\u5757\u6b63\u662f\u7531 httpd \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684 LoadModule \u6307\u4ee4\u51b3\u5b9a\u7684\u3002"),(0,p.kt)("p",null,"\u5f53\u60f3\u8981\u52a0\u8f7d\u67d0\u4e2a\u6a21\u5757 A \u65f6(\u5373\u6a21\u5757\u70ed\u63d2)\uff0c\u4f7f\u7528 LoadModule \u6307\u5b9a A \u6a21\u5757\u7684\u94fe\u63a5\u5730\u5740\uff0c\u518d\u53d1\u9001 HUP \u4fe1\u53f7\u91cd\u8bfb\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\u3002\u800c\u60f3\u8981\u505c\u6b62\u67d0\u4e2a\u6a21\u5757 A \u65f6(\u5373\u6a21\u5757\u70ed\u62d4)\uff0c\u53ea\u9700\u5c06\u5bf9\u5e94\u6a21\u5757\u7684 LoadModule \u6307\u4ee4\u884c\u7ed9\u6ce8\u91ca\uff0c\u518d\u91cd\u8bfb\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\u3002"),(0,p.kt)("p",null,"\u751a\u81f3\uff0c\u53ef\u4ee5\u968f\u65f6\u52a8\u6001\u7f16\u8bd1\u67d0\u4e2a\u5916\u90e8\u6a21\u5757\u5230 httpd \u4e2d\uff0c\u7136\u540e\u518d\u70ed\u63d2\u3002\u56e0\u4e3a\u4f55\u65f6\u7f16\u8bd1\u9700\u8981\u52a8\u6001\u52a0\u8f7d\u7684\u6a21\u5757\u5bf9 httpd \u6765\u8bf4\u662f\u65e0\u5173\u7d27\u8981\u7684\uff0c\u5b83\u53ea\u9700 LoadModule \u548c\u91cd\u8bfb\u914d\u7f6e\u6587\u4ef6\u4e24\u4e2a\u8fc7\u7a0b\u5bf9\u6a21\u5757\u8fdb\u884c\u63a7\u5236\u3002"),(0,p.kt)("p",null,"\u5728\u7f16\u8bd1\u9009\u9879\u4e2d\uff0c\u6709\u51e0\u79cd\u7c7b\u578b\u7684\u9009\u9879\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"--disable-FEATURE:              \u7981\u7528\u67d0\u7279\u6027\uff0c\u7b49\u4ef7\u4e8e--enable-FEATURE=no\n--enable-FEATURE[=ARG]:         \u542f\u7528\u67d0\u7279\u6027\uff0c\u9ed8\u8ba4\u53c2\u6570\u503c\u4e3aYES\n--enable-Module_Name=shared:    \u6307\u5b9a\u7684\u6a21\u5757Module_Name\u4ee5\u52a8\u6001\u7f16\u8bd1\u65b9\u5f0f\u5b89\u88c5\n--enable-Module_Name=static:    \u6307\u5b9a\u7684\u6a21\u5757Module_Name\u4ee5\u9759\u6001\u7f16\u8bd1\u65b9\u5f0f\u5b89\u88c5\n")),(0,p.kt)("p",null,"\u5bf9\u4e8e ",(0,p.kt)("inlineCode",{parentName:"p"},"./configure --help")," \u4e2d\u7ed9\u5b9a\u7684\u9009\u9879\uff0c\u5982\u679c\u8be5\u9009\u9879\u662f --disable \u7684\uff0c\u90a3\u4e48\u8868\u793a\u8be5\u9009\u9879\u9ed8\u8ba4\u662f\u542f\u7528\u7684\uff0c\u9700\u8981\u663e\u5f0f\u4f7f\u7528 --disable \u9009\u9879\u7981\u7528\uff1b\u5982\u679c\u8be5\u9009\u9879\u662f --enable \u7684\uff0c\u90a3\u4e48\u8868\u793a\u8be5\u9009\u9879\u9ed8\u8ba4\u662f\u7981\u7528\u7684\uff0c\u9700\u8981\u4f7f\u7528 --enable \u9009\u9879\u6765\u542f\u7528\u3002\u4f8b\u5982\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"--disable-authz-user    :\u8868\u793aauthz-user\u7279\u6027\u9ed8\u8ba4\u542f\u7528\uff0c\u7f16\u8bd1\u65f6\u65e0\u9700\u6307\u5b9a\u8be5\u9879\u3002\u5982\u679c\u8981\u7981\u7528\uff0c\u7f16\u8bd1\u65f6\u9700\u663e\u5f0f\u6307\u5b9a--disable-authz-user\n--enable-echo           :\u8868\u793aecho\u7279\u6027\u9ed8\u8ba4\u662f\u7981\u7528\u7684\uff0c\u5982\u679c\u8981\u542f\u7528\uff0c\u5219\u7f16\u8bd1\u65f6\u9700\u663e\u5f0f\u6307\u5b9a--enable-echo\n")),(0,p.kt)("p",null,'\u6a21\u5757\u540d\u7684\u4e66\u5199\u662f\u6709\u89c4\u5219\u7684\uff0c\u4e00\u822c\u6a21\u5757\u7684\u5168\u79f0\u7c7b\u4f3c\u4e8e "mod',"_",'BASENAME.so" \u683c\u5f0f\uff0c\u4f8b\u5982 "mod',"_","charset","_",'lite.so"\uff0c\u4f46\u5728\u7f16\u8bd1\u9009\u9879\u4e2d\u6307\u5b9a\u6a21\u5757\u65f6\uff0c\u53ea\u9700\u6307\u5b9a BASENAME\uff0c\u4e14\u5982\u679c basename \u4e2d\u5305\u542b\u4e0b\u5212\u7ebf\u65f6\uff0c\u9700\u8981\u8f6c\u6362\u4e3a\u77ed\u6a2a\u7ebf\u3002\u4f8b\u5982 "--enable-echo" \u8868\u793a\u7f16\u8bd1\u7684\u6a21\u5757\u662f "mod',"_",'echo.so"\u3002'),(0,p.kt)("p",null,"\u6b64\u5916\uff0c\u8fd8\u652f\u6301 3 \u79cd\u5217\u8868\u65b9\u5f0f\u7684\u52a8\u9759\u6001\u7f16\u8bd1\u9009\u9879\uff1a\u5217\u8868\u9879\u4e4b\u95f4\u4f7f\u7528\u7a7a\u683c\u5206\u9694\uff0c\u4f46\u8981\u4f7f\u7528\u5355\u5f15\u53f7\u5305\u56f4\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"--enable-modules='Module_Name1 Moduel_Name2'\n--enable-mods-shared='Module_Name1 Module_Name2'\n--enable-mods-statics='Module_Name1 Module_Name2'\n")),(0,p.kt)("p",null,'\u5217\u8868\u90e8\u5206\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5173\u952e\u5b57 "all/few/most/reallyall"\u3002\u5206\u522b\u8868\u793a\u7f16\u8bd1\u6240\u6709\u3001\u5c11\u91cf\u3001\u5927\u591a\u6570\u3001\u771f\u6b63\u7684\u6240\u6709\u6a21\u5757\u3002'),(0,p.kt)("p",null,'"--enable-modules" \u57fa\u672c\u7b49\u4ef7\u4e8e "--enable-mods-shared"\uff0c\u90fd\u662f\u52a8\u6001\u7f16\u8bd1\u7ed9\u5b9a\u5217\u8868\u4e2d\u7684\u6a21\u5757\uff0c\u4f46 "--enable-modules" \u53ef\u4ee5\u989d\u5916\u4f7f\u7528\u4e00\u4e2a\u5173\u952e\u5b57 "none"\uff0c\u8868\u793a\u4e0d\u7f16\u8bd1\u6240\u6709\u6a21\u5757\u3002'),(0,p.kt)("h2",{id:"64\u52a8\u9759\u6001\u7f16\u8bd1\u7684\u4f18\u5148\u7ea7\u89c4\u5219"},"6.4\u3001\u52a8\u9759\u6001\u7f16\u8bd1\u7684\u4f18\u5148\u7ea7\u89c4\u5219"),(0,p.kt)("p",null,"httpd \u52a8\u9759\u6001\u6a21\u5757\u7f16\u8bd1\u6709\u4e00\u5957\u89c4\u5219\uff0c\u5404\u79cd\u52a8\u9759\u6001\u7f16\u8bd1\u9009\u9879\u4e4b\u95f4\u6709\u4f18\u5148\u7ea7\u7684\u5b58\u5728\u3002\u4f8b\u5982\uff0c\u67d0\u4e2a\u975e\u6838\u5fc3\u6a21\u5757\u65e2\u6307\u5b9a\u4e86\u52a8\u6001\u7f16\u8bd1\uff0c\u540c\u65f6\u53c8\u6307\u5b9a\u4e86\u9759\u6001\u7f16\u8bd1\uff0c\u90a3\u5230\u5e95\u662f\u9759\u6001\u8fd8\u662f\u52a8\u6001\u7f16\u8bd1\uff1f"),(0,p.kt)("p",null,"\u53ef\u4ee5\u53c2\u7167\u4ee5\u4e0b\u4f18\u5148\u7ea7\u89c4\u5219\uff1a"),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},'\u4e0d\u6307\u5b9a\u4efb\u4f55\u6a21\u5757\u7f16\u8bd1\u9009\u9879\u65f6\uff0c\u9ed8\u8ba4\u7684\u9009\u9879\u4e3a "--enable-mods-shared"\uff0c\u800c\u8be5\u9009\u9879\u7684\u9ed8\u8ba4\u503c\u53c8\u662f most\uff0c\u6240\u4ee5\u7b49\u4ef7\u4e8e "--enable-mods-shared=most"\u3002')),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u663e\u5f0f\u6307\u5b9a\u8981\u52a8\u6001\u6216\u9759\u6001\u7f16\u8bd1\u7684\u4f18\u5148\u7ea7\u6700\u9ad8\u3002\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u663e\u5f0f\u6307\u5b9a\uff1a"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"--enable-Module_Name=shared \n--enable-Module_Name=static \n--enable-mods-shared='Module_Name1 Module_Name2'\n--enable-mods-statics='Module_Name1 Module_Name2'\n--enable-modules='Module_Name1 Moduel_Name2'\n")),(0,p.kt)("p",{parentName:"li"},"\u5982\u679c\u67d0\u4e2a\u6a21\u5757\u65e2\u663e\u5f0f\u6307\u5b9a\u4e86\u52a8\u6001\uff0c\u53c8\u663e\u5f0f\u6307\u5b9a\u4e86\u9759\u6001\u7f16\u8bd1\uff0c\u5219\u9759\u6001\u7f16\u8bd1\u4f18\u5148\u7ea7\u66f4\u9ad8\u3002\u4f8b\u5982\uff1a"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"--enable-echo=shared\n--enable-echo=static\n")),(0,p.kt)("p",{parentName:"li"},"\u90a3\u4e48\uff0cmod","_","echo \u6a21\u5757\u5c06\u88ab\u9759\u6001\u7f16\u8bd1\u3002")),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},'\u6307\u5b9a\u4e86\u5173\u952e\u5b57(all/most/few/reallyall)\u7684 "--enable-mods-static" \u9009\u9879\uff0c\u4f18\u5148\u7ea7\u9ad8\u4e8e\u6307\u5b9a\u6216\u672a\u6307\u5b9a\u5173\u952e\u5b57\u7684 "--enable-mods-shared" \u548c "--enable-modules" \u9009\u9879\uff0c\u5373\u9759\u6001\u5173\u952e\u5b57\u89c4\u5219\u5f3a\u4e8e\u52a8\u6001\u5173\u952e\u5b57\u89c4\u5219\u3002'),(0,p.kt)("p",{parentName:"li"},'\u4f8b\u5982\uff0c\u4e0b\u9762\u4e24\u4e2a\u7f16\u8bd1\u914d\u7f6e\u4e2d\uff0c\u90fd\u662f "--enable-mods-static=few" \u751f\u6548\u3002\u7b2c\u4e8c\u4e2a\u7f16\u8bd1\u914d\u7f6e\u8bed\u53e5\u4e2d\u5c06\u5ffd\u7565 "--enable-mods-shared=all"\u3002'),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/tmp/apache --enable-mods-static=few\n./configure --prefix=/tmp/apache --enable-mods-static=few --enable-mods-shared=all\n")),(0,p.kt)("p",{parentName:"li"},'\u5bf9\u4e8e\u4e0b\u9762\u7684\u4f8b\u5b50\uff0cauthn-file \u548c echo \u8fd9\u4e24\u4e2a\u6a21\u5757\u65e2\u6307\u5b9a\u4e86\u52a8\u6001\u7f16\u8bd1\u53c8\u6307\u5b9a\u4e86\u9759\u6001\u7f16\u8bd1\uff0c\u9759\u6001\u4f18\u5148\u7ea7\u9ad8\u4e8e\u52a8\u6001\uff0c\u6240\u4ee5\u8fd9\u4e24\u4e2a\u6a21\u5757\u88ab\u9759\u6001\u7f16\u8bd1\u3002\u7531\u4e8e\u6ca1\u6709\u4f7f\u7528\u5173\u952e\u5b57\uff0c\u6240\u4ee5\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u7684 "--enable-mods-shared=most" \u914d\u7f6e\u3002\u5373\u52a8\u6001\u7f16\u8bd1\u5927\u90e8\u5206\uff0c\u4f46\u6307\u5b9a\u7684\u8fd9\u4e24\u4e2a\u6a21\u5757\u88ab\u9759\u6001\u7f16\u8bd1\u3002'),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/tmp/apache \\\n--enable-mods-static='authn-file echo' --enable-mods-shared='authn-file echo'\n")),(0,p.kt)("p",{parentName:"li"},'\u800c\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u7531\u4e8e\u989d\u5916\u6307\u5b9a\u4e86\u4f7f\u7528 "--enable-mods-static=few" \u9009\u9879\uff0c\u5176\u4f18\u5148\u7ea7\u9ad8\u4e8e\u9ed8\u8ba4\u7684 "--enable-mods-shared=most"\uff0c\u6240\u4ee5\u7ed3\u679c\u662f\u9759\u6001\u7f16\u8bd1 few\uff0c\u4e14\u663e\u5f0f\u6307\u5b9a\u7684\u4e24\u4e2a\u6a21\u5757\u4e5f\u88ab\u9759\u6001\u7f16\u8bd1\u3002'),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/tmp/apache \\\n--enable-mods-static='authn-file echo' \\\n--enable-mods-shared='authn-file echo' \\\n--enable-mods-static=few\n"))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},'\u4f7f\u7528\u4e86\u5173\u952e\u5b57\u7684 "--enable-mods-static"\u3001"--enable-mods-shared " \u548c "--enable-modules" \u7684\u9009\u9879\uff0c\u9690\u542b\u4e86 "\u6ca1\u6709\u6307\u5b9a\u4f55\u79cd\u7f16\u8bd1\u65b9\u5f0f\u7684\u6a21\u5757" \u7684\u9ed8\u8ba4\u7f16\u8bd1\u65b9\u5f0f\u3002'),(0,p.kt)("p",{parentName:"li"},'\u4f8b\u5982\u4e0b\u9762\u7684\u7f16\u8bd1\u914d\u7f6e\uff0c"--enable-mods-static" \u6307\u5b9a\u4e86\u5173\u952e\u5b57 few\uff0c\u5b83\u5c06\u4f18\u5148\u4e8e\u9ed8\u8ba4\u7684\u914d\u7f6e\u89c4\u5219 "--enable-mods-shared=most"\uff0c\u6240\u4ee5\u6ca1\u6709\u6307\u5b9a\u7f16\u8bd1\u65b9\u5f0f\u7684\u6a21\u5757 "data" \u5c06\u4ee5\u9759\u6001\u7684\u65b9\u5f0f\u7f16\u8bd1\u3002'),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/tmp/apache --enable-mods-static=few --enable-data\n")),(0,p.kt)("p",{parentName:"li"},'\u4e0b\u9762\u7684\u914d\u7f6e\u5982\u4f55\u7f16\u8bd1\u7684\uff1f\u7531\u4e8e\u9ed8\u8ba4\u7684\u662f "--enable-mods-shared=most" \u7f16\u8bd1\u65b9\u5f0f\uff0c\u6240\u4ee5\u6a21\u5757 "data" \u5c06\u4ee5\u52a8\u6001\u7684\u65b9\u5f0f\u7f16\u8bd1\u3002'),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/tmp/apache --enable-data\n")),(0,p.kt)("p",{parentName:"li"},'\u518d\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff0c\u914d\u7f6e\u4e2d\u51fa\u73b0\u4e86 "--enable-mods-static=few" \u548c "--enable-mods-shared"(\u672a\u7ed9\u5b9a\u503c\u65f6\u4e5f\u662f\u9ed8\u8ba4\u4e3a most)\uff0cstatic \u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e shared\uff0c\u6240\u4ee5\u6ca1\u6709\u6307\u5b9a\u7f16\u8bd1\u65b9\u5f0f\u7684\u6a21\u5757 "data" \u4f7f\u7528\u9759\u6001\u7f16\u8bd1\u65b9\u5f0f\u7f16\u8bd1\uff0c\u800c\u663e\u5f0f\u6307\u5b9a\u4e86\u7f16\u8bd1\u65b9\u5f0f\u7684\u6a21\u5757 "echo" \u5176\u4f18\u5148\u7ea7\u6700\u5f3a\uff0c\u6240\u4ee5\u52a8\u6001\u7f16\u8bd1 "echo"\u3002'),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/tmp/apache \\\n--enable-mods-static=few --enable-mods-shared --enable-data --enable-echo=shared\n")))),(0,p.kt)("h2",{id:"65mpm-\u7684\u5b89\u88c5"},"6.5\u3001MPM \u7684\u5b89\u88c5"),(0,p.kt)("p",null,"\u7f16\u8bd1 mpm \u6a21\u5757(prefork/worker/event)\u548c\u5176\u4ed6\u6a21\u5757\u5dee\u4e0d\u591a\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\u5fc5\u987b\u81f3\u5c11\u7f16\u8bd1\u4e00\u4e2a mpm \u6a21\u5757\uff0c\u4e14\u5fc5\u987b\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u88ab httpd \u52a0\u8f7d\u3002"),(0,p.kt)("p",null,'\u7f16\u8bd1\u5b89\u88c5\u65f6\u9ed8\u8ba4\u7684 mpm \u662f event \u6a21\u5f0f(\u548c\u53d1\u884c\u7248\u6709\u5173)\u3002\u4f46\u53ef\u4ee5\u901a\u8fc7 "--with-mpm=MPM',"_",'NAME" \u6765\u6307\u5b9a\u88ab\u52a0\u8f7d\u7684 mpm \u6a21\u5757\u3002\u4ee5\u4e0b\u662f\u51e0\u4e2a\u76f8\u5173\u7f16\u8bd1\u9009\u9879\uff1a'),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"--with-mpm=MPM_Name\uff1a            \u7528\u4e8e\u6307\u5b9a\u9ed8\u8ba4\u7684mpm\u6a21\u5757\uff0c\u5b83\u6240\u6307\u5b9a\u7684\u6a21\u5757\u4f1a\u88ab\u9759\u6001\u7f16\u8bd1\uff0c\u5e76\u5728httpd\u542f\u52a8\u65f6\u52a0\u8f7d\u3002\n--enable-mpms-shared=MPM-LIST\uff1a  \u6307\u5b9a\u52a8\u6001\u7f16\u8bd1\u5b89\u88c5\u7684MPM\u5217\u8868\uff0c\u52a8\u6001\u7f16\u8bd1\u7684MPM\u5fc5\u987b\u4f7f\u7528LoadModule\u6307\u4ee4\u52a0\u8f7d\u624d\u80fd\u4f7f\u7528\u3002\n")),(0,p.kt)("p",null,'\u5982\u679c\u5b9a "--with-mpm" \u9009\u9879\u6307\u5b9a\u4e86\u67d0\u4e2a mpm\uff0c\u5219\u9ed8\u8ba4\u8be5\u6a21\u5757\u88ab\u9759\u6001\u7f16\u8bd1\uff0c\u4f46\u5982\u679c\u540c\u65f6\u4f7f\u7528 "--enable-mpms-shared" \u6307\u5b9a\u4e86\u8be5 mpm\uff0c\u5219\u8be5 mpm \u6a21\u5757\u88ab\u52a8\u6001\u7f16\u8bd1\u3002'),(0,p.kt)("p",null,"\u5982\u679c\u67d0\u4e2a mpm \u6a21\u5757\u88ab\u9759\u6001\u7f16\u8bd1\uff0c\u5728 httpd \u542f\u52a8\u65f6\u4f1a\u52a0\u8f7d\u5b83\uff0c\u5982\u679c\u60f3\u8981\u5207\u6362\u5230\u5176\u4ed6 mpm \u6a21\u5757\uff0c\u53ea\u6709\u4e00\u79cd\u65b9\u6cd5\uff1a\u91cd\u65b0\u7f16\u8bd1 httpd\u3002"),(0,p.kt)("p",null,'\u800c\u52a8\u6001\u7f16\u8bd1 mpm \u6a21\u5757\u65f6\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7 LoadModule \u6765\u5207\u6362\u5230\u5176\u4ed6 mpm \u6a21\u5757\u3002\u7531\u4e8e\u7f16\u8bd1\u65f6\u81ea\u5e26\u9ed8\u8ba4 mpm \u6a21\u5757\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528 "--with-mpm" \u6307\u5b9a\u9ed8\u8ba4 mpm \u6a21\u5757\uff0c\u6240\u4ee5\u52a8\u6001\u7f16\u8bd1 mpm \u6a21\u5757\u65e0\u7591\u6bd4\u9759\u6001\u7f16\u8bd1\u8981\u597d\u3002'),(0,p.kt)("p",null,'"--enable-mpms-shared" \u53ef\u4ee5\u6307\u5b9a\u52a8\u6001\u7f16\u8bd1\u7684 mpm \u5217\u8868\uff0c\u4f7f\u7528\u7a7a\u683c\u5206\u9694\uff0c\u4f46\u9700\u8981\u4f7f\u7528\u5355\u5f15\u53f7\u5305\u56f4\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5173\u952e\u5b57 "all" \u8868\u793a\u52a8\u6001\u7f16\u8bd1\u6240\u6709 mpm \u6a21\u5757\u3002 \u4f8b\u5982\uff1a'),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"--enable-mpms-shared='prefork worker'\n--enable-mpms-shared=all\n")),(0,p.kt)("h2",{id:"66\u5173\u4e8e---enable-so"},'6.6\u3001\u5173\u4e8e "--enable-so"'),(0,p.kt)("p",null,"\u4e00\u4e2a\u6a21\u5757\u88ab\u52a8\u6001\u7f16\u8bd1\uff0c\u5728\u9700\u8981\u52a0\u8f7d\u7684\u65f6\u5019\u4f7f\u7528 LoadModule \u6307\u4ee4\u6307\u5b9a\u8be5\u6a21\u5757\uff0c\u5e76\u91cd\u8bfb\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\u3002\u4f46 httpd \u4e3a\u4ec0\u4e48\u80fd\u52a0\u8f7d\u8be5\u52a8\u6001\u6a21\u5757\uff1f\u8fd9\u5c31\u662f mod","_","so \u7684\u80fd\u529b\u3002\u5b9e\u9645\u4e0a\uff0cLoadModule \u548c LoadFile \u6307\u4ee4\u5c31\u662f\u8be5\u6a21\u5757\u63d0\u4f9b\u7684\u3002"),(0,p.kt)("p",null,'\u8be5\u9009\u9879\u4f7f\u5f97 httpd \u6709\u52a0\u8f7d\u67d0\u52a8\u6001\u6a21\u5757\u7684\u80fd\u529b(DSO,Dynamic Shared Object)\uff0c\u4e5f\u56e0\u6b64\u5b83\u53ea\u80fd\u4f7f\u7528\u9759\u6001\u7f16\u8bd1\u65b9\u5f0f\u968f httpd \u542f\u52a8\u88ab\u52a0\u8f7d\u3002\u53ea\u8981\u4e0d\u663e\u5f0f\u6307\u5b9a "--enable-so=shared" \u6216\u8005\u5c06\u5176\u52a0\u5165\u663e\u5f0f\u7f16\u8bd1\u5217\u8868\uff0c\u5b83\u90fd\u4f1a\u9ed8\u8ba4\u4ee5\u9759\u6001\u65b9\u5f0f\u7f16\u8bd1\u3002\u5b9e\u9645\u4e0a\uff0c\u53ea\u8981\u663e\u5f0f\u6307\u5b9a\u4e86\u52a8\u6001\u65b9\u5f0f\u7f16\u8bd1\u8be5\u9009\u9879\uff0c\u7f16\u8bd1\u65f6\u4f1a\u62a5\u9519\u3002'),(0,p.kt)("h2",{id:"67\u5f00\u59cb\u7f16\u8bd1-httpd"},"6.7\u3001\u5f00\u59cb\u7f16\u8bd1 httpd"),(0,p.kt)("p",null,"\u81f3\u6b64\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u7f16\u8bd1 httpd \u4e86\u3002\u8fc7\u7a0b\u5982\u4e0b\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# tar xf httpd-2.4.51.tar.bz2 \n[root@arm64v8 ~]# cd httpd-2.4.51/\n[root@arm64v8 httpd-2.4.51]# ./configure --prefix=/usr/local/apache --sysconfdir=/etc/apache --with-z --with-pcre --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --with-mpm=event --enable-mpms-shared=all\n[root@arm64v8 httpd-2.4.51]# make && make install\n")),(0,p.kt)("p",null,"\u5176\u4e2d\u5b89\u88c5\u8def\u5f84\u4e3a /usr/local/apache\uff0c\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u4e3a /etc/apache\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# ls /usr/local/apache/\nbin  build  cgi-bin  error  htdocs  icons  include  logs  man  manual  modules\n[root@arm64v8 ~]#\n")),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},"bin \u76ee\u5f55\u4e3a\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u5b58\u653e\u4f4d\u7f6e\uff0c\u5982\u542f\u52a8\u811a\u672capachectl\u3001httpd\u3001htpasswd\u3001ab\uff08\u538b\u529b\u6d4b\u8bd5\u5de5\u5177\uff09\u7b49\uff1b"),(0,p.kt)("li",{parentName:"ul"},"htdocs \u76ee\u5f55\u5b58\u653e\u7f51\u9875\u6587\u4ef6\uff0c\u9ed8\u8ba4\u91cc\u9762\u6709 index.html\uff1blogs \u76ee\u5f55\u5b58\u653e\u4e86\u65e5\u5fd7\u6587\u4ef6\uff0c\u9664\u4e86\u65e5\u5fd7\u6587\u4ef6\uff0c\u9ed8\u8ba4\u8fd8\u6709 httpd \u8fd0\u884c\u7684 pid \u6587\u4ef6 httpd.pid\uff0c\u8fd9\u4e2a\u5efa\u8bae\u4fee\u6539\u5230 /var/run \u76ee\u5f55\u4e0b(\u65b9\u4fbf\u5224\u65ad)\uff1bmodules \u5b58\u653e\u4e86\u7f16\u8bd1\u540e\u7684\u6a21\u5757\uff1b"),(0,p.kt)("li",{parentName:"ul"},"man \u76ee\u5f55\u4e3a\u5e2e\u52a9\u6587\u6863\u8def\u5f84\u3002")),(0,p.kt)("p",null,"\u4f7f\u7528 httpd \u7684\u542f\u52a8\u811a\u672c bin/apahcectl \u542f\u52a8 httpd\uff0c\u7136\u540e\u6d4b\u8bd5\u5176\u662f\u5426\u6b63\u5e38\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cd /usr/local/apache/\n[root@arm64v8 apache]# bin/apachectl start\n[root@arm64v8 apache]# netstat -tnlp | grep httpd\ntcp6       0      0 :::80                   :::*                    LISTEN      3996/httpd        \n[root@arm64v8 apache]#\n")),(0,p.kt)("p",null,"\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165 IP \u5730\u5740\u5373\u53ef\u8bbf\u95ee\u3002"),(0,p.kt)("h2",{id:"68\u7f16\u8bd1\u540e\u7684\u89c4\u8303\u5316\u64cd\u4f5c"},"6.8\u3001\u7f16\u8bd1\u540e\u7684\u89c4\u8303\u5316\u64cd\u4f5c"),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u8bbe\u7f6e man \u8def\u5f84\u3002"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},'echo "MANPATH /usr/local/apache/man" >>/etc/man.config\n'))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u8bbe\u7f6e PATH \u73af\u5883\u53d8\u91cf\u3002"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"echo 'PATH=/usr/local/apache/bin:$PATH' >/etc/profile.d/apache.sh\nsource /etc/profile.d/apache.sh\n"))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u8f93\u51fa\u5934\u6587\u4ef6\u3002"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"ln -s /usr/include /usr/local/apache/include\n"))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u63d0\u4f9b\u670d\u52a1\u542f\u52a8\u811a\u672c\u3002"))),(0,p.kt)("p",null,"\u63d0\u4f9b\u4e0d\u63d0\u4f9b\u6ca1\u591a\u5927\u6240\u8c13\uff0c\u56e0\u4e3a apachectl \u6216 httpd \u547d\u4ee4\u81ea\u8eab\u53ef\u4ee5\u7ba1\u7406\u8fdb\u7a0b\u7684\u542f\u505c\uff0c\u4f46\u81ea\u8eab\u7ba1\u7406\u542f\u505c\u65f6\u4e0d\u63d0\u4f9b lock \u6587\u4ef6\u3002"),(0,p.kt)("p",null,"\u5982\u679c\u8981\u63d0\u4f9b\u7684\u8bdd\uff0c\u4ece yum \u5b89\u88c5\u7684 httpd \u63d0\u4f9b\u7684 /usr/lib/systemd/system/httpd.service(systemd) \u6216 /etc/init.d/httpd(sysV) \u62f7\u8d1d\u540e\u7a0d\u4f5c\u4fee\u6539\u5c31\u53ef\u4ee5\u4e86\u3002"),(0,p.kt)("p",null,"\u4ee5\u4e0b\u662f\u6839\u636e\u6211\u5f53\u524d\u7684\u7f16\u8bd1\u73af\u5883\u63d0\u4f9b\u7684 httpd sysV \u670d\u52a1\u7ba1\u7406\u811a\u672c /etc/rc.d/init.d/httpd\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\n#\n# httpd        Startup script for the Apache HTTP Server\n#\n# chkconfig: - 85 15\n# description: The Apache HTTP Server is an efficient and extensible  \\\n#           server implementing the current HTTP standards.\n#\n######################################################################\n#  \u82e5httpd\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u4e86PidFile\uff0c\u5219\u4fee\u6539\u6b64\u811a\u672c\u4e2d\u7684pidfile\u53d8\u91cf            #\n######################################################################\n\n. /etc/rc.d/init.d/functions\n\nif [ -f /etc/sysconfig/httpd ]; then\n        . /etc/sysconfig/httpd\nfi\n\n# Start httpd in the C locale by default.\nHTTPD_LANG=${HTTPD_LANG-"C"}\n\n# This will prevent initlog from swallowing up a pass-phrase prompt if\n# mod_ssl needs a pass-phrase from the user.\nINITLOG_ARGS=""\n\n# Set HTTPD=/usr/sbin/httpd.worker in /etc/sysconfig/httpd to use a server\n# with the thread-based "worker" MPM; BE WARNED that some modules may not\n# work correctly with a thread-based MPM; notably PHP will refuse to start.\n\n# Path to the apachectl script, server binary, and short-form for messages.\napachectl=/usr/local/apache/bin/apachectl\nhttpd=/usr/local/apache/bin/apachectl\nprog=httpd\npidfile=/usr/local/apache/logs/httpd.pid\nlockfile=/var/lock/subsys/httpd\nRETVAL=0\nSTOP_TIMEOUT=${STOP_TIMEOUT-10}\nconfig=/etc/apache/httpd.conf\n\n# The semantics of these two functions differ from the way apachectl does\n# things -- attempting to start while running is a failure, and shutdown\n# when not running is also a failure.  So we just do it the way init scripts\n# are expected to behave here.\nstart() {\n        echo -n $"Starting $prog: "\n        LANG=$HTTPD_LANG daemon --pidfile=${pidfile} $httpd -f $config $OPTIONS\n        RETVAL=$?\n        echo\n        [ $RETVAL = 0 ] && touch ${lockfile}\n        return $RETVAL\n}\n\n# When stopping httpd, a delay (of default 10 second) is required\n# before SIGKILLing the httpd parent; this gives enough time for the\n# httpd parent to SIGKILL any errant children.\nstop() {\n    status -p ${pidfile} $httpd > /dev/null\n    if [[ $? = 0 ]]; then\n        echo -n $"Stopping $prog: "\n        killproc -p ${pidfile} -d ${STOP_TIMEOUT} $httpd\n    else\n        echo -n $"Stopping $prog: "\n        success\n    fi\n    RETVAL=$?\n    echo\n    [ $RETVAL = 0 ] && rm -f ${lockfile} ${pidfile}\n}\n\nreload() {\n    echo -n $"Reloading $prog: "\n    if ! LANG=$HTTPD_LANG $httpd $OPTIONS -t >&/dev/null; then\n        RETVAL=6\n        echo $"not reloading due to configuration syntax error"\n        failure $"not reloading $httpd due to configuration syntax error"\n    else\n        # Force LSB behaviour from killproc\n        LSB=1 killproc -p ${pidfile} $httpd -HUP\n        RETVAL=$?\n        if [ $RETVAL -eq 7 ]; then\n            failure $"httpd shutdown"\n        fi\n    fi\n    echo\n}\n\n# See how we were called.\ncase "$1" in\n  start)\n    start\n    ;;\n  stop)\n    stop\n    ;;\n  status)\n        status -p ${pidfile} $httpd\n    RETVAL=$?\n    ;;\n  restart)\n    stop\n    start\n    ;;\n  condrestart|try-restart)\n    if status -p ${pidfile} $httpd >&/dev/null; then\n        stop\n        start\n    fi\n    ;;\n  force-reload|reload)\n        reload\n    ;;\n  graceful|help|configtest|fullstatus)\n    $apachectl $@\n    RETVAL=$?\n    ;;\n  *)\n    echo $"Usage: $prog {start|stop|restart|condrestart|try-restart|force-reload|reload|status|fullstatus|graceful|help|configtest}"\n    RETVAL=2\nesac\n\nexit $RETVAL\n')),(0,p.kt)("h2",{id:"69\u642d\u5efa-lamp-\u73af\u5883"},"6.9\u3001\u642d\u5efa LAMP \u73af\u5883"),(0,p.kt)("p",null,"\u672c\u6587\u7ed9\u51fa\u642d\u5efa LAMP \u7684\u6b65\u9aa4\uff0c\u5176\u4e2d php \u4f7f\u7528\u7684\u662f php-fpm \u7ba1\u7406\u65b9\u5f0f\uff0cphp \u548c MySQL(MariaDB) \u4ea4\u4e92\u4f7f\u7528\u7684\u662f mysqlnd \u65b9\u5f0f(\u53e6\u4e00\u79cd\u662f libmysql)\u3002\u6700\u540e\u7ed9\u51fa\u4e00\u4e2a php+mysql \u7684\u8bba\u575b\u7a0b\u5e8f discuz \u7684\u5e03\u7f6e\u8fc7\u7a0b\u3002"),(0,p.kt)("h3",{id:"691\u7f16\u8bd1-httpd"},"6.9.1\u3001\u7f16\u8bd1 httpd"),(0,p.kt)("p",null,"\u524d\u6587\u9488\u5bf9 httpd \u7f16\u8bd1\u505a\u4e86\u8be6\u7ec6\u5730\u63cf\u8ff0\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\uff0c\u4e0b\u9762\u53ea\u7ed9\u51fa\u5173\u952e\u6b65\u9aa4\u3002"),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u89e3\u51b3 httpd \u7f16\u8bd1\u4f9d\u8d56"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@aarch64 ~]# yum install pcre pcre-devel expat-devel\n[root@aarch64 ~]# tar xf apr-1.7.0.tar.bz2 \n[root@aarch64 ~]# cd apr-1.7.0/\n[root@aarch64 apr-1.7.0]# ./configure --prefix=/usr/local/apr\n[root@aarch64 apr-1.7.0]# make && make install\n[root@aarch64 ~]# tar xf apr-util-1.6.1.tar.bz2 \n[root@aarch64 ~]# cd apr-util-1.6.1/\n[root@aarch64 apr-util-1.6.1]# ./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr\n[root@aarch64 apr-util-1.6.1]# make && make install\n"))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u7f16\u8bd1 httpd"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@aarch64 ~]# tar xf httpd-2.4.47.tar.gz \n[root@aarch64 ~]# cd httpd-2.4.47/\n[root@aarch64 httpd-2.4.47]# ./configure --prefix=/usr/local/apache --sysconfdir=/etc/apache --with-z --with-pcre --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --with-mpm=event --enable-mpms-shared=all\n[root@aarch64 httpd-2.4.47]# make && make install\n"))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u7f16\u8bd1\u540e\u7684\u89c4\u8303\u5316\u64cd\u4f5c"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@aarch64 ~]# echo \"MANPATH /usr/local/apache/man\" >>/etc/man.config\n[root@aarch64 ~]# echo 'PATH=/usr/local/apache/bin:$PATH' >/etc/profile.d/apache.sh\n[root@aarch64 ~]# source /etc/profile.d/apache.sh\n[root@aarch64 ~]# ln -sv /usr/include /usr/local/apache/include\n\u2018/usr/local/apache/include/include\u2019 -> \u2018/usr/include\u2019\n[root@aarch64 ~]#\n"))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u63d0\u4f9b httpd \u670d\u52a1\u811a\u672c\uff0c\u7f16\u8f91 /etc/rc.d/init.d/httpd \u8f93\u5165\u5982\u4e0b\u811a\u672c"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\n#\n# httpd        Startup script for the Apache HTTP Server\n#\n# chkconfig: - 85 15\n# description: The Apache HTTP Server is an efficient and extensible  \\\n#           server implementing the current HTTP standards.\n#\n######################################################################\n#  \u82e5httpd\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u4e86PidFile\uff0c\u5219\u4fee\u6539\u6b64\u811a\u672c\u4e2d\u7684pidfile\u53d8\u91cf           #\n######################################################################\n\n. /etc/rc.d/init.d/functions\n\nif [ -f /etc/sysconfig/httpd ]; then\n       . /etc/sysconfig/httpd\nfi\n\n# Start httpd in the C locale by default.\nHTTPD_LANG=${HTTPD_LANG-"C"}\n\n# This will prevent initlog from swallowing up a pass-phrase prompt if\n# mod_ssl needs a pass-phrase from the user.\nINITLOG_ARGS=""\n\n# Set HTTPD=/usr/sbin/httpd.worker in /etc/sysconfig/httpd to use a server\n# with the thread-based "worker" MPM; BE WARNED that some modules may not\n# work correctly with a thread-based MPM; notably PHP will refuse to start.\n\n# Path to the apachectl script, server binary, and short-form for messages.\napachectl=/usr/local/apache/bin/apachectl\nhttpd=/usr/local/apache/bin/apachectl\nprog=httpd\npidfile=/usr/local/apache/logs/httpd.pid\nlockfile=/var/lock/subsys/httpd\nRETVAL=0\nSTOP_TIMEOUT=${STOP_TIMEOUT-10}\nconfig=/etc/apache/httpd.conf\n\n# The semantics of these two functions differ from the way apachectl does\n# things -- attempting to start while running is a failure, and shutdown\n# when not running is also a failure.  So we just do it the way init scripts\n# are expected to behave here.\nstart() {\n       echo -n $"Starting $prog: "\n       LANG=$HTTPD_LANG daemon --pidfile=${pidfile} $httpd -f $config $OPTIONS\n       RETVAL=$?\n       echo\n       [ $RETVAL = 0 ] && touch ${lockfile}\n       return $RETVAL\n}\n\n# When stopping httpd, a delay (of default 10 second) is required\n# before SIGKILLing the httpd parent; this gives enough time for the\n# httpd parent to SIGKILL any errant children.\nstop() {\n   status -p ${pidfile} $httpd > /dev/null\n   if [[ $? = 0 ]]; then\n       echo -n $"Stopping $prog: "\n       killproc -p ${pidfile} -d ${STOP_TIMEOUT} $httpd\n   else\n       echo -n $"Stopping $prog: "\n       success\n   fi\n   RETVAL=$?\n   echo\n   [ $RETVAL = 0 ] && rm -f ${lockfile} ${pidfile}\n}\n\nreload() {\n   echo -n $"Reloading $prog: "\n   if ! LANG=$HTTPD_LANG $httpd $OPTIONS -t >&/dev/null; then\n       RETVAL=6\n       echo $"not reloading due to configuration syntax error"\n       failure $"not reloading $httpd due to configuration syntax error"\n   else\n       # Force LSB behaviour from killproc\n       LSB=1 killproc -p ${pidfile} $httpd -HUP\n       RETVAL=$?\n       if [ $RETVAL -eq 7 ]; then\n           failure $"httpd shutdown"\n       fi\n   fi\n   echo\n}\n\n# See how we were called.\ncase "$1" in\n start)\n   start\n   ;;\n stop)\n   stop\n   ;;\n status)\n       status -p ${pidfile} $httpd\n   RETVAL=$?\n   ;;\n restart)\n   stop\n   start\n   ;;\n condrestart|try-restart)\n   if status -p ${pidfile} $httpd >&/dev/null; then\n       stop\n       start\n   fi\n   ;;\n force-reload|reload)\n       reload\n   ;;\n graceful|help|configtest|fullstatus)\n   $apachectl $@\n   RETVAL=$?\n   ;;\n *)\n   echo $"Usage: $prog {start|stop|restart|condrestart|try-restart|force-reload|reload|status|fullstatus|graceful|help|configtest}"\n   RETVAL=2\nesac\n\nexit $RETVAL\n'))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u542f\u52a8 httpd \u670d\u52a1"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@aarch64 ~]# chmod +x /etc/rc.d/init.d/httpd\n[root@aarch64 ~]# service httpd start\nReloading systemd:                                         [  OK  ]\nStarting httpd (via systemctl):                            [  OK  ]\n[root@aarch64 ~]# lsof -i :80\nCOMMAND  PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\nhttpd   1684   root    4u  IPv6  24292      0t0  TCP *:http (LISTEN)\nhttpd   1688 daemon    4u  IPv6  24292      0t0  TCP *:http (LISTEN)\nhttpd   1689 daemon    4u  IPv6  24292      0t0  TCP *:http (LISTEN)\nhttpd   1690 daemon    4u  IPv6  24292      0t0  TCP *:http (LISTEN)\n[root@aarch64 ~]#\n")))),(0,p.kt)("h3",{id:"692\u7f16\u8bd1-php"},"6.9.2\u3001\u7f16\u8bd1 php"),(0,p.kt)("p",null,"\u4e09\u79cd\u5de5\u4f5c\u6a21\u5f0f\uff1aCGI\u3001\u4f5c\u4e3a\u6a21\u5757\u52a0\u5165\u5230 apache\u3001fastcgi\u3002\u6700\u7b80\u5355\u7684\u662f\u4ee5\u6a21\u5757\u65b9\u5f0f\u52a0\u5165\u5230 apache\uff0c\u6b64\u5904\u6f14\u793a\u7684\u662f php-fpm \u7ba1\u7406 php-cgi \u65b9\u5f0f\u3002\u8bf7\u53c2\u89c1 ",(0,p.kt)("a",{parentName:"p",href:"https://www.brinnatt.com/addons/%e7%ac%ac-b-%e7%ab%a0-cgi-%e5%8a%a8%e6%80%81%e8%af%b7%e6%b1%82/"},"CGI \u539f\u7406"),"\u3002"),(0,p.kt)("p",null,"fastcgi \u6a21\u5f0f\u7684 php-cgi\uff0c\u7531 php-fpm \u63d0\u4f9b\u670d\u52a1\u7ba1\u7406\uff0c\u5b83\u4f1a\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\u4e00\u5b9a\u6570\u91cf\u7684 cgi \u8fdb\u7a0b\uff0c\u5176\u9ed8\u8ba4\u76d1\u542c\u7684\u7aef\u53e3\u4e3a 9000\uff0c\u8be5\u670d\u52a1\u6b63\u5e38\u5de5\u4f5c\u9700\u8981\u914d\u7f6e\u6587\u4ef6\u3002\u4e5f\u5c31\u662f\u8bf4 fastcgi \u6a21\u5f0f\u7684 php \u6709\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u4e00\u4e2a\u662f php \u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e00\u4e2a\u662f php-fpm \u7684\u914d\u7f6e\u6587\u4ef6\u3002"),(0,p.kt)("p",null,"\u867d\u7136\u6b64\u5904\u6f14\u793a\u7684\u662f php-fpm \u7ba1\u7406\u65b9\u5f0f\uff0c\u4f46\u6709\u5fc5\u8981\u8bf4\u660e\u4e0b\uff0c\u5728 Linux \u4e2d\u5982\u679c\u6a21\u5757\u5316\u5b89\u88c5 php\uff0c\u4e0d\u63a8\u8350\u5728\u4f7f\u7528 Apache 2.x \u4e2d\u4f7f\u7528\u7ebf\u7a0b\u5316 MPM(worker \u548c event)\uff0c\u800c\u662f\u4f7f\u7528 prefork \u6a21\u5f0f\u7684 mpm\uff0c\u56e0\u4e3a Linux \u7cfb\u7edf\u7684\u7ebf\u7a0b\u8bbe\u8ba1\u5e76\u4e0d\u90a3\u4e48\u5b8c\u7f8e\u3002"),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},"\u6240\u4ee5\uff0c\u5982\u679c php \u548c apache \u5728\u540c\u4e00\u53f0\u4e3b\u673a\u4e0a(cgi \u6216\u8005\u6a21\u5757\u5316\u65b9\u5f0f\u5b89\u88c5 php \u7684\u65f6\u5019)\uff0c\u5efa\u8bae httpd \u4f7f\u7528 prefork \u6a21\u578b\uff0c\u800c\u4e0d\u5728\u540c\u4e00\u53f0\u4e3b\u673a\u4e2d\uff0c\u5efa\u8bae\u5c06 php \u8bbe\u8ba1\u4e3a fastcgi \u7684\u5de5\u4f5c\u6a21\u5f0f\u3002"),(0,p.kt)("li",{parentName:"ul"},"\u800c\u5728 windows \u5e73\u53f0\u4e2d\u5219\u65e0\u9700\u8003\u8651\u8fd9\u4e9b\u95ee\u9898\uff0c\u56e0\u4e3a windows \u7cfb\u7edf\u662f\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u591a\u7ebf\u7a0b\u7cfb\u7edf\u3002")),(0,p.kt)("p",null,"\u4e0b\u8f7d\u76f8\u5173\u6587\u4ef6\u5730\u5740\uff1a"),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},"php \u4e0b\u8f7d\u5730\u5740\uff1a",(0,p.kt)("a",{parentName:"li",href:"http://php.net/downloads"},"http://php.net/downloads")),(0,p.kt)("li",{parentName:"ul"},"php \u624b\u518c\u5730\u5740\uff1a",(0,p.kt)("a",{parentName:"li",href:"http://php.net/manual/zh/"},"http://php.net/manual/zh/")),(0,p.kt)("li",{parentName:"ul"},"\u624b\u518c\u4e0b\u8f7d\u5730\u5740\uff1a",(0,p.kt)("a",{parentName:"li",href:"http://php.net/download-docs.php"},"http://php.net/download-docs.php"))),(0,p.kt)("h4",{id:"6921php-\u7f16\u8bd1\u9009\u9879\u8bf4\u660e"},"6.9.2.1\u3001php \u7f16\u8bd1\u9009\u9879\u8bf4\u660e"),(0,p.kt)("p",null,"\u7f16\u8bd1\u5b89\u88c5 php \u6709\u975e\u5e38\u591a\u7684\u9009\u9879\uff0c\u6bd4 httpd \u8fd8\u591a\u3002\u53ef\u4ee5\u5728\u89e3\u538b php \u540e\u7684\u76ee\u5f55\u4e0b\u4f7f\u7528 ",(0,p.kt)("inlineCode",{parentName:"p"},"./configure --help"),' \u67e5\u770b\u3002\u4ee5\u4e0b\u662f\u90e8\u5206\u9009\u9879\uff0c\u5176\u4e2d\u7ed9\u51fa "--enable-XXXX" \u7684\u9009\u9879\u8868\u793a\u9ed8\u8ba4\u662f disable \u7684\uff0c\u82e5\u8981\u5f00\u542f\uff0c\u9700\u8981\u5728\u6b64\u5904\u624b\u52a8 enable\uff0c\u5982\u679c\u7ed9\u51fa\u7684\u662f "--disable-XXXX" \u8868\u793a\u9ed8\u8ba4\u662f enable \u7684\u3002'),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"--prefix=PREFIX\n\u3010SAPI modules:\u3011\n--with-apxs2=FILE       Build shared Apache 2.0 Handler module. FILE is the optional\n                          pathname to the Apache apxs tool apxs\n--enable-fpm            Enable building of the fpm SAPI executable\n\n\u3010General settings:\u3011\n--with-config-file-path=PATH      Set the path in which to look for php.ini [PREFIX/lib]\n--with-config-file-scan-dir=PATH  Set the path where to scan for configuration files\n\n\u3010Extensions:\u3011\n      #######################################################\n      # --with-EXTENSION=shared[,PATH]                      #\n      # NOTE: Not all extensions can be build as 'shared'.  #\n      # Example: --with-foobar=shared,/usr/local/foobar/    #\n      #######################################################\n--with-openssl=DIR      Include OpenSSL support (requires OpenSSL >= 0.9.6)\n--enable-mbstring       Enable multibyte string support\n--with-zlib=DIR         Include ZLIB support\n--with-bz2=DIR          Include BZip2 support\n--with-mhash=DIR        Include mhash support\n--with-mcrypt=DIR       Include mcrypt support\n--with-freetype-dir=DIR  GD: Set the path to FreeType 2 install prefix\n--with-jpeg-dir=DIR     GD: Set the path to libjpeg install prefix\n--with-png-dir=DIR      GD: Set the path to libpng install prefix\n--with-libxml-dir=DIR   SimpleXML: libxml2 install prefix\n--enable-sockets        Enable sockets support\n--disable-xml           Disable XML support (\u4e0d\u5199\u65f6\u9ed8\u8ba4--enable-xml)\n\n\u3010\u8fde\u63a5\u6570\u636e\u5e93:\u3011\n--with-mysql=DIR        Include MySQL support.  DIR is the MySQL base\n                          directory, if no DIR is passed or the value is\n                          mysqlnd the MySQL native driver will be used\n--with-mysqli=FILE      Include MySQLi support.  FILE is the path\n                          to mysql_config.  If no value or mysqlnd is passed\n                          as FILE, the MySQL native driver will be used\n--with-pdo-mysql=DIR    PDO: MySQL support. DIR is the MySQL base directory\n                          If no value or mysqlnd is passed as DIR, the\n                          MySQL native driver will be used\n--enable-mysqlnd        Enable mysqlnd explicitly, will be done implicitly\n                          when required by other extensions\n\u3010Zend:\u3011\n--enable-maintainer-zts    Enable thread safety - for code maintainers only!!\n")),(0,p.kt)("p",null,"\u90e8\u5206\u9009\u9879\u8bf4\u660e\uff1a"),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},'\u5728\u3010zend\u3011\u6269\u5c55\u90e8\u5206\u7684\u9009\u9879 "--enable-maintainer-zts" \u662f\u4e3a\u4e86\u8ba9 php \u652f\u6301\u591a\u7ebf\u7a0b MPM \u7684\uff0c\u5373 php \u4ee5\u6a21\u5757\u5316\u65b9\u5f0f\u6216 cgi \u6a21\u5f0f\u5b89\u88c5\u65f6\u4e14 httpd \u914d\u7f6e\u4e3a worker \u6216 event \u65f6\u9700\u8981\u542f\u7528\u8be5\u9879\u3002\u800c\u5982\u679c php \u4ee5 fastcgi \u6a21\u5f0f\u5b89\u88c5\u65f6\uff0c\u7531\u4e8e php \u6709\u72ec\u7acb\u7684\u670d\u52a1\u548c\u8fdb\u7a0b\uff0c\u6240\u4ee5\u8be5\u9879\u662f\u591a\u4f59\u7684\u3002')),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},'"--with-apxs2" \u662f\u8ba9 php \u4ee5\u6a21\u5757\u5316\u7684\u65b9\u5f0f\u5b89\u88c5\u5230\u5176\u4ed6\u7a0b\u5e8f\u4e2d\uff0c"--enable-fpm" \u662f\u8ba9 php \u4ee5 fastcgi \u6a21\u5f0f\u5de5\u4f5c\u7684\u9009\u9879\u3002\u6240\u4ee5\u6b64\u5904\u91c7\u7528\u540e\u8005\uff0c\u800c\u4ee5\u6a21\u5757\u65b9\u5f0f\u548c httpd \u4ea4\u4e92\u65f6\u91c7\u7528\u524d\u8005\u3002')),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},'"--with-config-file-path" \u548c "--with-config-file-scan-dir" \u5206\u522b\u662f php \u914d\u7f6e\u6587\u4ef6 php.ini \u7684\u5b58\u653e\u4f4d\u7f6e\u4ee5\u53ca\u5176\u4ed6\u52a0\u8f7d\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff0cscan-dir \u7c7b\u7684\u76ee\u5f55\u5c31\u50cf /etc/profile.d\u3001/etc/httpd/conf.d \u8fd9\u6837\u7684\u76ee\u5f55\u8def\u5f84\u3002')),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},'"--with-openssl" \u9009\u9879\u8ba9 php \u652f\u6301 ssl\uff1b"--enable-mbstring" \u9009\u9879\u662f\u8ba9 php \u652f\u6301\u591a\u5b57\u8282\u5b57\u7b26\u7684\uff0c\u4f8b\u5982\u4e2d\u6587\u4e00\u4e2a\u5b57\u7b26\u4e24\u4e2a\u5b57\u8282\uff0c\u4e5f\u5c31\u662f\u8bf4\u8ba9 php \u652f\u6301\u56fd\u9645\u5316\u7684\uff1b"--with-zlib"\u3001"--with-bz2"\u3001"--with-mhash" \u548c "--with-mcrypt" \u9009\u9879\u8ba9 php \u652f\u6301\u8fd9\u4e9b\u538b\u7f29\u548c\u52a0\u5bc6\u673a\u5236\u3002')),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},'"--with-freetype-dir"\u3001"--with-jpeg-dir" \u548c "--with-png-dir" \u5206\u522b\u662f\u8ba9 php \u652f\u6301\u591a\u79cd\u6587\u5b57\u6837\u5f0f\u3001\u652f\u6301 jpeg\u3001\u652f\u6301 png \u7684\u9009\u9879\u3002')),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"php \u8fde\u63a5 mysql \u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f\u4ee5 libmysql \u7684\u9a71\u52a8\u65b9\u5f0f\u8fde\u63a5 mysql\uff0c\u4e00\u79cd\u662f\u4ee5 mysqlnd \u9a71\u52a8\u65b9\u5f0f\u8fde\u63a5 mysql\u3002\u4ee5\u4e0b\u5217\u51fa\u4e86 libmysql \u548c mysqlnd \u8fd9\u4e24\u79cd\u9a71\u52a8\u65b9\u5f0f\u7684\u7f16\u8bd1\u6a21\u5f0f\u3002"),(0,p.kt)("ul",{parentName:"li"},(0,p.kt)("li",{parentName:"ul"},(0,p.kt)("p",{parentName:"li"},'\u4ee5 libmysql \u9a71\u52a8\u65b9\u5f0f\u8fde\u63a5 mysql(Mariadb)\uff0c\u9700\u8981\u63d0\u524d\u5b89\u88c5 mysql(Mariadb) \u548c mysql-devel(mariadb-devel)\uff0c\u5e76\u4f7f\u7528 "--with-mysql" \u9009\u9879\u6307\u5b9a mysql \u5b89\u88c5\u8def\u5f84\uff0c"--with-mysqli" \u9009\u9879\u6307\u5b9a mysql',"_",'config \u811a\u672c\u7684\u8def\u5f84\uff0c"--with-pdo-mysql" \u9009\u9879\u4e5f\u6307\u5b9a mysql \u5b89\u88c5\u8def\u5f84\u3002\u5047\u5982 mysql \u5b89\u88c5\u5728 /usr/local/mysql \u4e0b\u3002'),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/usr/local/php \\\n--with-mysql=/usr/local/mysql \\\n--with-mysqli=/usr/local/mysql/bin/mysql_config\n"))),(0,p.kt)("li",{parentName:"ul"},(0,p.kt)("p",{parentName:"li"},"\u4ee5 mysqlnd \u9a71\u52a8\u65b9\u5f0f\u8fde\u63a5 mysql\uff0c\u4e0d\u9700\u8981\u63d0\u524d\u5b89\u88c5 mysql \u548c mysql-devel\uff0c--with-mysql\u3001--with-mysqli \u548c --with-pdo-mysql \u9009\u9879\u90fd\u4e0d\u9700\u8981\u6307\u5b9a\u5177\u4f53\u8def\u5f84\uff0c\u53ea\u9700\u4f7f\u7528 mysqlnd \u4f5c\u4e3a\u8fd9\u4e9b\u9009\u9879\u7684\u503c\u5373\u53ef\u3002"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"./configure --prefix=/usr/local/php \\\n--with-mysql=mysqlnd \\\n--with-mysqli=mysqlnd \\\n--with-pdo-mysql=mysqlnd\n")))),(0,p.kt)("p",{parentName:"li"},"\u5728 php 5.3 \u7684\u65f6\u5019\u5df2\u7ecf\u652f\u6301 mysqlnd \u9a71\u52a8\u65b9\u5f0f\u4e86\uff0c\u5728 php 5.4 \u7684\u65f6\u5019 mysqlnd \u5df2\u7ecf\u662f\u9ed8\u8ba4\u7684\u914d\u7f6e\u9009\u9879\u4e86\u3002\u5efa\u8bae\u4f7f\u7528 mysqlnd \u7684\u9a71\u52a8\u65b9\u5f0f\u3002"))),(0,p.kt)("h4",{id:"6922php-\u7f16\u8bd1\u8fc7\u7a0b"},"6.9.2.2\u3001php \u7f16\u8bd1\u8fc7\u7a0b"),(0,p.kt)("p",null,"\u7531\u4e8e\u662f\u914d\u7f6e fastcgi \u7684\u6a21\u5f0f\uff0c\u6240\u4ee5\u5728 ",(0,p.kt)("inlineCode",{parentName:"p"},"./configure"),' \u7684\u65f6\u5019\u5c06 apxs2 \u529f\u80fd\u6362\u4e3a "--enable-fpm"\uff0c\u5e76\u4e14\u7531\u4e8e\u6b64\u6a21\u5f0f\u4e0b\u7684 php \u7531\u81ea\u5df1\u72ec\u7acb\u7684\u670d\u52a1\u6765\u63a7\u5236\u8fdb\u7a0b\u7684\u751f\u6210\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4e3a\u4e86\u652f\u6301 httpd \u7ebf\u7a0b\u7684\u9009\u9879 "--enable-maintainer-zts" \u4e5f\u53bb\u6389\u3002\u4ee5\u4e0b\u662f\u7f16\u8bd1\u5b89\u88c5\u8fc7\u7a0b\uff1a'),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@aarch64 ~]# yum install -y bzip2-devel libmcrypt-devel openssl-devel libxml2-devel libsqlite3x-devel oniguruma-devel\n[root@aarch64 ~]# tar xf php-5.5.38.tar.bz2 \n[root@aarch64 ~]# cd php-5.5.38/\n[root@aarch64 php-5.5.38]# ./configure --prefix=/usr/local/php --with-openssl --enable-mbstring --enable-sockets --with-freetype-dir --with-jpeg-dir --with-png-dir --with-libxml-dir=/usr --enable-xml --with-zlib --with-mcrypt --with-bz2 --with-mhash --with-config-file-path=/etc --with-config-file-scan-dir=/etc/php.d --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --enable-fpm\n[root@aarch64 php-5.5.38]# make && make install\n")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"# \u63d0\u4f9bphp\u914d\u7f6e\u6587\u4ef6\n[root@aarch64 php-5.5.38]# cp php.ini-production /etc/php.ini\n\n# \u63d0\u4f9bphp-fpm\u670d\u52a1\u7ba1\u7406\u811a\u672c\n[root@aarch64 php-5.5.38]# cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpmd\n[root@aarch64 php-5.5.38]# chmod +x /etc/init.d/php-fpmd\n\n# \u63d0\u4f9bphp-fpm\u914d\u7f6e\u6587\u4ef6\n[root@aarch64 php-5.5.38]# cd /usr/local/php/\n[root@aarch64 php]# cp etc/php-fpm.conf.default etc/php-fpm.conf\n\n# \u4fee\u6539php-fpm\u914d\u7f6e\u6587\u4ef6(\u505a\u5b9e\u9a8c\u7684\u8bdd\u6539\u4e0d\u6539\u968f\u610f)\n[root@aarch64 php]# vim etc/php-fpm.conf\npm.max_children = 50\npm.start_servers = 5\npm.min_spare_servers = 2\npm.max_spare_servers = 8\n\n# \u542f\u52a8php-fpm\n[root@aarch64 ~]# service php-fpmd start\nStarting php-fpm  done\n")),(0,p.kt)("h4",{id:"6923\u914d\u7f6e-httpd-\u4f7f\u5176\u8f6c\u53d1\u52a8\u6001\u8bf7\u6c42\u7ed9-php-fpm"},"6.9.2.3\u3001\u914d\u7f6e httpd \u4f7f\u5176\u8f6c\u53d1\u52a8\u6001\u8bf7\u6c42\u7ed9 php-fpm"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},'# \u542f\u7528fcgi\u7684\u652f\u6301\u6a21\u5757\u3002\nLoadModule proxy_module modules/mod_proxy.so\nLoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so\n\n# \u6dfb\u52a0php\u540e\u7f00\u683c\u5f0f\u6587\u4ef6\u7684\u8bc6\u522b\u529f\u80fd\u3002\n<IfModule mime_module>\n    TypesConfig /etc/apache/mime.types\n    AddType application/x-compress .Z\n    AddType application/x-gzip .gz .tgz\n    AddType application/x-httpd-php .php            # \u65b0\u589e\n    AddType application/x-httpd-php-source .phps    # \u65b0\u589e\n</IfModule>\n\n# \u6dfb\u52a0php\u540e\u7f00\u7684\u4e3b\u9875\n<IfModule dir_module>\n    DirectoryIndex index.php index.html\n</IfModule>\n\n# \u542f\u7528\u865a\u62df\u4e3b\u673a\u6a21\u5757\uff0cInclude\u865a\u62df\u4e3b\u673a\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u6ce8\u91ca\u4e2d\u5fc3\u4e3b\u673aDocumentRoot\u3002\nInclude /etc/apache/extra/httpd-vhosts.conf\n#DocumentRoot "/usr/local/apache/htdocs"\n\n# \u914d\u7f6e\u865a\u62df\u4e3b\u673a\u3002\u6ce8\u610f\u4e3b\u673a\u4e2d\u9700\u8981\u6dfb\u52a0\u4e0b\u9762\u4e24\u884c\uff0c\u7b2c\u4e00\u884c\u8868\u793a\u5173\u95ed\u6b63\u5411\u4ee3\u7406\u529f\u80fd\uff0c\u7b2c\u4e8c\u884c\u8868\u793a\u53cd\u5411\u4ee3\u7406\u65f6\u8fdb\u884c\u6b63\u5219\u5339\u914d\u3002\n# \u5bf9\u4e3b\u673a\u7684.php(\u4e0d\u533a\u5206\u5927\u5c0f\u5199)\u6587\u4ef6\u7684\u8bbf\u95ee\u90fd\u901a\u8fc7fcgi\u534f\u8bae\u4ea4\u7ed9php\uff0c\u7531\u4e8e\u6b64\u5904\u6d4b\u8bd5\uff0cphp\u6b63\u597d\u548chttpd\u5728\u540c\u4e00\u670d\u52a1\u5668\u4e0a\uff0c# \u4e14php-fpm\u9ed8\u8ba4\u76d1\u542c\u7684\u7aef\u53e3\u4e3a9000\uff0c\u6240\u4ee5\u4e3afcgi://127.0.0.1:9000\uff0c\u5728\u6b64\u4e4b\u540e\u8fd8\u9700\u8981\u5199\u4e0a/DocumentRoot/$1\uff0c\n# "$1"\u662f\u6b63\u5219\u7684\u53cd\u5411\u5f15\u7528\n[root@arm64v8 ~]# grep -Ev "^#|^$" /etc/apache/extra/httpd-vhosts.conf\n<VirtualHost *:80>\n    ServerName www.a.com\n    DocumentRoot "/var/www/a.com"\n    ErrorLog "logs/dummy-host.example.com-error_log"\n    CustomLog "logs/dummy-host.example.com-access_log" common\n    ProxyRequests off\n    ProxyPassMatch "(?i)^/(.*\\.php)$" fcgi://127.0.0.1:9000/var/www/a.com/$1\n    <Directory "/var/www/a.com">\n            AllowOverride None\n            Options None\n            Require all granted\n    </Directory>\n</VirtualHost>\n[root@arm64v8 ~]#\n')),(0,p.kt)("p",null,"\u63d0\u4f9b\u4e3b\u9875\u6d4b\u8bd5\u6587\u4ef6 index.php\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@aarch64 ~]# mkdir -p /var/www/a.com\n[root@aarch64 ~]# vim /var/www/a.com/index.php\n<h1>a.com</h1>\n<?php\n    phpinfo();\n?>\n")),(0,p.kt)("p",null,"\u91cd\u542f httpd\uff0c\u6d4f\u89c8\u5668\u4e2d\u8fdb\u884c\u7ad9\u70b9\u8bbf\u95ee\u6d4b\u8bd5\uff0c\u5df2\u6d4b\u8bd5\u6210\u529f\u3002"),(0,p.kt)("h3",{id:"693\u4e3a-php-\u5b89\u88c5-xcache"},"6.9.3\u3001\u4e3a php \u5b89\u88c5 xcache"),(0,p.kt)("p",null,"php \u662f\u4e00\u79cd\u89e3\u91ca\u578b\u8bed\u8a00\uff0c\u610f\u5473\u7740 php \u811a\u672c\u5728\u6267\u884c\u65f6\u4e0d\u9700\u8981\u4e8b\u5148\u7f16\u8bd1\uff0c\u800c\u662f\u50cf shell \u811a\u672c\u4e00\u6837\u76f4\u63a5\u6267\u884c\u3002\u4f46\u4e8b\u5b9e\u4e0a\u5b83\u8fd8\u662f\u4f1a\u7f16\u8bd1\u7684\uff0c\u53ea\u4e0d\u8fc7\u662f\u6267\u884c\u65f6\u7f16\u8bd1\uff0c\u5b83\u4f1a\u5c06\u4ee3\u7801\u7f16\u8bd1\u6210\u5b57\u8282\u7801(opcode)\u7136\u540e\u8fd0\u884c\u3002"),(0,p.kt)("p",null,"\u7f16\u8bd1\u662f\u4e00\u4e2a\u5f88\u6d88\u8017\u65f6\u95f4\u7684\u64cd\u4f5c\uff0c\u56e0\u6b64\u9700\u8981\u4e3a\u7f16\u8bd1\u597d\u7684 opcode \u63d0\u4f9b\u7f13\u5b58\u4ee5\u63d0\u9ad8\u6027\u80fd\uff0c\u964d\u4f4e\u8d1f\u8f7d\u3002\u76ee\u524d\u6700\u6d41\u884c\u7684 opcode \u7f13\u5b58\u5de5\u5177\u662f XCache\uff0c\u5b83\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5de5\u5177\u3002"),(0,p.kt)("p",null,"\u5b89\u88c5 xcache\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@aarch64 ~]# tar xf xcache-3.2.0.tar.gz \n[root@aarch64 ~]# cd xcache-3.2.0/\n\n# \u6dfb\u52a0\u6269\u5c55\u524d\uff0c\u5148\u8fd0\u884cphpize\n[root@aarch64 xcache-3.2.0]# /usr/local/php/bin/phpize \nConfiguring for:\nPHP Api Version:         20121113\nZend Module Api No:      20121212\nZend Extension Api No:   220121212\n[root@aarch64 xcache-3.2.0]# ./configure --enable-xcache --with-php-config=/usr/local/php/bin/php-config\n[root@aarch64 xcache-3.2.0]# make && make install\n")),(0,p.kt)("p",null,"\u5728\u89e3\u538b xcache \u7684\u76ee\u5f55\u4e0b\uff0c\u6709 xcache \u7684\u914d\u7f6e\u6587\u4ef6 xcache.ini\uff0c\u5c06\u5176\u8ffd\u52a0\u5230 php \u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6216\u8005\u5c06\u5176\u590d\u5236\u5230 php \u7684\u914d\u7f6e\u6587\u4ef6\u626b\u63cf\u76ee\u5f55 /etc/php.d \u4e0b(\u8be5\u76ee\u5f55\u662f\u4e4b\u524d\u7f16\u8bd1 php \u65f6 ",(0,p.kt)("inlineCode",{parentName:"p"},"./configure"),' \u914d\u7f6e\u9009\u9879 "--with-config-file-scan-dir" \u6307\u5b9a\u7684\u9879)\u3002'),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@aarch64 xcache-3.2.0]# mkdir /etc/php.d\n[root@aarch64 xcache-3.2.0]# cp xcache.ini /etc/php.d\n")),(0,p.kt)("p",null,"\u5c06 xcache \u6e90\u7801\u76ee\u5f55\u4e0b\u7684 htdocs \u76ee\u5f55\u62f7\u8d1d\u5230\u865a\u62df\u4e3b\u673a\u7684\u6839\u76ee\u5f55\u4e0b"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 xcache-3.2.0]# cp -a htdocs/ /var/www/a.com/\n")),(0,p.kt)("p",null,"\u5173\u95ed xcache \u8ba4\u8bc1\uff0c\u7136\u540e\u91cd\u542f php-fpmd \u670d\u52a1\uff0c\u91cd\u542f httpd \u670d\u52a1\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# vim /etc/php.d/xcache.ini\n[xcache.admin]\nxcache.admin.enable_auth = Off\n[root@arm64v8 ~]# service php-fpmd restart \nGracefully shutting down php-fpm . done\nStarting php-fpm  done\n[root@arm64v8 ~]# service httpd restart \nRestarting httpd (via systemctl):                          [  OK  ]\n[root@arm64v8 ~]#\n")),(0,p.kt)("p",null,"\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165 ",(0,p.kt)("a",{parentName:"p",href:"http://192.168.0.88/htdocs"},"http://192.168.0.88/htdocs")," \u53ef\u4ee5\u770b\u5230 xcache \u754c\u9762\uff1a"),(0,p.kt)("p",null,(0,p.kt)("img",{alt:"xcache",src:a(9085).Z,width:"954",height:"483"})),(0,p.kt)("h3",{id:"694\u5b89\u88c5-mysqlmariadb"},"6.9.4\u3001\u5b89\u88c5 MySQL(MariaDB)"),(0,p.kt)("p",null,"\u5728 x86 \u67b6\u6784\u4e0b\uff0c\u5b89\u88c5 mysql/mariadb \u6709\u4e09\u4e2a\u9009\u62e9\uff0c\u7b2c\u4e00\u79cd\u662f\u901a\u8fc7\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5\uff0c\u7b2c\u4e8c\u79cd\u662f\u901a\u8fc7\u901a\u7528\u4e8c\u8fdb\u5236\u65b9\u5f0f\u5b89\u88c5\uff0c\u7b2c\u4e09\u79cd\u662f\u901a\u8fc7 Linux \u53d1\u884c\u7248\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u3002"),(0,p.kt)("p",null,"\u5728 arm64 \u67b6\u6784\u4e0b\uff0c\u5b89\u88c5 mysql/mariadb \u8981\u4e48\u81ea\u5df1\u901a\u8fc7\u6e90\u7801\u7f16\u8bd1\uff0c\u8981\u4e48\u901a\u8fc7 Linux \u53d1\u884c\u7248\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u3002\u8fd9\u91cc\u7684\u5b9e\u9a8c\u6211\u4eec\u9009\u62e9\u4f7f\u7528\u540e\u8005\uff0c\u5373 rpm \u5305\u8fdb\u884c\u5b89\u88c5\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cat /etc/yum.repos.d/mariadb.repo \n# MariaDB 10.3 CentOS repository list - created 2021-10-29 03:23 UTC\n# https://mariadb.org/download/\n[mariadb]\nname = MariaDB\nbaseurl = https://ftp.ubuntu-tw.org/mirror/mariadb/yum/10.3/centos7-aarch64\ngpgkey=https://ftp.ubuntu-tw.org/mirror/mariadb/yum/RPM-GPG-KEY-MariaDB\ngpgcheck=1\n\n[root@arm64v8 ~]#\n[root@arm64v8 ~]# yum install MariaDB-server MariaDB-client -y\n")),(0,p.kt)("p",null,"\u521d\u59cb\u5316 mariadb"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# systemctl start mariadb.service\n[root@arm64v8 ~]# mysql_secure_installation\n# \u6309\u7167\u6b65\u9aa4\u5b8c\u6210\u521d\u59cb\u5316\n[root@arm64v8 ~]# mysql -uroot -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 17\nServer version: 10.3.31-MariaDB MariaDB Server\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]>\n")),(0,p.kt)("h3",{id:"695\u6d4b\u8bd5-lamp\u642d\u5efa-discuz-\u8bba\u575b"},"6.9.5\u3001\u6d4b\u8bd5 LAMP\u2014\u2014\u642d\u5efa discuz \u8bba\u575b"),(0,p.kt)("p",null,"discuz \u662f\u8bba\u575b\u8f6f\u4ef6\u7cfb\u7edf\uff0c\u57fa\u4e8e php+MySQL \u5e73\u53f0\u3002\u57fa\u672c\u914d\u7f6e\u5f88\u7b80\u5355\uff0c\u66f4\u591a\u7684\u914d\u7f6e\u548c\u4e2a\u6027\u5316\u5b9a\u5236\u5728\u5b98\u65b9\u4e3b\u9875\u67e5\u770b\u6559\u7a0b\u3002"),(0,p.kt)("p",null,"\u5b98\u65b9\u4e3b\u9875\uff1a",(0,p.kt)("a",{parentName:"p",href:"http://www.discuz.net/forum.php"},"http://www.discuz.net/forum.php")),(0,p.kt)("p",null,"discuz \u4e0b\u8f7d\u5730\u5740\uff1a",(0,p.kt)("a",{parentName:"p",href:"http://www.discuz.net/thread-3570835-1-1.html"},"http://www.discuz.net/thread-3570835-1-1.html")),(0,p.kt)("p",null,"\u7b80\u5355\u5e03\u7f6e\u5b83\u4eec\u7684\u8fc7\u7a0b\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u590d\u5236\u76f8\u5173\u6587\u4ef6\u5230\u5bf9\u5e94\u7684\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\u5bf9\u5e94\u7684\u76ee\u5f55\u540d\u5373\u53ef\u6253\u5f00\u7a0b\u5e8f\u3002\u4e2d\u95f4\u6d4b\u8bd5\u8fc7\u7a0b\u4e2d\u5982\u679c\u51fa\u73b0\u95ee\u9898\uff0c\u518d\u5bf9\u5e94\u4fee\u6539\u5373\u53ef\u3002"),(0,p.kt)("p",null,"\u9996\u5148\u914d\u7f6e httpd\uff0c\u63d0\u4f9b\u4e00\u4e2a\u865a\u62df\u4e3b\u673a\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},'[root@arm64v8 ~]# grep -vE "^#|^$" /etc/apache/extra/httpd-vhosts.conf\n<VirtualHost *:80>\n    ServerName www.a.com\n    DocumentRoot "/var/www/a.com"\n    ErrorLog "logs/dummy-host.example.com-error_log"\n    CustomLog "logs/dummy-host.example.com-access_log" common\n    ProxyRequests off\n    ProxyPassMatch "(?i)^/(.*\\.php)$" fcgi://127.0.0.1:9000/var/www/a.com/$1\n    <Directory "/var/www/a.com">\n            AllowOverride None\n            Options None\n            Require all granted\n    </Directory>\n</VirtualHost>\n[root@arm64v8 ~]#\n')),(0,p.kt)("p",null,"\u5c06\u89e3\u538b\u540e discuz \u4e2d\u7684 upload \u76ee\u5f55\u590d\u5236\u5230\u5bf9\u5e94\u865a\u62df\u4e3b\u673a\u7684 DocumentRoot \u76ee\u5f55\u4e0b\u3002"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# unzip -q Discuz_X3.2_SC_UTF8.zip\n[root@arm64v8 ~]# cp -a upload/ /var/www/a.com/\n")),(0,p.kt)("p",null,"\u91cd\u542f httpd \u670d\u52a1\u3002\u6d4b\u8bd5 discuz\u3002\u4e0d\u8fc7\u5f97\u5148\u5728\u5ba2\u6237\u7aef\u7684 hosts \u6587\u4ef6\u4e2d\u6dfb\u52a0\u89e3\u6790\u8bb0\u5f55\uff0c\u4f8b\u5982\u6b64\u5904\u4e3a\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"10.47.76.25     www.a.com\n")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# service php-fpmd restart\nGracefully shutting down php-fpm . done\nStarting php-fpm  done\n[root@arm64v8 ~]# service httpd restart\nRestarting httpd (via systemctl):                          [  OK  ]\n[root@arm64v8 ~]#\n")),(0,p.kt)("p",null,"\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165 ",(0,p.kt)("a",{parentName:"p",href:"http://www.a.com/upload"},"http://www.a.com/upload"),"\uff1a"),(0,p.kt)("p",null,(0,p.kt)("img",{alt:"discuz_intall",src:a(49051).Z,width:"708",height:"496"})),(0,p.kt)("p",null,"\u7136\u540e\u5728\u5b89\u88c5\u524d\u4f1a\u81ea\u52a8\u68c0\u67e5\u662f\u5426\u7b26\u5408\u5b89\u88c5\u6761\u4ef6\u3002\u5c06\u4ee5\u4e0b\u6240\u6709\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u5168\u90e8\u4fee\u6539\u6210\u7b26\u5408\u6761\u4ef6\uff1a"),(0,p.kt)("p",null,(0,p.kt)("img",{alt:"discuz_problem",src:a(76130).Z,width:"708",height:"753"})),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"[root@arm64v8 ~]# cd /var/www/a.com/upload\n[root@arm64v8 upload]# touch config/config_{global,ucenter}.php\n[root@arm64v8 upload]# chmod a+w config/config_{global,ucenter}.php\n[root@arm64v8 upload]# chmod a+w  data config data/{cache,avatar,plugindata,download,addonmd5,template,threadcache,attachment,log} data/attachment/{album,forum,group}\n[root@arm64v8 upload]# chmod a+w uc_client/data/cache\n[root@arm64v8 upload]# chmod a+w uc_server/data uc_server/data/{cache,avatar,backup,logs,tmp,view}\n[root@arm64v8 upload]#\n")),(0,p.kt)("p",null,"\u5237\u65b0\u4e0b\uff0c\u6761\u4ef6\u6ee1\u8db3\uff1a"),(0,p.kt)("p",null,(0,p.kt)("img",{alt:"discuz_envok",src:a(40783).Z,width:"709",height:"753"})),(0,p.kt)("p",null,"\u7ee7\u7eed\u4e0b\u4e00\u6b65\uff0c\u914d\u7f6e\u6570\u636e\u5e93\u548c\u7ba1\u7406\u5458\u4fe1\u606f\uff0c\u6309\u7167\u63d0\u793a\u5f88\u5bb9\u6613\u914d\u7f6e\uff1a"),(0,p.kt)("p",null,(0,p.kt)("img",{alt:"discuz_envset",src:a(22432).Z,width:"708",height:"736"})),(0,p.kt)("p",null,"\u70b9\u51fb\u4e0b\u4e00\u6b65\u7ee7\u7eed\uff0c\u51fa\u73b0\u5982\u4e0b\u95ee\u9898\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"\u6570\u636e\u5e93\u8fde\u63a5\u9519\u8bef\nNo such file or directory\n\n\u60a8\u5fc5\u987b\u89e3\u51b3\u4ee5\u4e0a\u95ee\u9898\uff0c\u5b89\u88c5\u624d\u53ef\u4ee5\u7ee7\u7eed\n")),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},"\u89e3\u51b3\u65b9\u6cd5\uff1a\u5c06 localhost \u6539\u6210 mysql \u670d\u52a1\u5668\u7684 IP \u5730\u5740\u5373\u53ef\u3002")),(0,p.kt)("p",null,"\u7ee7\u7eed\u4e0b\u4e00\u6b65\u5b89\u88c5\u5b8c\u6210\uff1a"),(0,p.kt)("p",null,(0,p.kt)("img",{alt:"discuz_finished",src:a(43605).Z,width:"709",height:"725"})),(0,p.kt)("p",null,"\u81f3\u6b64\uff0cDiscuz \u8bba\u575b\u5df2\u7ecf\u5b8c\u6210\u5b89\u88c5\uff0cLAMP \u6d4b\u8bd5\u7ed3\u675f\u3002"))}m.isMDXComponent=!0},40783:function(e,t,a){t.Z=a.p+"assets/images/discuz_envok-8af4dedfb0678ff4aef3c2fc06a3a593.png"},22432:function(e,t,a){t.Z=a.p+"assets/images/discuz_envset-d9491d51e4a5e54a0d8b7d3540071707.png"},43605:function(e,t,a){t.Z=a.p+"assets/images/discuz_finished-b2b3521cc8ae3e8bf9f361a50157b5ab.png"},49051:function(e,t,a){t.Z=a.p+"assets/images/discuz_install-ec643749c04f8abe80986d893458a440.png"},76130:function(e,t,a){t.Z=a.p+"assets/images/discuz_problem-443be162bb86b95aefffe3412ed092e6.png"},9085:function(e,t,a){t.Z=a.p+"assets/images/xcache-d8d562b235da22473ac385f087710819.png"}}]);